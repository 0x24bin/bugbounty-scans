
<!DOCTYPE HTML>

 
<html lang="en" ng-app="uaApp">
<head>
<script src="/static/111213/js/perf/stub.js" type="text/javascript"></script><script src="/jslibrary/1500054742000/sfdc/VFRemote.js" type="text/javascript"></script><script type="text/javascript">
Visualforce.remoting.Manager.add(new $VFRM.RemotingProviderImpl({"vf":{"vid":"06636000006XieT","xhr":false,"dev":false,"tst":false,"dbg":false,"tm":1507270982433,"ovrprm":false},"actions":{"Sip_AccountController":{"ms":[{"name":"getAccountByExtId","len":1,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpOYSxoMVZRVXAxWkVELUltMFhFUjRMcFdPLFpqVTFaR1V4"},{"name":"getAccountByIATA","len":2,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpOYSw2bkw4TWRwNGQ0ME5vc192QWlkcXJyLE1HVXpOV1pq"},{"name":"getAccountById","len":2,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpOYSx4MGhCTXN4ZmRMMFg2dTJJYk9pbWEtLE9UQmlOalEz"},{"name":"getAccountSummaryById","len":2,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpOYSxneWpGYVpMZm1WYjdUSXdUYWY5b1QyLFpEVmlPVFJo"},{"name":"getAccounts","len":5,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpOYSxGV09PS2ZOM3hRam0wdXNYMlJTdlJBLE0ySTJZek0x"},{"name":"getAccountsForTransactionLog","len":4,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpOYSw2ejhPUmdIZkNyOTdZdUw2Q29sOTNOLE4yUmhOakF4"},{"name":"getAccountsForUpgrades","len":4,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpOYSxONXRUVzlFbFhuSDliZDJaZ0FKcE9lLFlqUTRObVE0"},{"name":"getBeneficiaryAccounts","len":4,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpSYSxpWE5KYXBMUUVZOEZqaFdVbVlxSXhrLFlqVXpObU15"},{"name":"getFromAccountsForFundsTx","len":2,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpSYSwzOGxPRF9XcWUza1NxWExZcDQtM3RJLFlXSXhaRFkw"},{"name":"getSelectableAccountsForFundsTxMultiple","len":4,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpSYSxadU5WeExubnpKcHZhTTBTU205U0hoLE4yTXpZakJo"},{"name":"getTransferLimit","len":2,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpSYSxPT3RDSUl4OHlLOG1rVHg5d3d0TTR0LFlXRTFNR0U0"},{"name":"isInAmexFamily","len":1,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpSYSwyYUtVTjNLRG1KdzU1dEJWdGRUTmJaLFpHVTBOV1Jp"},{"name":"submitFundsTransfer","len":1,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpkYSxHOWRSVDg2TUE3VjZKb0dOaF9ucGxNLFptUmlPRGxo"},{"name":"updateSFNotificationAmount","len":2,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTXpkYSxKMjY0WHBGOXlqSWk2WmNTeHg0a2RsLFlUTXlNREV3"}],"prm":1},"Sip_AmenityController":{"ms":[{"name":"activateTravelCert","len":8,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRGYSxMOERNOXRoQjJkYTdIclJHbTRIbE5SLFlXWTNNRGd5"},{"name":"addAmount","len":4,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRGYSxJTHdLQkREcXJJTHdQT1hHM1BPa3J6LFpEVmhNV1Jt"},{"name":"calculateNewExpirationDateByPremierLevelCutOffDate","len":1,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRGYSxjTG1mQksxTVVRLXBaeEJmc3ROVWhRLE4yVXpNakJp"},{"name":"commitTravelCertsTransaction","len":9,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRKYSw4dHhqd3M4TnFGTjRVVEVFc1lEcFZSLFlqYzFZMkpq"},{"name":"commitUpgradeTransaction","len":8,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRSYSw0UFhabWhVbDdWZ3RYS2E1OG13dWRJLE5qZG1aakV4"},{"name":"confirmAllTravelerServices","len":10,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRWYSw5Z1pyMTNSbUc4emNjaHFQMkg5QUlkLFl6QmtZbVJs"},{"name":"getAwardMiles","len":4,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRkYSx0QmRXN1BOVE43MHo3ZDItcmo0YUtaLFlXWTBObVZs"},{"name":"getBonusmilesQuota","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRsYSxrMWM5bXczQm9SeXJGMUVWMHFkd1F4LFlUa3hPRFEw"},{"name":"getCategoriesByAccountId","len":1,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTkRsYSxFZ0NDZng5OUg3dWtqQThNZHZLMzFTLFkyTTJNR1Ez"},{"name":"getCertAllocationByEmpID","len":0,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRCYSxfUUQybm5tTWJYWnphM3hfTTlSSmJELFpqRmxZVFUx"},{"name":"getCurrentPremierLevelStatus","len":1,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRCYSxHV3MydWVtVGFtbXpaajQ4WFYxdTJELFkyWmxPRFps"},{"name":"getPNRInfo","len":5,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRCYSxpZkR5c3V1ZDdyYndwSHFwclhfSkoyLE9XTmtNRE13"},{"name":"getPassDetail","len":3,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRSYSw4OVdTOGttQmx3Um9wQjBKVi1uUkk0LE5HWmpNR1Zs"},{"name":"getPassDetailWitEmail","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRSYSxwZUl4dnJrT2NESnVMYW5kSEdoS3NMLFlqYzBabUpp"},{"name":"getUpgradeBalance","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRaYSxMYnp0V1lldk1HYXZ3ODV2dWItYmZfLE1tTTVNemc0"},{"name":"preDeductAccountBalance","len":3,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRaYSxXMm1hYVZPSkxDV0cwcWN6WEw4WXg1LFpUQXdaR0Zr"},{"name":"preDeductAccountBalanceForNomination","len":4,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRaYSxtWU9BZlcyTmtsbkRUWGFZZ1hCbm10LFlXTTRaV1Jt"},{"name":"purchaseBeverageCoupons","len":8,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTlRoYSxmUU1GYkE2a2F6aDhCbWNLSkJvVHI3LE9ETm1OMlUz"},{"name":"purchasePremierLevel","len":9,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpGYSxXdjZNQmdxdjh1S3pLdWo4aWNtSC1tLE16UTJaVFV4"},{"name":"purchaseUpgrades","len":6,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpGYSx6ZlhDRUtKamJvQjVTSnhtYlJNc2ZSLE5qWXhZVGht"},{"name":"purchaseUpgradesRPU","len":6,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpGYSxlb2FZaFZWRTR0cTlNZUdpSW96NmxwLFpXVXlPVFl3"},{"name":"retrieveIssuePassWithMP","len":10,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpOYSw0X1V4UHNjcXhXdXpxdVNWVHlkdU1NLE0yWXlZak5o"},{"name":"retrieveIssuePassWithoutMP","len":8,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSxaTjFKYk9kam9EelNvWTdGQk10WUNtLE5XSmhOelV4"},{"name":"retrievePremierQualification","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSxCVUNfUzliOWlSYmZPa0Z5ZWpXY0pLLFlUZGxNak14"},{"name":"retrieveSubscription","len":4,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSw3ZXVhWkxhcDM1M084RHc3cnRsV2t0LFlUTTJaV1Ez"},{"name":"sendEmail","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSxtMkk3Y2lQUkI0ak5pTk5RQ2txN1h6LFlURXdNREF6"},{"name":"sendRemarks","len":5,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSxnckdkMnBSZnVkNGZwZEswOGxIUlZpLE9USmlOV1k1"},{"name":"sendTravelCertEmails","len":4,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSxraEFablhCMUJjZFJ1dk1sS0tFcU53LFpERm1PR1Uy"},{"name":"sendUnitedClubOTPEmail","len":3,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSxMQXhPMllIN0F1Rnl1UVFJQ3FpSWZVLE1ESTBNakJr"},{"name":"submitUCMEnrollment","len":8,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSxtMklrRGxEZVlTcUF5U1RaQy1JaEQ1LFlqSTVaRGsz"}],"prm":1},"Sip_CertificationFormController":{"ms":[{"name":"insertCertification","len":1,"ns":"","ver":39.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpSYSwxUVBOa3pMRUFNdWZLeVdpNnh3WWg5LE1HRmtZMkk1"}],"prm":1},"Sip_CommonController":{"ms":[{"name":"getAllControllerName","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSxiTUstWTNZSXBzeGdmZFJNMjFKWjZZLFptWXhNV1l4"}],"prm":0},"Sip_ContentManagementController":{"ms":[{"name":"doInitial","len":2,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSxkNU1ibFdXY3JUSXNHUDE2dzhJOTNTLFpqbGpOelpt"},{"name":"getAcquisition","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSwtS0s5SV9RMEswMlJfY0k0RHNfRlFaLE56Z3dNV0U1"},{"name":"getFeedbackContentManagementValues","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSxMY2FDa21kbVd5RHJQSXY1OUVpcDJnLE56RmtNakUw"},{"name":"getMarketingOrPromotionBlock1","len":2,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSw2Q21XRU1VR0ZXYXRvX0wxemYyOGZDLE16VmxaREJp"},{"name":"getMarketingOrPromotionBlock2","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSxqSS1KVVFFUkxzWGZvSHVpZUFIVE5ELE5HSmxOekJt"},{"name":"getUnitedMarketingOrPromotionTitleAndContent","len":1,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSx1WUt2R1E0Z2J4OUxZa0xJbWlQeTlTLFl6TXlZVFkw"},{"name":"getUnitedNewsContentManagementValues","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSw4Uy1oSFVla0duTzJxLXAzTXJmREdyLE9USTVNalZq"},{"name":"getUnitedSubscribeNowToOurEmail","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSxiRWFsaGpkbm44LU1sZlZtazh3andZLFpqQmxNak5p"},{"name":"getUnitedTravelWaiverContentManagementValues","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSxkOHdKd3l6OVMweXMzeHZWbmZaS2dOLFpETmtPR0pr"},{"name":"getUnitedUniversity","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSx3eGQ2V2hwSGFQMjdsazVtLTNvNnJoLE9USTNZekV6"}],"prm":1},"Sip_CountryListController":{"ms":[{"name":"getCountryList","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSxfZXAwTUFHc0lVRUhFc1JndEtZZXVLLE9EUm1abU0z"}],"prm":0},"Sip_EmbeddedBIController":{"ms":[{"name":"getDetailEmbeddedPowerBIReport","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSxZQ0hkeDFGNnlGUXV4Qi11ZzRTa1U2LFpEYzFOREpt"},{"name":"getEmbeddedPowerBIReport","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpWYSx1ZDRkRG5fb0d5dUJuLUlfTlM1RnRjLE56WXlPREUw"}],"prm":0},"Sip_GlobalSearchController":{"ms":[{"name":"search","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxneGk2STViMnFNSk9nWnFLckZWX2xLLE16YzROVGc1"}],"prm":0},"Sip_HomePageHeadersController":{"ms":[{"name":"getFooterValues","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxlbzZPbHZ3SThaeWEya1lKZFdlSXR4LFpEUXhaVGRq"},{"name":"getHeaderTitleandContentValues","len":1,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSw3X1d2Rnd6MUhqWGRUZTlfT0dNWUdiLFl6RTFOMlUx"},{"name":"getHomePageHeaderValues","len":0,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxDYUkwYjJfemQtc09aaFJnVVNHWEtaLFl6UTFOMlU0"}],"prm":0},"Sip_IncentiveReportsController":{"ms":[{"name":"getIncentiveReports","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSx2OVZfRmNBazFYeTJRa2JxT3VkZ2lvLE56QXdNVEk0"}],"prm":0},"Sip_LoginController":{"ms":[{"name":"login","len":2,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxhcmh0Mzh0VUo0cXBoTzlnTDhMeGtSLE9HWTRNREV3"}],"prm":0},"Sip_MyProfileController":{"ms":[{"name":"UpdateUserProfilePhotoandUserdata","len":3,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxUaklBblhVbnh0Wks4X1lCVjZDRWxmLE16TmhPRGM0"},{"name":"getImpersonationUserByContactId","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxPUGpVcER6SC1HZFJsZC1maVdxQ29CLE1EUmtPREF3"},{"name":"getKeyMetrics","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxXb2M5djlOZG1kNGJhWWhrWUNXeUl1LE5qSTVNMkZo"},{"name":"getSalesContacts","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSwwcUd6Mnl3NGkzbFluMy1VWnBIdEx1LE9HVTFZekl5"},{"name":"getUserInfoExtension","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSw2VDgzR1U5RUJYZDdFYzZSWWIzSkVYLFltSTVNMk5s"},{"name":"getUserInfo","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxXWVVBMWl1eXR1TWlfNFZRTUo5OUFqLE5tUTNZVE5s"},{"name":"updateUserPhoto","len":2,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpaYSxjYWJNbFNmemRZMjhSYkF1Z195ZXhxLFlUaGtaalZt"}],"prm":0},"Sip_NotificationController":{"ms":[{"name":"UpdateUserNotification","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpkYSxtcXJhWXBlRHZRMzBhWWdodUpHWlVBLFlqQTFPVGM1"},{"name":"getUserNotification","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpkYSxZVm1SaHE1Nm04UUhBSDh6c0F2SUwtLE9XWmpNR0Uz"}],"prm":0},"Sip_ProductInfoController":{"ms":[{"name":"getAmenityProductList","len":1,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpkYSxHY1h2aV9TOUVlYUhmVnhPeFJJV0ltLFlqZzJNRE13"},{"name":"getBonusMiles","len":1,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpkYSxtMkFoVVUzZUtid1c0V2FWaV9XcE1ZLFlUQXhaVGsz"},{"name":"getNominationProductList","len":1,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpkYSxGb1B6MjYyVXJCSzc4NFQwUnoyOXdLLFpEY3pPRGRp"},{"name":"getTravelCertificate","len":1,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpkYSxDTE9sMU1ZcEZ4RzZSWVdSWEN6SU5jLE9XVTNZV1E1"},{"name":"getUnitedClubProductList","len":1,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpkYSxBTG9mNjIxZHpLZXhua3RlZHV2S2hjLE5UWmhObUpt"}],"prm":0},"Sip_RegistrationPageandProcess":{"ms":[{"name":"InsertUserRegistrationPageValues","len":2,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTmpkYSxpbTZIQVgwM0oxY1hlNGZxWlBZSUJlLE9UVXhOMlkw"}],"prm":0},"Sip_TransactionHistoryController":{"ms":[{"name":"getDebitsByAccId","len":3,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpKYSxuVDJJYW40VC1qZ2hiaDA3cUVEX3c1LE1EUXlOV1F6"},{"name":"getDebitsByTransactionNumber","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSxUb1llY0VMR1NMR1U1M2lXbjVwejdPLE1XVXpPREl4"},{"name":"getDebitsFilterConfig","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSxjT0dwN2NnMmFtQVpJb3dOc2FiVUNrLFlqTmtZMlZo"},{"name":"getFamilyReportUrl","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSwxWEh0OHlUUE1PN2JCNjdjcnk3VzFyLE5UZzNNRE01"},{"name":"getSummaryByFilter","len":3,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSxKQ0VuWGN1RHFkR2Z0dFNRU1I1S0pULE0ySXdZMkUz"},{"name":"getTransactionDebitCSVUrl","len":4,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSxyOVBRTV9JWHhjdGdTczZxNEFrUUtoLE9HSXhZVGd3"},{"name":"getTransactionDetail","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSxIeDNFeENqZHNsMm8zUXpMV0YtRG1oLE5EWmlPVE5q"},{"name":"getTransactionSummaryCSVUrl","len":3,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSxUeHlDcENQTjZnMURlWlZqazFRalVxLFkyTTVOMk14"},{"name":"resendOTPEmail","len":3,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSx1cURXcDgwYVgxcnNUbkdiWC1DUlROLE1HWXlOMk0w"},{"name":"resendTravelCertEmail","len":2,"ns":"","ver":36.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSxBU3d3OXNKeFdSRklkQUdtQVJKdDF1LFlUYzVPVFUx"}],"prm":0},"Sip_UnitedNewsController":{"ms":[{"name":"getKnowMoreNewsContent","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpOYSxrdFdsTmRlTlZINFo1REl0MHpaQnZsLFlXSTBNVEJq"},{"name":"getViewAllUnitedNews","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSxfZ0xNSFBUcW11am1lbF9pOGZISzZ3LFptVTBaRFZp"}],"prm":0},"Sip_UserAgreementController":{"ms":[{"name":"UpdateUserAgreeCheckbox","len":1,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSw5QlF4LXJEQVJSSkxVZllrZ0dwdzgyLE1EaGlNVFJs"},{"name":"confirmAmenityConsent","len":0,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSxiSUxidGNscVVXa3BVbFBwZ285N3FuLE5UazJZemM0"},{"name":"getAmenityConsent","len":0,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSxZdEFtMDJNSmFMOW04M2R3NjBLUURxLE9UY3hNekF3"},{"name":"getTermConditionContentManagementValues","len":0,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSxTVFFRR2JkaktBeThabFk3SXZnTUdJLFpHRmhZVEl4"}],"prm":0},"Sip_UserManagementController":{"ms":[{"name":"activateUser","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSw1aGVSRUhZaGs4LWI2VDFVeDNEaE1uLFpEUXlPVGd5"},{"name":"createUserWithPermissions","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSx2bHpDSXlOYnBKc0d2RVdDaE44R0g4LE56UXhNMlU0"},{"name":"deactivateUser","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSxPSzFhQ1JVQkFaWkZZT28zZXVZTmVQLE1XRm1ZVE0y"},{"name":"exportUserManagementReportByArcNumbers","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpSYSxGYXplZkhTd2JNNTdlYVZBN3lncnFhLE1UQTBOV1Uy"},{"name":"exportUserManagementReportByType","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSxONTFCNGxlV3BNalB1U3dDemd1M0w1LFpqVXhORFEw"},{"name":"getAgencyAddress","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSxya3FUSDEwN2Yzd3dJVGo3VUtPNV9PLFpHVTBPV1kw"},{"name":"getAirports","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSwySE5fTnVKVkE0NlVjYnVXZW9YWDFfLE1USmtPREJo"},{"name":"getAvailableARCNumbers","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSx6VEpoZkdqbDRvY1ZVSVJDal9wSGY3LFpEa3lORGxp"},{"name":"getAvailablePermissions","len":3,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSw3S0puRVhBeWJLNy1keU1fcEVoTERuLE5HRXdabUUx"},{"name":"getAvailableUserRolesAndPermissionGroups","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSxfdHZQMmh3a0Q3cGZzOTdodDZQY1YwLE1USmpZMll5"},{"name":"getBranchLocation","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSxMaUJPTmZZX2wyOXhhaVE5MU4xcDFILE5tWmpaVFky"},{"name":"getCorpAgencies","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSxHVlZsSFNNWHMyVVFtTllVZ1Z2cE1fLE9EYzBOak15"},{"name":"getCorpAgencyDetail","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSw0ME5GZWtsODN0Mm1Nbmdrb1JEcVZuLE1qbGlZemd6"},{"name":"getCountries","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSxtaWpaWHJpTXV5TVFsdl9wS0hMaWtKLE1HVTNNalV5"},{"name":"getPowerBiReportPermissions","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpWYSxhTVdrRFAzOUhtbW9fRjlXRW1ESDhDLE56RmpZamd6"},{"name":"getSubordinateUsers","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSw2bUVEeGFfb0dCekVXOE9hSlNpRExrLE9HRTFNVEky"},{"name":"getUserDetails","len":2,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxpdkg4TkFNTlRVWDlkTXFhVTc3V1YyLFpqTTVNMlEw"},{"name":"getUserList","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSwtdWMyTTNUckpHbm0weHg1UXgxVGR0LFl6azBaVFpo"},{"name":"getUserManagementBasicVariable","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxQd21laG5iRF9lYW4zdF9FVml1ZWpELFl6bGhNR0l6"},{"name":"getUserManagementHelpDoc","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSx0WFJwRG8zNDJJX3VrT2FnTlNaWTItLE5qRXlNVFpo"},{"name":"getUserPermissions","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSwxdGNRWkJnQXVVVUtOaXJVdkFScl8yLE1qazFOV1po"},{"name":"lockUser","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxVY1VWN2VMWTJ2ZFNZMC00VmRlZjM0LE5tRm1Zemsw"},{"name":"manageAgencyFundAuthorization","len":0,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSw3VGFsWldYcDZTZTNkYXF1ZmY1MXliLE9EVTRPV0pp"},{"name":"massUploadUser","len":2,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxzVWdIZF9OOUExSnRHRDZQaUJmV0tzLE1XUmtaV000"},{"name":"rejectUser","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxJMkVBck9sV1IyemtMMmJRMzlyS081LE5HWmxNbUU1"},{"name":"resetPassword","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxLbVlvSXNPWG1LVV9FdG1GbXowd3BYLFpUbGtaV05t"},{"name":"saveUserPermissions","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxDc3BUbExJemM5S2RROVBnb2lPSWlzLE5HRmxOR0kz"},{"name":"unlockUser","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxHS0hzSy1tcjBocGR6Z0Nubl9JaTJrLE1tSXlOR0pp"},{"name":"updateAmount","len":3,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpaYSxiQ3BPYm4yR2U5RFBORkszWERuYkZULE5URmxPVGt5"},{"name":"updateCorpAgencyPermissions","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpkYSxib2lRbVZ1OTIyem9qMURjMWd1QzBELFpEaGpPRE16"},{"name":"updateUserProfile","len":2,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpkYSwxTGVuWDBvdmpEU1lYTFViZlpRX2NELE1XVm1aVFE0"},{"name":"validateAdditionalAgency","len":2,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpkYSxaSUN4NlUwXzhVbkNuOFJfMnlWWWpJLFpEaGhaR1Ez"},{"name":"validateUserProfileInfo","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpkYSxnbUV1NkdyUDc2U0JSZzBnV201U3hXLFlXSmxOVEUx"},{"name":"validationHelper","len":1,"ns":"","ver":35.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpkYSxlbGg3ejhBeEs0VGs2UDNjemZVMmt0LFl6VTNPV05s"}],"prm":0},"Sip_ValidatePNRController":{"ms":[{"name":"confirmWaiverFavor","len":7,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpkYSxmV2VYYklJbW9XV2k4RHFYNml4eE5KLFkyWXdOMlJr"},{"name":"generatePNRViewModelForEPlus","len":4,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpkYSxmaXFMTzBQY3NtY1EzY0lrOHNmVUROLFpURTROV1Ey"},{"name":"generatePNRViewModelForEPlusCorporateUser","len":4,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwTnpkYSxnNlpDcGFFRTV1b2tEcHotcVdrOEc4LE1tSTVPVGRq"},{"name":"generateSeatMapViewModelForEPlus","len":3,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RCYSxNX0tfSGZNQ3VjVHYtd1ZOc1pOLV9tLE1EWTJOams1"},{"name":"getPNRInfo","len":5,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RCYSxLYW9YaG1wendPSnVUb3ZGeUpSRm5SLFlUUTNOVEJt"},{"name":"getSalesAccountInfo","len":4,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RGYSwxZEt6aHQzUTExM0VjN3N1Rk1MTmNVLE9HTXdaVGsy"},{"name":"proceedTickets","len":1,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RGYSxUYTNweDN2MDl5MVBqZHB5S1JYNWdyLE9XVm1aR1pt"},{"name":"retrieveImpersonationSalesAccounts","len":2,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RGYSxyc2RHV2pGN2JGVmU4ZlhmNkdqRzlPLFlqRTVaV0Zo"},{"name":"retrieveSalesAccounts","len":2,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RGYSxFa0xRYUswR2lZTlZGMzRjLWxDUEFQLE1HSmtOVFJo"},{"name":"saveSelectedSeats","len":3,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RWYSx1NTVsVWpkSG9zc3pMLTRsb2NiY3ExLE56RXlNelUw"},{"name":"sendTransactionEmail","len":5,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSxfbFdwLVFGbnl2VURUSWtsbkJoZFNzLE4ySXlZelE0"},{"name":"submitEPlusEmail","len":5,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSw0a3B4T045YW5KcGRBNXRzXzg4Nk5DLE16QTRNekZq"},{"name":"submitEPlusFund","len":7,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSx2RE44ODU1MEdhQUV0blBJejkwd1E3LE1UTmlOamt4"},{"name":"submitEPlusRemarks","len":4,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSxnWkVnSWQ1cFZJNGNoVjBoaldWR1JqLFpEazBNVGc0"},{"name":"submitEPlus","len":4,"ns":"","ver":37.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSxVMlluMGM1ajhhclc2cUpNeFpjZ3huLE1qRTBNVFJt"}],"prm":0},"Sip_ViewAllTravelWaiverController":{"ms":[{"name":"getAllActiveTravelWaiversValues","len":0,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSxKY0x2ZllTRkFmRUt4RDMxd3NTSkkyLE5qRTFOMk00"},{"name":"getAllArchiveTravelWaiversValues","len":0,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSxqNlJBZVJUNk9yNmtmM2c2aHQyMWZDLFltWXpaakEy"}],"prm":0},"Sip_ViewTicketController":{"ms":[{"name":"getTicketInfo","len":2,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSxvRnhKbG1RcXVleUswbTNTeVRMVkxDLE9HWmtZbU5q"}],"prm":1},"Sip_WebToLeadController":{"ms":[{"name":"getWebToLead","len":0,"ns":"","ver":38.0,"csrf":"VmpFPSxNakF4TnkweE1DMHdPVlF3TmpveU16b3dNaTQwT0RaYSw1VmtWaEFLTE51dlNXWTdPamFFLTQ3LE1tUXpOemcw"}],"prm":0}},"service":"apexremote"}));
</script><meta HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE" />
<meta HTTP-EQUIV="Expires" content="Mon, 01 Jan 1990 12:00:00 GMT" />

  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
  <meta charset="UTF-8" />
  <meta content="Welcome to United’s business portal designed
            exclusively for our corporate customers and agency partners. Enjoy easy
            access to relevant news, operational waivers and self-service tools. With
            Insight comes new opportunities and solutions.
United. Offering
            Sales customers the best in global travel and support." name="description" />
  <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" name="viewport" />
  <meta content="yes" name="apple-mobile-web-app-capable" />
  <meta content="telephone=no" name="format-detection" />
  <meta content="email=no" name="format-detection" />
  <title>United Airlines</title>

  
  <script>
    window.dataLayer = window.dataLayer || [];
  </script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KR3G7XJ');</script>
  

  <script src="/resource/Sip_typekit_kit/awf4abw.js" type="text/javascript"></script>
  <script>
    try {
      Typekit.load();
    }
    catch (e) {
      console.log(e);
    }
  </script>
  <script src="/resource/Sip_jquery/dist/jquery.min.js" type="text/javascript"></script>
  <script src="/resource/Sip_angular/angular.js" type="text/javascript"></script>

  
  <link href="/resource/Sip_salesforce_lightning_design_system/assets/styles/salesforce-lightning-design-system.css" rel="stylesheet" />
  <link href="/resource/Sip_bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="/resource/Sip_angular_tree/angular-ui-tree.min.css" rel="stylesheet" />
  <link href="/resource/Sip_flatpickr/dist/flatpickr.css" rel="stylesheet" />
  <link href="/resource/Sip_custom_scrollbar/jquery.mCustomScrollbar.min.css" rel="stylesheet" /><span id="j_id0:j_id2">
<style type="text/css"> .flatpickr-calendar .flatpickr-innerContainer .flatpickr-rContainer .flatpickr-weekdays .flatpickr-weekday,.flatpickr-calendar .flatpickr-month{color:#fff}#footer .footer-wrapper a,a:focus,a:hover{text-decoration:none;background-color:transparent}#footer .footer-wrapper a:focus,:focus{outline:0}.modal,body,body .c-back{overflow-x:hidden}input[type=number]{-moz-appearance:textfield}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.forward{direction:ltr}.reverse{direction:rtl}.mCSB_inside>.mCSB_container{margin-right:16px!important}.mCSB_container.mCS_no_scrollbar_y.mCS_y_hidden{margin-right:0!important}.mCSB_scrollTools .mCSB_draggerRail{background-color:#f2f2f2}.mCSB_scrollTools .mCSB_dragger .mCSB_dragger_bar,.mCSB_scrollTools .mCSB_dragger.mCSB_dragger_onDrag .mCSB_dragger_bar,.mCSB_scrollTools .mCSB_dragger:active .mCSB_dragger_bar,.mCSB_scrollTools .mCSB_dragger:hover .mCSB_dragger_bar{background-color:#62a9e3;width:8px}.flatpickr-calendar{width:270.75px;font-size:12px;background-color:#2172BA}.flatpickr-calendar .flatpickr-month .flatpickr-next-month svg,.flatpickr-calendar .flatpickr-month .flatpickr-next-month svg:hover,.flatpickr-calendar .flatpickr-month .flatpickr-prev-month svg,.flatpickr-calendar .flatpickr-month .flatpickr-prev-month svg:hover{fill:#fff;color:#fff}.flatpickr-calendar .flatpickr-month .flatpickr-current-month .numInputWrapper span{right:-10px}.flatpickr-calendar .flatpickr-innerContainer{background-color:#fff;border-radius:0 0 5px 5px}.flatpickr-calendar .flatpickr-innerContainer .flatpickr-rContainer .flatpickr-weekdays{background-color:#2172BA}.flatpickr-calendar .flatpickr-innerContainer .flatpickr-rContainer .flatpickr-days{width:270.75px;display:inline-block}.flatpickr-calendar .flatpickr-innerContainer .flatpickr-rContainer .flatpickr-days .flatpickr-day{max-width:34px;height:34px;line-height:34px}.flatpickr-calendar .flatpickr-innerContainer .flatpickr-rContainer .flatpickr-days .flatpickr-day.selected{background-color:#2172BA;border-color:#2172BA}.flatpickr-calendar.arrowBottom:after,.flatpickr-calendar.arrowBottom:before,.flatpickr-calendar.arrowTop:after,.flatpickr-calendar.arrowTop:before{border:none}.flatpickr .input-group-addon{margin-left:0;margin-right:0}.flatpickr .glyphicon-calendar{color:#62a9e3;font-size:17px;margin-left:0;margin-right:0}.slds-checkbox [type=checkbox]:checked+.slds-checkbox--faux:after,.slds-checkbox [type=checkbox]:checked+.slds-checkbox__label .slds-checkbox--faux:after,.slds-checkbox [type=checkbox]:checked~.slds-checkbox--faux:after{display:block;content:'';height:.3rem;width:.7rem;position:absolute;top:45%;left:54%;transform:translate3d(-50%,-50%,0) rotate(-46deg);border-bottom:2px solid #62a9e3;border-left:2px solid #62a9e3}.slds-checkbox [type=checkbox]:checked+.slds-checkbox--faux.disabledChk:after,.slds-checkbox [type=checkbox]:checked+.slds-checkbox__label .slds-checkbox--faux.disabledChk:after,.slds-checkbox [type=checkbox]:checked~.slds-checkbox--faux.disabledChk:after{display:block;content:'';height:5px;width:9px;position:absolute;top:45%;left:54%;transform:translate3d(-50%,-50%,0) rotate(-46deg);border-bottom:2px solid #fff;border-left:2px solid #fff}.slds-checkbox .slds-checkbox__label{display:table}.slds-checkbox .slds-checkbox--faux{width:14px;height:14px;border:1px solid #999;border-radius:0}.slds-checkbox .slds-checkbox--faux.disabledChk{border:1px solid #ccc;background-color:#ccc}.slds-checkbox .slds-form-element__label{color:#666;padding-left:5px;line-height:normal;margin:0;display:table-cell!important;font-size:12px}.slds-radio [type=radio]:checked+.slds-radio--faux:after,.slds-radio [type=radio]:checked+.slds-radio__label .slds-radio--faux:after,.slds-radio [type=radio]:checked~.slds-radio--faux:after{width:.5rem;height:.5rem;content:'';position:absolute;top:50%;left:50%;transform:translate3d(-50%,-50%,0);border-radius:50%;background:#62a9e3}.slds-radio .slds-radio__label{display:table}.slds-radio .slds-radio--faux{border:1px solid #ccc;margin-top:4px}.slds-radio .slds-form-element__label{color:#666;padding-left:5px;line-height:normal;margin:0;display:table-cell!important;font-size:12px}.slds-spinner_container{background-color:transparent}.spinner-container{background-color:rgba(255,255,255,.8);bottom:0;left:0;position:fixed;right:0;top:0;z-index:10000;display:block}.spinner-container .circles-container{left:50%;margin-left:-30px;position:fixed;top:50%}.spinner-container .circles-container .circle:not(:required){position:absolute;text-indent:-9999px;display:inline-block;width:60px;height:60px;border-top-left-radius:60px;border-top-right-radius:60px;transform-origin:50% 100%}.spinner-container .circles-container .circle.circle-inner{animation:circles-loader-inner 36s -4s infinite cubic-bezier(.445,.05,.55,.95);border:1px solid #666;border-bottom:0;border-left-color:transparent;height:15px;left:15px;top:15px;width:30px}.spinner-container .circles-container .circle.circle-mid{animation:circles-loader-mid 36s -2s infinite cubic-bezier(.445,.05,.55,.95);border:2px solid #039;border-bottom:0;border-right-color:transparent;height:22px;left:7px;top:7px;width:44px}.spinner-container .circles-container .circle.circle-outer{animation:circles-loader-outer 36s infinite cubic-bezier(.445,.05,.55,.95);border:3px solid #2172BA;border-bottom:0;height:30px;left:0;top:0;width:60px}.spinner-container.inline{position:absolute}.spinner-container.inline .circles-container{left:50%;margin-left:-22px;position:absolute;top:50%;margin-top:-22px}body .c-back,body.menu-open-mobile .c-panel .c-panel-wrap .login-directive-container,body.menu-open-mobile .c-panel .c-panel-wrap .notification-panel-parent,body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel{left:0}.spinner-container.inline .circles-container .circle.circle-mid{height:15px;width:30px}.spinner-container.inline .circles-container .circle.circle-outer{height:22px;width:44px}@keyframes circles-loader-outer{0%{transform:rotate(-4320deg);border-left-width:3px;border-right-width:3px}25%{border-left-width:0}50%{border-left-width:3px;border-right-width:3px;transform:rotate(4320deg)}75%{border-right-width:0}100%{border-left-width:3px;border-right-width:3px}}@keyframes circles-loader-mid{0%{transform:rotate(-5040deg);border-top-width:2px;border-left-width:2px}25%{border-left-width:1px}50%{border-top-width:2px;border-left-width:2px;transform:rotate(5040deg)}75%{border-top-width:1px}100%{border-top-width:2px;border-left-width:2px}}@keyframes circles-loader-inner{0%{transform:rotate(-4320deg);border-left-width:1px;border-right-width:1px}25%{border-left-width:0}50%{border-left-width:1px;border-right-width:1px;transform:rotate(4320deg)}75%{border-right-width:0}100%{border-left-width:1px;border-right-width:1px}}.tooltips{position:absolute;color:#333;border-radius:0;text-align:left;white-space:normal}.tooltips:focus{border:1px solid #f2f2f2}.tooltips .slds-popover{width:100%;border-radius:0}.tooltips .slds-popover__body{padding:14px}.tooltips .slds-popover__body .tooltips-close{float:right;color:#333;margin-top:-2px}.tooltips .slds-popover__body .tooltips-header img{height:16px;width:16px}.tooltips .slds-popover__body p{font-size:11px;line-height:14px;margin-bottom:10px}.tooltips .slds-popover__body p:last-child{margin-bottom:0}.info-msg .slds-popover__body .tooltips-header span{line-height:16px;color:#2172BA;font-size:12px;vertical-align:middle;text-transform:uppercase;font-weight:700}.alert-msg .slds-popover__body .tooltips-header span{line-height:16px;color:#cd202c;font-size:12px;vertical-align:middle;text-transform:uppercase;font-weight:700}.tooltips.inline{width:100%;position:relative;display:table;border-collapse:separate}.tooltips.inline>span:first-child{display:table-cell;width:30px;vertical-align:middle;text-align:left;padding:0 5px}.tooltips.inline>span:first-child img{width:16px;height:16px;display:block}.tooltips.inline>span:last-child{display:table-cell;width:calc(100% - 16px);vertical-align:middle;text-align:left;font-size:11px;line-height:14px;word-wrap:break-word}.tooltips.inline.alert-msg{color:#cd202c}.helper-tooltips .tooltips.inline>span:last-child{font-size:inherit;line-height:inherit;color:#666}.helper-tooltips.alert-msg .tooltips.inline>span:last-child{font-size:inherit;line-height:inherit;color:#cd202c}.modal{overflow-y:auto}.modal .modal-dialog .modal-content{border-radius:0;padding:20px;background-clip:none;border:0}.modal .modal-dialog .modal-content img.icon{display:block;height:38px;margin:auto auto 20px}.modal .modal-dialog .modal-content.alert-msg{border-top:10px solid #f16321}.modal .modal-dialog .modal-content.info-msg{border-top:10px solid #2172BA}.modal .modal-dialog .modal-content.success-msg{border-top:10px solid #7ac24b}.send-me-email-addr{color:#2172BA}.error-msg{margin-top:6px;color:#CD202C;font-size:12px}.form-control.ng-error,.input-group.ng-error{border:1px solid #CD202C!important}.ng-error-icon{border-right:1px solid #CD202C!important;border-top:1px solid #CD202C!important;border-bottom:1px solid #CD202C!important}@media (min-width:544px){.slds-checkbox .slds-form-element__label,.slds-radio .slds-form-element__label{font-size:14px}}.mdl-shadow--2dp{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12)}.mdl-shadow--3dp{box-shadow:0 3px 4px 0 rgba(0,0,0,.14),0 3px 3px -2px rgba(0,0,0,.2),0 1px 8px 0 rgba(0,0,0,.12)}.mdl-shadow--4dp{box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.2)}.mdl-shadow--6dp{box-shadow:0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12),0 3px 5px -1px rgba(0,0,0,.2)}.mdl-shadow--8dp{box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12),0 5px 5px -3px rgba(0,0,0,.2)}.mdl-shadow--16dp{box-shadow:0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12),0 8px 10px -5px rgba(0,0,0,.2)}.mdl-shadow--24dp{box-shadow:0 9px 46px 8px rgba(0,0,0,.14),0 11px 15px -7px rgba(0,0,0,.12),0 24px 38px 3px rgba(0,0,0,.2)}.pd-l-10{padding-left:10px!important}.checkmark__circle{stroke-dasharray:166;stroke-dashoffset:166;stroke-width:2;stroke-miterlimit:10;stroke:#7ac24b;fill:none;animation:stroke .6s cubic-bezier(.65,0,.45,1) forwards}.checkmark{width:56px;height:56px;border-radius:50%;display:block;stroke-width:2;stroke:#fff;stroke-miterlimit:10;margin-left:auto;margin-right:auto;margin-bottom:20px;box-shadow:inset 0 0 0 #7ac24b;animation:fill .4s ease-in-out .4s forwards,scale .3s ease-in-out .9s both}.checkmark__check{transform-origin:50% 50%;animation:stroke .3s cubic-bezier(.65,0,.45,1) .8s forwards}@keyframes stroke{100%{stroke-dashoffset:0}}@keyframes scale{0%,100%{transform:none}50%{transform:scale3d(1.1,1.1,1)}}@keyframes fill{100%{box-shadow:inset 0 0 0 30px #7ac24b}}#footer{background:#011934;color:#fff;padding:40px 20px;width:100%}#footer .footer-wrapper a{color:#fff;line-height:20px;display:block}#footer .footer-wrapper a:active,#footer .footer-wrapper a:hover,#footer .footer-wrapper a:link,#footer .footer-wrapper a:visited{background-color:transparent;color:#fff}#footer .footer-wrapper .link ul li{padding-bottom:5px}#footer .footer-wrapper .link .column.social .new-window-icon{color:#fff}#footer .footer-wrapper .link .column.social>div{margin-top:10px;overflow:hidden}#footer .footer-wrapper .link .column.social>div span{display:none;padding:0 5px 10px 0}#footer .footer-wrapper .link .column.social>div ul{overflow:hidden}#footer .footer-wrapper .link .column.social>div ul li{float:left;margin-right:10px;width:27px}#footer .footer-wrapper .link .column.info{text-align:center}#footer .footer-wrapper .link .column.info .star-alliance{background:url(/resource/Sip_img_star_alliance) center no-repeat;background-size:contain;width:163px;height:16px;float:none;margin:5px auto auto}#footer .footer-wrapper .link .column.info p{font-size:10px;color:#949ea6;float:none;margin-top:5px;margin-bottom:0}#footer .footer-wrapper .footer-item>a{display:inline}#footer .footer-wrapper .footer-item svg{color:#fff;margin-top:-3.7px}.external-link-style{margin-top:20px;height:20px}.external-link-style svg{color:#fff}.external-link-style svg .new-window-icon{margin:0}.external-link-style p{font-size:12px;padding-left:5px;margin:0}@media (min-width:544px){#footer .footer-wrapper .link .column.social>div span{display:block}#footer .footer-wrapper .link .column.info .star-alliance{float:right}#footer .footer-wrapper .link .column.info p{float:left}}@media (min-width:768px){#footer .footer-wrapper .link .column,#footer .footer-wrapper .link .column+.column,#footer .footer-wrapper .link .column+.column+.column,#footer .footer-wrapper .link .column+.column+.column+.column{padding-right:10px;padding-left:10px}#footer .footer-wrapper .link .column+.column+.column.social{border-left:1px solid #2172BA}#footer .footer-wrapper .link .column+.column+.column.social>div{margin:0 10px;padding-top:5px;padding-bottom:5px}#footer .footer-wrapper .external-link-style{padding-left:10px}}@media (min-width:992px){#footer{padding-bottom:40px}#footer .footer-wrapper .link ul li:last-child{padding-bottom:0}#footer .footer-wrapper .link .column:first-child,#footer .footer-wrapper .link .column:nth-last-of-type(2){padding-left:10px;padding-right:10px}#footer .footer-wrapper .link .column.social{border-left:1px solid #2172BA;border-right:1px solid #2172BA}#footer .footer-wrapper .link .column.info>div{margin:0 10px;padding-top:5px;padding-bottom:5px}#footer .footer-wrapper .link .column.info>div .star-alliance{float:left;margin-top:0}#footer .footer-wrapper .link .column.info>div p{float:left;text-align:left}}body #content-container{margin-top:60px}body .no-text-selection{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}body .emulation-bar{background-color:#2172BA;text-align:center;height:20px;line-height:20px;color:#fff}body .c-back{position:absolute;top:60px;right:0;bottom:0;transition:opacity .15s linear;overflow-y:auto;z-index:89}.action-item,body header .header-wrap .c-user .user-wrap-new .user-more svg{transition:all .3s ease-in-out}body.menu-open .c-back{top:60px;background:#000;opacity:.5}body.menu-open-transparent .c-back{top:60px;opacity:0}body.menu-open-mobile{overflow:hidden}body.menu-open-mobile .c-panel{position:fixed;top:60px;bottom:0}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel>li{width:100%;overflow:hidden}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face{display:block}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap{display:block;font-weight:lighter;height:92px;border-top:1px solid #fff;padding:15px 30px}body header .header-wrap .c-menu,body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .desktop-signout{display:none}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap .user-face{float:left;margin:15px 13px 15px 0}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap .user-face img{height:36px;width:36px}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap .user-face:after{content:'';top:-18px;right:61px;position:absolute;border:9px solid #fff;border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap .user-info{float:left;margin:15px 0}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap .user-info div{line-height:18px;height:18px}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap .user-info div:first-of-type{font-weight:700}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap button{float:right;width:82px;background:0 0;border:1px solid;text-transform:uppercase;height:30px;font-weight:700;margin:15px 0}body.menu-open-mobile .c-panel .c-panel-wrap .user-drop-panel .mobile-user-face .wrap button:hover{background-color:#fff;color:#012086}body.menu-open-mobile .c-panel .c-panel-wrap .notification-panel-parent .notification-panel{width:100%;height:auto}body.menu-open-mobile .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card{width:100%}body.menu-open-mobile .c-back{top:0;background-color:#024;opacity:1}body header{position:fixed;top:0;width:100%;z-index:999;background-color:#012086}body header .header-wrap{height:60px;max-width:1280px;overflow:hidden;margin-left:auto;margin-right:auto;padding:0 10px}body header .header-wrap .c-logo{-ms-flex-align:center;align-items:center;position:relative;overflow:hidden}body header .header-wrap .c-logo .img-wrap{width:175px}body header .header-wrap .c-logo .img-wrap img{padding:23px 0}body header .header-wrap .c-sign-in,body header .header-wrap .c-sign-out{margin-left:5px}body header .header-wrap .c-sign-in a,body header .header-wrap .c-sign-out a{color:#fff;line-height:60px;text-transform:uppercase;font-weight:700}body header .header-wrap .c-search{height:100%;line-height:60px;margin:0 5px;position:relative}body header .header-wrap .c-search svg{height:100%}body header .header-wrap .c-hamburger{margin:0 5px;height:100%}body header .header-wrap .c-hamburger .c-icon-more{display:inline-block;width:24px;height:100%;position:relative}body header .header-wrap .c-hamburger .c-icon-more:before{content:'';position:absolute;display:block;height:2px;background:#fff;top:24px;width:100%}body header .header-wrap .c-hamburger .c-icon-more:after{content:'';position:absolute;display:block;height:2px;background:#fff;bottom:23px;width:100%}body header .header-wrap .c-hamburger .c-icon-close{display:inline-block;width:24px;height:100%;position:relative}body header .header-wrap .c-hamburger .c-icon-close:before{content:'';position:absolute;display:block;height:2px;background:#fff;top:29px;width:100%;transform:rotate(45deg)}body header .header-wrap .c-hamburger .c-icon-close:after{content:'';position:absolute;display:block;height:2px;background:#fff;bottom:29px;width:100%;transform:rotate(135deg)}body header .header-wrap .c-notification{width:30px;height:100%;line-height:60px;margin:0 5px;position:relative}body header .header-wrap .c-notification .arrow{top:70%;position:absolute;border:9px solid #fff;border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}body header .header-wrap .c-notification .has-msgs{background:url(/resource/Sip_img_notification_on) center no-repeat;background-size:contain;width:18px;height:100%}body header .header-wrap .c-notification .empty-msgs{background:url(/resource/Sip_img_notification_off) center no-repeat;background-size:contain;width:18px;height:100%}body header .header-wrap .c-notification .notes-count-wrapper{display:inline-block;width:30px}body header .header-wrap .c-notification .notes-count-wrapper .notes-count{padding:0 4px;border:1px solid #fff;border-radius:10px;background:#CD202C;position:relative;color:#fff;right:-12px;font-size:10px}body header .header-wrap .c-notification .notes-count-wrapper .notes-count.empty{background:#012086}body header .header-wrap .c-user{color:#fff;cursor:pointer;height:100%;margin-left:5px}body header .header-wrap .c-user .user-wrap-new{height:100%;display:table}body header .header-wrap .c-user .user-wrap-new .item{display:table-cell;vertical-align:middle}body header .header-wrap .c-user .user-wrap-new .item:first-child{padding-right:10px}body header .header-wrap .c-user .user-wrap-new .item:last-child{padding-left:10px}body header .header-wrap .c-user .user-wrap-new .user-info{display:none;text-align:right}body header .header-wrap .c-user .user-wrap-new .user-info p{font-size:12px;line-height:14px;margin:0;-ms-text-overflow:ellipsis;text-overflow:ellipsis;max-width:90px;white-space:nowrap;overflow:hidden}body header .header-wrap .c-user .user-wrap-new .user-info p:first-child{margin-bottom:5px;font-weight:700}body header .header-wrap .c-user .user-wrap-new .user-face img{width:37px;height:37px;border:1px solid #fff}body header .header-wrap .c-user .user-wrap-new .user-more{display:none}body header .header-wrap .c-user .user-wrap-new .user-more svg.open{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg)}body .c-panel{z-index:99;position:absolute;top:0;left:0;right:0}body .c-panel .c-panel-wrap{position:relative;max-width:1280px;height:100%;overflow-y:auto;overflow-x:hidden;margin:0 auto}body .c-panel .c-panel-wrap .menu-more{top:0;position:absolute;background:#024;width:100%;z-index:99;font-size:16px}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root{font-weight:700;background:#024;padding-top:2px}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .one-layer>div{font-weight:100}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .btn{margin-right:8px}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .angular-ui-tree-handle{background:#f8faff;border:1px solid #dae2ea;color:#7c9eb2;padding:10px 0;cursor:pointer}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root tr.angular-ui-tree-empty{height:100px}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .group-title{background-color:#687074!important;color:#FFF!important}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .tree-node{border:none;background:#024;color:#fff}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .nodrop{background-color:#f2dede}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .tree-handle{padding:10px;background:#428bca;color:#FFF;margin-right:10px}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .angular-ui-tree-placeholder{background:#f0f9ff;border:2px dashed #bed2db;box-sizing:border-box}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .angular-ui-tree-nodes>li .tree-node-content{font-size:16px;color:#fff;text-transform:uppercase}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .angular-ui-tree-nodes>li>ol>li .tree-node-content{font-size:12px;color:#fff}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .angular-ui-tree-nodes>li>ol{padding-left:18px}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root>ol{margin-left:22px}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .slds-icon-text-default{fill:#fff;width:12px;height:12px;margin-bottom:4px}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .tree-title{font-size:10px;color:#fff;text-transform:uppercase;padding-left:22px!important;margin:6px 0}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .tree-title:first-of-type{margin:17px 0 5px;font-size:10px;color:#fff;text-transform:uppercase;padding-left:20px!important}body .c-panel .c-panel-wrap .menu-more #tree-row #tree-root .slds-icon_container{padding:2px}body .c-panel .c-panel-wrap .mega-menu{position:absolute;top:0;left:318px;right:0;margin:0 auto}body .c-panel .c-panel-wrap .mega-menu .menu-level2{float:left;margin-left:-318px}body .c-panel .c-panel-wrap .mega-menu .menu-level2 a{display:block;height:60px;width:318px;line-height:60px;text-align:left;background-color:#333;text-indent:20px;color:#e6e6e6;font-weight:700}body .c-panel .c-panel-wrap .mega-menu .menu-level2 a:hover{background-color:#0070B9}body .c-panel .c-panel-wrap .mega-menu .menu-level2 a:active{background-color:#333}body .c-panel .c-panel-wrap .mega-menu .menu-level2 a.active{background-color:#e6e6e6;color:#002F57}body .c-panel .c-panel-wrap .mega-menu .menu-level3{background:#fff;overflow:hidden;box-sizing:border-box;padding-bottom:15px}body .c-panel .c-panel-wrap .mega-menu .menu-level3 .menu3-title{color:#333;font-family:"Open Sans";font-size:24px;font-weight:lighter;line-height:88px;padding:0 34px;margin-bottom:-8px;text-overflow:ellipsis;white-space:nowrap}body .c-panel .c-panel-wrap .mega-menu .menu-level3 .menu3-wrap{padding:0 16px}body .c-panel .c-panel-wrap .mega-menu .menu-level3 .menu3-wrap .menu3-item{display:inline-block;vertical-align:top;width:274px;margin:0 18px}body .c-panel .c-panel-wrap .mega-menu .menu-level3 .menu3-wrap .menu3-item .title{font-weight:700;color:#2172BA;font-family:"Open Sans";font-size:14px;overflow:hidden;display:inline}body .c-panel .c-panel-wrap .mega-menu .menu-level3 .menu3-wrap .menu3-item .content{color:#666;font-size:14px;font-weight:400;font-family:"Open Sans";display:-webkit-box;padding-bottom:10px;margin-bottom:10px}body .c-panel .c-panel-wrap .mega-menu .menu-level3 .menu3-wrap .menu3-item .menu4-wrap{margin-bottom:10px}body .c-panel .c-panel-wrap .user-drop-panel{position:absolute;right:0;top:0}body .c-panel .c-panel-wrap .user-drop-panel li{width:300px;text-align:left;line-height:30px;font-weight:700;text-transform:uppercase;background:#012086;color:#fff}body .c-panel .c-panel-wrap .user-drop-panel li>a{display:block;padding:15px 30px;color:#fff;border-top:1px solid #2172BA}body .c-panel .c-panel-wrap .user-drop-panel li:hover{border-left:5px solid #fff;background-color:#2172BA}body .c-panel .c-panel-wrap .user-drop-panel li:hover>a{padding-left:25px}body .c-panel .c-panel-wrap .user-drop-panel li.mobile-user-face{display:none;border-left:none;background-color:#012086}body .c-panel .c-panel-wrap .notification-panel-parent{position:absolute;right:0}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel{max-height:600px;overflow:auto;overflow-x:hidden;border:2px solid #E6E6E6;border-top:none;margin:0;width:400px;background:#fff;padding:0;color:#666}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card{position:relative;cursor:pointer;margin:0;padding:0 20px;line-height:50px;background:#fff}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card .note-header{font-weight:700!important}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card .note-wrap{line-height:20px;overflow:hidden;border-bottom:1px solid #e6e6e6;padding:10px 0}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card .note-wrap p{line-height:19px;margin:0 0 10px}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card .note-wrap p.note-title{font-weight:lighter;color:#2172BA;margin:0}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card .note-wrap p.note-date{margin:0;font-size:10px;color:#999}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card:hover{background:#F2F2F2}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card .close-btn{position:absolute;right:27px;top:-5px}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card:first-child:hover{background:#fff}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card:last-child{margin-bottom:0}body .c-panel .c-panel-wrap .notification-panel-parent .notification-panel .note-card:last-child .note-wrap{border-bottom:none}body .c-panel .c-panel-wrap .login-directive-container{position:absolute;top:0;right:0;height:280px;border:1px solid #ddd}.new-window-icon{margin-left:4px;margin-top:-4px}.external-card .external-link-small{position:absolute;bottom:15px;right:15px}.external-card.external-link-waiver .external-link-small{float:right;position:static;margin-top:-2px;margin-left:2px}#public-landing .external-card.external-link-subscribe .external-link-small{float:right;position:static;margin-left:2px}#public-landing .external-card.external-link-subscribe .external-link-small svg{color:#2172BA}@media all and (min-width:576px){body header .header-wrap .c-sign-in,body header .header-wrap .c-sign-out{margin-left:10px}body header .header-wrap .c-hamburger,body header .header-wrap .c-notification,body header .header-wrap .c-search{margin:0 10px}body header .header-wrap .c-user{margin-left:10px}}@media all and (min-width:768px){body #content-container{margin-top:0}body header{position:relative}body header .header-wrap{padding:0 20px}body header .header-wrap .c-menu{display:block;margin-left:10px}body header .header-wrap .c-menu .menu-item{line-height:60px}body header .header-wrap .c-menu .menu-item .menu-link{color:#fff;padding:22px 5px;position:relative;font-weight:700}body header .header-wrap .c-menu .menu-item .menu-link.active:after{content:'';position:absolute;display:block;left:calc(50% - 10px);bottom:0;border:10px solid #fff;border-left-color:#012086;border-right-color:#012086;border-top-color:#012086}body header .header-wrap .c-hamburger{display:none}body header .header-wrap .c-user .user-wrap-new .user-info{display:table-cell}body .c-panel{top:60px}body .c-panel .c-panel-wrap{overflow-y:visible;overflow-x:visible}}body,h5,h6,html{line-height:16px}h2,h3{color:#333}body,html,label{font-weight:400}@media all and (min-width:992px){body header .header-wrap .c-menu{margin-left:20px}body header .header-wrap .c-menu .menu-item .menu-link{padding:22px 10px}body header .header-wrap .c-logo .img-wrap{width:257px}body header .header-wrap .c-logo .img-wrap img{padding:19px 0}body header .header-wrap .c-user .user-wrap-new .user-info p{max-width:311px}body header .header-wrap .c-user .user-wrap-new .user-more{display:table-cell}}*,body,html,ol,ul{margin:0}.ng-cloak,.x-ng-cloak,[data-ng-cloak],[ng-cloak],[ng\:cloak],[x-ng-cloak]{display:none!important}*{font-family:open-sans,"Helvetica Neue",Arial,Helvetica,Calibri,"Lucida Grande",sans-serif!important;padding:0}:focus{box-shadow:none}::-ms-clear{display:none}body,html{position:relative;padding:0;font-size:12px;font-synthesis:none;color:#666;background-color:#f2f2f2}body{height:auto;background-repeat:no-repeat;background-size:cover;background-position:center center}h1,h2,h3,h4{font-weight:lighter}h1,h2,h3,h4,h5,h6{padding:0;margin:0;display:inline}h1{font-size:24px;line-height:28px;color:#039}h2{font-size:22px;line-height:26px}h3{font-size:18px;line-height:22px}h4{font-size:14px;line-height:18px}.bold-font,.section-header,a,a:focus,a:hover,h6.sub-title{font-weight:700}h5,h6{font-size:12px}h6.sub-title{text-transform:uppercase;display:block}a{color:#2172BA}a:focus,a:hover{color:#2172BA;outline:0}a .link-item{text-transform:uppercase}ol,ul{padding:0}input,textarea{border:none;outline:0!important;box-shadow:none!important;border-radius:0!important;resize:none!important;font-size:12px}::-webkit-input-placeholder{font-size:12px;line-height:16px}input[type=text]:-moz-placeholder{font-size:12px;line-height:30px}input[type=text]::-moz-placeholder{font-size:12px;line-height:30px}textarea:-moz-placeholder{font-size:12px;line-height:30px}textarea::-moz-placeholder{font-size:12px;line-height:30px}:-ms-input-placeholder{font-size:12px;line-height:16px}#content-container{padding:0 10px}.container-fluid{position:relative;max-width:1280px;margin:0 auto;padding:0}.nav,.navbar,.navbar-collapse,.navbar-header,.navbar-nav{margin:0;padding:0;border-radius:0}.row{margin:0;padding:0}[class*=col-]{padding:0;min-height:1px}.break-line-10px{display:block;height:10px}.break-line-20px{display:block;height:20px}.break-line-30px{display:block;height:30px}.break-line-40px{display:block;height:40px}.break-line-50px{display:block;height:50px}.break-line-60px{display:block;height:60px}.break-line-70px{display:block;height:70px}.break-line-80px{display:block;height:80px}.up-80px{top:60px!important}.uppercase-font{text-transform:uppercase}.section-header{text-transform:uppercase;color:#002F57;display:block}.section-wrapper .section-header-row{padding:15px 0;border-bottom:1px solid #2172BA;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.section-wrapper .section-header-row>:last-child{margin-left:auto}.section-wrapper svg.toggle-btn{transition:all .3s ease-in-out;color:#2172BA}.section-wrapper svg.toggle-btn.open{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg)}.single-line-truncate{overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1;white-space:nowrap}.wrap-text{word-wrap:break-word}.message-panel{height:60px;margin:0 -10px;border:3px solid #fff;background-color:#fff;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.message-panel .img-icon{margin-left:20px;height:20px}.message-panel.alert-msg{background-color:#cd202c;color:#fff}.message-panel.alert-msg .img-icon{transform:rotate(180deg)}.message-panel.info-msg{background-color:#2172BA;color:#fff}.message-panel.success-msg{background-color:#7ac24b;color:#fff}.message-panel .message-panel-content{margin-left:10px}.message-panel .message-panel-content a{font-weight:700!important;text-transform:uppercase!important;color:#fff!important;position:static}.dropdown-item,.dropdown-item a{text-transform:none;font-weight:400;text-overflow:ellipsis;-webkit-line-clamp:1;white-space:nowrap}.message-panel svg{margin-left:auto;margin-right:20px}.search-panel{margin:0 -10px;background-color:#fff}.dropdown-menu{font-size:12px;line-height:14px;width:100%;max-height:200px;overflow-y:auto;overflow-x:hidden;border-radius:0;border:0;padding:0;margin-top:2px}.dropdown-item,.dropdown-item *{line-height:20px}.dropdown-menu li a{padding:0;margin:0}.list-limit-exceeded{padding:10px;font-size:11px;color:#666}.dropdown-item{height:40px;width:100%;padding:10px;text-align:left;color:#666;display:block;overflow:hidden}.responsive-table .table-row>div,.table-footer>div.text-right,.table-header>div.text-right,.table-row>div.text-right{text-align:right}.dropdown-item.dropdown-item:focus,.dropdown-item.dropdown-item:hover{background-color:#f5f5f5}.dropdown-item a{display:inline;color:#666;overflow:hidden}label{margin:0}label.text-label{margin:13px 0 5px}.form-control{height:50px;font-size:12px;line-height:18px;padding:10px;border:1px solid #ccc!important;color:#333}.form-control.ng-error{border-color:#CD202C!important}.form-control.no-border{border:0!important}.form-control.no-left-border{border-left:0!important}.form-control.no-right-border{border-right:0!important}.form-control.alert-highlight{border:1px solid #CD202C!important}.form-control.required{border-left:4px solid #CD202C!important}.form-control[disable],.form-control[readonly]{background-color:#fff;opacity:1}.input-group-addon{border-radius:0;background-color:#fff;border:1px solid #ccc}.input-group-addon.no-border{border:0!important}.input-group-addon.no-left-border{border-left:0!important}.input-group-addon.no-right-border{border-right:0!important}.input-group.custom{border:1px solid #ccc;background-color:#fff}.input-group.custom.required{border-left:4px solid #CD202C!important}.input-group.custom.ng-error{border-color:#CD202C}.input-group.custom .form-control{border:0!important;height:48px}.input-group.custom .input-group-addon{border:0!important}.slds-button__icon{color:#62a9e3}.slds-button__icon.white{color:#fff}.slds-button__icon.grey{color:#bbb}.slds-button__icon.green{color:#7ac24b}.slds-button__icon.red{color:#cd202c}.slds-button__icon.orange{color:#f16321}.slds-required{text-decoration:none!important;cursor:none!important;border:none!important}.input-label{margin:10px 0 5px}.label-text{color:#666}.dark-text{color:#333}.blue-text{color:#2172BA}.flex-center{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.glyphicon{font-family:'Glyphicons Halflings'!important}.table-header{padding:12px 0}.table-header>div{padding-right:10px}.table-header h6{font-size:12px;text-transform:uppercase;font-weight:700;color:#666}.table-footer,.table-row{border-top:1px solid #e6e6e6;color:#333}.table-row{padding:12px 0}.table-row>div{padding-right:10px}.table-footer{padding:12px 0}.table-footer.no-border{border:0}.table-footer>div{padding-right:10px}.responsive-table .flex-center{display:block}.responsive-table .table-row{padding:0;border-top:2px solid #e6e6e6}.responsive-table .table-row>div{padding:12px 10px;border-top:1px solid #e6e6e6}.responsive-table .table-row>div:before{font-size:12px;text-transform:uppercase;font-weight:700;color:#666;content:attr(data-label);float:left}.responsive-table .table-row:last-child{border-bottom:3px solid #e6e6e6}.responsive-table .table-footer{padding:0;border-top:3px solid #e6e6e6}.responsive-table .table-footer>div{padding:12px 10px;text-align:right}.responsive-table .table-footer>div:before{font-size:12px;font-weight:700;color:#333;content:attr(data-label);float:left}.action-item{margin:0;border-radius:0;border:1px solid #fff;text-align:center;font-size:12px}.action-item.flex-center{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.action-item a,.action-item.btn{font-weight:700;text-transform:uppercase;display:block;color:#fff;line-height:20px}.action-item.w-margin{margin:0 10px!important}.action-item.l-margin{margin-left:10px!important}.action-item.r-margin{margin-right:10px!important}.action-item.btn{width:100%;padding:14px 0;margin:auto}.action-item.btn.w-margin{width:calc(100% - 20px)}.action-item.btn.quaternary{padding:12px 0}.action-item a{padding:14px;font-size:12px;overflow:hidden}.action-item.primary{background-color:#1C5CAB}.action-item.secondary{background-color:#7C848A}.action-item.tertiary{background-color:#2172BA}.action-item.quaternary{border:3px solid #2172BA;background-color:#fff;color:#2172BA;padding:12px 15px}.action-item.quaternary *{padding:0;margin:0 5px;line-height:20px;max-height:20px}.action-item.quaternary a{color:#2172BA}.action-item.quaternary.activated{background-color:#2172BA;color:#fff}.action-item.quaternary.activated *{color:#fff}.action-item.quinary{background-color:#f16321}.action-item.senary{background-color:#cd202c}.action-item.septenary{background-color:#fff;color:#2172BA;border:3px solid #fff;padding:12px 15px}.action-item.septenary *{padding:0;margin:0 5px;line-height:20px;max-height:20px}.action-item.septenary a{color:#2172BA}.action-item.septenary:hover{border:3px solid #2172BA;background-color:#2172BA;color:#fff}.action-item.septenary:hover *{color:#fff}.action-item.disabled{background-color:#CCC;opacity:.65}@media (min-width:440px){.message-panel .message-panel-content a{position:absolute;right:60px}}@media (min-width:544px){body,h6,html{font-size:14px;line-height:18px}h1{font-size:30px;line-height:34px}h2{font-size:28px;line-height:32px}h3{font-size:24px;line-height:28px}h4{font-size:20px;line-height:24px}h5{font-size:16px;line-height:20px}[class*=col-]{min-height:1px}::-webkit-input-placeholder{font-size:14px;line-height:18px}input[type=text]:-moz-placeholder{font-size:14px;line-height:30px}input[type=text]::-moz-placeholder{font-size:14px;line-height:30px}textarea:-moz-placeholder{font-size:14px;line-height:18px}textarea::-moz-placeholder{font-size:14px;line-height:18px}:-ms-input-placeholder{font-size:14px;line-height:18px}.action-item,.action-item a,.form-control,input,textarea{font-size:14px}.table-footer,.table-header,.table-row{padding:11px 0}.responsive-table .table-footer,.responsive-table .table-row{padding:0}.responsive-table .table-footer>div,.responsive-table .table-row>div{padding:11px 10px}}@media (min-width:768px){.responsive-table .table-footer>div:before,.responsive-table .table-row>div:before{content:''}.table-footer,.table-header,.table-row{padding:11px 0}.responsive-table .flex-center{display:-ms-flexbox;display:flex}.responsive-table .table-row{padding:11px 0;border-top:1px solid #e6e6e6}.responsive-table .table-row>div{border-top:none;padding:0 10px 0 0;text-align:left}.responsive-table .table-row:last-child{border-bottom:none}.responsive-table .table-footer{padding:11px 0;border-top:1px solid #e6e6e6}.responsive-table .table-footer>div{padding:0 10px 0 0;text-align:left}.section-wrapper .section-header-row>:last-child{margin-right:10px}.up-80px{top:80px!important}}#gohome-confirm-modal .row.button .col-xs-6:first-child .action-item{margin-left:0}#gohome-confirm-modal .row.button .col-xs-6:last-child .action-item{margin-right:0}html{background-color:#fff}html.security body{height:auto;background:url(/resource/Sip_img_security_background) center repeat-x;background-size:auto 100%;background-color:#2172BA!important}html.security body footer{height:90px;padding:20px 0}html.security body #security div.function-block{margin:40px auto 20px}html.security body #security .change-password,html.security body #security .question,html.security body #security .reset-password,html.security body #security .username{background:#fff;padding:20px}html.security body #security .reset-password-complete{background:#fff;padding:20px;text-align:center}html.security body #security .reset-password-complete img.icon{display:block;height:38px;margin:auto}html.security body footer .star-alliance{background:url(/resource/Sip_img_star_alliance) center no-repeat;background-size:contain;width:163px;height:16px;float:none;margin:5px auto auto}html.security body footer .copyright{font-size:10px;color:#fff;text-align:center}html.security body #password-not-match,html.security body #wrong-answer{width:80%;bottom:55px;left:10%} 
</style></span><span id="j_id0:j_id5">
<style type="text/css"> #marketing-detail .marketing-content,#news-detail .news-content,#sub-menu-page,#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .table-row span{word-wrap:break-word}.acquisition-wf{max-width:800px;padding:0 0 20px;margin:0 auto}.acquisition-wf .title h1{display:block;text-align:center;color:#039}#acquisition-wf1 .radio{margin-top:0;margin-bottom:0;height:30px}#acquisition-wf1 .radioValue .col-sm-4{margin-bottom:10px}#acquisition-wf1 .checkBoxValue,#acquisition-wf1 .radioValue{padding-left:20px}#acquisition-wf2 #country{border-right:none!important}#acquisition-wf2 .checkBoxValue label{margin-top:0;margin-bottom:0}#acquisition-wf2 .checkbox,.radio{margin-top:0!important;margin-bottom:0!important}#acquisition-wf2 .checkbox label,.radio label{padding-left:0}#acquisition-wf2 textarea{height:200px;border-left:1px solid #ccc!important}#acquisition-wf2 .inputLabelSection{margin-top:20px}#acquisition-wf2 .required-note{color:#CD202C;margin-top:15px;padding-left:0;margin-bottom:5px}#acquisition-wf2 .required-note span{color:#333}#acquisition-wf2 .slds-checkbox__label{display:table}#acquisition-wf2 .slds-checkbox--faux{margin-top:4px}#acquisition-wf2 .slds-form-element__label{display:table-cell;padding-left:5px}#acquisition-form .inputLabel{height:35px}#acquisition-wf3 h1{display:block;margin:auto;text-align:center;line-height:60px;font-weight:100}#acquisition-form .address-row .col-sm-6:first-child,#acquisition-form .address-row .col-sm-6:last-child{margin-bottom:10px}.country-ul{margin-left:0;width:100%!important}#acquisition-wf2 .input-group-addon{border-radius:0;background-color:#fff;border-left:none}#acquisition-wf2 .input-group-addon .slds-button__icon{color:#62a9e3}#acquisition-wf2 .col-xs-12 span{color:#CD202C}@media (min-width:768px){#acquisition-form .row .col-sm-6:first-child{padding-right:10px}#acquisition-form .row .col-sm-6:last-child{padding-left:10px}#acquisition-wf2 .inputLabelSection:last-child>ul{margin-left:10px}}#travel-container{padding:33px;overflow-x:hidden}#travel-container>h1{font-size:30px;color:#039;margin-bottom:18px;display:block}#travel-container>h6{font-size:14px;color:#999}#travel-container>h6 span{color:#333}#travel-container .sub-title{color:#666;font-size:14px;margin:50px 0 54px}#travel-container .parameter-legend>h2{font-size:24px;color:#333}#travel-container .parameter-legend>h2 span{font-size:14px;color:#D93639;font-weight:700}#travel-container .parameter-legend ul{margin-top:40px}#travel-container .parameter-legend ul .wrap{background:#F2F2F2;height:430px}@media all and (max-width:992px){#travel-container .parameter-legend ul .wrap{height:400px}}#travel-container .parameter-legend ul li{padding:0 5px}#travel-container .parameter-legend ul li .head{height:80px;text-align:center;text-transform:uppercase}#travel-container .parameter-legend ul li .head p:first-of-type{font-size:12px;line-height:36px;font-weight:700}#travel-container .parameter-legend ul li .head p:nth-of-type(2){font-size:30px;font-weight:lighter}#travel-container .parameter-legend ul li .body{padding:0 24px}#travel-container .parameter-legend ul li .body .item{margin:30px 0}#travel-container .parameter-legend ul li .body .item p:nth-child(1){color:#666;font-size:12px;text-transform:uppercase;font-weight:700}#travel-container .parameter-legend ul li .body .item p:nth-child(2){color:#424242;font-size:14px;font-weight:400}#travel-container .parameter-legend ul li .body .item-no-head{color:#424242}#travel-container .parameter-legend ul li .body .item-no-head p:first-of-type{margin-bottom:0}#travel-container .parameter-legend ul li .body .conditions-list{margin-top:0;margin-bottom:10px;padding-left:2em}#travel-container .parameter-legend ul li .body .conditions-list li{height:auto;position:relative}#travel-container .parameter-legend ul li .body .conditions-list li:before{content:'';display:inline-block;height:8px;width:8px;border-radius:1px;background-color:#2172BA;position:absolute;left:-20px;top:4px}#travel-container .parameter-legend ul li .body .conditions-list .wrap{height:600px}#travel-container #active-travel-waivers{padding:0 24px}#travel-container #active-travel-waivers .table caption{padding-left:8px}#travel-container #active-travel-waivers .table caption .c-badge{float:right;margin-top:-50px}#travel-container #active-travel-waivers .table .sub-title{margin:10px 0 0;font-size:12px;color:#999}#travel-container #active-travel-waivers .labelOne,#travel-container #active-travel-waivers .labelOnePlus,#travel-container #active-travel-waivers .labelThree,#travel-container #active-travel-waivers .labelTwo,#travel-container .archived-travel-waivers .labelOne,#travel-container .archived-travel-waivers .labelOnePlus,#travel-container .archived-travel-waivers .labelThree,#travel-container .archived-travel-waivers .labelTwo{width:100%;display:block;height:25px;line-height:25px}#travel-container .archived-travel-waivers{position:absolute;top:0;width:100%}#travel-container .date-select .list-of-date{padding:0 24px;border:1px solid #E6E6E6;margin-bottom:20px}#travel-container .date-select .list-of-date .line-view{font-size:24px;margin:0 -24px;background:#F2F2F2;font-weight:lighter;border:1px solid #E6E6E6;text-align:left;text-indent:30px;min-height:80px;line-height:80px;position:relative}#travel-container .date-select .list-of-date .line-view .icon-wrap{position:absolute;right:30px;top:0}#travel-container .date-select .list-of-date .line-view .icon-wrap svg{fill:#2172BA}#travel-container .date-select .list-of-date .line-view .c-badge{position:absolute;right:90px;top:26px;text-indent:0}#travel-container .date-select .list-of-date .line-view:hover{background-color:#2172BA;color:#fff}#travel-container .date-select .list-of-date .line-view:hover .icon-wrap{color:#000}#travel-container .date-select .list-of-date .line-view:hover .icon-wrap svg{fill:#fff}#travel-container .date-select .list-of-date .line-view:hover .c-badge{background-color:transparent;border:1px solid #fff}#travel-container .date-select .list-of-date .c-table caption{padding-left:8px}#travel-container .date-select .list-of-date .c-table caption .c-badge{float:right;margin-right:30px}#travel-container .date-select .list-of-date .c-table caption .c-triangle{float:right;margin-right:10px}#travel-container .date-select .list-of-date .c-table caption .slds-icon-text-default{transform:rotate(180deg);fill:#2172BA}#travel-container .date-select .list-of-date .icon-wrap{float:right}#travel-container .date-select>button{display:block;margin:0 auto 7px;color:#fff;font-size:14px;font-weight:700;background:#2172BA;border:none;height:50px;width:200px;text-align:center;line-height:50px}#travel-container .date-select .parameter-legend{margin-bottom:30px}#travel-container .date-select .parameter-legend .wrap{height:550px}@media all and (max-width:1280px){#travel-container .date-select .parameter-legend .wrap{height:640px}}@media all and (max-width:992px){#travel-container .date-select .parameter-legend .wrap{height:500px}}#travel-container .c-badge{width:90px;height:30px;background-color:#999;color:#FFF;font-weight:700;font-size:12px;text-transform:uppercase;display:block;text-align:center;line-height:30px;border-radius:15px}#travel-container .c-badge.active{background-color:#7AC24B;margin-right:24px}#travel-container .c-table{margin:32px 0}#travel-container .c-table caption{font-size:24px;font-weight:lighter;color:#333;padding:0 0 0 8px;margin-bottom:38px}#travel-container .c-table thead tr th{min-width:70px;font-size:12px;font-weight:700;color:#666;text-transform:uppercase;width:10%;vertical-align:top}#travel-container .c-table tbody tr td{font-size:14px;color:#333;font-weight:400}#travel-container .c-table tbody tr td span,#travel-container h1~h6{display:block}#travel-container .labelOne{text-align:center;color:#333;background-color:#bfbfbf}#travel-container .labelOnePlus{text-align:center;color:#333!important;background-color:#EDB72B}#travel-container .labelTwo{text-align:center;color:#fff!important;background-color:#F16321}#travel-container .labelThree{text-align:center;color:#fff!important;background-color:#CD202C}#certification{max-width:800px;padding:20px 0;margin:0 auto}#certification .required-note{color:#CD202C;padding-left:0}#certification .required-note span{color:#333}#certification .title{font-weight:lighter;color:#039}#certification .dropdown-menu{top:48px}#certification #description{height:150px}#certification .ng-required{border-right:1px solid #CD202C!important;border-top:1px solid #CD202C!important;border-bottom:1px solid #CD202C!important}#certification-confirm{max-width:800px;padding:20px 0;margin:0 auto}#certification-confirm h1{display:block;margin:auto;text-align:center;line-height:60px;font-weight:100}@media (min-width:768px){#certification .row .col-sm-6:first-child{padding-right:10px}#certification .row .col-sm-6:last-child{padding-left:10px}}#global-search{max-width:1280px;margin:0 -10px}#global-search .search-section{background-color:#f2f2f2;height:150px;padding:20px;margin-top:0}#global-search .search-section .search-criteria .col-sm-10 input,#global-search .search-section .search-criteria .col-xs-9 input{border-right:none!important}#global-search .search-section .search-criteria .col-sm-2 input,#global-search .search-section .search-criteria .col-xs-10 input{margin-left:0!important;border:1px solid #ccc!important;border-left:none!important}#global-search .content{padding:20px}#global-search .content .result-row .content-url{color:#2172BA;margin:4px 0!important}#global-search .content .pagination{color:#ccc;text-align:center}#global-search .content .pagination a{color:#2172BA;display:inline-block;font-weight:700;padding:0 10px;vertical-align:middle}#global-search .content .pagination a:hover{text-decoration:none}#global-search .content .pagination span.current{display:inline-block;padding:0 10px;color:#333;vertical-align:middle;font-weight:700}#global-search .content .pagination span.disabled{display:inline-block;padding:0 10px;color:#ccc;vertical-align:middle}#global-search .content .pagination span.disabled .slds-button__icon{color:#ccc!important}#global-search .content .division{width:100%;height:2px;background-color:#f2f2f2}#global-search .content .search-united{margin-bottom:40px}#global-search .content .search-united input{margin-left:0!important}@media (min-width:768px){#global-search{margin:0 auto}#global-search .search-section{margin-top:12px}}#login-module>div.row>div.col-sm-6 div#login-module{border:1px solid #ddd}#login-module.root{width:100%;padding:20px;background:#fff;position:relative}#login-module.root .sign-in-label{float:left;font-weight:lighter;padding-bottom:5px;color:#666}#login-module.root .sign-up-label{font-weight:700;text-align:right;color:#2172BA;line-height:30px}#login-module.root .sign-up-label span{margin-left:10px}#login-module.root .sign-up-label a{color:#2172BA}#login-module.root .login-form{clear:both}#login-module.root .login-form .log-wrap{margin:0!important;border-bottom:1px solid #d0cdc7}#login-module.root .login-form .log-wrap .log-input{width:100%;color:#000;height:45px}#login-module.root .login-form .log-wrap .log-input::-webkit-input-placeholder{color:#bbb;font-size:14px!important}#login-module.root .login-form .log-wrap .log-input:-moz-placeholder{color:#bbb;font-size:14px!important}#login-module.root .login-form .log-wrap .log-input::-moz-placeholder{color:#bbb;font-size:14px!important}#login-module.root .login-form .log-wrap .log-input:-ms-input-placeholder{color:#bbb;font-size:14px!important}#login-module.root .login-form .input-fix{padding-top:12px}#login-module.root .login-form #password,#login-module.root .login-form #username{padding:10px 0}#login-module.root .login-form .forgot-cont{text-align:right;color:#2172BA;border-bottom:none;font-weight:700;line-height:40px;margin:0}#login-module.root .login-form .forgot-cont a{color:#2172BA!important}#login-module.root .login-form .gsa-link{margin-top:12px;text-align:right;margin-bottom:0}#login-module.root .login-form .gsa-link a{color:#666}#login-module.root .login-form .submit-cont{text-align:center;color:#2172BA}#login-module.root .login-form .submit-cont input{text-align:center;background-color:#fff;border:3px solid #2172BA!important;text-transform:uppercase;font-weight:700;width:294px;line-height:44px}#login-module.root .login-form .submit-cont.active{color:#fff}#login-module.root .login-form .submit-cont.active input{background-color:#2172BA}#login-error-tooltips{top:-50px;left:calc(50% - 145px)}#login-error-tooltips.popup-style{right:10px;left:initial;top:36px}@media (min-width:768px){#login-error-tooltips.popup-style{right:initial;left:-275px;top:36px}}#agreement{max-width:800px;padding:20px;margin:20px auto;background-color:#fff}#agreement .title{text-align:center;font-weight:lighter;display:block;padding-bottom:20px;color:#039}#agreement .agreement-wrapper .subtitle{text-align:center;color:#000;font-weight:700;text-transform:uppercase;margin-bottom:20px}#agreement .agreement-wrapper .agreement-content{text-align:left;line-height:1.8}#agreement .agreement-wrapper .agreement-content p{margin:10px 0}#agreement .agreement-wrapper .agreement-content ul{padding-left:2em}#agreement .agreement-wrapper .agreement-content li{margin:10px 0;position:relative}#agreement .agreement-wrapper .agreement-content li::before{content:'';display:inline-block;height:8px;width:8px;border-radius:1px;background-color:#2172BA;position:absolute;left:-20px;top:9px}#agreement .row.agreement-footer{padding-top:20px}#agreement .row.agreement-footer .action-item{padding-left:0;padding-right:0}#marketing-detail{max-width:800px;padding-top:20px;margin:0 auto}#marketing-detail .title{font-weight:lighter;color:#333}#marketing-detail .marketing-content h1{font-size:24px;font-weight:lighter;color:#039}#marketing-detail .marketing-content h2{font-size:18px;font-weight:lighter;color:#333}#marketing-detail .marketing-content h3{font-size:12px;font-weight:700;color:#003057}#marketing-detail .marketing-content a{font-weight:400;color:#2172BA}#marketing-detail .marketing-content table{border:none!important;margin-top:20px;width:auto!important}#marketing-detail .marketing-content table td,#marketing-detail .marketing-content table th{font-size:14px;color:#333;font-weight:400;padding:8px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}#marketing-detail .marketing-content table tr:hover>td,#marketing-detail .marketing-content table tr:hover>th{box-shadow:#d8dde6 0 -1px 0 inset,#d8dde6 0 1px 0 inset;background-color:#f4f6f9}#marketing-detail .marketing-content table th{font-size:12px;font-weight:700;color:#666;text-transform:uppercase}#marketing-detail .marketing-content table thead tr:first-child>td,#marketing-detail .marketing-content table thead tr:first-child>th{border-top:none}#marketing-detail .marketing-content img{width:100%!important;height:auto!important}#marketing-detail .marketing-content ul{padding-left:2em}#marketing-detail .marketing-content ul:before{content:'';display:block;height:30px}#marketing-detail .marketing-content ul li{margin-bottom:12px;position:relative}#marketing-detail .marketing-content ul li:before{content:'';display:inline-block;height:8px;width:8px;border-radius:1px;background-color:#2172BA;position:absolute;left:-20px;top:4px}#marketing-detail .marketing-content ul li li:before{border:2px solid #2172BA;background-color:transparent;border-radius:50%}#marketing-detail .marketing-content ul li li li:before{height:2px;top:7px;border:none;background-color:#2172BA;width:10px}@media (min-width:544px){#marketing-detail .marketing-content h1{font-size:30px;font-weight:lighter}#marketing-detail .marketing-content h2{font-size:24px;font-weight:lighter}#marketing-detail .marketing-content h3{font-size:14px;font-weight:700}}.main-wrap-mass{position:relative;margin:0 20px}.main-wrap-mass .table-header>div{padding-left:10px}.main-wrap-mass .table-header>div:last-child{text-align:left;padding-left:10px;padding-right:0}.main-wrap-mass .table-row>div{padding-left:10px}.main-wrap-mass .table-row>div:last-child{text-align:left;padding-left:10px;padding-right:0}.main-wrap-mass.error,.main-wrap-mass.success{margin:30px 0}.main-wrap-mass .btns{margin:20px 0}.svg-40{width:32px;height:32px}.svg-25{height:20px;width:20px}.svg-red{fill:#c61a32}.svg-blue{fill:#7cc54b}.reupload-container{background:#f2f2f2;margin:30px 0;padding:20px 0}.reupload-container .left-panel,.reupload-container>h3{padding-left:20px}.reupload-container .right-panel{padding-left:20px;border-left:1px solid #c8c8c8}.reupload-container .row{margin:10px 0}.reupload-container .file-input-row{margin:22px 0}.mass-main-style{padding:0 20px}@media all and (min-width:992px){.main-wrap-mass .col-md-1{width:10.33333333%}.main-wrap-mass .table-header{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.main-wrap-mass .table-header>div{padding-left:10px}.main-wrap-mass .table-header>div:last-child{text-align:right;padding-left:0;padding-right:10px}.main-wrap-mass .table-row{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.main-wrap-mass .table-row>div{padding-left:10px}.main-wrap-mass .table-row>div:last-child{text-align:right;padding-left:0;padding-right:10px}}#my-incentives{max-width:1280px;padding:20px 10px;margin:0 auto;background-color:#fff}#my-incentives .title{font-weight:lighter;color:#039;margin-left:10px}#my-incentives .report-wrapper-row{-ms-flex-wrap:wrap;flex-wrap:wrap;display:block}#my-incentives .report-wrapper-row .report-wrapper{padding:0 10px 20px}#my-incentives .report-wrapper-row .report-wrapper .report-title h3{color:#333}#my-incentives .report-wrapper-row .report-wrapper .report-block{background-color:#f2f2f2;border:1px solid #e6e6e6;height:100%;padding:20px;position:relative}#my-incentives .report-wrapper-row .report-wrapper .report-block .report-content{margin-bottom:40px}#my-incentives .report-wrapper-row .report-wrapper .report-block .report-content p{color:#666}#my-incentives .report-wrapper-row .report-wrapper .report-block .view-report-btn{position:absolute;left:20px;bottom:20px;font-weight:700}#my-incentives .hover-style{background-color:#2172BA!important;color:#fff}#my-incentives .hover-style a,#my-incentives .hover-style h3,#my-incentives .hover-style p{color:#fff!important}@media (min-width:768px){#my-incentives .report-wrapper-row{display:-ms-flexbox;display:flex}}#my-profile-wrapper{max-width:800px;margin:80px auto;position:relative;background-color:#fff;padding:20px}#my-profile-wrapper h3{display:block;margin:40px auto 5px;width:200px;text-align:center}#my-profile-wrapper #title{text-align:center;color:#a9a9a9!important}#my-profile-wrapper #photo{border-radius:50%;background-color:#fff;border:4px solid #fff;width:100px;height:100px;position:absolute;left:calc(50% - 50px);top:-50px;background-position:center;background-size:cover;overflow:hidden}#my-profile-wrapper #photo .img,#my-profile-wrapper #photo img{width:100px;height:100px}#my-profile-wrapper #photo .mask-style{background-color:#B8B8B8;z-index:1;filter:alpha(opacity=50);opacity:.8;position:absolute;text-align:center;overflow:hidden;width:100px;height:100px;left:0!important;top:0!important}#my-profile-wrapper ._box,#my-profile-wrapper ._box input{width:120px;height:20px;line-height:20px;position:absolute;cursor:pointer}#my-profile-wrapper ._box{background-image:url(images/bg.png);background-repeat:no-repeat;background-position:0 0;background-attachment:scroll;text-align:center;color:#fff;overflow:hidden;z-index:1;left:calc(50% - 60px);top:0}#my-profile-wrapper ._box input{font-size:23px;opacity:0;filter:"alpha(opacity=0)";filter:alpha(opacity=0);-moz-opacity:0;z-index:2;padding:0!important}#profile-form .row{margin:0 -10px}#profile-form .row .form-group{margin-bottom:0;padding:0 10px}#profile-form .row .form-group h3,#profile-form .row .form-group h6{display:block}#profile-form .row .form-group label{color:#999}#profile-form .row .form-group label .tooltips{top:-100px;left:32px}#profile-form .row .form-group label .slds-nubbin--bottom:after,#profile-form .row .form-group label .slds-nubbin--bottom:before{left:20%}#profile-form .row .form-group label img{height:14px;margin-top:-2px}#profile-form .row .form-group input#user-airport{border-right:none!important}#my-sales-contacts-page{max-width:1280px;padding-top:20px}#my-sales-contacts-page .contacts-title,#my-sales-contacts-page .page-title{padding-left:10px}#my-sales-contacts-page .contacts-information{padding:0 0 20px}#my-sales-contacts-page .contacts-information .col-sm-6{padding:0 10px}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block{background-color:#fff;padding:40px 10px 20px;border:1px solid #e2e2e2}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block p{color:#333}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block .photo-img{border-radius:50%;background-color:#fff;width:80px;height:80px;position:absolute;left:30px;top:20px;background-position:center;background-size:cover;overflow:hidden}#my-sales-contacts-page .help-desk-info table tr:hover>td,#my-sales-contacts-page .help-desk-info table tr:hover>th,#news-detail .news-content table tr:hover>td,#news-detail .news-content table tr:hover>th{box-shadow:#d8dde6 0 -1px 0 inset,#d8dde6 0 1px 0 inset;background-color:#f4f6f9}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block h3{display:block;height:28px;margin-left:110px}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block h6{display:block;height:18px;margin-left:110px}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block .info-row a.email-link{display:block;margin:0 0 10px;font-weight:400}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block .account-row{border-top:1px solid #62a9e3;margin:0 10px}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block .account-row .col-sm-6{padding:0}#my-sales-contacts-page .contacts-information .admin-user,#my-sales-contacts-page .contacts-information .sales-manager,#my-sales-contacts-page .contacts-information .sales-service-manager{padding-bottom:20px}#my-sales-contacts-page .contacts-information .admin-user:last-child{padding-bottom:0}#my-sales-contacts-page .help-desk-info{padding:0 10px 20px}#my-sales-contacts-page .help-desk-info table{margin-top:10px;width:100%}#my-sales-contacts-page .help-desk-info table tbody tr td{padding:10px;border-top:1px solid #ddd;color:#333}#my-sales-contacts-page .help-desk-info table tbody tr td:first-child{width:50%;padding-right:10px}#my-sales-contacts-page .help-desk-info table tbody tr td:last-child{width:50%;padding-left:10px}@media (min-width:768px){#my-sales-contacts-page .contacts-information .col-sm-6 .information-block{margin-bottom:0!important}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block .info-row{height:100px;overflow:hidden}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block .account-row .col-sm-6:first-child{padding-left:0}#my-sales-contacts-page .contacts-information .col-sm-6 .information-block .account-row .col-sm-6:last-child{padding-left:10px}}#news-detail{max-width:800px;padding-top:20px;margin:0 auto}#news-detail #breadcrumb{padding-bottom:20px}#news-detail #breadcrumb li{padding-left:0;padding-right:5px;float:left}#news-detail #breadcrumb li a{color:#2172BA;font-weight:700}#news-detail .title{font-weight:lighter;color:#333}#news-detail .publish-date{margin-top:10px;color:#666}#news-detail a.next,#news-detail a.prev{color:#2172BA;font-weight:700;margin-top:20px}#news-detail a.prev{float:left}#news-detail a.next{float:right}#news-detail .is-first,#news-detail .is-last{color:#ccc!important}#news-detail .news-content h1{font-size:24px;font-weight:lighter;color:#039}#news-detail .news-content h2{font-size:18px;font-weight:lighter;color:#333}#news-detail .news-content h3{font-size:12px;font-weight:700;color:#003057}#news-detail .news-content a{font-weight:400;color:#2172BA}#news-detail .news-content table{border:none!important;margin-top:20px;width:auto!important}#news-detail .news-content table td,#news-detail .news-content table th{font-size:14px;color:#333;font-weight:400;padding:8px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}#news-detail .news-content table th{font-size:12px;font-weight:700;color:#666;text-transform:uppercase}#news-detail .news-content table thead tr:first-child>td,#news-detail .news-content table thead tr:first-child>th{border-top:none}#news-detail .news-content img{width:100%!important;height:auto!important}#news-detail .news-content ul{padding-left:2em}#news-detail .news-content ul:before{content:'';display:block;height:30px}#news-detail .news-content ul li{margin-bottom:12px;position:relative}#news .news-body,#news .news-body .news-list .row .action-item{margin-top:10px;margin-bottom:10px}#news-detail .news-content ul li:before{content:'';display:inline-block;height:8px;width:8px;border-radius:1px;background-color:#2172BA;position:absolute;left:-20px;top:4px}#news-detail .news-content ul li li:before{border:2px solid #2172BA;background-color:transparent;border-radius:50%}#news-detail .news-content ul li li li:before{height:2px;top:7px;border:none;background-color:#2172BA;width:10px}@media (min-width:544px){#news-detail .news-content h1{font-size:30px;font-weight:lighter}#news-detail .news-content h2{font-size:24px;font-weight:lighter}#news-detail .news-content h3{font-size:14px;font-weight:700}}#news .news-head h1{display:block;padding-top:20px;color:#039}#news .news-body .news-list .row{margin-left:-10px;margin-right:-10px}#news .news-body .news-list .row .news-item{padding:10px;cursor:pointer}#news .news-body .news-list .row .news-item .news-item-wrapper{height:304px;background-color:#fff;border:1px solid #ddd}#news .news-body .news-list .row .news-item .news-item-wrapper:hover{box-shadow:1px 1px 10px 3px #ccc}#news .news-body .news-list .row .news-item .news-item-wrapper .img{height:136px;background-size:cover;background-position:center}#news .news-body .news-list .row .news-item .news-item-wrapper .content{height:218px;padding:20px}#news .news-body .news-list .row .news-item .news-item-wrapper .content h6{font-weight:700;color:#2172BA;display:block;padding:0 0 10px}#news .news-body .news-list .row .news-item .news-item-wrapper .content h3{font-weight:lighter;color:#333}#news .news-body .news-list .row .news-item .news-item-wrapper .content span{font-weight:400;color:#666;position:absolute;top:280px;left:30px}#news .news-body .news-list .row .action-item.is-last{display:none!important}@media (min-width:544px){#news .news-body .news-list .row .news-item .news-item-wrapper{height:304px}#news .news-body .news-list .row .news-item .news-item-wrapper .content span{top:280px}}@media (min-width:768px){#news .news-body .news-list .row .news-item .news-item-wrapper{height:324px}#news .news-body .news-list .row .news-item .news-item-wrapper .content span{top:300px}}@media (min-width:992px){#news .news-body .news-list .row .news-item .news-item-wrapper{height:344px}#news .news-body .news-list .row .news-item .news-item-wrapper .content span{top:320px}}@media (min-width:1200px){#news .news-body .news-list .row .news-item .news-item-wrapper{height:374px}#news .news-body .news-list .row .news-item .news-item-wrapper .content span{top:350px}}#public-landing>.row{margin:0 -10px}#public-landing>.row.banner{margin-bottom:5px}#public-landing>.row.banner .col-sx-12 .mini-banner{height:150px;background-image:url(/resource/Sip_img_tmp/Sip_img_tmp/banner_6.png);background-repeat:no-repeat;background-size:cover;background-position:left center;position:relative}#public-landing>.row.banner .col-sx-12 .main-banner{background-color:#fff}#public-landing>.row.banner .col-sx-12 .main-banner .col-sm-6{padding:20px}#public-landing>.row>.col-sm-6{padding:5px 10px}#public-landing>.row>.col-sm-6>div{background:#fff;border:1px solid #e6e6e6;height:280px}#public-landing>.row>.col-sm-6>div.marketing{height:auto}#public-landing>.row:last-child{margin:0 -5px 5px}#public-landing>.row:last-child .col-sm-6{padding:0}#public-landing>.row:last-child .col-sm-6 .col-xs-6{padding:5px;height:auto;background:0 0;border:none}#public-landing>.row:last-child .col-sm-6 .col-xs-6>div{background:#fff;border:1px solid #e6e6e6;height:180px}@media (min-width:768px){#public-landing>.row.banner{margin-bottom:10px}#public-landing>.row.banner .col-sx-12 .main-banner{background-image:url(/resource/Sip_img_tmp/Sip_img_tmp/banner_6.png);background-repeat:no-repeat;background-size:cover;background-position:left center;position:relative;height:280px}#public-landing>.row.banner .col-sx-12 .main-banner .col-sm-6,#public-landing>.row.banner .col-sx-12 .main-banner .col-sm-6 h1{color:#fff!important}#public-landing>.row>.col-sm-6{padding:10px}#public-landing>.row>.col-sm-6>div.marketing{height:280px}#public-landing>.row:last-child{margin:0 -10px 10px}#public-landing>.row:last-child .col-sm-6{padding:0}#public-landing>.row:last-child .col-sm-6 .col-xs-6{padding:10px}}.registration_wf{max-width:800px;padding:0;margin:0 auto}.registration_wf .title{padding-left:10px}.registration_wf .required-note{color:#CD202C;margin-top:15px;padding-left:10px}.registration_wf .corp-user-msg,.registration_wf .field-block{padding:0 10px}.registration_wf .required-note span{color:#333}.registration_wf .field-block #country{border-right:none!important}.registration_wf .field-block .country-ul{margin-left:0}.registration_wf .field-block .input-group-addon{border-radius:0;background-color:#fff}.registration_wf .field-block .input-group-addon .slds-button__icon{color:#62a9e3}.registration_wf .cancel-btn{margin:0 10px 10px}.registration_wf .save-btn{margin:0 10px 20px}.registration_wf .save-btn a:hover{background:initial}.registration_wf .thx-msg{text-align:center}.registration_wf .m-bottom-40{margin-bottom:40px}.registration_wf .m-bottom-20{margin-bottom:20px}.registration_wf .m-bottom-10{margin-bottom:10px}.registration_wf .m-top-40{margin-top:40px}.registration_wf input::-webkit-inner-spin-button,.registration_wf input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.registration_wf .submit-btn{background-color:transparent;display:block;width:100%;height:100%}#tab-content .tab-pane{position:relative}#tab-content .tab-pane#dashboard{min-height:450px;margin:0 -10px;background-color:#fff}#tab-content .tab-pane#dashboard iframe{border:0}#tab-content .tab-pane#dashboard .view-as{position:absolute;bottom:20px;width:300px;right:175px}#no-data,#tab ul li{width:100%}#tab-content .tab-pane#dashboard .view-as label{float:left;margin:15px 20px 0 0;color:#fff}#tab-content .powerbi-frame{height:400px;border-top:1px solid #e6e6e6}#tab{margin:0 -10px}#tab ul{border-top:1px solid #ddd;border-bottom:1px solid #ddd}#tab ul.nav-justified li a{height:50px;background-color:#2172BA;font-size:14px;font-weight:700;color:#fff;line-height:30px;text-transform:uppercase;margin-bottom:0}#tab ul.nav-justified li a.disabled{background-color:#ccc}#tab ul.nav-justified li.active a{background-color:#003057}#no-data{height:450px;color:#000;background-color:#D4D4D0;text-align:center;vertical-align:middle;padding-top:200px;display:none}div.single-pb-menu{width:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:stretch;align-items:stretch}div.single-pb-menu .single-bp-menu-item{padding:25px 20px 22px;line-height:20px;text-transform:uppercase;color:#2172BA;border-bottom:3px solid transparent;font-weight:700;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}div.single-pb-menu .single-bp-menu-item.selected{color:#002F57;border-bottom:3px solid #2172BA}div.single-pb-menu .more-reports{width:200px;position:absolute;right:10px;top:10px}div.single-pb-menu .more-reports .slds-button-group .slds-button{width:160px;height:50px;font-size:14px;text-transform:uppercase;font-weight:700;padding-left:0;color:#2172BA}div.single-pb-menu .more-reports .slds-button-group .slds-button:focus>span,div.single-pb-menu .more-reports .slds-button-group .slds-button:hover>span{background-color:#f4f6f9}div.single-pb-menu .more-reports .slds-button-group .slds-button span{background-color:#fff}div.single-pb-menu .more-reports .slds-button-group .slds-button span svg{fill:#2172BA}div.single-pb-menu .more-reports .slds-button-group .slds-button span svg.slds-icon--large{width:2.5rem;height:2.5rem}div.single-pb-menu .more-reports .slds-dropdown-trigger .slds-button{height:50px;width:40px}div.single-pb-menu .more-reports .slds-dropdown{width:200px}.jump-to-full{position:absolute;bottom:20px;right:20px;width:auto!important;padding-left:20px!important;padding-right:20px!important}#single-pb,#single-pb .single-pb-menu{position:relative}.key-metrics h1,.key-metrics label{text-align:center;display:block}.key-metrics h1{color:#333}.key-metrics h1 span{display:inline-block}.key-metrics h1 span a.disabled .slds-button__icon{color:#ccc}@media (min-width:768px){#tab ul{display:table}#tab ul li{width:50%}}#common-home>.row{margin:0 -10px}#common-home>.row>.col-sm-6{padding:5px 10px}#common-home>.row>.col-sm-6>div{background:#fff;border:1px solid #e6e6e6;height:280px}#common-home>.row>.col-sm-6>div.marketing{height:auto}#common-home>.row:last-child{margin:0 -5px 5px}#common-home>.row:last-child .col-sm-6{padding:0}#common-home>.row:last-child .col-sm-6 .col-xs-6{padding:5px;height:auto;background:0 0;border:none}#common-home>.row:last-child .col-sm-6 .col-xs-6>div{background:#fff;border:1px solid #e6e6e6;height:180px}#common-home>.row.ticket-search{background-color:#fff;border:1px solid #e6e6e6;padding:10px;margin:5px 0}#common-home>.row.ticket-search a{display:block}#common-home>.row.ticket-search a h6{font-weight:700}#common-home>.row.ticket-search .col-xs-4,#common-home>.row.ticket-search .col-xs-8{height:auto!important;border:none!important;background-color:transparent!important}#common-home>.row.ticket-search .col-xs-8 input{border:1px solid #2172BA!important;border-right:none!important}#common-home>.row.ticket-search .col-xs-4 input{margin-left:0!important;border:1px solid #2172BA!important;border-left:none!important;width:100%}@media (min-width:768px){#common-home>.row>.col-sm-6{padding:10px}#common-home>.row>.col-sm-6>div.marketing{height:280px}#common-home>.row:last-child{margin:0 -10px 10px}#common-home>.row:last-child .col-sm-6{padding:0}#common-home>.row:last-child .col-sm-6 .col-xs-6{padding:10px}#common-home>.row.ticket-search{padding:20px;margin:10px 0}}#single-pb .report-header{padding:0 10px}#single-pb .powerbi-frame{height:100%;margin:0 -10px}#single-pb iframe{width:100%;min-height:500px!important;border:0}@media (min-width:768px){#single-pb .report-header{padding:10px 20px 0}}#sub-menu-page{max-width:800px;padding:0!important}#sub-menu-page img{width:100%}#sub-menu-page .sub-title,#sub-menu-page h3{display:block;margin:26px 0 16px}#sub-menu-page h2{display:block;font-weight:lighter;line-height:100%;margin-bottom:26px}#sub-menu-page .sub-bottom{margin:0}#sub-menu-page .sub-bottom h1{font-size:24px;font-weight:lighter;color:#039}#sub-menu-page .sub-bottom h2{font-size:18px;font-weight:lighter;color:#333}#sub-menu-page .sub-bottom h3{font-size:12px;font-weight:700;color:#003057}#sub-menu-page .sub-bottom a{font-weight:400}#sub-menu-page .sub-bottom table{border:none!important;margin-top:20px;width:auto!important}#sub-menu-page .sub-bottom table td,#sub-menu-page .sub-bottom table th{font-size:14px;color:#333;font-weight:400;padding:8px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}#sub-menu-page .sub-bottom table tr:hover>td,#sub-menu-page .sub-bottom table tr:hover>th{box-shadow:#d8dde6 0 -1px 0 inset,#d8dde6 0 1px 0 inset;background-color:#f4f6f9}#sub-menu-page .sub-bottom table th{font-size:12px;font-weight:700;color:#666;text-transform:uppercase}#sub-menu-page .sub-bottom table thead tr:first-child>td,#sub-menu-page .sub-bottom table thead tr:first-child>th{border-top:none}#sub-menu-page .sub-bottom:after{content:'';display:block;height:50px}#sub-menu-page .sub-bottom .btn{display:none!important}#sub-menu-page .sub-bottom>div{margin:0!important}#sub-menu-page .sub-bottom>p{padding:0!important;margin:0!important;line-height:20px}#sub-menu-page .sub-bottom>p:before{content:'';display:block;height:30px}#sub-menu-page .sub-bottom>p b,#sub-menu-page .sub-bottom>p b>span{color:#002F57}#sub-menu-page .sub-bottom>p:first-child:before{height:0}#sub-menu-page .sub-bottom ul{padding-left:2em}#sub-menu-page .sub-bottom ul:before{content:'';display:block;height:30px}#sub-menu-page .sub-bottom ul li{margin-bottom:12px;position:relative}#sub-menu-page .sub-bottom ul li:before{content:'';display:inline-block;height:8px;width:8px;border-radius:1px;background-color:#2172BA;position:absolute;left:-20px;top:4px}#sub-menu-page .sub-bottom ul li li:before{border:2px solid #2172BA;background-color:transparent;border-radius:50%}#sub-menu-page .sub-bottom ul li li li:before{height:2px;top:7px;border:none;background-color:#2172BA;width:10px}#sub-menu-page ol{list-style-type:decimal;padding-left:15px}@media (min-width:544px){#sub-menu-page .sub-bottom h1{font-size:30px;font-weight:lighter}#sub-menu-page .sub-bottom h2{font-size:24px;font-weight:lighter}#sub-menu-page .sub-bottom h3{font-size:14px;font-weight:700}}#term-condition{max-width:800px;padding:20px;margin:20px auto;background-color:#fff}#term-condition .term-condition-title{text-align:center;font-weight:lighter;display:block;padding-bottom:20px;color:#039}#term-condition #term-condition-content{text-align:left;line-height:1.8}#term-condition #term-condition-content li,#term-condition #term-condition-content p{margin:10px 0}.access-manage-wrap .row{margin:0 -10px}.access-manage-wrap .row .col-md-6{padding:0 10px}.access-manage-wrap .row .col-md-6 h3{display:block}.access-manage-wrap .tab-item{margin:10px 0;border:1px solid #e6e6e6;position:relative}.access-manage-wrap .tab-item .general-title{display:block;height:60px;width:100%;background-color:#F2F2F2;line-height:60px;text-indent:2em;font-weight:700}.access-manage-wrap .tab-item .icon-wrap{position:absolute;right:20px;top:18px}.access-manage-wrap .tab-item .icon-wrap svg{transition:all .3s ease-in-out;fill:#2172BA}.access-manage-wrap .tab-item .icon-wrap .rotate-180{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg);fill:#fff}.access-manage-wrap .tab-item .selected-item{background-color:#2172BA!important;color:#fff!important}.access-manage-wrap .tab-item form{padding:0 20px}.access-manage-wrap .tab-item form h5{display:block;margin:20px 0 10px}.access-manage-wrap .new-row .col-sm-3{padding:0 10px}.access-manage-wrap .new-row .col-sm-3 .quaternary{border:none!important}.access-manage-wrap .new-row .col-sm-3 .quaternary a{padding:14px}.access-manage-wrap .disabledChk{background:#ccc!important}.access-manage-wrap .additional-iata-wrap .add-iata-input input{float:left;width:77%}.access-manage-wrap .additional-iata-wrap .add-iata-input button{float:right;width:20%}.access-manage-wrap .additional-iata-list{max-height:500px}.access-manage-wrap .additional-iata-list .iata-row-wrap{padding:0 10px}.access-manage-wrap .additional-iata-list .iata-row{line-height:50px;box-shadow:0 1px 0 #e6e6e6}.access-manage-wrap .additional-iata-list .iata-row .pull-right{width:20%;text-align:center;text-transform:uppercase}.access-manage-wrap .additional-iata-list .iata-row .pull-left{padding-left:10px;max-width:70%;overflow:hidden;text-overflow:ellipsis}.c-inline{margin-top:10px}.c-inline .tooltips.inline>span:nth-of-type(2){font-size:14px;font-weight:700}.c-inline .c-desc{margin-left:6px;margin-top:6px}.main-wrap-agency{position:relative}.main-wrap-agency .user-search{border-bottom:1px solid #e6e6e6}.agency-selector{border:1px solid #e6e6e6;border-right:none}.um-agency-detail{background-color:#fff;padding:30px;border:1px solid #e6e6e6;border-left:none}.um-agency-detail .um-agency-detail-header{padding:15px 0;border-top:1px solid #e6e6e6;border-bottom:1px solid #2172BA;margin-bottom:15px;position:relative}.um-agency-detail .um-agency-detail-header .down-icon{position:absolute;right:13px;top:calc(50% - 9px)}.um-agency-detail .firstline{padding:20px 10px;font-weight:700;border-bottom:1px solid #e6e6e6}.um-agency-detail .firstline label{font-weight:700!important}.um-agency-detail .secondline label{padding:0 0 10px}.um-agency-detail .sub-row{padding:10px 30px 0;background-color:#f2f2f2}.um-agency-detail .user-persona{margin:10px 0}.um-agency-detail .sub-title{color:#002F57}.um-agency-detail .related-agencies-wrap .sub-title{color:#002F57;margin:20px 0}.um-agency-detail .related-agencies-wrap .related-agencies{overflow:auto;background:#fff;max-height:581.5px}.um-agency-detail .related-agencies-wrap .related-agencies table tr{border-top:1px solid #e6e6e6}.um-agency-detail .related-agencies-wrap .related-agencies table tr th{font-weight:700;color:#666}.um-agency-detail .related-agencies-wrap .related-agencies table tr td{color:#333}.user-branch-main-wrap .access-title{padding-left:10px;line-height:80px}.user-branch-main-wrap .btn-concat{margin-bottom:20px}.user-branch-main-wrap .btn-concat .right-part{float:right;display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:space-between;width:620px;margin:6px 0 0}.user-branch-main-wrap .btn-concat .right-part .branch-top{width:200px}.user-branch-main-wrap .disabled-btn2{cursor:no-drop}.branch-table-wrap{padding:20px;background:#fff}.branch-table-wrap table{border-top:0}.branch-table-wrap table tr th{color:#666;border-top:0;padding-left:0}.branch-table-wrap table tr td{border-top:1px solid #e6e6e6;color:#333}.branch-table-wrap table tr td.status .slds-truncate{color:#fff}.branch-table-wrap table tr td.status .active{width:80px}.branch-table-wrap table tr td.status .inactive{width:100px}.branch-table-wrap table .th-text{font-size:12px}.branch-table-wrap .c-badge{padding:0 10px;height:25px;line-height:25px}.branch-table-wrap .slds-max-medium-table--stacked-horizontal td:before,.branch-table-wrap .slds-max-medium-table--stacked-horizontal th:before{font-weight:700;font-size:inherit}.inline-title{width:60%;display:inline-block}@media all and (max-width:992px){.input-group .form-control{z-index:1}.user-branch-main-wrap .btn-concat .switch-toggle-wrap{margin-top:20px}.user-branch-main-wrap .btn-concat .right-part{margin-top:20px;width:100%}.user-branch-main-wrap .btn-concat .right-part .btn-mass-create{width:48%!important}.status .c-badge{float:right}}#templ-basic .address-col .font24{font-size:18px!important;line-height:22px!important;font-weight:lighter!important;height:35px;padding:0;border:0!important}#templ-basic .address-col .col-xs-12,#templ-basic .mailRow{margin-bottom:10px}#templ-basic #email-tooltip.tooltips{top:-85px;left:-50px}#templ-basic .title{padding-left:10px;line-height:50px}.ng-error-country{border:1px solid #CD202C!important}@media (min-width:544px){#user-profile-wrapper input.font24{font-size:24px!important;line-height:28px!important;font-weight:lighter!important;height:35px;padding:0;border:0!important}}.main-wrap-create-new{position:relative;max-width:800px;margin:auto;color:#999}.main-wrap-create-new .new-row .col-md-6{padding:0 10px}#templ-type .sub-title,#templ-type .title{padding-left:10px;line-height:50px}.main-wrap-create-new .bottom-btn{display:block;margin-left:auto;margin-right:auto}.main-wrap-create-new .type-choose{height:220px;border:1px solid #f2f2f2;margin:10px auto 20px;text-align:center}.main-wrap-create-new .type-choose:hover{background:#e6e6e6}.main-wrap-create-new .type-choose.active{background:#2172BA;color:#fff}.main-wrap-create-new .type-choose .user-icons{font-size:30px;height:60%;-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex}.main-wrap-create-new .type-choose .user-icons .glyphicon{margin:auto}.ua-progress{margin:20px 0;text-transform:uppercase}.ua-progress .slds-tabs--path .slds-is-complete .slds-tabs--path__link,.ua-progress .slds-tabs--path .slds-is-current .slds-tabs--path__link,.ua-progress .slds-tabs--path .slds-is-incomplete .slds-tabs--path__link,.ua-progress .slds-tabs--path .slds-is-lost .slds-tabs--path__link{height:60px}.ua-progress .slds-tabs--path__title{line-height:54px}.ua-progress .slds-tabs--path .slds-is-complete,.ua-progress .slds-tabs--path__item+.slds-is-complete:before,.ua-progress .slds-tabs--path__item+.slds-is-current:before{background-color:#7AC24B}.ua-progress .slds-tabs--path .slds-is-current,.ua-progress .slds-tabs--path .slds-is-current+.slds-is-incomplete:before{background-color:#2172BA}.ua-progress .slds-tabs--path__item:before{transform:rotate(45deg);width:60px;height:60px;content:'';position:absolute;top:0;left:-30px;border:2px solid #fff;border-left:0;border-bottom:0;background-clip:padding-box}.ua-progress .slds-tabs--path__item:before:first-of-type{border:none}.ua-progress .slds-tabs--path__stage{transform:rotateX(-180deg)}.ua-progress .slds-tabs--path__stage,.ua-progress .slds-tabs--path__title{-webkit-backface-visibility:hidden;backface-visibility:hidden}.b-secondary{background-color:#ccc}.access-title{color:#039;line-height:60px;height:60px;margin-top:20px}.access-title.create-new{display:block;text-align:center}#templ-type .sub-title{display:block}#templ-type .slds-icon-text-blue{fill:#2172BA}#templ-type .slds-icon-text-white{fill:#fff}.required-note{color:#CD202C;margin-top:15px;padding-left:10px}.required-note span{color:#333}@media all and (min-width:768px){.main-wrap-create-new .new-row .b-cancel{margin-right:10px}.main-wrap-create-new .new-row .b-continue{margin-left:10px}}@media all and (max-width:768px){.btn-vertical-distance{margin-bottom:10px}}#um-dashboard .user-selection-row{padding:0 0 30px;position:relative}#um-dashboard .user-selection-row h3{line-height:50px}#um-dashboard .user-selection-row .view-as label{margin-top:0;padding-left:0}#um-dashboard .user-info{background-color:#fff;margin:0 -10px 2px;padding:20px}#um-dashboard .user-info .user-face{margin-right:10px;height:50px;width:50px;border:1px solid #fff}#um-dashboard .user-info h3{vertical-align:middle}#um-dashboard .tab-pane{position:relative}#um-dashboard .tab-pane#dashboard{min-height:450px;margin:0 -10px;background-color:#fff}#um-dashboard .tab-pane#dashboard iframe{border:0}#um-dashboard .powerbi-frame{height:400px;border-top:1px solid #e6e6e6}#um-dashboard #no-data{height:450px;width:100%;color:#000;background-color:#D4D4D0;text-align:center;vertical-align:middle;padding-top:200px;display:none}#um-dashboard div.single-pb-menu{width:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:stretch;align-items:stretch}#um-dashboard div.single-pb-menu .single-bp-menu-item{padding:25px 20px 22px;line-height:20px;text-transform:uppercase;color:#2172BA;border-bottom:3px solid transparent;font-weight:700;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}#um-dashboard div.single-pb-menu .single-bp-menu-item.selected{color:#002F57;border-bottom:3px solid #62a9e3}#um-dashboard div.single-pb-menu .more-reports{width:200px;position:absolute;right:10px;top:10px}#um-dashboard div.single-pb-menu .more-reports .slds-button-group .slds-button{width:160px;height:50px;font-size:14px;text-transform:uppercase;font-weight:700;padding-left:0;color:#2172BA}#um-dashboard div.single-pb-menu .more-reports .slds-button-group .slds-button:focus>span,#um-dashboard div.single-pb-menu .more-reports .slds-button-group .slds-button:hover>span{background-color:#f4f6f9}#sip_um_fund .table,#um-dashboard div.single-pb-menu .more-reports .slds-button-group .slds-button span{background-color:#fff}#um-dashboard div.single-pb-menu .more-reports .slds-button-group .slds-button span svg{fill:#2172BA}#um-dashboard div.single-pb-menu .more-reports .slds-button-group .slds-button span svg.slds-icon--large{width:2.5rem;height:2.5rem}#um-dashboard div.single-pb-menu .more-reports .slds-dropdown-trigger .slds-button{height:50px;width:40px}#um-dashboard div.single-pb-menu .more-reports .slds-dropdown{width:200px}#um-dashboard .jump-to-full{position:absolute;bottom:20px;right:20px;width:auto!important;padding-left:20px!important;padding-right:20px!important}@media (min-width:768px){#um-dashboard .user-selection-row{padding:0 0 30px 20px}#um-dashboard .user-selection-row .view-as label{margin-top:15px;padding-left:40px}}#sip_um_fund .table{padding:25px 40px}#sip_um_fund .table td{color:#333}#sip_um_fund .table td>.text-right{padding-right:6px}#sip_um_fund .table table{border-top:0;border-bottom:0}#sip_um_fund .table table th{border-top:0}#sip_um_fund .table table th .slds-th__action{padding-left:0!important;padding-right:0!important}#sip_um_fund .table table td,#sip_um_fund .table table th{padding:10px 10px 10px 6px}#sip_um_fund .tab-dashboard{margin-bottom:10px}#sip_um_fund .tab-dashboard .item{padding:19px 0;height:80px;background-color:#fff;text-align:center;border:1px solid #e6e6e6}#sip_um_fund .tab-dashboard .item h6{display:block}#sip_um_fund .amount-container{position:relative}#sip_um_fund .amount-container .amount-panel{z-index:999;position:absolute;width:140%;padding:5px;top:100%;left:0;background:#fff;box-shadow:0 2px 14px 2px rgba(0,0,0,.2)}#sip_um_fund .amount-container .amount-panel .amount-title{line-height:40px;color:#666}#sip_um_fund .amount-container .amount-panel .slds-form-element__label{color:#333}#sip_um_fund .amount-container .amount-panel .dollor-icon:before{content:'$ ';position:absolute;top:17px;left:10px}#sip_um_fund .amount-container .amount-panel .dollor-icon input{padding-left:20px}.fund-cover{position:fixed;top:0;right:0;left:0;bottom:0;z-index:99}.center-line{position:relative}.center-line:before{content:'';position:absolute;left:33.333%;z-index:9;bottom:0;display:block;width:1px;top:0;background-color:#e6e6e6}.home-sub-nav{padding:0 20px}.home-sub-nav .inner{border-bottom:1px solid #e6e6e6;overflow:hidden}.home-sub-nav .um-tab-desktop .slds-tabs_default__nav{position:relative}.home-sub-nav .um-tab-desktop .slds-tabs_default__nav li{color:#003057;background-color:transparent}.home-sub-nav .um-tab-desktop .slds-tabs_default__nav li:hover:after{height:0}.home-sub-nav .um-tab-desktop .slds-tabs_default__nav li .slds-tabs_default__link:hover{color:currentColor!important}.home-sub-nav .um-tab-desktop .slds-tabs_default__nav li a{color:currentColor;text-transform:uppercase}.home-sub-nav .um-tab-desktop .slds-tabs_default__nav li.active{color:#666}.home-sub-nav .um-tab-desktop .slds-tabs_default__nav li.active:after{background-color:#62A9E3;height:3px}.home-sub-nav .um-badge{padding:5px 15px;line-height:47px}.tab-panel{padding:0 20px}@media all and (max-width:992px){.center-line:before{content:'';display:none}.user-access-main-wrap .main-wrap .user-selector .user-filter{z-index:1}}#profile-form-wrap .row .form-group h3,#profile-form-wrap .row .form-group h6,.user-access-main-wrap .title-btn{display:block}#profile-form-wrap .row{margin:0 -10px}#profile-form-wrap .row .form-group{margin-bottom:0;padding:0 10px}#profile-form-wrap .row .form-group h6{color:#333}.um-sub-btn,.um-sub-btn .slds-button__icon{color:#2071ba}#profile-form-wrap .row .form-group label .tooltips{top:-100px;left:32px}#profile-form-wrap .row .form-group label .slds-nubbin--bottom:after,#profile-form-wrap .row .form-group label .slds-nubbin--bottom:before{left:20%}#profile-form-wrap .row .form-group label img{height:14px;margin-top:-2px}#profile-form-wrap .row .form-group input#user-airport{border-right:none!important}.um-sub-btn{float:right;width:200px;height:40px;border:none;font-weight:700;font-size:14px;text-transform:uppercase;border-radius:0!important}.um-sub-btn svg{margin-right:16px}.um-sub-btn.disabled{opacity:.5}.um-sub-btn.disabled:hover{color:#2071ba!important;background-color:#fff}.um-sub-btn.disabled:hover .slds-button__icon{color:#2071ba}.um-sub-btn:hover{background-color:#2071BA;color:#fff}.um-sub-btn:hover .slds-button__icon{color:#fff}.user-access-main-wrap .back-to-list{font-weight:700;top:17px;position:relative;cursor:pointer;color:#fff}.user-access-main-wrap .back-to-list svg{fill:#fff}.user-access-main-wrap .back-to-list .back-to-text{text-transform:uppercase;color:#fff}.user-access-main-wrap .access-title{color:#039;line-height:90px;height:60px;padding:0 10px;position:relative;top:10px}.user-access-main-wrap .title-btn>div{margin-top:10px;margin-bottom:10px}.user-access-main-wrap .branch-selection{margin:20px 0;padding:0 10px;position:relative}.user-access-main-wrap .branch-selection .branch-arrow-back{position:absolute;left:10px;top:calc(50% - 15px)}.user-access-main-wrap .branch-selection .left-part .acc-name{display:inline-block;padding:2px 10px;text-overflow:ellipsis;overflow:hidden;max-width:100%;white-space:nowrap;position:relative;top:10px}.user-access-main-wrap .branch-selection .left-part .right-part{float:right;-ms-flex-wrap:nowrap;flex-wrap:nowrap;display:-ms-flexbox;display:flex;width:630px;-ms-flex-pack:justify;justify-content:space-between;padding-right:12px}.user-access-main-wrap .branch-selection .left-part .right-part .btn-mass-create{width:200px;float:right}.user-access-main-wrap .branch-selection.selectedBranch{padding:0 10px 0 40px}.user-access-main-wrap .branch-selection .table{background-color:#fff;padding:25px 40px}.user-access-main-wrap .main-wrap{margin-bottom:20px}.user-access-main-wrap .main-wrap .user-selector{height:auto;background:#fff;border:1px solid #e6e6e6;border-right:none}.user-access-main-wrap .main-wrap .user-selector .form-control,.user-access-main-wrap .main-wrap .user-selector .input-group-addon{border:none!important}.user-access-main-wrap .main-wrap .user-selector .user-filter{border:1px solid #2172BA;font-weight:700;z-index:9}.user-access-main-wrap .main-wrap .user-selector .user-filter input::-webkit-input-placeholder{font-weight:700;color:#666}.user-access-main-wrap .main-wrap .user-selector ul.user-list{position:relative;overflow-y:auto;overflow-x:hidden;max-height:900px}.user-access-main-wrap .main-wrap .user-selector ul.user-list li{padding:0 12px;height:60px;position:relative;cursor:pointer}.user-access-main-wrap .main-wrap .user-selector ul.user-list li .one-user-container{padding:11px 0;border-top:1px solid #e6e6e6}.user-access-main-wrap .main-wrap .user-selector ul.user-list li:first-of-type .one-user-container{border-top:none}.user-access-main-wrap .main-wrap .user-selector ul.user-list li .user-face{position:absolute;left:0;margin:0 13px;height:38px;width:38px;border:1px solid #fff}.user-access-main-wrap .main-wrap .user-selector ul.user-list li .user-name{padding-left:50px;color:#2172BA;margin-bottom:2px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;width:70%}.user-access-main-wrap .main-wrap .user-selector ul.user-list li .user-persona{font-size:12px;padding-right:100px;padding-left:50px;color:#999;text-transform:uppercase;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.user-access-main-wrap .main-wrap .user-selector ul.user-list li .c-badge{position:absolute;right:14px;top:16px}.user-access-main-wrap .main-wrap .user-selector ul.user-list li.active{border-right:none;background:#2172BA}.user-access-main-wrap .main-wrap .user-selector ul.user-list li.active .one-user-container{border-top:none}.user-access-main-wrap .main-wrap .user-selector ul.user-list li.active:hover{background:#2172BA}.user-access-main-wrap .main-wrap .user-selector ul.user-list li.active .user-name,.user-access-main-wrap .main-wrap .user-selector ul.user-list li.active .user-persona{color:#fff}.user-access-main-wrap .main-wrap .user-selector ul.user-list li.active:after{content:'';display:block;position:absolute;top:22px;right:-12px;border:8px solid #fff;transform:rotate(45deg)}.user-access-main-wrap .main-wrap .user-selector ul.user-list li.active .c-badge{background-color:#2172BA;border:1px solid #fff}.user-access-main-wrap .main-wrap .user-selector ul.user-list li:hover{background:#f2f2f2}.user-access-main-wrap .main-wrap .user-selector ul.user-list #new-user,.user-access-main-wrap .main-wrap .user-selector ul.user-list .more-user{line-height:37px;font-weight:700;text-transform:uppercase;text-align:center;color:#2172BA}.user-access-main-wrap .main-wrap .user-selector ul.user-list #new-user .one-user-container,.user-access-main-wrap .main-wrap .user-selector ul.user-list .more-user .one-user-container{border-top:none}.user-access-main-wrap .main-wrap .user-selector ul.user-list #new-user:hover,.user-access-main-wrap .main-wrap .user-selector ul.user-list .more-user:hover{background:#2172BA;color:#fff}.user-access-main-wrap .main-wrap #page-wrapper{height:auto;border:1px solid #e6e6e6;border-left:none;background-color:#fff}.user-access-main-wrap .main-wrap #page-wrapper .card{position:relative;top:-18px;left:20px;width:25%;margin-bottom:-38px}.user-access-main-wrap .main-wrap #page-wrapper .card .user-face{width:100px;height:100px;background-position:center;background-size:cover}.user-access-main-wrap .main-wrap #page-wrapper .card .user-face.editImgFlg:before{content:'';display:block;height:100%;width:100%;border-radius:50%;background-color:#B8B8B8;z-index:1;filter:alpha(opacity=50);opacity:.8}.user-access-main-wrap .main-wrap #page-wrapper .card .title-wrap{margin-top:6px;margin-bottom:6px}.user-access-main-wrap .main-wrap #page-wrapper .card .title-wrap h3{white-space:nowrap}.user-access-main-wrap .main-wrap #page-wrapper .card .title-wrap .lock-icon{line-height:28px}.user-access-main-wrap .main-wrap #page-wrapper .btn-concat{position:absolute;top:20px;right:10px}.user-access-main-wrap .main-wrap #page-wrapper .btn-concat>div{margin:2px 0}.user-access-main-wrap .main-wrap #page-wrapper .others-btn{overflow:hidden}.user-access-main-wrap .main-wrap #page-wrapper .others-btn button{margin:0!important}.user-access-main-wrap .main-wrap #page-wrapper .tab-wrap{position:relative;padding:0 20px}.user-access-main-wrap .main-wrap #page-wrapper .tab-wrap .c-badge{position:absolute;right:30px}.user-access-main-wrap .unlock-btn{background-color:#7AC24B}.disabled-btn{background-color:#CCC}.action-item.junior{border:none!important;background-color:#fff!important}.action-item.junior a{color:#2071ba!important;padding-top:10px;padding-bottom:10px}.action-item.junior svg{float:left;margin-top:9px;margin-left:14px}.action-item.junior:hover{background-color:#2071ba!important}.action-item.junior:hover a,.action-item.junior:hover svg{color:#fff!important}.btn-concat{overflow:hidden;padding:0 10px}.btn-concat .right{float:right;margin-left:-3px!important}.btn-concat .left{float:right;margin:0!important}.btn-concat.left .right{float:left;margin:0!important}.btn-concat.left .left{float:left;margin-left:-3px!important}.btn-concat .switch-toggle-wrap{overflow:hidden;float:left}.btn-concat .switch-toggle-wrap .switch-toggle{display:-ms-flexbox;display:flex;border:3px solid #2172BA!important;border-radius:3px!important;width:400px}.btn-concat .switch-toggle-wrap .switch-toggle input{padding:10px 0!important;background-color:#fff;color:#2172BA;margin:0;border:0!important;line-height:20px}.btn-concat .switch-toggle-wrap .switch-toggle input:first-child.on,.btn-concat .switch-toggle-wrap .switch-toggle input:last-child.on{color:#fff;background-color:#2172BA}.btn-concat .switch-toggle-wrap .switch-toggle input:first-child{border-right:0!important}.btn-concat .switch-toggle-wrap .switch-toggle input:last-child{border-left:0!important}.mass-content .mass-download{overflow:hidden;height:48px;margin-bottom:10px}.mass-content .download-btn{border:none!important}.mass-content #click-upload-mass{margin-top:20px;border-top:1px solid #e6e6e6;padding-top:10px}.mass-content .template-title{margin:3px 0}.mass-content .template-title:first-of-type{text-transform:uppercase;font-weight:700}.um-common-table{padding:0 10px}.um-common-table table,.um-common-table table tr th{border-top:0}.um-common-table table tr th .slds-th__action{padding:1rem .5rem}.um-common-table table tr td{color:#333}.um-common-table table tr td.status .slds-truncate,.um-tab-desktop .slds-tabs_default__nav .slds-is-active,.um-tab-desktop .slds-tabs_default__nav .slds-tabs--default__item.slds-active .slds-tabs--default__link:hover,.um-tab-desktop .slds-tabs_default__nav .slds-tabs--default__item.slds-active .slds-tabs_default__link:hover,.um-tab-desktop .slds-tabs_default__nav .slds-tabs--default__item.slds-is-active .slds-tabs--default__link:hover,.um-tab-desktop .slds-tabs_default__nav .slds-tabs--default__item.slds-is-active .slds-tabs_default__link:hover,.um-tab-desktop .slds-tabs_default__nav .slds-tabs--default__link,.um-tab-desktop .slds-tabs_default__nav .slds-tabs_default__item.slds-active .slds-tabs--default__link:hover,.um-tab-desktop .slds-tabs_default__nav .slds-tabs_default__item.slds-active .slds-tabs_default__link:hover,.um-tab-desktop .slds-tabs_default__nav .slds-tabs_default__item.slds-is-active .slds-tabs--default__link:hover,.um-tab-desktop .slds-tabs_default__nav .slds-tabs_default__item.slds-is-active .slds-tabs_default__link:hover,.um-tab-desktop .slds-tabs_default__nav .slds-tabs_default__link{color:#fff}.um-common-table table tr td.status .active{width:80px}.um-common-table table tr td.status .inactive{width:100px}.um-common-table table .th-text{font-size:12px}.um-common-table .c-badge{padding:0 10px;height:25px;line-height:25px}.um-common-table .slds-max-medium-table--stacked-horizontal td:before,.um-common-table .slds-max-medium-table--stacked-horizontal th:before{font-weight:700;font-size:inherit}.um-main-tab-wrap{position:relative;z-index:2;padding:0 10px;height:120px}.um-main-tab-wrap:after{content:'';display:block;position:absolute;width:999999px;height:120px;left:-999px;top:0;background:#2072bb;z-index:-1}.um-main-tab-wrap .access-title{color:#fff;line-height:70px;font-weight:lighter}.um-tab-desktop .slds-tabs_default__nav{position:absolute;bottom:0;border-bottom:none}.um-tab-desktop .slds-tabs_default__nav .slds-tabs--default__item,.um-tab-desktop .slds-tabs_default__nav .slds-tabs_default__item{padding:6px 10px;font-weight:700;text-transform:uppercase}.um-tab-desktop .slds-tabs_default__nav .slds-tabs--default__item.slds-active:after,.um-tab-desktop .slds-tabs_default__nav .slds-tabs--default__item.slds-is-active:after,.um-tab-desktop .slds-tabs_default__nav .slds-tabs_default__item.slds-active:after,.um-tab-desktop .slds-tabs_default__nav .slds-tabs_default__item.slds-is-active:after{background-color:#fff}.d-width{width:430px!important}.c-badge{width:90px;height:30px;background-color:#999;color:#FFF;font-weight:700;text-transform:uppercase;display:block;text-align:center;line-height:30px;border-radius:15px}.c-badge.active{background-color:#7AC24B}.c-badge.inactive{background-color:#cd202c}.c-badge.pending{background-color:#f16321}.um-badge{font-size:12px;font-weight:700;color:#fff;line-height:24px}.slds-badge.um-inactive{background-color:#CD202C}.slds-badge.um-active{background-color:#7AC24B}.slds-badge.um-pending{background-color:#f16321}.input-num-group{padding-top:5px}.input-num-group input{height:40px;text-align:center}.input-num-group .input-group-addon{border-radius:0;background-color:#eee;height:40px;width:40px;font-weight:700;font-size:22px;padding:0;transition:all .3s;-moz-transition:all .3s;-webkit-transition:all .3s;-o-transition:all .3s}.input-num-group .input-group-addon.not-allow-mp{cursor:not-allowed}.input-num-group .input-group-addon.highlight-mp{color:#009CDE}.input-num-group .input-group-addon:hover{color:#fff;background-color:#2172BA;transition:all .3s;-moz-transition:all .3s;-webkit-transition:all .3s;-o-transition:all .3s}.user-persona{color:#999;text-transform:uppercase}.nav.nav-tabs{border-bottom-color:#e6e6e6;margin-bottom:20px}.nav.nav-tabs>li>a{color:#003057;font-weight:700;text-align:center;border:0;border-bottom:3px solid transparent;background-color:transparent;line-height:20px;padding-top:15px;padding-bottom:12px}.nav.nav-tabs>li>a:focus,.nav.nav-tabs>li>a:hover{background-color:transparent;border:0}.nav.nav-tabs>li.active>a{color:#666;border-bottom:3px solid #62A9E3}.um-mobile-menu{float:right;top:35px}.um-mobile-menu slds-dropdown{border-radius:0}.um-mobile-menu ul li a{color:#2071ba!important;font-size:14px;font-weight:700;text-transform:uppercase}@media all and (min-width:992px){.user-access-main-wrap .title-btn>div{margin-top:0;margin-bottom:0}.user-access-main-wrap .main-wrap #page-wrapper .others-btn{padding-top:20px;padding-right:20px}}@media all and (max-width:992px){.user-access-main-wrap.list-view .back-to-list{display:none}.user-access-main-wrap.list-view .branch-selection,.user-access-main-wrap.list-view .main-wrap .user-selector{display:block}.user-access-main-wrap.list-view .main-wrap #page-wrapper{display:none}.user-access-main-wrap.tab-view .back-to-list{display:block}.user-access-main-wrap.tab-view .branch-selection,.user-access-main-wrap.tab-view .main-wrap .user-selector{display:none}.user-access-main-wrap.tab-view .main-wrap #page-wrapper{display:block}.user-access-main-wrap .main-wrap{border:none}.user-access-main-wrap .main-wrap .tab-wrap{padding:20px 0!important}.user-access-main-wrap .main-wrap .user-selector ul.user-list{max-height:99999px!important}.user-access-main-wrap .main-wrap #page-wrapper{margin-top:60px}.user-access-main-wrap .main-wrap #page-wrapper .card{left:0;width:100%}.user-access-main-wrap .main-wrap #page-wrapper .card .title-wrap{text-align:center;margin-top:24px;margin-bottom:6px}.user-access-main-wrap .main-wrap #page-wrapper .card .title-wrap h3{white-space:normal}.user-access-main-wrap .main-wrap #page-wrapper .card .user-persona{text-align:center;padding-bottom:6px}.user-access-main-wrap .main-wrap #page-wrapper .card .user-face{margin:auto}.user-access-main-wrap .main-wrap #page-wrapper .others-btn{margin-top:10px}.btn-concat{margin-top:-20px}.btn-concat .btn-mass-create{width:50%}.btn-concat .switch-toggle-wrap{width:100%}.btn-concat .switch-toggle-wrap .switch-toggle{width:auto}}@media all and (max-width:768px){.user-access-main-wrap .branch-selection .left-part .right-part{width:100%;margin-top:12px}.um-main-tab .action-item.quaternary{border:none;border-bottom:1px solid #2172BA}.um-sub-btn{width:100%;margin-left:0!important}}@media all and (max-width:375px){.user-access-main-wrap .branch-selection .left-part .right-part{width:100%;padding-right:0;-ms-flex-wrap:wrap;flex-wrap:wrap;height:150px}.user-access-main-wrap .branch-selection .left-part .right-part .btn-mass-create{width:100%}}.c-inlineMass .tooltips span:first-child{width:21px;padding:0}.c-inlineMass .tooltips span:last-child{color:#666;font-weight:400!important;font-size:12px!important}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}#view-ticket-page{max-width:1280px;margin:0 auto;padding:0 10px}#view-ticket-page .header{background-color:#011934;padding:40px;margin:0 -20px}#view-ticket-page .header .header-label h1{color:#fff}#view-ticket-page .header .search-section input:last-child{border-left:none!important;margin-left:0!important}#view-ticket-page .ticket-information{margin-bottom:20px!important;border:1px solid #e6e6e6}#view-ticket-page .ticket-information .information-header{background-color:#f2f2f2;padding:20px;position:relative;height:125px}#view-ticket-page .ticket-information .information-header .icon-wrap{position:absolute;right:20px;top:50px}#view-ticket-page .ticket-information .information-header .icon-wrap .slds-icon-text-default{fill:#2172BA;transition:all .3s ease-in-out}#view-ticket-page .ticket-information .information-header .col-xs-3{margin-top:20px}#view-ticket-page .ticket-information .information-header .col-xs-3 label{margin-top:0}#view-ticket-page .ticket-information .information-detail{display:none;padding:20px}#view-ticket-page .ticket-information .information-detail p{font-weight:700}#view-ticket-page .ticket-information .information-detail h6{display:block}#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .flex-center{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .table-header,#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .table-row{margin:0 -10px;min-height:40px}#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .table-header div,#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .table-row div{width:10%}#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .table-header div:last-child,#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .table-row div:last-child{text-align:left;padding-left:10px;padding-right:0}#view-ticket-page .ticket-information .information-detail .coupon-information .information-table .table-row{border-top:1px solid #e6e6e6}#view-ticket-page .ticket-information.on .information-header{background-color:#2172BA;color:#fff}#view-ticket-page .ticket-information.on .information-header .icon-wrap .slds-icon-text-default{fill:#fff;transform:rotate(-180deg);transition:all .3s ease-in-out}#view-ticket-page .ticket-information.on .information-header h3,#view-ticket-page .ticket-information.on .information-header label{color:#fff}#view-ticket-page .ticket-information.on .information-detail{display:block}#view-ticket-page .trancate{width:100%;white-space:nowrap}#view-ticket-page .trancate h3{overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1}#view-ticket-page .rest-box{display:none!important}#view-ticket-page .rest-box.on{display:block!important;position:absolute;left:-10px;background:#2172BA;color:#fff;padding:10px;width:80%;z-index:9}.sip_form label{margin:5px 0}.sip_form .dropdown-menu .dropdown-item a{display:inline}#feedback{max-width:800px;padding:20px 0;margin:0 auto}#feedback .required-note{color:#CD202C;padding-left:0}#feedback .required-note span{color:#333}#feedback .title{font-weight:lighter;color:#039}#feedback .dropdown-menu{top:48px}#feedback #description{height:150px}#feedback .ng-required{border-right:1px solid #CD202C!important;border-top:1px solid #CD202C!important;border-bottom:1px solid #CD202C!important}@media (min-width:768px){#feedback .row .col-sm-6:first-child{padding-right:10px}#feedback .row .col-sm-6:last-child{padding-left:10px}} 
</style></span><span id="j_id0:j_id8">
<style type="text/css"> #amenity-widget #amenity-option .no-permission-item,#bc .coupon-container .input-num-group .input-group-addon.not-allow-mp{cursor:not-allowed}.seat-map .seatmap a,.tl .tl-debits .debit-table .table-footer>div .pagination a:hover{text-decoration:none}#acc-summary input[type=number],#ug #apply-upgrades .input-num>input[type=number]{-moz-appearance:textfield}#acc-summary{padding:10px}#acc-summary .edit-below{padding:10px 20px;background-color:#f2f2f2}#acc-summary .edit-below>div:nth-child(1){background:url(/resource/Sip_img_notification_on) center no-repeat;background-size:contain;width:18px;height:50px}#acc-summary .edit-below>div:nth-child(2) label{margin-left:10px;line-height:30px}#acc-summary .edit-below>div:nth-child(3){border-bottom:1px solid #ccc}#acc-summary .edit-below>div:nth-child(3)>div:first-child{margin-top:10px;font-weight:700;line-height:30px}#acc-summary .edit-below>div:nth-child(3)>div:last-child{margin-top:8px}#acc-summary .edit-below>div:nth-child(3)>div:last-child span{line-height:30px}#acc-summary .edit-below>div:nth-child(3)>div:last-child span svg{width:1.3rem;height:1.3rem}#acc-summary .edit-below>div:nth-child(3)>div:last-child .tooltips{top:-90px;left:-125px}#acc-summary .edit-below>div:nth-child(4) div .col-sm-4{margin-left:-10px}#acc-summary .edit-below>div:nth-child(4) div .col-sm-4 input{border:none!important;line-height:23px;width:100%}#acc-summary .edit-below>div:nth-child(4) div .col-sm-8 span{position:absolute;left:10px;top:18px;color:#62a9e3}#acc-summary .edit-below>div:nth-child(4) div .col-sm-8 input{padding-left:20px}#acc-summary input[type=number]::-webkit-inner-spin-button,#acc-summary input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}@media (min-width:768px){#acc-summary .edit-below>div:nth-child(4) div .col-sm-4 input{width:150%}#acc-summary .edit-below>div:nth-child(4) div .col-sm-8 span{top:16px}}#wf .input-row{margin:-5px 0}#wf .input-row>[class*=col-]{padding:5px 0}#wf #pnr-no-ticket,#wf #pnr-unticketed{text-align:center}#wf #pnr-no-ticket img,#wf #pnr-unticketed img{width:45px;display:block;margin:20px auto}#wf #pnr-no-ticket h4,#wf #pnr-unticketed h4{display:block}#wf #pnr-no-ticket .line,#wf #pnr-unticketed .line{width:130px;margin:30px auto}#wf #pnr-no-ticket .line{border-bottom:1px solid #f16321}#wf #pnr-no-ticket h4 span.pnr-number{color:#f16321}#wf #pnr-unticketed{display:none}#wf #pnr-unticketed .line{border-bottom:1px solid #2172BA}#wf #pnr-unticketed h4 span.pnr-number{color:#2172BA}#wf #apply-waiver-favor{margin-top:10px}#wf #apply-waiver-favor .account-info{padding:20px;background:#f2f2f2}#wf #pnr-no-ticket-proceed .tooltips.inline{width:auto;margin:0 auto}#wf #confirm-waiver-favor{margin-top:10px}#wf #confirm-waiver-favor .summary-table .table-row>div input{margin-top:10px;height:40px;padding:0 10px}#wf #confirm-waiver-favor .ps-note img{height:20px;width:20px;margin-right:10px}#wf #confirm-waiver-favor .add-ticket{color:#7ac24b}#wf #waiver-favor-confirm-modal .highlight{color:#f16321}#wf #waiver-favor-success-modal h2.waiver-code{display:inline-block}#wf #waiver-favor-success-modal .wrap-text{word-wrap:break-word}#wf #waiver-favor-success-modal .highlight{color:#67ae44}#wf #waiver-favor-success-modal .header,#wf #waiver-favor-success-modal .ref-number-text{text-transform:uppercase;color:#999;display:block;margin-bottom:5px}#wf #waiver-favor-success-modal .copy-to-clipboard{text-transform:uppercase;font-weight:700;margin-left:10px;color:#2172BA}@media (min-width:768px){#wf,#wf .input-row>[class*=col-]{padding:0 10px}#wf .input-row{margin:0 -10px}#wf #confirm-waiver-favor .summary-table .table-footer>div,#wf #confirm-waiver-favor .summary-table .table-header>div,#wf #confirm-waiver-favor .summary-table .table-row>div{-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0}#wf #confirm-waiver-favor .summary-table .table-footer>div input,#wf #confirm-waiver-favor .summary-table .table-header>div input,#wf #confirm-waiver-favor .summary-table .table-row>div input{margin-top:0}}#amenity-widget{margin:0 -10px;background:url(/resource/Sip_img_amenity_background) center center no-repeat;background-size:cover;position:relative}#amenity-widget .slds-button__icon,#amenity-widget h1,#amenity-widget h2,#amenity-widget h3{color:#fff}#amenity-widget .slds-button__icon.grey{color:#bbb}#amenity-widget .dark-bg{background-color:rgba(0,34,68,.6);color:#fff}#amenity-widget .animation-perspective{perspective:1300px}#amenity-widget .step-block{padding:20px;margin-bottom:20px;min-height:370px}#amenity-widget .step-block .step-nav :first-child{margin-right:auto}#amenity-widget .step-block .step-nav :last-child{margin-left:auto}#amenity-widget .step-block .step-title{font-weight:700;text-transform:uppercase;margin:auto;text-align:center;display:block}#amenity-widget .step-block .step-info .fee-info1{position:absolute;left:20px;bottom:20px;font-weight:700;text-transform:uppercase}#amenity-widget .step-block .step-info .fee-info1 .tooltips1{width:250px;bottom:38px;left:-10px}#amenity-widget .step-block .step-info .fee-info1 .tooltips1>.slds-popover:after,#amenity-widget .step-block .step-info .fee-info1 .tooltips1>.slds-popover:before{left:20%}#amenity-widget .step-block .step-info .fee-info2 .tooltips2:after,#amenity-widget .step-block .step-info .fee-info2 .tooltips2:before,#amenity-widget .step-block-mini .step-balance-info .fee-info3 .tooltips3:after,#amenity-widget .step-block-mini .step-balance-info .fee-info3 .tooltips3:before{left:92.5%}#amenity-widget .step-block .step-info .fee-info1 .tooltips1 p.tt-content{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;padding:5px 0;margin:0;border-bottom:1px solid #e6e6e6}#amenity-widget .step-block .step-info .fee-info1 .tooltips1 p.tt-content span:first-child{font-weight:400;text-transform:none}#amenity-widget .step-block .step-info .fee-info1 .tooltips1 p.tt-content span:last-child{margin-left:auto;font-weight:700;text-transform:none}#amenity-widget .step-block .step-info .fee-info1 .tooltips1 p.tt-content:last-child{border-bottom:0}#amenity-widget .step-block .step-info .fee-info2{position:absolute;right:20px;bottom:20px}#amenity-widget .step-block .step-info .fee-info2 .tooltips2{width:280px;bottom:38px;right:-10px}#amenity-widget .step-block-mini{padding:28px 20px}#amenity-widget .step-block-mini .step-title-nav .step-title{margin-left:20px;margin-right:40px;font-weight:700;text-transform:uppercase;white-space:nowrap}#amenity-widget .step-block-mini .step-title-nav .step-account{margin-right:20px;margin-left:auto;font-weight:700;text-transform:uppercase}#amenity-widget .step-block-mini .step-balance-info{height:50px}#amenity-widget .step-block-mini .step-balance-info .acc-balance{margin-left:auto;text-align:right}#amenity-widget .step-block-mini .step-balance-info .acc-balance h3{display:block;font-weight:700}#amenity-widget .step-block-mini .step-balance-info .fee-info3{margin-left:20px}#amenity-widget .step-block-mini .step-balance-info .fee-info3 .tooltips3{top:50px;right:-10px}#amenity-widget .img-icon{height:25px;max-width:25px;width:auto}#amenity-widget .img-icon.horizontal{width:25px;height:auto}#amenity-widget .form-control{box-shadow:none}#amenity-widget .form-control:focus{border-color:transparent;outline:0;box-shadow:none}#amenity-widget .search-input{margin:2px;border:1px solid #fff}#amenity-widget .search-input .account-symbol{display:table-cell;vertical-align:middle;text-align:center;width:40px}#amenity-widget .search-input .account-symbol.corporate span{background:#441E4C}#amenity-widget .search-input .account-symbol.dis span{background:#f16321}#amenity-widget .search-input .account-symbol.reserved span{background:#cd202c}#amenity-widget .search-input .account-symbol.agency span{background:#10807E}#amenity-widget .search-input .account-symbol span{display:inline-block;height:24px;width:24px;border-radius:12px;line-height:24px;font-weight:700;color:#fff}#amenity-widget .search-input input[type=text],#amenity-widget .search-input input[type=email],#amenity-widget .search-input input[type=number]{background-color:transparent;color:#fff;font-weight:700}#amenity-widget .search-input input[type=text]::-webkit-input-placeholder,#amenity-widget .search-input input[type=email]::-webkit-input-placeholder,#amenity-widget .search-input input[type=number]::-webkit-input-placeholder{color:#fff;font-weight:700;text-transform:uppercase}#amenity-widget .search-input input[type=text]:-moz-placeholder,#amenity-widget .search-input input[type=email]:-moz-placeholder,#amenity-widget .search-input input[type=number]:-moz-placeholder{opacity:1;color:#fff;font-weight:700;text-transform:uppercase}#amenity-widget .search-input input[type=text]::-moz-placeholder,#amenity-widget .search-input input[type=email]::-moz-placeholder,#amenity-widget .search-input input[type=number]::-moz-placeholder{opacity:1;color:#fff;font-weight:700;text-transform:uppercase}#amenity-widget .search-input input[type=text]:-ms-input-placeholder,#amenity-widget .search-input input[type=email]:-ms-input-placeholder,#amenity-widget .search-input input[type=number]:-ms-input-placeholder{color:#fff;font-weight:700;text-transform:uppercase}#amenity-widget .search-input input[type=text]#txt-all-wf::-webkit-input-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-account::-webkit-input-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-first-name::-webkit-input-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-last-name::-webkit-input-placeholder,#amenity-widget .search-input input[type=email]#txt-all-wf::-webkit-input-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-account::-webkit-input-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-first-name::-webkit-input-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-last-name::-webkit-input-placeholder,#amenity-widget .search-input input[type=number]#txt-all-wf::-webkit-input-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-account::-webkit-input-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-first-name::-webkit-input-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-last-name::-webkit-input-placeholder{font-weight:400;text-transform:none}#amenity-widget .search-input input[type=text]#txt-all-wf:-moz-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-account:-moz-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-first-name:-moz-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-last-name:-moz-placeholder,#amenity-widget .search-input input[type=email]#txt-all-wf:-moz-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-account:-moz-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-first-name:-moz-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-last-name:-moz-placeholder,#amenity-widget .search-input input[type=number]#txt-all-wf:-moz-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-account:-moz-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-first-name:-moz-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-last-name:-moz-placeholder{font-weight:400;text-transform:none}#amenity-widget .search-input input[type=text]#txt-all-wf::-moz-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-account::-moz-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-first-name::-moz-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-last-name::-moz-placeholder,#amenity-widget .search-input input[type=email]#txt-all-wf::-moz-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-account::-moz-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-first-name::-moz-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-last-name::-moz-placeholder,#amenity-widget .search-input input[type=number]#txt-all-wf::-moz-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-account::-moz-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-first-name::-moz-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-last-name::-moz-placeholder{font-weight:400;text-transform:none}#amenity-widget .search-input input[type=text]#txt-all-wf:-ms-input-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-account:-ms-input-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-first-name:-ms-input-placeholder,#amenity-widget .search-input input[type=text]#txt-caller-last-name:-ms-input-placeholder,#amenity-widget .search-input input[type=email]#txt-all-wf:-ms-input-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-account:-ms-input-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-first-name:-ms-input-placeholder,#amenity-widget .search-input input[type=email]#txt-caller-last-name:-ms-input-placeholder,#amenity-widget .search-input input[type=number]#txt-all-wf:-ms-input-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-account:-ms-input-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-first-name:-ms-input-placeholder,#amenity-widget .search-input input[type=number]#txt-caller-last-name:-ms-input-placeholder{font-weight:400;text-transform:none}#amenity-widget .search-input input[type=text]#txt-upgrade-account,#amenity-widget .search-input input[type=email]#txt-upgrade-account,#amenity-widget .search-input input[type=number]#txt-upgrade-account{width:calc(100% - 60px)}#amenity-widget .search-input .iata-label{position:absolute;right:10px;top:17px;color:#fff;font-weight:700}#amenity-widget .search-input .input-group-addon{border:0;border-radius:0;background-color:transparent;color:#fff}#amenity-widget .dropdown-item span.symbol{display:inline-block;width:20px;height:20px;text-align:center;border-radius:10px;margin-right:5px}#amenity-widget .dropdown-item a.content{display:inline}#amenity-widget .dropdown-item a.content span.iata{margin-left:5px;display:inline-block;min-width:50px}#amenity-widget .dropdown-item a.content span.fund-balance{position:absolute;right:10px;font-weight:700}#amenity-widget .dropdown-item a.content span.fund-avail{color:#7ac24b}#amenity-widget .dropdown-item a.content span.fund-unavail{color:#cd202c}#amenity-widget .dropdown-item a.content span.dropdown-name{max-width:52%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}#amenity-widget .dropdown-item.corporate span.symbol{background:#441E4C;color:#fff;font-weight:700}#amenity-widget .dropdown-item.corporate a.content span.iata{color:#441E4C;font-weight:700}#amenity-widget .dropdown-item.dis span.symbol{background:#f16321;color:#fff;font-weight:700}#amenity-widget .dropdown-item.dis a.content span.iata{color:transparent;font-weight:700}#amenity-widget .dropdown-item.reserved span.symbol{background:#cd202c;color:#fff;font-weight:700}#amenity-widget .dropdown-item.reserved a.content span.iata{color:#cd202c;font-weight:700}#amenity-widget .dropdown-item.agency span.symbol{background:#10807E;color:#fff;font-weight:700}#amenity-widget .dropdown-item.agency a.content span.iata{color:#10807E;font-weight:700}#amenity-widget .action-item{margin:2px;background-color:#fff;border:1px solid #fff;text-align:center;text-transform:uppercase}#amenity-widget .action-item.invalid,#amenity-widget .action-item.invalid:hover{background-color:rgba(255,255,255,.4);border:1px solid rgba(255,255,255,.4)}#amenity-widget .action-item .left{text-align:left}#amenity-widget .action-item a{padding:15px;line-height:20px;font-weight:700;display:block;color:#024}#amenity-widget .action-item.btn{width:calc(100% - 4px);color:#024;padding:15px}#amenity-widget .action-item.invalid:hover,#amenity-widget .action-item.invalid:hover a{color:#024}#amenity-widget .action-item:hover{background-color:#1C5DAC;color:#fff;border:1px solid #fff}#amenity-widget .action-item:hover a{color:#fff}#amenity-widget #amenity-init{min-height:450px;padding:20px 0;position:relative}#amenity-widget #amenity-init .special-load-help-text{position:relative;display:inline-block;margin-left:5px}#amenity-widget #amenity-init .special-load-help-text img.help-icon{width:18px}#amenity-widget #amenity-init .special-load-help-text .tooltips{bottom:30px;left:-130px}#amenity-widget #amenity-init .block{height:100%;padding:20px;color:#fff}#amenity-widget #amenity-init .block .info{padding:0 10px 10px;min-height:50px;background-color:#fff}#amenity-widget #amenity-init .block .info span{display:block;color:#666}#amenity-widget #amenity-init .block .info span.amt{color:#7ac24b}#amenity-widget #amenity-init .block .info span.amt.warning{color:#cd202c}#amenity-widget #amenity-init .block .info div.acc,#amenity-widget #amenity-init .block .info div.fund,#amenity-widget #amenity-init .block .info div.gs{margin-top:10px}#amenity-widget #amenity-init .block .input-wrapper{background:#fff;padding:5px}#amenity-widget #amenity-init .block .input-wrapper .input-group{background-color:#f2f2f2}#amenity-widget #amenity-init .block .input-wrapper .input-group .account-symbol{display:table-cell;vertical-align:middle;text-align:center;width:40px}#amenity-widget #amenity-init .block .input-wrapper .input-group .account-symbol.corporate span{background:#441E4C}#amenity-widget #amenity-init .block .input-wrapper .input-group .account-symbol.dis span{background:#f16321}#amenity-widget #amenity-init .block .input-wrapper .input-group .account-symbol.reserved span{background:#cd202c}#amenity-widget #amenity-init .block .input-wrapper .input-group .account-symbol.agency span{background:#10807E}#amenity-widget #amenity-init .block .input-wrapper .input-group .account-symbol span{display:inline-block;height:24px;width:24px;border-radius:12px;line-height:24px;font-weight:700;color:#fff}#amenity-widget #amenity-init .block .input-wrapper .input-group input[type=text]{background-color:transparent;height:40px;padding:10px}#amenity-widget #amenity-init .block .input-wrapper .input-group input[type=text]::-webkit-input-placeholder{line-height:20px}#amenity-widget #amenity-init .block .input-wrapper .input-group input[type=text]:-moz-placeholder{line-height:20px}#amenity-widget #amenity-init .block .input-wrapper .input-group input[type=text]::-moz-placeholder{line-height:20px}#amenity-widget #amenity-init .block .input-wrapper .input-group input[type=text]:-ms-input-placeholder{line-height:20px}#amenity-widget #amenity-init .block .input-wrapper .input-group .input-group-addon{background-color:transparent}#amenity-widget #amenity-init .consent-tile{height:350px;padding:5px}#amenity-widget #amenity-init .consent-tile .block{border-top:5px solid #cd202c;background-color:#fff;color:#666;text-align:center}#amenity-widget #amenity-init .consent-tile .block .icon{display:block;height:38px;margin:20px auto}#amenity-widget #amenity-init .consent-tile .block h3{color:#333;display:block;margin-bottom:20px}#amenity-widget #amenity-init .consent-tile .block .content{padding:0 50px}#amenity-widget #amenity-init .consent-tile .block .content .highlight{color:#2172BA}#amenity-widget #amenity-init .consent-tile .block .action-item.tertiary{width:100%!important;background-color:#2172BA;color:#fff!important}#amenity-widget #amenity-init .consent-tile .block .action-item a,#amenity-widget #amenity-init .consent-tile .block .action-item a:hover{color:#fff}#amenity-widget #amenity-init .amenity-tile{transition:all .3s ease-in-out;height:330px;padding:5px}#amenity-widget #amenity-init .amenity-tile .block{background-color:#024}#amenity-widget #amenity-init .amenity-tile.col-md-8{height:540px}#amenity-widget #amenity-init .amenity-tile.col-md-8 .block{background-color:rgba(0,34,68,.6)}#amenity-widget #amenity-init .banking-tile{transition:all .3s ease-in-out;height:330px;padding:5px}#amenity-widget #amenity-init .banking-tile .block{background-color:#0093b2}#amenity-widget #amenity-init .banking-tile.col-md-8{height:395px}#amenity-widget #amenity-init .banking-tile.col-md-8 .block{background-color:rgba(0,147,178,.6)}#amenity-widget #amenity-init .transaction-log{transition:all .3s ease-in-out;height:110px;padding:5px}#amenity-widget #amenity-init .transaction-log .block{background-color:#edb72b}#amenity-widget #amenity-init .transaction-log .block *{color:#002F57}#amenity-widget #amenity-init.wo-caller .amenity-tile{height:270px}#amenity-widget #amenity-init.wo-caller .amenity-tile.col-md-8{height:400px}#amenity-widget #amenity-init.wo-caller .banking-tile{height:270px}#amenity-widget #amenity-init.wo-caller .banking-tile.col-md-8{height:400px}#amenity-widget #banking-mini .step-block-mini{background-color:#0093b2;color:#fff;z-index:1}#amenity-widget #banking-mini .step-block-mini .step-title-nav .step-title{font-weight:lighter!important;text-transform:none!important}#amenity-widget #banking-mini .info{margin:2px;padding:0 10px 10px;min-height:52px;background-color:#fff}#amenity-widget #banking-mini .info span{display:block;color:#666}#amenity-widget #banking-mini .info span.amt{color:#7ac24b}#amenity-widget #banking-mini .info span.amt.warning{color:#cd202c}#amenity-widget #banking-mini .info div.acc,#amenity-widget #banking-mini .info div.fund,#amenity-widget #banking-mini .info div.gs{margin-top:10px}#amenity-widget #banking-mini .banking-option{position:absolute;bottom:-28px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#amenity-widget #banking-mini .banking-option>a{text-align:center;color:#fff;padding:10px;text-transform:uppercase;font-weight:700;border-bottom:4px solid transparent}#amenity-widget #banking-mini .banking-option>a.selected{border-bottom:4px solid #fff}#amenity-widget #banking-mini:before{content:'';display:block;position:absolute;width:999999px;height:100%;left:-999px;top:0;background:#0093b2;z-index:0}#amenity-widget #amenity-target .target-info *{color:#fff}#amenity-widget #amenity-target .target-info>div{padding:10px}#amenity-widget #amenity-target .target-info>div span{display:block}#amenity-widget #amenity-target .target-info>div.acc{text-align:left}#amenity-widget #amenity-target .target-info>div.info{text-align:right}#amenity-widget #amenity-target .target-info>div.info .gs{margin-bottom:10px}#amenity-widget #amenity-option{min-height:390px;padding-bottom:18px;position:relative}#amenity-widget #amenity-option .option-note{padding:3px}#amenity-widget #amenity-option .option-note>div{font-size:12px;line-height:16px;background-color:#fff;padding:10px}#amenity-widget #amenity-option .option-note>div .flex-center img{height:16px;width:16px;margin-right:5px}#amenity-widget #amenity-option .option-note>div .flex-center span{font-size:11px;line-height:14px;color:#cd202c;vertical-align:middle;text-transform:uppercase;font-weight:700}#amenity-widget #amenity-option .no-permission-item:hover{background-color:#ddd;transition:all .5s}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div{padding:2px}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group{display:block;height:120px;width:100%;padding:10px;background-color:rgba(0,34,68,.6)}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group:hover{background-color:#024}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group.white{background-color:rgba(255,255,255,.7)}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group.white>.icon-text>.widget-text{color:#024}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group.white .new-window-icon{color:#2172BA;position:absolute;right:10px;bottom:10px}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.icon-text{height:60px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.icon-text>.widget-icon{width:50px;text-align:right;padding-right:10px;color:#fff}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.icon-text>.widget-text{width:calc(100% - 50px);text-align:left;padding-left:5px;padding-right:20px;color:#fff;font-weight:700;text-transform:uppercase}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.icon-text.full-height{height:100px}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.text-only{height:60px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;text-align:center;font-weight:700;text-transform:uppercase;color:#024}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.text-only>span{margin:auto}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.coming-soon .coming-soon-wrapper{position:relative;padding:0 10px}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.coming-soon .coming-soon-wrapper img{height:40px;display:block;margin-left:auto;margin-right:auto}#amenity-widget #amenity-option .menu-item>div.col-sm-10>div>div.input-group>.coming-soon .coming-soon-wrapper span.coming-soon-text{position:absolute;left:0;top:9px;width:100%;text-align:center;font-weight:700;text-transform:uppercase;color:#fff;font-size:12px}#amenity-widget #united-club .step-block .united-club-option .club-type{border:2px solid #fff;padding:10px}#amenity-widget #united-club .step-block .united-club-option .club-type h3{font-weight:700}#amenity-widget #united-club .step-block .united-club-option .club-type:focus,#amenity-widget #united-club .step-block .united-club-option .club-type:hover{background-color:#fff}#amenity-widget #united-club .step-block .united-club-option .club-type:focus *,#amenity-widget #united-club .step-block .united-club-option .club-type:hover *{color:#003057}#amenity-widget #united-club .step-block .united-club-option .col-sm-12:first-child,#amenity-widget #united-club .step-block .united-club-option .col-sm-6:first-child{margin-bottom:10px}#amenity-widget #united-club .step-block h4{margin:0 0 5px;display:block}#amenity-widget #united-club .step-block .otp-option{border:2px solid #fff;margin:0 2px;padding:2px}#amenity-widget #united-club .step-block .otp-option .col-xs-6>div{line-height:20px;padding:8px 15px;text-align:center;overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1;white-space:nowrap}#amenity-widget #united-club .step-block .otp-option .col-xs-6>div.selected{background:#fff;color:#003057}#amenity-widget .animate-slide-in{transform:translateX(-100%);animation:slideIn .5s ease-in-out forwards}@keyframes slideIn{100%{transform:translateX(0);opacity:1}}#amenity-widget .animate-slide-out{transform:translateX(0);animation:slideOut .3s ease-in-out forwards}@keyframes slideOut{100%{transform:translateX(100%);opacity:1}}#amenity-widget .animate-scale-up{transform:scale(.6);animation:scaleUp .3s ease-in-out forwards}@keyframes scaleUp{100%{transform:scale(1);opacity:1}}#amenity-widget .animate-scale-down{transform:scale(0);animation:scaleDown .3s ease-in-out forwards}@keyframes scaleDown{0%{transform:scale(1);opacity:1}}#amenity-widget .animate-fall{transform-style:preserve-3d;transform:translateZ(400px) translateY(300px) rotateX(-90deg);animation:fallPerspective .8s ease-in-out forwards}@keyframes fallPerspective{100%{transform:translateZ(0) translateY(0) rotateX(0);opacity:1}}@media (min-width:768px){#amenity-widget .step-block .step-info .fee-info2 .tooltips2{left:-160px}#amenity-widget .step-block .step-info .fee-info2 .tooltips2:after,#amenity-widget .step-block .step-info .fee-info2 .tooltips2:before{left:62%}#amenity-widget #amenity-target .target-info{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:60px}#amenity-widget #amenity-target .target-info>div{padding:0 10px}#amenity-widget #amenity-target .target-info>div.info{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#amenity-widget #amenity-target .target-info>div.info .gs{margin-left:auto;padding-right:20px;margin-bottom:0}#amenity-widget #amenity-target .target-info>div.info .fund{padding-left:20px;border-left:1px solid #fff}#amenity-widget #united-club .step-block .united-club-option .col-sm-6:first-child{padding-right:10px}#amenity-widget #united-club .step-block .united-club-option .col-sm-6:last-child{padding-left:10px}#amenity-widget #united-club .step-block .united-club-option .col-sm-6 .club-type{padding:20px}#amenity-widget #united-club .step-block h4{margin:0 0 20px}#amenity-widget #banking-mini .info{padding:0 10px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#amenity-widget #banking-mini .info div.acc{margin-top:0;padding-right:10px}#amenity-widget #banking-mini .info div.fund,#amenity-widget #banking-mini .info div.gs{margin-top:0;border-left:1px solid #ccc;padding-left:10px}#amenity-widget #travel-certificate-mini .margin-left-20{margin-top:20px}}@media (min-width:992px){#amenity-widget #amenity-init{padding:5px 0}#amenity-widget #amenity-init .block .info{padding:0 10px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#amenity-widget #amenity-init .block .info div.acc{margin-top:0;padding-right:10px}#amenity-widget #amenity-init .block .info div.fund,#amenity-widget #amenity-init .block .info div.gs{margin-top:0;border-left:1px solid #ccc;padding-left:10px}#amenity-widget #amenity-init .consent-tile{float:left}#amenity-widget #amenity-init .amenity-tile.col-md-8{float:left;height:440px}#amenity-widget #amenity-init .banking-tile.col-md-8{float:right;height:440px}#amenity-widget #amenity-init .banking-tile.col-md-8.only-one{float:left;height:440px}#amenity-widget #amenity-init .transaction-log{position:absolute;top:330px}#amenity-widget #amenity-init .transaction-log.amenity{right:0}#amenity-widget #amenity-init .transaction-log.amenity.only-one{right:0;top:0}#amenity-widget #amenity-init .transaction-log.banking{left:0}#amenity-widget #amenity-init .transaction-log.banking.only-one{left:auto;right:0;top:0}#amenity-widget #amenity-init.wo-caller{padding:50px 0}#amenity-widget #amenity-init.wo-caller .amenity-tile{height:240px}#amenity-widget #amenity-init.wo-caller .amenity-tile.col-md-8{float:left;height:350px}#amenity-widget #amenity-init.wo-caller .banking-tile{height:240px}#amenity-widget #amenity-init.wo-caller .banking-tile.col-md-8{float:right;height:350px}#amenity-widget #amenity-init.wo-caller .banking-tile.col-md-8.only-one{float:left;height:350px}#amenity-widget #amenity-init.wo-caller .transaction-log{position:absolute;top:240px}#amenity-widget #amenity-init.wo-caller .transaction-log.amenity{right:0}#amenity-widget #amenity-init.wo-caller .transaction-log.amenity.only-one{right:0;top:0}#amenity-widget #amenity-init.wo-caller .transaction-log.banking{left:0}#amenity-widget #amenity-init.wo-caller .transaction-log.banking.only-one{left:auto;right:0;top:0}}@media (min-width:768px){#banking{padding:0 10px}}#bc{margin:10px}#bc .coupon-container{border:1px solid #ccc;padding:20px}#bc .coupon-container .input-num-group input{height:40px;text-align:center}#bc .coupon-container .input-num-group .input-group-addon{border-radius:0;background-color:#eee;height:40px;width:40px;font-weight:700;font-size:22px;padding:0;transition:all .3s;-moz-transition:all .3s;-webkit-transition:all .3s;-o-transition:all .3s}#bc .coupon-container .input-num-group .input-group-addon.highlight-mp{color:#009CDE}#bc .coupon-container .input-num-group .input-group-addon:hover{color:#fff;background-color:#2172BA;transition:all .3s;-moz-transition:all .3s;-webkit-transition:all .3s;-o-transition:all .3s}#bc .coupon-container .bc-editor{display:block}#bc .coupon-container .bc-editor>div{padding:5px 0}#bc .button-group .col-sm-3:first-child,#bc .padding-right-10,#bc .padding-right-20{padding-right:0}#bc .coupon-container .bc-editor>div:first-child{padding-top:0}#bc .coupon-container .bc-editor>div:last-child{padding-bottom:0}#bc .required-icon-no-border{cursor:none;border:none}#bc .padding-top-10,#bc .padding-top-101{padding-top:10px}#bc .button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#bc #beverage-coupons-confirm-modal .highlight{color:#f16321}#bc #beverage-coupons-confirm-modal .row.button .col-xs-6:first-child{padding-right:10px}#bc #beverage-coupons-confirm-modal .row.button .col-xs-6:last-child{padding-left:10px}@media (min-width:768px){#bc .coupon-container .input-num-group>input[type=number]{-moz-appearance:textfield}#bc .coupon-container .input-num-group>input[type=number]::-webkit-inner-spin-button,#bc .coupon-container .input-num-group>input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}#bc .coupon-container .bc-editor{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#bc .coupon-container .bc-editor>div{padding:0 10px}#bc .coupon-container .bc-editor>div.count-label{text-align:right}#bc .coupon-container .bc-editor>div:first-child{padding-left:0}#bc .coupon-container .bc-editor>div:last-child{padding-right:0}#bc .padding-right-20{padding-right:20px}#bc .button-group .col-sm-3:first-child,#bc .padding-right-10{padding-right:10px}#bc .padding-top-10{padding-top:10px}#bc .padding-top-101{padding-top:0}#bc .button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}}#bm #apply-bonus-miles{margin:10px}#bm #apply-bonus-miles .headcount-icon{color:#62a9e3;margin-right:10px}#bm #apply-bonus-miles .bm-border{border:2px solid #eee;padding:20px}#bm #apply-bonus-miles .bm-border>.row .col-sm-4{margin:10px 0}#bm #apply-bonus-miles .bm-border>.row .col-sm-4 .input-num-group{width:100%}#bm #apply-bonus-miles .bm-border>.row .col-sm-4:first-child{margin-top:0}#bm #apply-bonus-miles .bm-border>.row .col-sm-4:last-child{margin-bottom:0}#bm #apply-bonus-miles .input-num-group input{height:40px;text-align:center}#bm #apply-bonus-miles .input-num-group .input-group-addon{border-radius:0;background-color:#eee;height:40px;width:40px;font-weight:700;font-size:22px;padding:0;transition:all .3s;-moz-transition:all .3s;-webkit-transition:all .3s;-o-transition:all .3s}#bm #apply-bonus-miles .input-num-group .input-group-addon.not-allow-mp{cursor:not-allowed}#bm #apply-bonus-miles .input-num-group .input-group-addon.highlight-mp{color:#009CDE}#bm #apply-bonus-miles .input-num-group .input-group-addon:hover{color:#fff;background-color:#2172BA;transition:all .3s;-moz-transition:all .3s;-webkit-transition:all .3s;-o-transition:all .3s}#bm #confirm-bonus-miles{margin:10px}#bm #confirm-bonus-miles .button-group .col-sm-3:first-child{padding-right:0}#bm #confirm-bonus-miles .button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#bm #bonus-miles-confirm-modal .highlight{color:#f16321}#bm #bonus-miles-confirm-modal .row.button .col-xs-6:first-child{padding-right:10px}#bm #bonus-miles-confirm-modal .row.button .col-xs-6:last-child{padding-left:10px}@media (min-width:768px){#bm{padding:0 10px}#bm #apply-bonus-miles .bm-border>.row{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#bm #apply-bonus-miles .bm-border>.row .col-sm-4{margin:0}#bm #apply-bonus-miles .bm-border>.row .col-sm-4:last-child{text-align:right}#bm #confirm-bonus-miles .button-group .col-sm-3:first-child{padding-right:10px}#bm #confirm-bonus-miles .button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}}.e-ticket{display:block;position:relative;margin-bottom:20px;border-top:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6}.e-ticket .e-ticket-tooltips{bottom:calc(100% - 10px);width:300px;left:calc(50% - 150px)}.e-ticket .col-label{color:#666;display:block;margin-left:20px}.e-ticket .col-value h3{color:#333;display:block;margin-left:20px}.e-ticket .ticket-info{height:125px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-bottom:1px solid #e6e6e6}.e-ticket .ticket-info .checkbox-cell{width:40px;height:calc(100% + 1px);background-color:#e6e6e6}.e-ticket .ticket-detail .coupon-list,.e-ticket .ticket-detail .fare-detail{background-color:#f2f2f2;padding:20px}.e-ticket .ticket-info .checkbox-cell .slds-button__icon{color:#fff}.e-ticket .ticket-info .checkbox-cell>svg{border-radius:2px;border:2px solid #fff;margin-top:50px;margin-left:9px}.e-ticket .ticket-info .checkbox-cell>svg>path,.e-ticket .ticket-info .checkbox-cell>svg>use{display:none}.e-ticket .ticket-info .passenger-cell{width:calc(35% - 40px)}.e-ticket .ticket-info .passenger-cell h3{overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1}.e-ticket .ticket-info .pnr-cell{width:calc(15% - 40px)}.e-ticket .ticket-info .tour-code-cell{width:calc(25% - 40px)}.e-ticket .ticket-info .coupon-cell{width:40px;height:100%}.e-ticket .ticket-info .coupon-cell svg{margin-top:50px;margin-left:9px;transition:all .3s ease-in-out;color:#2172BA}.e-ticket .ticket-info .coupon-cell svg.open{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg)}.e-ticket .ticket-info .flight-type-cell{width:40px;height:100%;position:relative}.e-ticket .ticket-info .flight-type-cell .vertical-text{transform:rotate(-90deg);position:absolute;left:0;font-weight:700;text-transform:uppercase;color:#ccc!important}.e-ticket .ticket-info .flight-type-cell .vertical-text.domestic{bottom:38px}.e-ticket .ticket-info .flight-type-cell .vertical-text.international{bottom:18px}.e-ticket .ticket-detail{border-bottom:1px solid #e6e6e6}.e-ticket .ticket-detail .coupon-list h6.sub-title{font-weight:700;text-transform:uppercase}.e-ticket .ticket-detail .fare-detail h6{color:#999!important}.e-ticket .ticket-detail .fare-detail h6.sub-title{color:#666!important;font-weight:700}.e-ticket.selected{border-top:1px solid #62a9e3;border-left:1px solid #62a9e3;border-right:1px solid #62a9e3}.e-ticket.selected .ticket-info{border-bottom:1px solid #62a9e3}.e-ticket.selected .ticket-info .checkbox-cell{background-color:#62a9e3}.e-ticket.selected .ticket-info .checkbox-cell .slds-button__icon{color:#fff}.e-ticket.selected .ticket-info .checkbox-cell>svg{border:none;margin-top:50px;margin-left:9px}.e-ticket.selected .ticket-info .checkbox-cell>svg>path,.e-ticket.selected .ticket-info .checkbox-cell>svg>use{display:block}.e-ticket.selected .ticket-detail{border-bottom:1px solid #2172BA}.e-ticket.selectable{background-color:#fff}.e-ticket.not-selectable .ticket-info .checkbox-cell{background-color:transparent!important}.e-ticket.not-selectable .ticket-info .checkbox-cell>svg,.e-ticket.not-selectable .ticket-info .checkbox-cell>svg>path,.e-ticket.not-selectable .ticket-info .checkbox-cell>svg>use{display:none}@media (min-width:768px){.ticket-detail .coupon-list .segment{width:10.33333333%}.ticket-detail .coupon-list .flight-number,.ticket-detail .coupon-list .status-code{width:14.66666667%}.ticket-detail .coupon-list .arrival-time{width:10.33333333%}}#ft #apply-fund-transfer .dropdown-item span.symbol{display:inline-block;width:20px;height:20px;text-align:center;border-radius:10px;margin-right:5px}#ft #apply-fund-transfer .dropdown-item a.content{display:inline}#ft #apply-fund-transfer .dropdown-item a.content span.iata{position:absolute;right:10px}#ft #apply-fund-transfer .dropdown-item.corporate span.symbol{background:#441E4C;color:#fff;font-weight:700}#ft #apply-fund-transfer .dropdown-item.corporate a.content span.iata{color:#441E4C;font-weight:700}#ft #apply-fund-transfer .dropdown-item.dis span.symbol{background:#f16321;color:#fff;font-weight:700}#ft #apply-fund-transfer .dropdown-item.dis a.content span.iata{color:transparent;font-weight:700}#ft #apply-fund-transfer .dropdown-item.reserved span.symbol{background:#cd202c;color:#fff;font-weight:700}#ft #apply-fund-transfer .dropdown-item.reserved a.content span.iata{color:#cd202c;font-weight:700}#ft #apply-fund-transfer .dropdown-item.agency span.symbol{background:#10807E;color:#fff;font-weight:700}#ft #apply-fund-transfer .dropdown-item.agency a.content span.iata{color:#10807E;font-weight:700}#ft #apply-fund-transfer .fund-transfer-line{margin:10px -10px 0}#ft #apply-fund-transfer .fund-transfer-line>div{padding:0 10px}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom .account-symbol{display:table-cell;vertical-align:middle;text-align:center;width:40px}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom .account-symbol.corporate span{background:#441E4C}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom .account-symbol.dis span{background:#f16321}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom .account-symbol.reserved span{background:#cd202c}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom .account-symbol.agency span{background:#10807E}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom .account-symbol span{display:inline-block;height:24px;width:24px;border-radius:12px;line-height:24px;font-weight:700;color:#fff}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom input{height:48px}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom span.acc-iata{font-weight:700}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom span.agency-iata{color:#10807E}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom span.dis-iata{color:transparent}#ft #apply-fund-transfer .fund-transfer-line>div .input-group.custom span.corporate-iata{color:#441E4C}#ft #apply-fund-transfer .fund-transfer-line>div.acc-name{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:50px}#ft #apply-fund-transfer .fund-transfer-line>div.acc-name>div{padding:10px;width:100%;line-height:30px;background-color:#f2f2f2}#ft #apply-fund-transfer .fund-transfer-line>div.acc-name>div>span{color:#333}#ft #apply-fund-transfer .fund-transfer-line>div.acc-name>div>span:last-child{position:absolute;right:20px;font-weight:700}#ft #apply-fund-transfer .fund-transfer-line>div.acc-name>div>span:last-child.acc-iata{font-weight:700}#ft #apply-fund-transfer .fund-transfer-line>div.acc-name>div>span:last-child.agency-iata{color:#10807E}#ft #apply-fund-transfer .fund-transfer-line>div.acc-name>div>span:last-child.dis-iata{color:transparent}#ft #apply-fund-transfer .fund-transfer-line>div.acc-name>div>span:last-child.corporate-iata{color:#441E4C}#ft #apply-fund-transfer .fund-transfer-line>div.button-cell{clear:both;padding-top:10px}#ft #apply-fund-transfer .fund-transfer-line>div.button-cell .disabled{background-color:#999;color:#fff!important;height:50px;border:none!important}#ft #apply-fund-transfer .fund-transfer-line>div.button-cell a{line-height:50px}#ft #apply-fund-transfer .fund-transfer-line .input-group.custom.amt .input-group-addon{padding-right:2px;padding-top:9px}#ft #apply-fund-transfer .comment,#ft #confirm-fund-transfer .button-group .col-sm-3:first-child{padding-right:0}#ft #apply-fund-transfer .fund-transfer-line .input-group.custom.amt .form-control{padding-left:2px}#ft #apply-fund-transfer .comment #txt-ft-comment{height:100px}#ft #confirm-fund-transfer .button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#ft #fund-transfer-confirm-modal .highlight{color:#f16321}#passenger-list .passenger .passenger-info span.glyphicon,#passenger-list .passenger .passenger-overlay span.glyphicon{color:#62a9e3;margin-right:5px}#ft #fund-transfer-confirm-modal .row.button .col-xs-6:first-child{padding-right:10px}#ft #fund-transfer-confirm-modal .row.button .col-xs-6:last-child{padding-left:10px}@media (min-width:768px){#ft{padding:0 10px}#ft #apply-fund-transfer .fund-transfer-line>div.button-cell{clear:none;padding-top:0}#ft #apply-fund-transfer .comment,#ft #confirm-fund-transfer .button-group .col-sm-3:first-child{padding-right:10px}#ft #confirm-fund-transfer .button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}}#passenger-list .passenger{position:relative;padding:0 5px}#passenger-list .passenger:last-child .passenger-info{border-bottom:1px solid #e6e6e6!important}#passenger-list .passenger .passenger-info{padding:10px;line-height:30px;border:1px solid #e6e6e6;border-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#passenger-list .passenger .passenger-info div.passenger-name{width:calc(100% - 80px)}#passenger-list .passenger .passenger-info img.loyalty{height:40px;position:absolute;right:15px;top:5px}#passenger-list .passenger .passenger-overlay{padding:10px;background-color:#fff;position:absolute;bottom:0;left:5px;right:5px;z-index:1;border:1px solid #e6e6e6;height:50px;opacity:0}#passenger-list .passenger .passenger-overlay.expand{opacity:1;height:auto}#passenger-list .passenger .passenger-overlay div.passenger-name{font-weight:700;word-wrap:break-word;word-break:break-all}#passenger-list .passenger .passenger-overlay .loyalty{margin-top:15px;display:-ms-flexbox;display:flex;-ms-flex-align:end;align-items:flex-end}#passenger-list .passenger .passenger-overlay .loyalty div.frequent-number{font-weight:700}#passenger-list .passenger .passenger-overlay .loyalty img{width:auto;height:50px;float:right;margin-top:0}@media (min-width:768px){#passenger-list .passenger{position:relative;padding:0 5px;margin-bottom:10px}#passenger-list .passenger .passenger-info{border:1px solid #e6e6e6!important}}.payment-option{position:relative;padding:20px;background-color:#f2f2f2}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center{background-color:#fff;border:1px solid #ccc}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center.ng-error{border:1px solid #cd202c}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .check{margin:5px;width:40px;height:40px;padding:10px;background-color:#ccc}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .check path,.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .check svg{color:transparent}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .check.selected{background:#62a9e3}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .check.selected path,.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .check.selected svg{color:#fff}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group{width:calc(100% - 200px);background-color:#f2f2f2}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .account-symbol{display:table-cell;vertical-align:middle;text-align:center;width:40px}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .account-symbol.corporate span{background:#441E4C}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .account-symbol.dis span{background:#f16321}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .account-symbol.reserved span{background:#cd202c}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .account-symbol.agency span{background:#10807E}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .account-symbol span{display:inline-block;height:24px;width:24px;border-radius:12px;line-height:24px;font-weight:700;color:#fff}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul{background-color:#fff}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul .dropdown-item.corporate span.symbol{background:#441E4C;color:#fff;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul .dropdown-item.corporate a.content span.ext-id{color:#441E4C;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul .dropdown-item.dis span.symbol{background:#f16321;color:#fff;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul .dropdown-item.dis a.content span.ext-id{color:transparent;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul .dropdown-item.reserved span.symbol{background:#cd202c;color:#fff;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul .dropdown-item.reserved a.content span.ext-id{color:#cd202c;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul .dropdown-item.agency span.symbol{background:#10807E;color:#fff;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group ul .dropdown-item.agency a.content span.ext-id{color:#10807E;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item .symbol{float:left;display:inline-block;width:20px;height:20px;text-align:center;border-radius:10px;margin-right:5px;color:#fff;font-weight:700}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item a{display:inline}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item a .name{width:calc(100% - 80px);display:inline-block;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:1}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item a .ext-id{font-weight:700;position:absolute;right:10px}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item.corporate .symbol{background:#441E4C}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item.corporate a .ext-id{color:#441E4C}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item.dis .symbol{background:#f16321}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item.dis a .ext-id{color:#f16321}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item.reserved .symbol{background:#cd202c}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item.reserved a .ext-id{color:#cd202c}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item.agency .symbol{background:#10807E}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .dropdown-menu .dropdown-item.agency a .ext-id{color:#10807E}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .form-control{overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1;height:40px;padding:5px}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .form-control.agency,.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .form-control.company{width:calc(100% - 80px)}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .ext-id-label{line-height:20px;position:absolute;right:40px;top:10px;font-weight:700;z-index:5}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .ext-id-label.corporate{color:#441E4C}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .ext-id-label.dis{color:#f16321}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .ext-id-label.reserved{color:#cd202c}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group .ext-id-label.agency{color:#10807E}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group.custom{background:#fff;width:100%;border:0}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group.custom .form-control{width:calc(100% - 80px);height:50px}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group.custom .ext-id-label{line-height:30px}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group.readonly{background-color:#fff;border-right:1px solid #ccc}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .input-group>*{background-color:transparent}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .value{width:140px;margin-right:10px;text-align:right}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .value label{font-weight:700;text-transform:uppercase;display:block}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .value span{font-weight:700;text-transform:uppercase}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .value.valid span{color:#7ac24b}.payment-option .fund-charge .col-sm-6 .col-xs-12.flex-center .value.warning span{color:#cd202c}.payment-option #txt-comment,.payment-option #txt-remark{height:100px}.payment-option .tt-comment,.payment-option .tt-remark{bottom:30px;left:-132px}.payment-option .icon-03{height:16px;margin-top:-2px}@media (min-width:768px){.payment-option .fund-charge{margin:0 -10px}.payment-option .fund-charge .col-sm-6{padding:0 10px}}#pw #pnr-no-ticket,#pw #pnr-unticketed{text-align:center}#pw #pnr-no-ticket img,#pw #pnr-unticketed img{width:45px;display:block;margin:20px auto}#pw #pnr-no-ticket h4,#pw #pnr-unticketed h4{display:block}#pw #pnr-no-ticket .line,#pw #pnr-unticketed .line{width:130px;margin:30px auto}#pw #pnr-no-ticket .line{border-bottom:1px solid #f16321}#pw #pnr-no-ticket h4 span.pnr-number{color:#f16321}#pw #pnr-unticketed{display:none}#pw #pnr-unticketed .line{border-bottom:1px solid #2172BA}#pw #pnr-unticketed h4 span.pnr-number{color:#2172BA}#pw #apply-penalty-waiver,#pw #confirm-penalty-waiver{margin-top:10px}#pw #confirm-penalty-waiver .summary-table .passenger-name{overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1}#pw #confirm-penalty-waiver .headcount-icon{color:#011934;font-size:20px}#pw #confirm-penalty-waiver .button-group .col-sm-3:first-child{padding-right:0}#pw #confirm-penalty-waiver .button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#pw #penalty-waiver-confirm-modal .highlight{color:#f16321}#pw #penalty-waiver-confirm-modal .row.button .col-xs-6:first-child .action-item{margin-left:0}#pw #penalty-waiver-confirm-modal .row.button .col-xs-6:last-child .action-item{margin-right:0}#pw #penalty-waiver-success-modal h2.waiver-code{display:inline-block}#pw #penalty-waiver-success-modal .wrap-text{word-wrap:break-word}#pw #penalty-waiver-success-modal .highlight{color:#67ae44}#pw #penalty-waiver-success-modal .header,#pw #penalty-waiver-success-modal .ref-number-text{text-transform:uppercase;color:#999;display:block;margin-bottom:5px}#pw #penalty-waiver-success-modal .copy-to-clipboard{text-transform:uppercase;font-weight:700;margin-left:10px;color:#2172BA}#eplus .tooltip.right,#eplus .tooltip.top{margin-left:3px;margin-top:0}#eplus .tooltip.right .tooltip-inner,#eplus .tooltip.top .tooltip-inner{border-radius:0;font-size:11px;line-height:14px;color:#333;background-color:#fff}@media (min-width:768px){#pw{padding:0 10px}#pw #confirm-penalty-waiver .button-group .col-sm-3:first-child{padding-right:10px}#pw #confirm-penalty-waiver .button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}}#eplus .tooltip.top .tooltip-arrow{border-top-color:#fff}#eplus .tooltip.right .tooltip-inner{text-align:left!important;text-align:start!important}#eplus .tooltip.right .tooltip-arrow{border-right-color:#fff}#eplus .pnr-error{text-align:center}#eplus .pnr-error img{width:45px;display:block;margin:20px auto}#eplus .pnr-error h4{display:block}#eplus .pnr-error h4 span.pnr-number{color:#F16321}#eplus .pnr-error .line{width:130px;margin:30px auto;border-bottom:1px solid #F16321}#eplus #apply-eplus{position:relative}#eplus #apply-eplus .pnr{line-height:52px}#eplus #apply-eplus #eplus-cart{position:absolute;z-index:1;top:0;right:0;left:0;padding:4px 20px;margin:0 -20px;background-color:#fff}#eplus #apply-eplus #eplus-cart .action-item.cart-button{width:100%;margin-right:0;float:right;text-align:right}#eplus #apply-eplus #eplus-cart .action-item.cart-button a{color:#666}#eplus #apply-eplus #eplus-cart .action-item.cart-button a .cart-counter{border:1px solid #fff;background:#C00822;color:#fff;font-size:10px;line-height:10px;float:left;padding:4px 6px;margin-left:-10px;position:relative}#eplus #apply-eplus #eplus-cart .action-item.cart-button a .glyphicon{font-size:20px;float:left;margin-top:-2px}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item .wrapper .price,#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-footer .price,#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-header .close-cart{float:right}#eplus #apply-eplus #eplus-cart .eplus-cart-panel{position:absolute;right:0;background-color:#fff;border:1px solid #E6E6E6;z-index:1;top:50px;width:100%;color:#666}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-header{padding:20px}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-header h6{font-weight:lighter}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body{max-height:226px;overflow-y:auto}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item{position:relative;cursor:pointer;margin:0;padding:0 20px;line-height:50px;background:#fff}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item .wrapper{line-height:20px;overflow:hidden;border-bottom:1px solid #e6e6e6;padding:10px 0}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item .wrapper p{line-height:19px;margin:0 0 5px}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item .wrapper p.name{overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1;font-weight:lighter;color:#2172BA}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item .wrapper p.flight{font-weight:lighter;color:#2172BA}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item .wrapper p.desc{font-size:12px;color:#999}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item .wrapper a.change{text-transform:uppercase}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-body ul .cart-item:hover{background:#F2F2F2}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .cart-footer{background-color:#002F57;color:#fff;padding:16px 20px}#eplus #apply-eplus #eplus-cart .eplus-cart-panel .action-item{border:0!important}#eplus #apply-eplus #eplus-cart-spacing{height:110px}#eplus #apply-eplus .privilege-content{margin-top:10px;height:130px}#eplus #apply-eplus #eplus-segment .segment{position:relative}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info.table-row:last-child{border-bottom:none}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .flight-number .disclaimer-msg{position:relative;display:inline-block}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .flight-number .disclaimer-msg .disclaimer-tooltips{width:200px;bottom:30px;left:-90px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .flight-number .disclaimer-msg img{width:16px;margin-top:-3px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .airport{font-weight:700}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .assign-seat-tooltips{width:200px;bottom:30px;left:-50px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .segment-action{float:none;text-align:right}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .segment-action a{font-weight:700;text-transform:uppercase}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .segment-action a.disabled{color:#999}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .segment-action svg.segment-toggle{margin-left:5px;transition:all .3s ease-in-out;color:#2172BA}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .segment-action svg.segment-toggle.open{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg)}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .reassign-seat{line-height:56px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .flight-segment-tab{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;float:right;margin-right:20px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .flight-segment-tab .segment-leg{padding:16px 30px;background-color:#2172BA;color:#fff;text-align:center;border:0}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .flight-segment-tab .segment-leg span{display:block}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .flight-segment-tab .segment-leg span.airport{font-weight:700}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .flight-segment-tab .segment-leg.active{background-color:#f2f2f2;color:#666}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view{clear:both;background-color:#f2f2f2;padding:20px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger{margin:0 -5px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .header-tooltip{height:26px;margin-top:-10px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3{padding:5px;position:relative}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div{background-color:#fff;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div>span.passenger-index{width:51px;height:50px;line-height:20px;padding:15px 0;background-color:#2172BA;text-align:center;color:#fff;border-right:1px solid #fff}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div>div.passenger-info{width:calc(100% - 51px);line-height:20px;padding:15px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div>div.passenger-info span.passenger-name{font-weight:700;overflow:hidden;text-overflow:ellipsis;display:inline-block;-webkit-line-clamp:1}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div>div.passenger-info span.seat-number{margin-left:auto;font-weight:700;color:#2172BA}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div>div.passenger-info span.seat-assignment-restriction{margin-left:5px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div>div.passenger-info span.seat-assignment-restriction img{width:18px;height:18px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div.active>div.passenger-info{background-color:#002F57}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3>div.active>div.passenger-info span{color:#fff}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3 .passenger-tiny-tooltip{position:absolute;margin-left:5px;right:5px;top:60px;font-size:12px!important;min-height:30px;padding:5px;z-index:2;border:1px solid #e6e6e6;border-radius:3px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-view-passenger .col-sm-3 .passenger-tiny-tooltip .glyphicon{color:#62a9e3}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-passenger-privilege{padding:5px;background-color:#572C5F;color:#fff;font-size:12px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-passenger-privilege .logo-svg{max-width:30px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-passenger-privilege .logo-svg .svg{fill:#C5AB85}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-passenger-privilege .logo-text{float:left;width:135px;color:#C5AB85;font-weight:700;text-transform:uppercase;margin-right:5px;margin-left:2px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-passenger-privilege .privilege-text{padding-top:5px;margin-bottom:5px;word-wrap:break-word;word-break:normal}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-wrapper{overflow-x:scroll;overflow-y:hidden;clear:both;background-color:#bbd1e8;padding:0 20px}#eplus #confirm-eplus .row .col-sm-6:first-child,#eplus #confirm-eplus .row.button-group .col-sm-3:first-child{padding-right:0}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-footer .seat-map-legend{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-footer .seat-map-legend>div{margin-right:10px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-footer .seat-map-legend>div span{display:block;margin:auto 10px auto auto}#eplus #confirm-eplus .row .col-sm-6:last-child,#eplus #confirm-eplus .row.button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-footer .seat-map-legend>div span.unavailable{width:20px;height:26px;background-image:url(/resource/Sip_seat_map/newseat/keyOccupied.gif)}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-footer .seat-map-legend>div span.exit-door{width:16px;height:26px;background-image:url(/resource/Sip_seat_map/newseat/keyExit.gif)}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-footer .seat-map-legend>div span.exit-row{width:47px;height:7px;background-image:url(/resource/Sip_seat_map/newseat/keyExitRow.gif)}#eplus #apply-eplus #eplus-segment .segment .segment-body .row .segment-seat-map .seat-map-view .seat-map-footer .seat-map-legend>div span.inaccessible{width:20px;height:26px;background-image:url(/resource/Sip_seat_map/newseat/keyPermblocked.gif)}#eplus #apply-eplus #eplus-segment .segment .segment-body:last-child{border-bottom:3px solid #e6e6e6}#eplus #confirm-eplus .summary-table .passenger-name{overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1}#eplus #complete-eplus .passenger-name{overflow:hidden;text-overflow:ellipsis;display:block;-webkit-line-clamp:1}#eplus #complete-eplus .fail .table-desc>div{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;color:#cd202c}#eplus #complete-eplus .fail .table-desc>div img{height:20px;width:20px;margin-right:10px}#eplus #complete-eplus .fail .summary-table img,#eplus #complete-eplus .success .summary-table svg{height:20px;width:20px;margin-top:-3px}#eplus #complete-eplus .email{padding:20px;background-color:#f2f2f2}#eplus #complete-eplus .email .email-addr{color:#2172BA}#eplus #complete-eplus .email .tooltips.inline.alert-msg{width:auto;margin-right:20px}#eplus #exit-seat-modal{font-size:12px}#eplus #exit-seat-modal ul{padding-left:20px}#eplus #exit-seat-modal ul li{height:auto;position:relative;font-size:12px;margin:5px 0}#eplus #exit-seat-modal ul li:first-child{margin-top:0}#eplus #exit-seat-modal ul li:last-child{margin-bottom:0}#eplus #exit-seat-modal ul li:before{content:'';display:inline-block;height:8px;width:8px;border-radius:1px;background-color:#2172BA;position:absolute;left:-20px;top:4px}@media (min-width:768px){#eplus #confirm-eplus .row .col-sm-6:first-child,#eplus #confirm-eplus .row.button-group .col-sm-3:first-child{padding-right:10px}#eplus{margin:0 10px}#eplus #apply-eplus #eplus-cart .action-item.cart-button{max-width:350px}#eplus #apply-eplus #eplus-cart .eplus-cart-panel{width:350px}#eplus #apply-eplus #eplus-cart-spacing{height:60px}#eplus #apply-eplus .privilege-content{margin-top:10px;height:95px}#eplus #confirm-eplus .row .col-sm-6:last-child,#eplus #confirm-eplus .row.button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info.table-row>div.col-sm-2.arrival,#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info.table-row>div.col-sm-2.departure,#eplus #apply-eplus #eplus-segment .segment .table-header>div.col-sm-2,#eplus #apply-eplus #eplus-segment .segment .table-header>div:last-child{width:19%}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info.table-row>div:last-child{width:10.66666667%}#eplus #apply-eplus #eplus-segment .segment .segment-body .row.segment-info .segment-action{float:right}#eplus #apply-eplus #eplus-segment .segment .segment-body:last-child{border-bottom:none}#eplus #confirm-eplus .summary-table .date{width:20.66666667%}#eplus #confirm-eplus .summary-table .cost{width:12.66666667%}#eplus #complete-eplus .summary-table .date{width:20.66666667%}#eplus #complete-eplus .summary-table .change{width:12.66666667%}#eplus #complete-eplus .wrap-text{word-wrap:break-word}#eplus #exit-seat-modal .modal-dialog{width:768px}}.seat-map table{width:auto;line-height:normal;color:#333}.seat-map table caption{line-height:0;padding:0;margin:0;display:none}.seat-map .table-plane-map{width:auto;line-height:normal}.seat-map .table-plane-map caption{line-height:0;padding:0;margin:0;display:none}.seat-map .visuallyhidden{display:none}.seat-map .economy td,.seat-map .economy th,.seat-map .frontCabin td,.seat-map .frontCabin th{font-size:11px;font-weight:700;text-align:right;padding:0}.seat-map .interior td,.seat-map .interior th,.seat-map .windows td,.seat-map .windows th{background:#d7d7d7}.seat-map td .available.inaccessible span,.seat-map td .inaccessible span{background-position:-8px -404px!important}.seat-map span.aisle,.seat-map span.gap,.seat-map span.seat{display:block;margin:0 0 0 auto;text-align:right}.seat-map .frontCabin span.gap,.seat-map .frontCabin span.seat{width:30px}.seat-map .frontCabin span.gap{height:16px}.seat-map .frontCabin .FBB span.seat,.seat-map .frontCabin .FBF span.seat,.seat-map .frontCabin .FBL span.seat,.seat-map .frontCabin .FBR span.seat,.seat-map .sectionA .FBL1 .seat,.seat-map .sectionA .FBL2 .seat,.seat-map .sectionA .FBR1 .seat,.seat-map .sectionA .FBR2 .seat{width:36px}.seat-map .frontCabin span.seat,.seat-map .sectionA .FBL1 .seat,.seat-map .sectionA .FBR1 .seat{height:20px}.seat-map .sectionA .FBL2 .seat,.seat-map .sectionA .FBR2 .seat{height:30px}.seat-map .frontCabin .FBB span.seat,.seat-map .frontCabin .FBF span.seat{height:16px}.seat-map .frontCabin span.aisle{width:16px;height:24px}.seat-map .frontCabin .upper .windowseats span.seat,.seat-map .frontCabin span.seat{margin-top:4px}.seat-map .frontCabin .lower .windowseats span.seat{margin-bottom:4px}.seat-map .ci6-2_7-2 .frontCabin .lower .windowseats span.seat,.seat-map .ci7-2_9-2 .frontCabin .lower .windowseats span.seat,.seat-map .economy .lower .windowseats span.seat{margin-bottom:2px}.seat-map .frontCabin .seat{background-image:url(/resource/Sip_seat_map/newseat/first20.png)}.seat-map .frontCabin .FBL .seat{background-image:url(/resource/Sip_seat_map/newseat/first20fbla.png)}.seat-map .frontCabin .FBR .seat{background-image:url(/resource/Sip_seat_map/newseat/first20fbra.png)}.seat-map .frontCabin .FBF .seat{background-image:url(/resource/Sip_seat_map/newseat/uabusiness16fbfa.png)}.seat-map .frontCabin .FBB .seat{background-image:url(/resource/Sip_seat_map/newseat/uabusiness16fbba.png)}.seat-map .frontCabin .daa-fl .seat,.seat-map .frontCabin .daa-fr .seat,.seat-map .frontCabin .daa-l .seat,.seat-map .frontCabin .daa-r .seat{width:32px;height:28px}.seat-map .frontCabin .daa-fl .seat,.seat-map .frontCabin .daa-fr .seat{margin-left:1px}.seat-map .frontCabin .daa-l .seat{background-image:url(/resource/Sip_seat_map/newseat/daa-left.png)}.seat-map .frontCabin .daa-r .seat{background-image:url(/resource/Sip_seat_map/newseat/daa-right.png)}.seat-map .frontCabin .daa-fr .seat{background-image:url(/resource/Sip_seat_map/newseat/daa-front-right.png)}.seat-map .frontCabin .daa-fl .seat{background-image:url(/resource/Sip_seat_map/newseat/daa-front-left.png)}.seat-map .sectionA .FBF .seat{background-image:url(/resource/Sip_seat_map/newseat/uafirst16fbfa.png)}.seat-map .sectionA .FBL1 .seat{background-image:url(/resource/Sip_seat_map/newseat/uafirst20fbl1a.png)}.seat-map .sectionA .FBL2 .seat{background-image:url(/resource/Sip_seat_map/newseat/uafirst30fbl2a.png)}.seat-map .sectionA .FBR1 .seat{background-image:url(/resource/Sip_seat_map/newseat/uafirst20fbr1a.png)}.seat-map .sectionA .FBR2 .seat{background-image:url(/resource/Sip_seat_map/newseat/uafirst30fbr2a.png)}.seat-map .economy span.gap,.seat-map .economy span.seat{width:22px;height:16px}.seat-map .economy span.aisle{width:16px;height:19px;font-size:0}.seat-map .economy .upper span.seat{margin-top:1px}.seat-map .economy .upper .windowseats span.seat{margin-top:2px}.seat-map .economy .lower span.seat,.seat-map .economy .mid span.seat{margin-top:1px}.seat-map .sectionA+.sectionB .seatLetter,.seat-map .sectionA+.sectionC .seatLetter,.seat-map .sectionB+.sectionC .seatLetter{padding-left:1em}.seat-map .ci6-2_7-2 .frontCabin .upper .windowseats span.seat,.seat-map .ci6-2_7-2 .frontCabin span.seat,.seat-map .ci7-2_9-2 .frontCabin span.seat{margin-top:2px}.seat-map .ci3-1_4-1 .frontCabin span.aisle,.seat-map .ci7-2_9-2 .frontCabin span.aisle{height:18px}.seat-map .ci3-1_4-1 .economy span.aisle{height:19px}.seat-map .ci3-1_7-2 .economy span.aisle,.seat-map .ci4-2_10-2 .economy span.aisle,.seat-map .ci4-2_9-2 .economy span.aisle{height:14px}.seat-map .ci3-1_7-2 .frontCabin .upper .windowseats span.seat,.seat-map .ci3-1_7-2 .frontCabin span.seat,.seat-map .ci4-1_10-2 .frontCabin .upper .windowseats span.seat,.seat-map .ci4-1_10-2 .frontCabin span.seat,.seat-map .ci4-2_10-2 .frontCabin .upper .windowseats span.seat,.seat-map .ci4-2_10-2 .frontCabin span.seat,.seat-map .ci4-2_9-2 .frontCabin .upper .windowseats span.seat,.seat-map .ci4-2_9-2 .frontCabin span.seat{margin-top:10px}.seat-map .ci3-1_7-2 .frontCabin .lower .windowseats span.seat,.seat-map .ci4-2_10-2 .frontCabin .lower .windowseats span.seat,.seat-map .ci4-2_9-2 .frontCabin .lower .windowseats span.seat{margin-bottom:10px}.seat-map .ci4-1_10-2 .frontCabin .upper .windowseats span.seat,.seat-map .ci4-1_10-2 .frontCabin span.seat{margin-top:14px}.seat-map .ci4-1_10-2 .frontCabin .lower .windowseats span.seat{margin-bottom:14px}.seat-map .ci4-2_9-2 .frontCabin span.aisle{height:27px}.seat-map .ci4-1_10-2 .frontCabin span.aisle{height:61px}.seat-map .ci4-2_10-2 .frontCabin span.aisle{height:35px}.seat-map .ci4-2_10-2 .frontCabin .upper span.aisle{height:36px}.seat-map .ci3-1_7-2 .frontCabin span.aisle{height:50px}.seat-map .ci6-2_7-2 .economy span.aisle,.seat-map .ci6-2_9-2 .frontCabin span.aisle{height:23px}.seat-map .ci6-2_7-2 .frontCabin span.aisle{height:17px}.seat-map .ci0-0_4-1 .economy span.seat{margin-top:1px}.seat-map .ci0-0_4-1 .economy span.aisle{height:22px}.seat-map .ci0-0_4-1 span.lav{border-top:none;height:33px}.seat-map .ci0-0_4-1 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ci0-0_4-1.png);width:134px;height:132px}.seat-map .ci0-0_4-1 span.tail{background-image:url(/resource/Sip_seat_map/newseat/atrtail.png);width:60px;height:132px}.seat-map .economy .seat{background-image:url(/resource/Sip_seat_map/newseat/economy16.png)}.seat-map .economy .preferred .seat{background-image:url(/resource/Sip_seat_map/newseat/preferred16.png)}.seat-map .economy .comfort .seat{background-image:url(/resource/Sip_seat_map/newseat/comfort16.png)}.seat-map .economy .legroom .seat{background-image:url(/resource/Sip_seat_map/newseat/legroom16.png)}.seat-map .economy td.elitezone,.seat-map .economy th.elitezone{background-color:#b6c0d5}.seat-map .economy .pitch{width:30px}.seat-map .seat{background-position:-8px -14px}.seat-map .available .seat{background-position:-8px -44px!important}.seat-map .seatmap a{cursor:default;display:block}.seat-map .available a .seat{cursor:pointer}.seat-map .blocked .seat{background-position:-8px -74px!important}.seat-map .current1 .seat{background-position:-8px -104px!important}.seat-map .current2 .seat{background-position:-8px -134px!important}.seat-map .current3 .seat{background-position:-8px -164px!important}.seat-map .current4 .seat{background-position:-8px -194px!important}.seat-map .current5 .seat{background-position:-8px -224px!important}.seat-map .current6 .seat{background-position:-8px -254px!important}.seat-map .current7 .seat{background-position:-8px -284px!important}.seat-map .current8 .seat{background-position:-8px -314px!important}.seat-map .current9 .seat{background-position:-8px -344px!important}.seat-map .permblocked .seat{background-position:-8px -404px!important}.seat-map .top td,.seat-map .top th{vertical-align:bottom}.seat-map .bottom td,.seat-map .bottom th,.seat-map .upper td.closet,.seat-map .upper td.galley,.seat-map .upper td.lav{vertical-align:top}.seat-map .windows td,.seat-map .windows th{height:9px;font-size:0}.seat-map .exterior td,.seat-map .exterior th{text-align:right;height:43px}.seat-map span.window{display:block;background:#fff;height:9px;width:100%;line-height:0}.seat-map .exterior td.sky,.seat-map .exterior td.wing,.seat-map .exterior th.sky,.seat-map .exterior th.wing{background-image:url(/resource/Sip_seat_map/newseat/wings.png)}.seat-map .exterior td.exit,.seat-map .exterior th.exit{background-image:url(/resource/Sip_seat_map/newseat/wingsexit.png)}.seat-map .frontCabin .exterior td.exit,.seat-map .frontCabin .exterior th.exit,.seat-map html>body .exterior td.exit.pitch,.seat-map html>body .exterior th.exit.pitch{background-image:url(/resource/Sip_seat_map/newseat/wingsexitpitch.png)}.seat-map .top span.window{border-top:solid 1px #464646;border-bottom:solid 6px #acacac}.seat-map .top .le span.window,.seat-map .top .wing span.window{border-top-color:#fff}.seat-map .top .te span.window{border-top-color:#464646}.seat-map .top .first span.window{border-bottom-color:#F48C0F}.seat-map .top .legroom span.window{border-bottom-color:#36c}.seat-map .top .comfort span.window{border-bottom-color:#990042}.seat-map .top .exit span.window{border-bottom-color:#ec1c24}.seat-map .top .exterior td.sky,.seat-map .top .exterior th.sky{background-position:0 bottom}.seat-map .top .exterior td.wing,.seat-map .top .exterior th.wing{background-position:-80px bottom}.seat-map .top .exterior td.le,.seat-map .top .exterior th.le{background-position:-40px bottom!important}.seat-map .top .exterior td.te,.seat-map .top .exterior th.te{background-position:-120px bottom!important}.seat-map .bottom span.window{border-bottom:solid 1px #464646;border-top:solid 6px #acacac}.seat-map .bottom .le span.window,.seat-map .bottom .wing span.window{border-bottom-color:#fff}.seat-map .bottom .te span.window{border-bottom-color:#464646}.seat-map .bottom .first span.window{border-top-color:#f48c0f}.seat-map .bottom .legroom span.window{border-top-color:#36c}.seat-map .bottom .comfort span.window{border-top-color:#990042}.seat-map .bottom .exit span.window{border-top-color:#ec1c24}.seat-map .bottom .exterior td.sky,.seat-map .bottom .exterior th.sky{background-position:0 top}.seat-map .bottom .exterior td.wing,.seat-map .bottom .exterior th.wing{background-position:-80px top}.seat-map .bottom .exterior td.le,.seat-map .bottom .exterior th.le{background-position:-40px top!important}.seat-map .bottom .exterior td.te,.seat-map .bottom .exterior th.te{background-position:-120px top!important}.seat-map span.closet,.seat-map span.galley,.seat-map span.lav,.seat-map span.stairs{display:block;border:1px solid #acacac;margin:0 0 0 auto;background-position:center center;background-repeat:no-repeat}.seat-map td.lav{width:36px}.seat-map span.stairs{width:38px;height:23px;background-image:url(/resource/Sip_seat_map/newseat/stairsup.png)}.seat-map span.lav{width:28px;background-image:url(/resource/Sip_seat_map/newseat/lav.png)}.seat-map td.galley{width:36px}.seat-map span.galley{width:28px;background-image:url(/resource/Sip_seat_map/newseat/galley.png)}.seat-map td.closet{width:28px}.seat-map span.closet{width:20px;background-image:url(/resource/Sip_seat_map/newseat/closet.png)}.seat-map .upper span.closet,.seat-map .upper span.galley,.seat-map .upper span.lav{border-top:none}.seat-map .lower span.closet,.seat-map .lower span.galley,.seat-map .lower span.lav{border-bottom:none}.seat-map .lower td.closet,.seat-map .lower td.galley,.seat-map .lower td.lav{vertical-align:bottom}.seat-map .mid span.closet,.seat-map .mid span.galley,.seat-map .mid span.lav{height:46px;margin-top:1px}.seat-map .frontCabin .mid span.closet,.seat-map .frontCabin .mid span.galley,.seat-map .frontCabin .mid span.lav{height:42px;margin-top:4px}.seat-map .lower span.closet,.seat-map .lower span.galley,.seat-map .lower span.lav,.seat-map .upper span.closet,.seat-map .upper span.galley,.seat-map .upper span.lav{height:47px}.seat-map span.nose,.seat-map span.tail{display:block;background-position:center center;background-repeat:no-repeat}.seat-map .upperDeck .frontCabin span.aisle{height:26px}.seat-map .upperDeck .frontCabin span.seat{margin-bottom:4px}.seat-map .b77c .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .l7i .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .lci .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .uhc .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .uhd .sectionB .frontCabin .lower .windowseats span.seat{margin-bottom:1px}.seat-map .upperDeck span.closet{height:23px;width:38px}.seat-map .upperDeck span.stairs{border-bottom:none;background-image:url(/resource/Sip_seat_map/newseat/stairsdown.png)}.seat-map .upperDeck span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b744uppernose.png);width:173px;height:166px}.seat-map .upperDeck span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-b744uppertail.png);width:95px;height:166px}.seat-map .divPlaneMap .seatDtl{width:10em;text-align:left;border:1px solid #000;background:#fafbad;position:absolute;z-index:30;padding:.25em;display:none;margin-left:4px;color:#000}.seat-map .divPlaneMap .disclosures .seatDtl{width:20em}.seat-map .divPlaneMap a.app-state-hover,.seat-map .divPlaneMap span.app-state-hover{z-index:1}.seat-map .divPlaneMap a.app-state-hover .seatDtl,.seat-map .divPlaneMap span.app-state-hover .seatDtl{display:block}.seat-map .l7i .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .l7i .sectionA .frontCabin span.aisle{height:32px}.seat-map .l7i .economy span.aisle{height:14px}.seat-map .l7i .frontCabin span.aisle{height:15px}.seat-map .l7i .lower span.closet,.seat-map .l7i .lower span.galley,.seat-map .l7i .lower span.lav,.seat-map .l7i .upper span.closet,.seat-map .l7i .upper span.galley,.seat-map .l7i .upper span.lav{height:33px}.seat-map .l7i .frontCabin .mid span.galley,.seat-map .l7i .mid span.closet,.seat-map .l7i .mid span.lav{height:59px}.seat-map .l7i .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .l7i span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .l7i span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .lci .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .lci .sectionA .frontCabin span.aisle{height:32px}.seat-map .lci .economy span.aisle{height:14px}.seat-map .lci .frontCabin span.aisle{height:15px}.seat-map .lci .lower span.closet,.seat-map .lci .lower span.galley,.seat-map .lci .lower span.lav,.seat-map .lci .upper span.closet,.seat-map .lci .upper span.galley,.seat-map .lci .upper span.lav{height:33px}.seat-map .lci .frontCabin .mid span.galley,.seat-map .lci .mid span.closet,.seat-map .lci .mid span.lav{height:59px}.seat-map .lci .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .lci span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .lci span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .b77c .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .b77c .sectionA .frontCabin span.aisle{height:32px}.seat-map .b77c .sectionB .frontCabin span.aisle{height:26px}.seat-map .b77c .economy span.aisle{height:14px}.seat-map .b77c .frontCabin span.aisle{height:15px}.seat-map .b77c .lower span.closet,.seat-map .b77c .lower span.galley,.seat-map .b77c .lower span.lav,.seat-map .b77c .upper span.closet,.seat-map .b77c .upper span.galley,.seat-map .b77c .upper span.lav{height:33px}.seat-map .b77c .frontCabin .mid span.galley,.seat-map .b77c .mid span.closet,.seat-map .b77c .mid span.lav{height:59px}.seat-map .b77c .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .b77c span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .b77c span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .uhc .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .uhc .sectionA .frontCabin span.aisle{height:32px}.seat-map .uhc .sectionB .frontCabin span.aisle{height:15px}.seat-map .uhc .economy span.aisle{height:14px}.seat-map .uhc .frontCabin span.aisle{height:15px}.seat-map .uhc .lower span.closet,.seat-map .uhc .lower span.galley,.seat-map .uhc .lower span.lav,.seat-map .uhc .upper span.closet,.seat-map .uhc .upper span.galley,.seat-map .uhc .upper span.lav{height:33px}.seat-map .uhc .frontCabin .mid span.galley,.seat-map .uhc .mid span.closet,.seat-map .uhc .mid span.lav{height:59px}.seat-map .uhc .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .u7h span.tail,.seat-map .uhc span.tail{background-image:url(/resource/Sip_seat_map/newseat/U7H_UHC_Tail.png);width:106px;height:228px}.seat-map .u7h span.nose,.seat-map .uhc span.nose{background-image:url(/resource/Sip_seat_map/newseat/U7H_UHC_Nose.png);width:231px;height:228px}.seat-map .uhd .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .uhd .sectionA .frontCabin span.aisle{height:32px}.seat-map .uhd .sectionB .frontCabin span.aisle{height:15px}.seat-map .uhd .economy span.aisle{height:14px}.seat-map .uhd .frontCabin span.aisle{height:15px}.seat-map .uhd .lower span.closet,.seat-map .uhd .lower span.galley,.seat-map .uhd .lower span.lav,.seat-map .uhd .upper span.closet,.seat-map .uhd .upper span.galley,.seat-map .uhd .upper span.lav{height:33px}.seat-map .uhd .frontCabin .mid span.galley,.seat-map .uhd .mid span.closet,.seat-map .uhd .mid span.lav{height:59px}.seat-map .uhd .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .u7h span.tail,.seat-map .uhd span.tail{background-image:url(/resource/Sip_seat_map/newseat/U7H_UHC_Tail.png);width:106px;height:228px}.seat-map .u7h span.nose,.seat-map .uhd span.nose{background-image:url(/resource/Sip_seat_map/newseat/U7H_UHC_Nose.png);width:231px;height:228px}.seat-map .g4a .frontCabin span.seat,.seat-map .g4b .frontCabin span.seat,.seat-map .g4c .frontCabin span.seat,.seat-map .h4a .frontCabin span.seat,.seat-map .h4b .frontCabin span.seat,.seat-map .h4c .frontCabin span.seat{margin:1px 0}.seat-map .g4a .economy span.aisle,.seat-map .g4b .economy span.aisle,.seat-map .g4c .economy span.aisle,.seat-map .h4a .economy span.aisle,.seat-map .h4b .economy span.aisle,.seat-map .h4c .economy span.aisle{height:14px}.seat-map .g4a .frontCabin .upper .windowseats span.seat,.seat-map .g4b .frontCabin .upper .windowseats span.seat,.seat-map .g4c .frontCabin .upper .windowseats span.seat,.seat-map .h4a .frontCabin .upper .windowseats span.seat,.seat-map .h4b .frontCabin .upper .windowseats span.seat,.seat-map .h4c .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .g4a .frontCabin .lower .windowseats span.seat,.seat-map .g4b .frontCabin .lower .windowseats span.seat,.seat-map .g4c .frontCabin .lower .windowseats span.seat,.seat-map .h4a .frontCabin .lower .windowseats span.seat,.seat-map .h4b .frontCabin .lower .windowseats span.seat,.seat-map .h4c .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .g4a .frontCabin span.aisle,.seat-map .g4b .frontCabin span.aisle,.seat-map .g4c .frontCabin span.aisle,.seat-map .h4a .frontCabin span.aisle,.seat-map .h4b .frontCabin span.aisle,.seat-map .h4c .frontCabin span.aisle{height:19px}.seat-map .g4a span.nose,.seat-map .g4b span.nose,.seat-map .g4c span.nose,.seat-map .h4a span.nose,.seat-map .h4b span.nose,.seat-map .h4c span.nose{background-image:url(/resource/Sip_seat_map/newseat/b767nose.png);width:213px;height:190px}.seat-map .g4a span.tail,.seat-map .g4b span.tail,.seat-map .g4c span.tail,.seat-map .h4a span.tail,.seat-map .h4b span.tail,.seat-map .h4c span.tail{background-image:url(/resource/Sip_seat_map/newseat/b767tail.png);width:114px;height:190px}.seat-map .g4a .lower span.closet,.seat-map .g4a .lower span.lav,.seat-map .g4a .upper span.closet,.seat-map .g4a .upper span.lav,.seat-map .g4b .lower span.galley,.seat-map .g4b .lower span.lav,.seat-map .g4b .upper span.galley,.seat-map .g4b .upper span.lav,.seat-map .g4c .lower span.lav,.seat-map .g4c .upper span.lav,.seat-map .h4a .lower span.closet,.seat-map .h4a .lower span.galley,.seat-map .h4a .lower span.lav,.seat-map .h4a .upper span.closet,.seat-map .h4a .upper span.galley,.seat-map .h4a .upper span.lav,.seat-map .h4b .lower span.closet,.seat-map .h4b .lower span.galley,.seat-map .h4b .lower span.lav,.seat-map .h4b .upper span.closet,.seat-map .h4b .upper span.galley,.seat-map .h4b .upper span.lav,.seat-map .h4c .lower span.lav,.seat-map .h4c .upper span.lav{height:34px}.seat-map .g4a .frontCabin .mid span.closet,.seat-map .g4b .frontCabin .mid span.closet,.seat-map .g4c .frontCabin .mid span.closet,.seat-map .h4a .frontCabin .mid span.closet,.seat-map .h4b .frontCabin .mid span.closet,.seat-map .h4c .frontCabin .mid span.closet{height:20px;margin-top:0}.seat-map .a9a span.nose,.seat-map .a9b span.nose,.seat-map .a9c span.nose{background-image:url(/resource/Sip_seat_map/newseat/b739nose.png);width:174px;height:166px}.seat-map .a9a span.tail,.seat-map .a9b span.tail,.seat-map .a9c span.tail,.seat-map .a9d span.tail{background-image:url(/resource/Sip_seat_map/newseat/b739tail.png);width:126px;height:166px}.seat-map .a9d span.nose{background-image:url(/resource/Sip_seat_map/newseat/A9D_NOSE.gif);width:179px;height:166px}.seat-map .l30 span.nose,.seat-map .l32 span.nose,.seat-map .l39 span.nose,.seat-map .l93 span.nose,.seat-map .la3 span.nose,.seat-map .la4 span.nose,.seat-map .u32 span.nose,.seat-map .u39 span.nose{background-image:url(/resource/Sip_seat_map/newseat/u32nose.png);width:172px;height:166px}.seat-map .l30 span.tail,.seat-map .l32 span.tail,.seat-map .l39 span.tail,.seat-map .l93 span.tail,.seat-map .la3 span.tail,.seat-map .la4 span.tail,.seat-map .u32 span.tail,.seat-map .u39 span.tail{background-image:url(/resource/Sip_seat_map/newseat/u32tail.png);width:126px;height:166px}.seat-map .d2a span.tail,.seat-map .d2b span.tail,.seat-map .d2d span.tail,.seat-map .d2e span.tail,.seat-map .d2f span.tail,.seat-map .e2a span.tail,.seat-map .e2b span.tail,.seat-map .f2d span.tail,.seat-map .l57 span.tail,.seat-map .l75 span.tail,.seat-map .u57 span.tail,.seat-map .u5j span.tail{background-image:url(/resource/Sip_seat_map/newseat/b752tail.png);width:118px;height:166px}.seat-map .d2a span.nose,.seat-map .d2b span.nose,.seat-map .d2d span.nose,.seat-map .d2e span.nose,.seat-map .d2f span.nose,.seat-map .e2a span.nose,.seat-map .e2b span.nose,.seat-map .f2d span.nose,.seat-map .l57 span.nose,.seat-map .l75 span.nose,.seat-map .u57 span.nose,.seat-map .u5j span.nose{background-image:url(/resource/Sip_seat_map/newseat/b739nose.png);width:174px;height:166px}.seat-map .l75 span.tail{background-image:url(/resource/Sip_seat_map/newseat/L75-Tail.png);width:118px;height:166px}.seat-map .e2c span.tail,.seat-map .e2d span.tail{background-image:url(/resource/Sip_seat_map/newseat/b752tail.png);width:118px;height:166px}.seat-map .e2c span.nose,.seat-map .e2d span.nose{background-image:url(/resource/Sip_seat_map/newseat/b739nose.png);width:174px;height:166px}.seat-map .b52c span.tail{background-image:url(/resource/Sip_seat_map/newseat/b752tail.png);width:118px;height:166px}.seat-map .b52c span.nose{background-image:url(/resource/Sip_seat_map/newseat/b739nose.png);width:174px;height:166px}.seat-map .d3a span.tail,.seat-map .d3b span.tail,.seat-map .d3c span.tail,.seat-map .d3d span.tail,.seat-map .p01 span.tail{background-image:url(/resource/Sip_seat_map/newseat/b753tail.png);width:85px;height:166px}.seat-map .d3a span.nose,.seat-map .d3b span.nose,.seat-map .d3c span.nose,.seat-map .d3d span.nose,.seat-map .p01 span.nose{background-image:url(/resource/Sip_seat_map/newseat/b739nose.png);width:174px;height:166px}.seat-map .d3d .economy .lav{column-span:none;width:24px}.seat-map .a8a span.tail,.seat-map .a8b span.tail,.seat-map .a8c span.tail,.seat-map .a8d span.tail,.seat-map .a8e span.tail,.seat-map .a8f span.tail,.seat-map .a8g span.tail,.seat-map .b8a span.tail,.seat-map .cma span.tail,.seat-map .cs2 span.tail,.seat-map .cs8 span.tail{background-image:url(/resource/Sip_seat_map/newseat/b739tail.png);width:126px;height:166px}.seat-map .a8a span.nose,.seat-map .a8b span.nose,.seat-map .a8c span.nose,.seat-map .a8d span.nose,.seat-map .a8e span.nose,.seat-map .a8f span.nose,.seat-map .b8a span.nose,.seat-map .cma span.nose,.seat-map .cs2 span.nose,.seat-map .cs8 span.nose{background-image:url(/resource/Sip_seat_map/newseat/b73nose.png);width:175px;height:166px}.seat-map .a8j span.tail{background-image:url(/resource/Sip_seat_map/newseat/738_A8J_Tail.png);width:126px;height:166px}.seat-map .a8j span.nose{background-image:url(/resource/Sip_seat_map/newseat/738_A8J_Nose.png);width:175px;height:166px}.seat-map .a9e span.tail{background-image:url(/resource/Sip_seat_map/newseat/737-900_A9E_Tail.gif);width:126px;height:166px}.seat-map .a9e span.nose{background-image:url(/resource/Sip_seat_map/newseat/737-900_A9E_Nose.gif);width:179px;height:166px}.seat-map .a8h span.tail,.seat-map .a8i span.tail,.seat-map .a8k span.tail,.seat-map .a8l span.tail,.seat-map .a9f span.tail,.seat-map .a9g span.tail,.seat-map .a9h span.tail,.seat-map .a9i span.tail,.seat-map .c9a span.tail,.seat-map .p02 span.tail,.seat-map .p03 span.tail{background-image:url(/resource/Sip_seat_map/newseat/A8I_Retro_Tail.png);width:126px;height:166px}.seat-map .a8h span.nose,.seat-map .a8i span.nose,.seat-map .a8k span.nose,.seat-map .a8l span.nose,.seat-map .a9f span.nose,.seat-map .a9g span.nose,.seat-map .a9h span.nose,.seat-map .a9i span.nose,.seat-map .c9a span.nose,.seat-map .p02 span.nose,.seat-map .p03 span.nose{background-image:url(/resource/Sip_seat_map/newseat/A8I_Retro_Nose.png);width:179px;height:166px}.seat-map .p02 span.nose,.seat-map .p03 span.nose{width:177px}.seat-map .a8g span.nose{background-image:url(/resource/Sip_seat_map/newseat/A8G_NOSE.png);width:179px;height:166px}.seat-map .a3d span.tail,.seat-map .a5a span.tail,.seat-map .a5b span.tail,.seat-map .a5c span.tail{background-image:url(/resource/Sip_seat_map/newseat/b739tail.png);width:126px;height:166px}.seat-map .a3d span.nose,.seat-map .a5a span.nose,.seat-map .a5b span.nose,.seat-map .a5c span.nose{background-image:url(/resource/Sip_seat_map/newseat/b735nose.png);width:164px;height:166px}.seat-map .c8a span.nose{background-image:url(/resource/Sip_seat_map/newseat/738_C8A_Nose.png);width:179px;height:166px}.seat-map .c8a span.tail{background-image:url(/resource/Sip_seat_map/newseat/738_C8A_Tail.png);width:130px;height:166px}.seat-map .g2a .frontCabin span.seat,.seat-map .h2a .frontCabin span.seat{margin:1px 0}.seat-map .g2a .frontCabin .upper .windowseats span.seat,.seat-map .h2a .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .g2a .frontCabin .lower .windowseats span.seat,.seat-map .h2a .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .g2a .frontCabin span.aisle,.seat-map .h2a .frontCabin span.aisle{height:19px}.seat-map .g2a .economy span.aisle,.seat-map .h2a .economy span.aisle{height:14px}.seat-map .g2a .lower span.closet,.seat-map .g2a .lower span.galley,.seat-map .g2a .lower span.lav,.seat-map .g2a .upper span.closet,.seat-map .g2a .upper span.galley,.seat-map .g2a .upper span.lav,.seat-map .h2a .lower span.closet,.seat-map .h2a .lower span.galley,.seat-map .h2a .lower span.lav,.seat-map .h2a .upper span.closet,.seat-map .h2a .upper span.galley,.seat-map .h2a .upper span.lav{height:34px}.seat-map .g2a span.nose,.seat-map .h2a span.nose{background-image:url(/resource/Sip_seat_map/newseat/b767nose.png);width:213px;height:190px}.seat-map .g2a span.tail,.seat-map .h2a span.tail{background-image:url(/resource/Sip_seat_map/newseat/b767tail.png);width:114px;height:190px}.seat-map .at1 span.galley,.seat-map .at2 span.galley{height:34px}.seat-map .at1 span.nose,.seat-map .at2 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ATR42_72_Nose.png);width:172px;height:134px}.seat-map .at1 span.tail,.seat-map .at2 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ATR42_72_Tail.png);width:82px;height:134px}.seat-map .b3c1 .economy span.aisle,.seat-map .b3c1 .economy span.seat,.seat-map .b9l1 .economy span.aisle,.seat-map .b9l1 .economy span.seat,.seat-map .b9lc .economy span.aisle,.seat-map .b9lc .economy span.seat,.seat-map .sf3 .economy span.aisle,.seat-map .sf3 .economy span.seat,.seat-map .sf4 .economy span.aisle,.seat-map .sf4 .economy span.seat,.seat-map .u34 .economy span.seat,.seat-map .x9c .economy span.aisle,.seat-map .x9c .economy span.seat,.seat-map .xs4 .economy span.aisle,.seat-map .xs4 .economy span.seat{height:16px;margin-top:1px!important}.seat-map .b3c1 .economy .upper .windowseats span.seat,.seat-map .b9l1 .economy .upper .windowseats span.seat,.seat-map .b9lc .economy .upper .windowseats span.seat,.seat-map .sf3 .economy .upper .windowseats span.seat,.seat-map .sf4 .economy .upper .windowseats span.seat,.seat-map .u34 .economy .upper .windowseats span.seat,.seat-map .x9c .economy .upper .windowseats span.seat,.seat-map .xs4 .economy .upper .windowseats span.seat{margin-bottom:1px!important;margin-top:2px!important}.seat-map .sf3 .economy span.aisle,.seat-map .sf4 .economy span.aisle,.seat-map .u34 .economy span.aisle,.seat-map .xs4 .economy span.aisle{height:0}.seat-map .b3c1 span.nose{background-image:url(/resource/Sip_seat_map/newseat/sf3nose.png);width:138px;height:113px}.seat-map .b3c1 span.tail{background-image:url(/resource/Sip_seat_map/newseat/sf3tail.png);width:52px;height:113px}.seat-map .b9l1 span.tail,.seat-map .b9lc span.tail,.seat-map .sf3 span.tail,.seat-map .u34 span.tail,.seat-map .x91 span.tail,.seat-map .x9c span.tail,.seat-map .xs4 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-sf3tail.png);width:60px;height:114px}.seat-map .b9l1 span.nose,.seat-map .b9lc span.nose,.seat-map .sf3 span.nose,.seat-map .u34 span.nose,.seat-map .x91 span.nose,.seat-map .x9c span.nose,.seat-map .xs4 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-sf3nose.png);width:184px;height:114px}.seat-map .sf4 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-sf3tail.png);width:60px;height:117px}.seat-map .sf4 span.nose{background-image:url(/resource/Sip_seat_map/newseat/SF4_Nose.png.png);width:172px;height:117px}.seat-map .c53 .economy .lower span.gap,.seat-map .xd3 .economy .lower span.gap,.seat-map .xq3 .economy .lower span.gap{margin-top:1px}.seat-map .c53 .economy .lower #tdSeat1Y span.gap,.seat-map .xd3 .economy .lower #tdSeat1Y span.gap,.seat-map .xq3 .economy .lower #tdSeat1Y span.gap{margin-bottom:2px}.seat-map .c53 .sectionRFSeats .economy .lower span.seatLetter,.seat-map .xd3 .sectionRFSeats .economy .lower span.seatLetter,.seat-map .xq3 .sectionRFSeats .economy .lower span.seatLetter{visibility:hidden}.seat-map .c53 span.nose,.seat-map .xd3 span.nose{background-image:url(/resource/Sip_seat_map/newseat/q300nose.png);width:136px;height:134px}.seat-map .c53 span.tail,.seat-map .xd3 span.tail,.seat-map .xq3 span.tail{background-image:url(/resource/Sip_seat_map/newseat/q300tail.png);width:84px;height:134px}.seat-map .xq3 span.nose{background-image:url(/resource/Sip_seat_map/newseat/XQ3_Q300_Aircraft_Nose.png);width:144px;height:134px}.seat-map .b9l2 .economy span.aisle,.seat-map .x92 .economy span.aisle{height:1px;line-height:0}.seat-map .b9l2 span.nose,.seat-map .x92 span.nose{background-image:url(/resource/Sip_seat_map/newseat/q200nose.png);width:169px;height:132px}.seat-map .b9l2 span.tail,.seat-map .x92 span.tail{background-image:url(/resource/Sip_seat_map/newseat/q200tail.png);width:60px;height:132px}.seat-map .b47c span.nose,.seat-map .l47 span.nose,.seat-map .l74 span.nose,.seat-map .u74 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b744nosea.png);width:105px;height:245px}.seat-map .b47c span.tail,.seat-map .l47 span.tail,.seat-map .l74 span.tail,.seat-map .u74 span.tail{background-image:url(/resource/Sip_seat_map/newseat/0314-WTS-04-01.png);width:156px;height:245px}.seat-map .b47c .frontCabin .upper span.aisle,.seat-map .l47 .frontCabin .upper span.aisle,.seat-map .l74 .frontCabin .upper span.aisle,.seat-map .u74 .frontCabin .upper span.aisle{height:19px}.seat-map .b47c .frontCabin span.aisle,.seat-map .l47 .frontCabin span.aisle,.seat-map .l74 .frontCabin span.aisle,.seat-map .u74 .frontCabin span.aisle{height:18px}.seat-map .b47c .economy span.aisle,.seat-map .l47 .economy span.aisle,.seat-map .l74 .economy span.aisle,.seat-map .u74 .economy span.aisle{height:14px}.seat-map .b47c #tdSeat1006H span.galley,.seat-map .l47 #tdSeat1006H span.galley,.seat-map .l74 #tdSeat1006H span.galley,.seat-map .u74 #tdSeat1006H span.galley{height:78px}.seat-map .b47c .sectionB span.lav,.seat-map .l47 .sectionB span.lav,.seat-map .l74 .sectionB span.lav,.seat-map .u74 .sectionB span.lav{height:39px}.seat-map .b47c .sectionB .mid span.closet,.seat-map .b47c .sectionB .mid span.galley,.seat-map .l47 .sectionB .mid span.closet,.seat-map .l47 .sectionB .mid span.galley,.seat-map .l74 .sectionB .mid span.closet,.seat-map .l74 .sectionB .mid span.galley,.seat-map .u74 .sectionB .mid span.closet,.seat-map .u74 .sectionB .mid span.galley{width:28px;height:38px;margin:0}.seat-map .l7a .sectionA .lower .windowseats span.seat,.seat-map .u5s .sectionA .lower .windowseats span.seat,.seat-map .u7a .sectionA .lower .windowseats span.seat{margin-bottom:8px}.seat-map .b47c .sectionB .mid .middleseats span.closet,.seat-map .b47c .sectionB .mid .middleseats span.galley,.seat-map .l47 .sectionB .mid .middleseats span.closet,.seat-map .l47 .sectionB .mid .middleseats span.galley,.seat-map .l74 .sectionB .mid .middleseats span.closet,.seat-map .l74 .sectionB .mid .middleseats span.galley,.seat-map .u74 .sectionB .mid .middleseats span.closet,.seat-map .u74 .sectionB .mid .middleseats span.galley{height:39px;border-top:none}.seat-map .b47c .sectionA span.closet,.seat-map .l47 .sectionA span.closet,.seat-map .l74 .sectionA span.closet,.seat-map .u74 .sectionA span.closet{height:32px;width:22px;border:1px solid #acacac;margin-top:0}.seat-map .b47c .sectionA span.galley,.seat-map .l47 .sectionA span.galley,.seat-map .l74 .sectionA span.galley,.seat-map .u74 .sectionA span.galley{height:46px;margin-top:0}.seat-map .l7a .sectionA .upper .windowseats span.seat,.seat-map .l7a .sectionA span.seat,.seat-map .u5s .sectionA .upper .windowseats span.seat,.seat-map .u5s .sectionA span.seat,.seat-map .u7a .sectionA .upper .windowseats span.seat,.seat-map .u7a .sectionA span.seat{margin-top:8px}.seat-map .b47c .sectionA .frontCabin,.seat-map .l47 .sectionA .frontCabin,.seat-map .l74 .sectionA .frontCabin,.seat-map .u74 .sectionA .frontCabin{background-image:url(/resource/Sip_seat_map/newseat/ua-b744noseb.png);background-repeat:no-repeat;background-position:left center}.seat-map .b47c .sectionA .frontCabin td,.seat-map .b47c .sectionA .frontCabin th,.seat-map .l47 .sectionA .frontCabin td,.seat-map .l47 .sectionA .frontCabin th,.seat-map .l74 .sectionA .frontCabin td,.seat-map .l74 .sectionA .frontCabin th,.seat-map .u74 .sectionA .frontCabin td,.seat-map .u74 .sectionA .frontCabin th{background:0 0}.seat-map .b47c .sectionA .frontCabin td span.window,.seat-map .b47c .sectionA .frontCabin th span.window,.seat-map .l47 .sectionA .frontCabin td span.window,.seat-map .l47 .sectionA .frontCabin th span.window,.seat-map .l74 .sectionA .frontCabin td span.window,.seat-map .l74 .sectionA .frontCabin th span.window,.seat-map .u74 .sectionA .frontCabin td span.window,.seat-map .u74 .sectionA .frontCabin th span.window{border:none;background:0 0}.seat-map .b47c .sectionA .frontCabin span.aisle,.seat-map .l47 .sectionA .frontCabin span.aisle,.seat-map .l74 .sectionA .frontCabin span.aisle,.seat-map .u74 .sectionA .frontCabin span.aisle{height:22px}.seat-map .b47c .sectionA .frontCabin .upper span.aisle,.seat-map .l47 .sectionA .frontCabin .upper span.aisle,.seat-map .l74 .sectionA .frontCabin .upper span.aisle,.seat-map .u74 .sectionA .frontCabin .upper span.aisle{height:23px}.seat-map .b47c .sectionA span.seat,.seat-map .l47 .sectionA span.seat,.seat-map .l74 .sectionA span.seat,.seat-map .u74 .sectionA span.seat{margin-top:8px;margin-bottom:8px}.seat-map .b47c .sectionA .seat,.seat-map .b47c .sectionA .seatLetter,.seat-map .l47 .sectionA .seat,.seat-map .l47 .sectionA .seatLetter,.seat-map .l74 .sectionA .seat,.seat-map .l74 .sectionA .seatLetter,.seat-map .u74 .sectionA .seat,.seat-map .u74 .sectionA .seatLetter{position:relative}.seat-map .b47c .sectionA .upper .seatLetter,.seat-map .l47 .sectionA .upper .seatLetter,.seat-map .l74 .sectionA .upper .seatLetter,.seat-map .u74 .sectionA .upper .seatLetter{top:30px}.seat-map .b47c .sectionA .lower .seatLetter,.seat-map .l47 .sectionA .lower .seatLetter,.seat-map .l74 .sectionA .lower .seatLetter,.seat-map .u74 .sectionA .lower .seatLetter{top:-30px}.seat-map .b47c .sectionA .mid .seatLetter,.seat-map .l47 .sectionA .mid .seatLetter,.seat-map .l74 .sectionA .mid .seatLetter,.seat-map .u74 .sectionA .mid .seatLetter{left:36px}.seat-map .b47c #tdSeat1K .seat,.seat-map .l47 #tdSeat1K .seat,.seat-map .l74 #tdSeat1K .seat,.seat-map .u74 #tdSeat1K .seat{top:36px}.seat-map .b47c #tdSeat2K .seat,.seat-map .l47 #tdSeat2K .seat,.seat-map .l74 #tdSeat2K .seat,.seat-map .u74 #tdSeat2K .seat{top:24px}.seat-map .b47c #tdSeat3K .seat,.seat-map .l47 #tdSeat3K .seat,.seat-map .l74 #tdSeat3K .seat,.seat-map .u74 #tdSeat3K .seat{top:12px}.seat-map .b47c #tdSeat3H .seat,.seat-map .l47 #tdSeat3H .seat,.seat-map .l74 #tdSeat3H .seat,.seat-map .u74 #tdSeat3H .seat{top:6px}.seat-map .b47c #tdSeat3C .seat,.seat-map .l47 #tdSeat3C .seat,.seat-map .l74 #tdSeat3C .seat,.seat-map .u74 #tdSeat3C .seat{top:-6px}.seat-map .b47c #tdSeat1A .seat,.seat-map .l47 #tdSeat1A .seat,.seat-map .l74 #tdSeat1A .seat,.seat-map .u74 #tdSeat1A .seat{top:-36px}.seat-map .b47c #tdSeat2A .seat,.seat-map .l47 #tdSeat2A .seat,.seat-map .l74 #tdSeat2A .seat,.seat-map .u74 #tdSeat2A .seat{top:-24px}.seat-map .b47c #tdSeat3A .seat,.seat-map .l47 #tdSeat3A .seat,.seat-map .l74 #tdSeat3A .seat,.seat-map .u74 #tdSeat3A .seat{top:-12px}.seat-map .u7a .sectionA span.aisle{height:20px}.seat-map .u7a span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b757nose.png);width:174px;height:166px}.seat-map .u7a span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-b757tail.png);width:118px;height:166px}.seat-map .l7a .sectionA span.aisle{height:20px}.seat-map .l7a span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b757nose.png);width:174px;height:166px}.seat-map .l7a span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-b757tail.png);width:118px;height:166px}.seat-map .u5s .sectionA span.aisle{height:20px}.seat-map .u5s span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b757nose.png);width:174px;height:166px}.seat-map .u5s span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-b757tail.png);width:118px;height:166px}.seat-map .b9l4 span.nose,.seat-map .b9l5 span.nose,.seat-map .x95 span.nose,.seat-map .x96 span.nose,.seat-map .xq4 span.nose{background-image:url(/resource/Sip_seat_map/newseat/X96_Q400_Nose.png);width:164px;height:134px}.seat-map .b9l4 span.tail,.seat-map .b9l5 span.tail,.seat-map .x95 span.tail,.seat-map .x96 span.tail,.seat-map .xq4 span.tail{background-image:url(/resource/Sip_seat_map/newseat/q400tail.png);width:84px;height:134px}.seat-map .x94 span.nose{background-image:url(/resource/Sip_seat_map/newseat/X94_Q400_Nose.png);width:160px;height:134px}.seat-map .x94 span.tail{background-image:url(/resource/Sip_seat_map/newseat/X94_Tail.png);width:110px;height:134px}.seat-map .xj4 .economy span.aisle{height:6px;line-height:0}.seat-map .xj4 span.nose{background-image:url(/resource/Sip_seat_map/newseat/q400nose.png);width:147px;height:134px}.seat-map .xj4 span.tail{background-image:url(/resource/Sip_seat_map/newseat/q400tail.png);width:84px;height:134px}.seat-map .b9l6 .frontCabin .upper .windowseats span.seat,.seat-map .b9l6 .frontCabin span.seat{margin-top:2px}.seat-map .b9l6 .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .b9l6 .frontCabin span.aisle{height:22px}.seat-map .b9l6 span.nose{background-image:url(/resource/Sip_seat_map/newseat/q400nose.png);width:147px;height:134px}.seat-map .b9l6 span.tail{background-image:url(/resource/Sip_seat_map/newseat/q400tail.png);width:84px;height:134px}.seat-map .x96 .frontCabin .upper .windowseats span.seat,.seat-map .x96 .frontCabin span.seat{margin-top:1px}.seat-map .x96 .frontCabin .lower .windowseats span.seat{margin-bottom:1px}.seat-map .x96 .frontCabin span.aisle{height:10px}.seat-map .u76 .frontCabin span.seat{margin:1px 0}.seat-map .u76 .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .u76 .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .u76 .frontCabin .upper .asileseats .FBF span.seat,.seat-map .ua-b763 .frontCabin .upper .asileseats .FBB span.seat{margin-bottom:12px}.seat-map .u76 .frontCabin .lower .asileseats .FBF span.seat,.seat-map .ua-b763 .frontCabin .lower .asileseats .FBB span.seat{margin-top:13px}.seat-map .u76 .sectionA .frontCabin span.aisle{height:41px}.seat-map .u76 .frontCabin span.aisle{height:8px}.seat-map .u76 .economy span.aisle{height:14px}.seat-map .u76 .lower span.closet,.seat-map .u76 .lower span.galley,.seat-map .u76 .lower span.lav,.seat-map .u76 .upper span.closet,.seat-map .u76 .upper span.galley,.seat-map .u76 .upper span.lav{height:34px}.seat-map .u76 .economy .mid span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .u76 .economy .mid .middleseats span.galley{height:32px;margin:0}.seat-map .u76 .frontCabin .mid span.closet,.seat-map .u76 .frontCabin .mid span.galley{height:34px;margin-top:0}.seat-map .u76 span.nose{background-image:url(/resource/Sip_seat_map/newseat/u6dnose.png);width:213px;height:190px}.seat-map .u76 span.tail{background-image:url(/resource/Sip_seat_map/newseat/u6dtail.png);width:119px;height:190px}.seat-map .l76 .frontCabin span.seat{margin:1px 0}.seat-map .l76 .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .l76 .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .l76 .frontCabin .upper .asileseats .FBF span.seat,.seat-map .ua-b763 .frontCabin .upper .asileseats .FBB span.seat{margin-bottom:12px}.seat-map .l76 .frontCabin .lower .asileseats .FBF span.seat,.seat-map .ua-b763 .frontCabin .lower .asileseats .FBB span.seat{margin-top:13px}.seat-map .l76 .sectionA .frontCabin span.aisle{height:41px}.seat-map .l76 .frontCabin span.aisle{height:8px}.seat-map .l76 .economy span.aisle{height:14px}.seat-map .l76 .lower span.closet,.seat-map .l76 .lower span.galley,.seat-map .l76 .lower span.lav,.seat-map .l76 .upper span.closet,.seat-map .l76 .upper span.galley,.seat-map .l76 .upper span.lav{height:34px}.seat-map .l76 .economy .mid span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .l76 .economy .mid .middleseats span.galley{height:32px;margin:0}.seat-map .l76 .frontCabin .mid span.closet,.seat-map .l76 .frontCabin .mid span.galley{height:34px;margin-top:0}.seat-map .l76 span.nose{background-image:url(/resource/Sip_seat_map/newseat/u6dnose.png);width:213px;height:190px}.seat-map .l76 span.tail{background-image:url(/resource/Sip_seat_map/newseat/u6dtail.png);width:119px;height:190px}.seat-map .l7c .frontCabin span.seat{margin:1px 0}.seat-map .l7c .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .l7c .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .l7c .frontCabin .upper .asileseats .FBB span.seat,.seat-map .l7c .frontCabin .upper .asileseats .FBF span.seat{margin-bottom:12px}.seat-map .l7c .frontCabin .lower .asileseats .FBB span.seat,.seat-map .l7c .frontCabin .lower .asileseats .FBF span.seat{margin-top:13px}.seat-map .l7c .frontCabin .upper span.aisle{height:8px}.seat-map .l7c .frontCabin span.aisle{height:9px}.seat-map .l7c .sectionA .frontCabin span.aisle{height:41px}.seat-map .l7c .economy span.aisle{height:14px}.seat-map .l7c .lower span.closet,.seat-map .l7c .lower span.galley,.seat-map .l7c .lower span.lav,.seat-map .l7c .upper span.closet,.seat-map .l7c .upper span.galley,.seat-map .l7c .upper span.lav{height:34px}.seat-map .l7c .economy .mid span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .l7c .economy .mid .middleseats span.galley{height:32px;margin:0}.seat-map .l7c .frontCabin .mid span.closet,.seat-map .l7c .frontCabin .mid span.galley{height:34px;margin-top:0}.seat-map .l7c span.nose{background-image:url(/resource/Sip_seat_map/newseat/u6dnose.png);width:213px;height:190px}.seat-map .l7c span.tail{background-image:url(/resource/Sip_seat_map/newseat/u6dtail.png);width:119px;height:190px}.seat-map .mc7 .frontCabin span.seat{margin:1px 0}.seat-map .mc7 .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .mc7 .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .mc7 .frontCabin .upper .asileseats .FBB span.seat,.seat-map .mc7 .frontCabin .upper .asileseats .FBF span.seat{margin-bottom:12px}.seat-map .mc7 .frontCabin .lower .asileseats .FBB span.seat,.seat-map .mc7 .frontCabin .lower .asileseats .FBF span.seat{margin-top:12px}.seat-map .mc7 .frontCabin .upper span.aisle{height:8px}.seat-map .mc7 .frontCabin span.aisle{height:9px}.seat-map .mc7 .sectionA .frontCabin span.aisle{height:41px}.seat-map .mc7 .economy span.aisle{height:14px}.seat-map .mc7 .lower span.closet,.seat-map .mc7 .lower span.galley,.seat-map .mc7 .lower span.lav,.seat-map .mc7 .upper span.closet,.seat-map .mc7 .upper span.galley,.seat-map .mc7 .upper span.lav{height:34px}.seat-map .mc7 .economy .mid span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .mc7 .economy .mid .middleseats span.galley{height:32px;margin:0}.seat-map .mc7 .frontCabin .mid span.closet,.seat-map .mc7 .frontCabin .mid span.galley{height:34px;margin-top:0}.seat-map .mc7 span.nose{background-image:url(/resource/Sip_seat_map/newseat/MC7_M76_Nose_8-29-14.png);width:213px;height:190px}.seat-map .mc7 span.tail{background-image:url(/resource/Sip_seat_map/newseat/MC7_M76_Tail_8-29-14.png);width:119px;height:190px}.seat-map .m76 .frontCabin span.seat{margin:1px 0}.seat-map .m76 .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .m76 .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .m76 .frontCabin .upper .asileseats .FBB span.seat,.seat-map .m76 .frontCabin .upper .asileseats .FBF span.seat{margin-bottom:12px}.seat-map .m76 .frontCabin .lower .asileseats .FBB span.seat,.seat-map .m76 .frontCabin .lower .asileseats .FBF span.seat{margin-top:13px}.seat-map .m76 .frontCabin .upper span.aisle{height:8px}.seat-map .m76 .frontCabin span.aisle{height:9px}.seat-map .m76 .sectionA .frontCabin span.aisle{height:41px}.seat-map .m76 .economy span.aisle{height:14px}.seat-map .m76 .lower span.closet,.seat-map .m76 .lower span.galley,.seat-map .m76 .lower span.lav,.seat-map .m76 .upper span.closet,.seat-map .m76 .upper span.galley,.seat-map .m76 .upper span.lav{height:34px}.seat-map .m76 .economy .mid span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .m76 .economy .mid .middleseats span.galley{height:32px;margin:0}.seat-map .m76 .frontCabin .mid span.closet,.seat-map .m76 .frontCabin .mid span.galley{height:34px;margin-top:0}.seat-map .m76 span.nose{background-image:url(/resource/Sip_seat_map/newseat/MC7_M76_Nose_8-29-14.png);width:213px;height:190px}.seat-map .m76 span.tail{background-image:url(/resource/Sip_seat_map/newseat/MC7_M76_Tail_8-29-14.png);width:119px;height:190px}.seat-map .l94 span.nose,.seat-map .p04 span.nose{background-image:url(/resource/Sip_seat_map/newseat/L94-Nose.png);width:160px;height:166px}.seat-map .l94 span.tail,.seat-map .p04 span.tail{background-image:url(/resource/Sip_seat_map/newseat/L94-Tail.png);width:113px;height:166px}.seat-map .p04 span.nose{width:168px}.seat-map .p04 span.tail{width:118px}.seat-map .u6d .frontCabin span.seat{margin:1px 0}.seat-map .u6d .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .u6d .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .u6d .frontCabin span.aisle{height:8px}.seat-map .u6d .economy span.aisle{height:14px}.seat-map .u6d .lower span.closet,.seat-map .u6d .lower span.galley,.seat-map .u6d .lower span.lav,.seat-map .u6d .upper span.closet,.seat-map .u6d .upper span.galley,.seat-map .u6d .upper span.lav{height:34px}.seat-map .u6d .frontCabin .mid .asileseats span.closet{height:40px;margin-top:1px}.seat-map .u6d .economy .mid .asileseats span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .u6d .mid .middleseats span.galley{height:32px;margin:0}.seat-map .u6d span.nose{background-image:url(/resource/Sip_seat_map/newseat/u6dnose.png);width:213px;height:190px}.seat-map .u6d span.tail{background-image:url(/resource/Sip_seat_map/newseat/u6dtail.png);width:119px;height:190px}.seat-map .u6c .frontCabin span.seat{margin:1px 0}.seat-map .u6c .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .u6c .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .u6c .frontCabin span.aisle{height:8px}.seat-map .u6c .economy span.aisle{height:14px}.seat-map .u6c .lower span.closet,.seat-map .u6c .lower span.galley,.seat-map .u6c .lower span.lav,.seat-map .u6c .upper span.closet,.seat-map .u6c .upper span.galley,.seat-map .u6c .upper span.lav{height:34px}.seat-map .u6c .frontCabin .mid .asileseats span.closet{height:40px;margin-top:1px}.seat-map .u6c .economy .mid .asileseats span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .u6c .mid .middleseats span.galley{height:32px;margin:0}.seat-map .u6c span.nose{background-image:url(/resource/Sip_seat_map/newseat/u6dnose.png);width:213px;height:190px}.seat-map .u6c span.tail{background-image:url(/resource/Sip_seat_map/newseat/u6dtail.png);width:119px;height:190px}.seat-map .m6c .frontCabin span.seat{margin:1px 0}.seat-map .m6c .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .m6c .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .m6c .frontCabin span.aisle{height:19px}.seat-map .m6c .economy span.aisle{height:14px}.seat-map .m6c .lower span.closet,.seat-map .m6c .lower span.galley,.seat-map .m6c .lower span.lav,.seat-map .m6c .upper span.closet,.seat-map .m6c .upper span.galley,.seat-map .m6c .upper span.lav{height:34px}.seat-map .m6c .frontCabin .mid .asileseats span.closet{height:40px;margin-top:1px}.seat-map .m6c .economy .mid .asileseats span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .m6c .mid .middleseats span.galley{height:32px;margin:0}.seat-map .m6c span.nose{background-image:url(/resource/Sip_seat_map/newseat/M6E_M6C_Nose.png);width:224px;height:194px}.seat-map .m6c span.tail{background-image:url(/resource/Sip_seat_map/newseat/M6E_M6C_Tail-b.png);width:131px;height:194px}.seat-map .mc6 .frontCabin span.seat{margin:1px 0}.seat-map .mc6 .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .mc6 .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .mc6 .frontCabin span.aisle{height:19px}.seat-map .mc6 .economy span.aisle{height:14px}.seat-map .mc6 .lower span.closet,.seat-map .mc6 .lower span.galley,.seat-map .mc6 .lower span.lav,.seat-map .mc6 .upper span.closet,.seat-map .mc6 .upper span.galley,.seat-map .mc6 .upper span.lav{height:34px}.seat-map .mc6 .frontCabin .mid .asileseats span.closet{height:40px;margin-top:1px}.seat-map .mc6 .economy .mid .asileseats span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .mc6 .mid .middleseats span.galley{height:32px;margin:0}.seat-map .mc6 span.nose{background-image:url(/resource/Sip_seat_map/newseat/M6E_M6C_Nose.png);width:224px;height:194px}.seat-map .mc6 span.tail{background-image:url(/resource/Sip_seat_map/newseat/M6E_M6C_Tail-b.png);width:131px;height:194px}.seat-map .m6e .frontCabin span.seat{margin:1px 0}.seat-map .m6e .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .m6e .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .m6e .frontCabin span.aisle{height:19px}.seat-map .m6e .economy span.aisle{height:14px}.seat-map .m6e .lower span.closet,.seat-map .m6e .lower span.galley,.seat-map .m6e .lower span.lav,.seat-map .m6e .upper span.closet,.seat-map .m6e .upper span.galley,.seat-map .m6e .upper span.lav{height:34px}.seat-map .m6e .frontCabin .mid .asileseats span.closet{height:40px;margin-top:1px}.seat-map .m6e .economy .mid .asileseats span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .m6e .mid .middleseats span.galley{height:32px;margin:0}.seat-map .m6e span.nose{background-image:url(/resource/Sip_seat_map/newseat/M6E_M6C_Nose.png);width:224px;height:194px}.seat-map .m6e span.tail{background-image:url(/resource/Sip_seat_map/newseat/M6E_M6C_Tail-b.png);width:131px;height:194px}.seat-map .m6f .frontCabin span.seat{margin:1px 0}.seat-map .m6f .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .m6f .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .m6f .frontCabin span.aisle{height:19px}.seat-map .m6f .economy span.aisle{height:14px}.seat-map .m6f .lower span.closet,.seat-map .m6f .lower span.galley,.seat-map .m6f .lower span.lav,.seat-map .m6f .upper span.closet,.seat-map .m6f .upper span.galley,.seat-map .m6f .upper span.lav{height:34px}.seat-map .m6f .frontCabin .mid .asileseats span.closet{height:40px;margin-top:1px}.seat-map .m6f .economy .mid .asileseats span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .m6f .mid .middleseats span.galley{height:32px;margin:0}.seat-map .m6f span.nose{background-image:url(/resource/Sip_seat_map/newseat/M6E_M6C_Nose.png);width:224px;height:194px}.seat-map .m6f span.tail{background-image:url(/resource/Sip_seat_map/newseat/M6E_M6C_Tail-b.png);width:131px;height:194px}.seat-map .u6e .frontCabin span.seat{margin:1px 0}.seat-map .u6e .frontCabin .upper .windowseats span.seat{margin-top:2px}.seat-map .u6e .frontCabin .lower .windowseats span.seat{margin-bottom:2px}.seat-map .u6e .frontCabin span.aisle{height:19px}.seat-map .u6e .frontCabin .mid span.closet{height:20px;margin-top:0}.seat-map .u6e .economy span.aisle{height:14px}.seat-map .u6e .lower span.closet,.seat-map .u6e .lower span.galley,.seat-map .u6e .lower span.lav,.seat-map .u6e .upper span.closet,.seat-map .u6e .upper span.galley,.seat-map .u6e .upper span.lav{height:34px}.seat-map .u6e .frontCabin .mid .asileseats span.closet{height:40px;margin-top:1px}.seat-map .u6e .economy .mid .asileseats span.closet{height:16px;width:28px;margin:0;border-bottom:none}.seat-map .u6e .mid .middleseats span.galley{height:32px;margin:0}.seat-map .b77w .economy .upper .windowseats span.seat,.seat-map .u7q .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .l7j .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .l7k .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .l7p .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .l7q .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .lcj .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .lck .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .lcp .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .lcq .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .u7p .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .u7q .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .u7r .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .ucq .sectionB .frontCabin .lower .windowseats span.seat,.seat-map .ucr .sectionB .frontCabin .lower .windowseats span.seat{margin-bottom:1px}.seat-map .u6e span.nose{background-image:url(/resource/Sip_seat_map/newseat/u6dnose.png);width:213px;height:190px}.seat-map .u6e span.tail{background-image:url(/resource/Sip_seat_map/newseat/u6dtail.png);width:119px;height:190px}.seat-map .u77 .frontCabin span.aisle{height:18px}.seat-map .u77 .economy span.aisle,.seat-map .u7h .economy span.aisle{height:14px}.seat-map .u77 .economy .lower .lav,.seat-map .u77 .economy .upper .lav,.seat-map .u77 .lower span.closet,.seat-map .u77 .lower span.galley,.seat-map .u77 .lower span.lav,.seat-map .u77 .upper span.closet,.seat-map .u77 .upper span.galley,.seat-map .u77 .upper span.lav,.seat-map .u7h .economy .lower .lav,.seat-map .u7h .economy .upper .lav,.seat-map .u7h .lower span.closet,.seat-map .u7h .lower span.galley,.seat-map .u7h .lower span.lav,.seat-map .u7h .upper span.closet,.seat-map .u7h .upper span.galley,.seat-map .u7h .upper span.lav{height:33px}.seat-map .u77 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-b777atail.png);width:116px;height:224px}.seat-map .u77 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777anose.png);width:211px;height:224px}.seat-map .u7h .frontCabin span.aisle{height:6px}.seat-map .b77w .frontCabin span.aisle{height:16px}.seat-map .b77w .economy span.aisle{height:10px}.seat-map .b77w span.tail{background-image:url(/resource/Sip_seat_map/newseat/b77w_tail.png);width:115px;height:234px;background-size:cover}.seat-map .b77w span.nose{background-image:url(/resource/Sip_seat_map/newseat/b77w_nose.png);width:235px;height:234px;background-size:cover}.seat-map .u7q .sectionA .frontCabin span.aisle{height:32px}.seat-map .u7q .economy span.aisle{height:14px}.seat-map .u7q .frontCabin span.aisle{height:20px}.seat-map .u7q .lower span.closet,.seat-map .u7q .lower span.galley,.seat-map .u7q .lower span.lav,.seat-map .u7q .upper span.closet,.seat-map .u7q .upper span.galley,.seat-map .u7q .upper span.lav{height:33px}.seat-map .u7q .frontCabin .mid span.galley,.seat-map .u7q .frontCabin .mid span.lav,.seat-map .u7q .mid span.closet{height:59px}.seat-map .u7q .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .u7p span.tail,.seat-map .u7q span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .u7p span.nose,.seat-map .u7q span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .u7r .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .u7r .sectionA .frontCabin span.aisle{height:32px}.seat-map .u7r .economy span.aisle{height:14px}.seat-map .u7r .frontCabin span.aisle{height:20px}.seat-map .u7r .lower span.closet,.seat-map .u7r .lower span.galley,.seat-map .u7r .lower span.lav,.seat-map .u7r .upper span.closet,.seat-map .u7r .upper span.galley,.seat-map .u7r .upper span.lav{height:33px}.seat-map .u7r .frontCabin .mid span.galley,.seat-map .u7r .frontCabin .mid span.lav,.seat-map .u7r .mid span.closet{height:59px}.seat-map .u7r .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .u7p span.tail,.seat-map .u7r span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .u7p span.nose,.seat-map .u7r span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .l7q .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .l7q .sectionA .frontCabin span.aisle{height:32px}.seat-map .l7q .economy span.aisle{height:14px}.seat-map .l7q .frontCabin span.aisle{height:20px}.seat-map .l7q .lower span.closet,.seat-map .l7q .lower span.galley,.seat-map .l7q .lower span.lav,.seat-map .l7q .upper span.closet,.seat-map .l7q .upper span.galley,.seat-map .l7q .upper span.lav{height:33px}.seat-map .l7q .frontCabin .mid span.galley,.seat-map .l7q .frontCabin .mid span.lav,.seat-map .l7q .mid span.closet{height:59px}.seat-map .l7q .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .l7q span.tail,.seat-map .u7p span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .l7q span.nose,.seat-map .u7p span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .lcq .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .lcq .sectionA .frontCabin span.aisle{height:32px}.seat-map .lcq .economy span.aisle{height:14px}.seat-map .lcq .frontCabin span.aisle{height:20px}.seat-map .lcq .lower span.closet,.seat-map .lcq .lower span.galley,.seat-map .lcq .lower span.lav,.seat-map .lcq .upper span.closet,.seat-map .lcq .upper span.galley,.seat-map .lcq .upper span.lav{height:33px}.seat-map .lcq .frontCabin .mid span.galley,.seat-map .lcq .frontCabin .mid span.lav,.seat-map .lcq .mid span.closet{height:59px}.seat-map .lcq .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .lcq span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .lcq span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .ucq .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .ucq .sectionA .frontCabin span.aisle{height:32px}.seat-map .ucq .economy span.aisle{height:14px}.seat-map .ucq .frontCabin span.aisle{height:20px}.seat-map .ucq .lower span.closet,.seat-map .ucq .lower span.galley,.seat-map .ucq .lower span.lav,.seat-map .ucq .upper span.closet,.seat-map .ucq .upper span.galley,.seat-map .ucq .upper span.lav{height:33px}.seat-map .ucq .frontCabin .mid span.galley,.seat-map .ucq .frontCabin .mid span.lav,.seat-map .ucq .mid span.closet{height:59px}.seat-map .ucq .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .ucq span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .ucq span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .p06 .economy span.aisle{height:17px}.seat-map .p06 .lower span.lav,.seat-map .p06 .upper span.lav{height:32px}.seat-map .p06 .economy .mid span.closet,.seat-map .p06 .economy .mid span.galley,.seat-map .p06 .economy .mid span.lav{height:64px}.seat-map .p06 .frontCabin .mid span.galley,.seat-map .p06 .frontcabin .mid span.closet,.seat-map .p06 .frontcabin .mid span.lav{height:75px}.seat-map .p06 .frontcabin span.closet{height:31px}.seat-map .p06 .frontCabin span.aisle{height:21px}.seat-map .p06 span.tail{background-image:url(/resource/Sip_seat_map/newseat/p06tail.png);width:111px;background-size:cover;height:255px}.seat-map .p06 span.nose{background-image:url(/resource/Sip_seat_map/newseat/p06nose.png);width:253px;background-size:cover;height:255px}.seat-map .l7l .economy span.aisle,.seat-map .u7i .economy span.aisle{height:15px}.seat-map .l7l .lower span.lav,.seat-map .l7l .upper span.lav{height:32px}.seat-map .l7l .economy .mid span.closet,.seat-map .l7l .economy .mid span.galley,.seat-map .l7l .economy .mid span.lav{height:70px}.seat-map .l7l .frontCabin .mid span.galley{height:76px}.seat-map .l7l .frontCabin span.aisle{height:21px}.seat-map .l7l span.tail{background-image:url(/resource/Sip_seat_map/newseat/U7H_UHC_Tail.png);width:117px;background-size:cover;height:256px}.seat-map .l7l span.nose{background-image:url(/resource/Sip_seat_map/newseat/L7J_Nose.png);width:234px;background-size:cover;height:254px}.seat-map .u7i .frontCabin span.aisle{height:19px}.seat-map .u7i .economy span.aisle{height:15px}.seat-map .u7i .frontCabin .mid span.galley{height:75px}.seat-map .u7i span.tail{background-image:url(/resource/Sip_seat_map/newseat/p06tail.png);width:116px;background-size:cover;height:221px}.seat-map .u7i span.nose{background-image:url(/resource/Sip_seat_map/newseat/L7J_Nose.png);width:226px;background-size:cover;height:251px}.seat-map .ucr .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .ucr .sectionA .frontCabin span.aisle{height:32px}.seat-map .ucr .economy span.aisle{height:14px}.seat-map .ucr .frontCabin span.aisle{height:20px}.seat-map .ucr .lower span.closet,.seat-map .ucr .lower span.galley,.seat-map .ucr .lower span.lav,.seat-map .ucr .upper span.closet,.seat-map .ucr .upper span.galley,.seat-map .ucr .upper span.lav{height:33px}.seat-map .ucr .frontCabin .mid span.galley,.seat-map .ucr .frontCabin .mid span.lav,.seat-map .ucr .mid span.closet{height:59px}.seat-map .ucr .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .ucr span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .ucr span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-b777qxpnose.png);width:211px;height:224px}.seat-map .u7j span.nose{background-image:url(/resource/Sip_seat_map/newseat/U7H_UHC_Nose.png);width:230px;height:202px}.seat-map .u7j .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .u7j .sectionB .frontCabin .lower .windowseats span.seat{margin-bottom:1px}.seat-map .u7j .frontCabin .mid span.galley,.seat-map .u7j .frontCabin .mid span.lav,.seat-map .u7j .mid span.closet{height:59px}.seat-map .u7j .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .u7j .frontCabin span.aisle{height:15px}.seat-map .u7j .lower span.closet,.seat-map .u7j .lower span.galley,.seat-map .u7j .lower span.lav,.seat-map .u7j .upper span.closet,.seat-map .u7j .upper span.galley,.seat-map .u7j .upper span.lav{height:33px}.seat-map .u7j .economy span.aisle{height:14px}.seat-map .u7j span.tail{background-image:url(/resource/Sip_seat_map/newseat/U7H_UHC_Tail.png);width:104px;height:202px}.seat-map .l7j .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .l7j .sectionA .frontCabin span.aisle{height:32px}.seat-map .l7j .economy span.aisle{height:14px}.seat-map .l7j .frontCabin span.aisle{height:20px}.seat-map .l7j .lower span.closet,.seat-map .l7j .lower span.galley,.seat-map .l7j .lower span.lav,.seat-map .l7j .upper span.closet,.seat-map .l7j .upper span.galley,.seat-map .l7j .upper span.lav{height:33px}.seat-map .l7j .frontCabin .mid span.galley,.seat-map .l7j .frontCabin .mid span.lav,.seat-map .l7j .mid span.closet{height:59px}.seat-map .l7j .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .l7j span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .l7j span.nose{background-image:url(/resource/Sip_seat_map/newseat/L7J_Nose.png);width:208px;height:228px}.seat-map .l7k .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .l7k .sectionA .frontCabin span.aisle{height:32px}.seat-map .l7k .economy span.aisle{height:14px}.seat-map .l7k .frontCabin span.aisle{height:20px}.seat-map .l7k .lower span.closet,.seat-map .l7k .lower span.galley,.seat-map .l7k .lower span.lav,.seat-map .l7k .upper span.closet,.seat-map .l7k .upper span.galley,.seat-map .l7k .upper span.lav{height:33px}.seat-map .l7k .frontCabin .mid span.galley,.seat-map .l7k .frontCabin .mid span.lav,.seat-map .l7k .mid span.closet{height:59px}.seat-map .l7k .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .l7k span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .l7k span.nose{background-image:url(/resource/Sip_seat_map/newseat/L7J_Nose.png);width:208px;height:228px}.seat-map .lcj .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .lcj .sectionA .frontCabin span.aisle{height:32px}.seat-map .lcj .economy span.aisle{height:14px}.seat-map .lcj .frontCabin span.aisle{height:20px}.seat-map .lcj .lower span.closet,.seat-map .lcj .lower span.galley,.seat-map .lcj .lower span.lav,.seat-map .lcj .upper span.closet,.seat-map .lcj .upper span.galley,.seat-map .lcj .upper span.lav{height:33px}.seat-map .lcj .frontCabin .mid span.galley,.seat-map .lcj .frontCabin .mid span.lav,.seat-map .lcj .mid span.closet{height:59px}.seat-map .lcj .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .lcj span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .lcj span.nose{background-image:url(/resource/Sip_seat_map/newseat/L7J_Nose.png);width:208px;height:228px}.seat-map .lck .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .lck .sectionA .frontCabin span.aisle{height:32px}.seat-map .lck .economy span.aisle{height:14px}.seat-map .lck .frontCabin span.aisle{height:20px}.seat-map .lck .lower span.closet,.seat-map .lck .lower span.galley,.seat-map .lck .lower span.lav,.seat-map .lck .upper span.closet,.seat-map .lck .upper span.galley,.seat-map .lck .upper span.lav{height:33px}.seat-map .lck .frontCabin .mid span.galley,.seat-map .lck .frontCabin .mid span.lav,.seat-map .lck .mid span.closet{height:59px}.seat-map .lck .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .lck span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .lck span.nose{background-image:url(/resource/Sip_seat_map/newseat/L7J_Nose.png);width:208px;height:228px}.seat-map .u7p .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .u7p .sectionA .frontCabin span.aisle{height:32px}.seat-map .u7p .economy span.aisle{height:14px}.seat-map .u7p .frontCabin span.aisle{height:15px}.seat-map .u7p .lower span.closet,.seat-map .u7p .lower span.galley,.seat-map .u7p .lower span.lav,.seat-map .u7p .upper span.closet,.seat-map .u7p .upper span.galley,.seat-map .u7p .upper span.lav{height:33px}.seat-map .u7p .frontCabin .mid span.galley,.seat-map .u7p .frontCabin .mid span.lav,.seat-map .u7p .mid span.closet{height:59px}.seat-map .u7p .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .l7p .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .l7p .sectionA .frontCabin span.aisle{height:32px}.seat-map .l7p .economy span.aisle{height:14px}.seat-map .l7p .frontCabin span.aisle{height:15px}.seat-map .l7p .lower span.closet,.seat-map .l7p .lower span.galley,.seat-map .l7p .lower span.lav,.seat-map .l7p .upper span.closet,.seat-map .l7p .upper span.galley,.seat-map .l7p .upper span.lav{height:33px}.seat-map .l7p .frontCabin .mid span.galley,.seat-map .l7p .frontCabin .mid span.lav,.seat-map .l7p .mid span.closet{height:59px}.seat-map .l7p .sectionA .mid span.closet,.seat-map .l7p .sectionA .mid span.galley,.seat-map .l7p .sectionA .mid span.lav{height:42px}.seat-map .l7p .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .lcp .sectionB .frontCabin .upper .windowseats span.seat{margin-top:1px}.seat-map .b787 .sectionB .frontCabin span.seat,.seat-map .b789 .sectionB .frontCabin span.seat,.seat-map .lcp .sectionB .frontCabin span.seat{margin-top:2px}.seat-map .lcp .sectionA .frontCabin span.aisle{height:32px}.seat-map .lcp .economy span.aisle{height:14px}.seat-map .lcp .frontCabin span.aisle{height:15px}.seat-map .lcp .lower span.closet,.seat-map .lcp .lower span.galley,.seat-map .lcp .lower span.lav,.seat-map .lcp .upper span.closet,.seat-map .lcp .upper span.galley,.seat-map .lcp .upper span.lav{height:33px}.seat-map .lcp .frontCabin .mid span.galley,.seat-map .lcp .frontCabin .mid span.lav,.seat-map .lcp .mid span.closet{height:59px}.seat-map .lcp .sectionA .mid span.closet,.seat-map .lcp .sectionA .mid span.galley,.seat-map .lcp .sectionA .mid span.lav{height:42px}.seat-map .b787 .economy span.aisle{height:14px}.seat-map .b787 .frontCabin span.aisle{height:20px}.seat-map .b787 .frontCabin .upper span.aisle{height:21px}.seat-map .b787 .lower span.closet,.seat-map .b787 .lower span.galley,.seat-map .b787 .lower span.lav,.seat-map .b787 .upper span.closet,.seat-map .b787 .upper span.galley,.seat-map .b787 .upper span.lav{height:49px}.seat-map .b787 .frontCabin .mid span.galley,.seat-map .b787 .frontCabin .mid span.lav,.seat-map .b787 .mid span.closet{height:42px}.seat-map .b787 span.tail{background-image:url(/resource/Sip_seat_map/newseat/b787tail.png);width:127px;height:224px}.seat-map .b787 span.nose{background-image:url(/resource/Sip_seat_map/newseat/b787nose.png);width:211px;height:224px}.seat-map .b789 .economy span.aisle{height:14px}.seat-map .b789 .frontCabin span.aisle{height:20px}.seat-map .b789 .frontCabin .upper span.aisle{height:21px}.seat-map .b789 .lower span.closet,.seat-map .b789 .lower span.galley,.seat-map .b789 .lower span.lav,.seat-map .b789 .upper span.closet,.seat-map .b789 .upper span.galley,.seat-map .b789 .upper span.lav{height:46px}.seat-map .b789 .frontCabin .mid span.galley,.seat-map .b789 .frontCabin .mid span.lav,.seat-map .b789 .mid span.closet{height:42px}.seat-map .b789 span.tail{background-image:url(/resource/Sip_seat_map/newseat/b787tail.png);width:127px;height:224px}.seat-map .b789 span.nose{background-image:url(/resource/Sip_seat_map/newseat/b787nose.png);width:211px;height:224px}.seat-map .u70 .frontCabin span.seat,.seat-map .ue7 .frontCabin span.seat{margin:1px 0}.seat-map .u70 .frontCabin span.aisle,.seat-map .ue7 .frontCabin span.aisle{height:18px}.seat-map .u70 span.nose,.seat-map .ue7 span.nose{background-image:url(/resource/Sip_seat_map/newseat/u70nose.png);width:187px;height:130px}.seat-map .u70 span.tail,.seat-map .ue7 span.tail{background-image:url(/resource/Sip_seat_map/newseat/u70tail.png);width:72px;height:130px}.seat-map .xm7 .frontCabin span.aisle,.seat-map .xm8 .frontCabin span.aisle{height:18px}.seat-map .xm7 .frontCabin span.seat,.seat-map .xm8 .frontCabin span.seat{margin:2px 0 0}.seat-map .p05 .economy span.seat,.seat-map .xm8 .economy span.seat{margin-bottom:1px;margin-top:1px;width:23px}.seat-map .p05 .economy span.aisle,.seat-map .xm8 .economy span.aisle{height:16px}.seat-map .m8a span.tail{background-image:url(/resource/Sip_seat_map/newseat/M8A_Tail.png);width:130px;height:166px}.seat-map .m8a span.nose{background-image:url(/resource/Sip_seat_map/newseat/737-900_M8E_Nose.gif);width:179px;height:166px}.seat-map .m8b span.tail{background-image:url(/resource/Sip_seat_map/newseat/M8B_TAIL.png);width:126px;height:166px}.seat-map .m8b span.nose{background-image:url(/resource/Sip_seat_map/newseat/M8B_NOSE.png);width:179px;height:166px}.seat-map .cq7 span.tail{background-image:url(/resource/Sip_seat_map/newseat/CQ7_TAIL.png);width:126px;height:166px}.seat-map .cq7 span.nose{background-image:url(/resource/Sip_seat_map/newseat/CQ7_NOSE.png);width:179px;height:166px}.seat-map .x75 .frontCabin span.aisle{height:18px}.seat-map .x75 .frontCabin span.seat{margin:2px 0 0}.seat-map .l21 .economy .mid span.seat,.seat-map .l21 .economy .mid span.seatLetter,.seat-map .u21 .economy .mid span.seat,.seat-map .u21 .economy .mid span.seatLetter,.seat-map .zke .economy .mid span.seat,.seat-map .zke .economy .mid span.seatLetter{margin-top:2px;margin-bottom:1px}.seat-map .p05 span.nose,.seat-map .x75 span.nose,.seat-map .xm7 span.nose,.seat-map .xm8 span.nose{background-image:url(/resource/Sip_seat_map/newseat/EMB170_Nose.gif);width:168px;height:134px}.seat-map .p05 span.nose,.seat-map .xm8 span.nose{width:167px}.seat-map .p05 span.tail,.seat-map .x75 span.tail,.seat-map .xm7 span.tail,.seat-map .xm8 span.tail{background-image:url(/resource/Sip_seat_map/newseat/EMB170_Tail.gif);width:78px;height:134px}.seat-map .u12 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-em2anose.png);width:144px;height:115px}.seat-map .u12 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-em2atail.png);width:68px;height:115px}.seat-map .u21 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-em2anose.png);width:144px;height:115px}.seat-map .u21 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-em2dtail.png);width:68px;height:115px}.seat-map .em6 .economy span.aisle{height:2px;line-height:0}.seat-map .em6 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-em2cnose.png);width:150px;height:115px}.seat-map .em6 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-em2ctail.png);width:59px;height:115px}.seat-map .l21 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-em2cnose.png);width:150px;height:115px}.seat-map .l21 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-em2ctail.png);width:59px;height:115px}.seat-map .l2c .economy span.aisle{height:6px;line-height:0}.seat-map .l2c span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-em2cnose.png);width:150px;height:115px}.seat-map .l2c span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-em2ctail.png);width:59px;height:115px}.seat-map .c7c .frontCabin span.seat,.seat-map .c7r .frontCabin span.seat,.seat-map .cx7 .frontCabin span.seat,.seat-map .u7c .frontCabin span.seat,.seat-map .uc7 .frontCabin span.seat,.seat-map .ucj .frontCabin span.seat,.seat-map .x7c .frontCabin span.seat,.seat-map .x7d .frontCabin span.seat,.seat-map .xc7 .frontCabin span.seat{margin:1px 0}.seat-map .zke span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-em2cnose.png);width:150px;height:115px}.seat-map .zke span.tail{background-image:url(/resource/Sip_seat_map/newseat/ua-em2ctail.png);width:59px;height:115px}.seat-map .emd .upper span.galley,.seat-map .erj .upper span.galley,.seat-map .u45 .upper span.galley{height:34px}.seat-map .u45 span.tail{background-image:url(/resource/Sip_seat_map/newseat/erjtail.png);width:68px;height:115px}.seat-map .u45 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ua-er4nose.png);width:128px;height:115px}.seat-map .u7c .frontCabin span.aisle,.seat-map .uc7 .frontCabin span.aisle{height:18px}.seat-map .c7r span.nose,.seat-map .u7c span.nose,.seat-map .uc7 span.nose,.seat-map .xc7 span.nose{background-image:url(/resource/Sip_seat_map/newseat/uc7nose.png);width:151px;height:128px}.seat-map .c7r span.tail,.seat-map .u7c span.tail,.seat-map .uc7 span.tail,.seat-map .xc7 span.tail{background-image:url(/resource/Sip_seat_map/newseat/uc7tail.png);width:61px;height:128px}.seat-map .x7c .frontCabin span.aisle,.seat-map .x7d .frontCabin span.aisle,.seat-map .xc7 .frontCabin span.aisle{height:18px}.seat-map .p08 span.nose,.seat-map .x7c span.nose,.seat-map .x7d span.nose,.seat-map .xc7 span.nose{background-image:url(/resource/Sip_seat_map/newseat/uc7nose.png);width:151px;height:128px}.seat-map .p08 span.tail,.seat-map .x7c span.tail,.seat-map .x7d span.tail,.seat-map .xc7 span.tail{background-image:url(/resource/Sip_seat_map/newseat/uc7tail.png);width:61px;height:128px}.seat-map .c7r .frontCabin span.aisle{height:18px}.seat-map .c7r span.nose{background-image:url(/resource/Sip_seat_map/newseat/uc7nose.png);width:151px;height:128px}.seat-map .c7r span.tail{background-image:url(/resource/Sip_seat_map/newseat/uc7tail.png);width:61px;height:128px}.seat-map .cx7 .frontCabin span.aisle{height:18px}.seat-map .cx7 span.nose{background-image:url(/resource/Sip_seat_map/newseat/uc7nose.png);width:151px;height:128px}.seat-map .cx7 span.tail{background-image:url(/resource/Sip_seat_map/newseat/uc7tail.png);width:61px;height:128px}.seat-map .c7c .frontCabin span.aisle{height:18px}.seat-map .c7c span.nose{background-image:url(/resource/Sip_seat_map/newseat/uc7nose.png);width:151px;height:128px}.seat-map .c7c span.tail{background-image:url(/resource/Sip_seat_map/newseat/uc7tail.png);width:61px;height:128px}.seat-map .ucj .frontCabin span.aisle{height:18px}.seat-map .ucj .upper span.lav{height:34px}.seat-map .ucj span.aisle,.seat-map .ucj span.gap{width:10px}.seat-map .ucj span.tail{background-image:url(/resource/Sip_seat_map/newseat/crjtail.png);width:60px;height:132px}.seat-map .ucj span.nose{background-image:url(/resource/Sip_seat_map/newseat/UCJ_Nose_3-24-15.png);width:164px;height:128px}.seat-map .er3 span.nose,.seat-map .lr3 span.nose,.seat-map .x35 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ER3_X35_Nose.png);width:177px;height:117px}.seat-map .er3 span.tail,.seat-map .lr3 span.tail,.seat-map .x35 span.tail{background-image:url(/resource/Sip_seat_map/newseat/erjtail.png);width:68px;height:115px}.seat-map .emd .economy span.aisle,.seat-map .er0 .economy span.aisle,.seat-map .er2 .economy span.aisle,.seat-map .erj .economy span.aisle,.seat-map .xrj .economy span.aisle{height:15px;line-height:0}.seat-map .emd span.galley,.seat-map .er0 span.galley,.seat-map .er2 span.galley,.seat-map .erj span.galley,.seat-map .xrj span.galley{height:38px}.seat-map .emd span.nose,.seat-map .er0 span.nose,.seat-map .er2 span.nose,.seat-map .erj span.nose,.seat-map .xrj span.nose{background-image:url(/resource/Sip_seat_map/newseat/XRJ_Nose.png);width:156px;height:117px}.seat-map .emd span.tail,.seat-map .er0 span.tail,.seat-map .er2 span.tail,.seat-map .erj span.tail,.seat-map .xrj span.tail{background-image:url(/resource/Sip_seat_map/newseat/erjtail.png);width:68px;height:117px}.seat-map .be2 .economy span.aisle,.seat-map .be6 .economy span.aisle,.seat-map .xbe .economy span.aisle,.seat-map .xbs .economy span.aisle,.seat-map .zkb .economy span.aisle{height:1px;line-height:0}.seat-map .be2 .economy .lower span.seat,.seat-map .be2 .economy .mid span.seat,.seat-map .be6 .economy .lower span.seat,.seat-map .be6 .economy .mid span.seat,.seat-map .xbe .economy .lower span.seat,.seat-map .xbe .economy .mid span.seat,.seat-map .xbs .economy .lower span.seat,.seat-map .xbs .economy .mid span.seat,.seat-map .zkb .economy .lower span.seat,.seat-map .zkb .economy .mid span.seat{margin-top:0}.seat-map .be2 span.nose,.seat-map .be6 span.nose,.seat-map .xbe span.nose,.seat-map .xbs span.nose,.seat-map .zkb span.nose{background-image:url(/resource/Sip_seat_map/newseat/b1900nose.png);width:116px;height:96px}.seat-map .be2 span.tail,.seat-map .be6 span.tail,.seat-map .xbe span.tail,.seat-map .xbs span.tail,.seat-map .zkb span.tail{background-image:url(/resource/Sip_seat_map/newseat/b1900tail.png);width:40px;height:96px}.seat-map .a3a span.nose,.seat-map .a3b span.nose,.seat-map .a3c span.nose,.seat-map .am7 span.nose,.seat-map .ap7 span.nose,.seat-map .cp7 span.nose,.seat-map .cs1 span.nose,.seat-map .csg span.nose,.seat-map .csh span.nose,.seat-map .m7b span.nose{background-image:url(/resource/Sip_seat_map/newseat/b73nose.png);width:175px;height:166px}.seat-map .a32 span.tail,.seat-map .a3b span.tail,.seat-map .a3c span.tail,.seat-map .am7 span.tail,.seat-map .ap7 span.tail,.seat-map .cp7 span.tail,.seat-map .cs1 span.tail,.seat-map .csg span.tail,.seat-map .csh span.tail,.seat-map .m7b span.tail{background-image:url(/resource/Sip_seat_map/newseat/b739tail.png);width:126px;height:166px}.seat-map .i2c .frontCabin span.aisle,.seat-map .j2a .frontCabin span.aisle,.seat-map .j2b .frontCabin span.aisle,.seat-map .j2c .frontCabin span.aisle,.seat-map .j2d .frontCabin span.aisle,.seat-map .k2a .frontCabin span.aisle,.seat-map .k2b .frontCabin span.aisle,.seat-map .k2c .frontCabin span.aisle,.seat-map .k2d .frontCabin span.aisle{height:18px}.seat-map .i2c .economy span.aisle,.seat-map .j2a .economy span.aisle,.seat-map .j2b .economy span.aisle,.seat-map .j2c .economy span.aisle,.seat-map .j2d .economy span.aisle,.seat-map .k2a .economy span.aisle,.seat-map .k2b .economy span.aisle,.seat-map .k2c .economy span.aisle,.seat-map .k2d .economy span.aisle{height:14px}.seat-map .i2c span.nose,.seat-map .j2a span.nose,.seat-map .j2b span.nose,.seat-map .j2c span.nose,.seat-map .j2d span.nose,.seat-map .k2a span.nose,.seat-map .k2b span.nose,.seat-map .k2c span.nose,.seat-map .k2d span.nose,.seat-map .l7p span.nose{background-image:url(/resource/Sip_seat_map/newseat/b777nose.png);width:211px;height:224px}.seat-map .i2c span.tail,.seat-map .j2a span.tail,.seat-map .j2b span.tail,.seat-map .j2c span.tail,.seat-map .j2d span.tail,.seat-map .k2a span.tail,.seat-map .k2b span.tail,.seat-map .k2c span.tail,.seat-map .k2d span.tail,.seat-map .l7p span.tail{background-image:url(/resource/Sip_seat_map/newseat/b777tail.png);width:117px;height:224px}.seat-map .c52 .economy span.aisle{height:1px;line-height:0}.seat-map .c52 span.nose{background-image:url(/resource/Sip_seat_map/newseat/q200nose.png);width:169px;height:132px}.seat-map .c52 span.tail{background-image:url(/resource/Sip_seat_map/newseat/q200tail.png);width:60px;height:132px}.seat-map .xq2 .economy span.aisle{height:0;line-height:0}.seat-map .xq2 span.nose{background-image:url(/resource/Sip_seat_map/newseat/0291-ENS-01-01.png);width:180px;height:132px}.seat-map .xq2 span.tail{background-image:url(/resource/Sip_seat_map/newseat/q200tail.png);width:60px;height:132px}.seat-map .crj .upper span.closet,.seat-map .crj .upper span.lav,.seat-map .xcj .upper span.closet,.seat-map .xcj .upper span.lav{height:34px}.seat-map .crj span.lav,.seat-map .xcj span.lav{width:24px}.seat-map .crj td.lav,.seat-map .xcj td.lav{width:30px}.seat-map .crj span.aisle,.seat-map .crj span.gap,.seat-map .xcj span.aisle,.seat-map .xcj span.gap{width:10px}.seat-map .crj span.nose,.seat-map .xcj span.nose{background-image:url(/resource/Sip_seat_map/newseat/crjnose.png);width:141px;height:132px}.seat-map .crj span.tail,.seat-map .xcj span.tail{background-image:url(/resource/Sip_seat_map/newseat/crjtail.png);width:60px;height:132px}.seat-map .ei1 .frontCabin span.aisle{height:18px}.seat-map .ei1 .economy span.aisle{height:22px}.seat-map .ei1 .economy .upper span.aisle{height:23px}.seat-map .ei1 span.nose{background-image:url(/resource/Sip_seat_map/newseat/ei1nose.png);width:211px;height:224px}.seat-map .ei1 span.tail{background-image:url(/resource/Sip_seat_map/newseat/ei1tail.png);width:117px;height:224px}.seat-map .a3a span.nose{background-image:url(/resource/Sip_seat_map/newseat/0038-NNS-01-02-nose.png);width:180px;height:166px}.seat-map .a3a span.tail{background-image:url(/resource/Sip_seat_map/newseat/0032-NTS-02-01-tail.png);width:118px;height:166px}.segment-list{position:relative}.segment-list .table-header>div.col-sm-2.arrival,.segment-list .table-header>div.col-sm-2.departure{width:22%}.segment-list .table-header>div:last-child{width:13%}.segment-list .segment-body .row.segment-info .flight-number .disclaimer-msg{position:relative;display:inline-block}.segment-list .segment-body .row.segment-info .flight-number .disclaimer-msg .disclaimer-tooltips{width:200px;bottom:30px;left:-90px}.segment-list .segment-body .row.segment-info .flight-number .disclaimer-msg img{width:16px;margin-top:-3px}.segment-list .segment-body .row.segment-info .airport{font-weight:700}@media (min-width:768px){.segment-list .segment-body .row.segment-info.table-row>div.col-sm-2.arrival,.segment-list .segment-body .row.segment-info.table-row>div.col-sm-2.departure{width:22%}.segment-list .segment-body .row.segment-info.table-row>div:last-child{width:13%}}#sn #apply-status-nom{margin-top:10px}#sn #apply-status-nom .headcount-icon{color:#62a9e3;margin-right:10px}#sn #apply-status-nom .status-nom-option .row{margin:0 -5px}#sn #apply-status-nom .status-nom-option .row .col-md-3,#sn #apply-status-nom .status-nom-option .row .col-sm-6{padding:5px}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option{border:1px solid #e6e6e6;padding:10px}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option>div,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option>div{position:relative;height:100px}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option>div h3,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option>div h3{position:absolute;top:0;left:0}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option>div img,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option>div img{position:absolute;top:0;right:0;width:50px}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option>div .cost,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option>div .cost{width:100%;position:absolute;height:50px;bottom:0}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option>div .cost>div,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option>div .cost>div{width:50%}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option>div .cost>div span,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option>div .cost>div span{display:block;font-weight:700}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option>div .check-indicator,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option>div .check-indicator{position:absolute;bottom:0;right:0;height:30px;width:30px;background:#eee;border-radius:15px;padding:5px}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option>div .c-badge,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option>div .c-badge{position:absolute;bottom:0;right:0;width:120px;height:30px;background-color:#7ac24b;color:#fff;font-weight:700;text-transform:uppercase;font-size:12px;text-align:center;line-height:30px;border-radius:15px}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option.selected,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option.selected{border:1px solid #2172BA}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option.selected>div .check-indicator,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option.selected>div .check-indicator{background:#62a9e3}#sn #apply-status-nom .status-nom-option .row .col-md-3 .option.excluded,#sn #apply-status-nom .status-nom-option .row .col-sm-6 .option.excluded{background:#f2f2f2}#sn #confirm-status-nom{margin-top:10px}#sn #confirm-status-nom .button-group .col-sm-3:first-child{padding-right:0}#sn #confirm-status-nom .button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#sn #status-nom-confirm-modal .highlight{color:#f16321}#sn #status-nom-confirm-modal .row.button .col-xs-6:first-child{padding-right:10px}#sn #status-nom-confirm-modal .row.button .col-xs-6:last-child{padding-left:10px}@media (min-width:768px){#sn{padding:0 10px}#sn #confirm-status-nom .button-group .col-sm-3:first-child{padding-right:10px}#sn #confirm-status-nom .button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}}.tl svg.toggle-btn{transition:all .3s ease-in-out}.tl svg.toggle-btn.open{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg)}.tl .top-section{display:block;padding:30px 0 20px}.tl .top-section .title-acc h3.title{display:block;margin-right:20px}.tl .top-section .title-acc .acc{position:relative;z-index:2;margin-top:15px;display:block}.tl .top-section .title-acc .acc h3.txn-acc{color:#2172BA;display:inline-block}.tl .top-section .title-acc .acc .current{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.tl .top-section .title-acc .acc .current .account-symbol{text-align:center;width:40px;height:50px;line-height:50px;border:1px solid #ccc;border-right:none}.tl .top-section .title-acc .acc .current .account-symbol.corporate span{background:#441E4C}.tl .top-section .title-acc .acc .current .account-symbol.dis span{background:#f16321}.tl .top-section .title-acc .acc .current .account-symbol.reserved span{background:#cd202c}.tl .top-section .title-acc .acc .current .account-symbol.agency span{background:#10807E}.tl .top-section .title-acc .acc .current .account-symbol span{display:inline-block;height:24px;width:24px;border-radius:12px;line-height:24px;font-weight:700;color:#fff}.tl .top-section .title-acc .acc .current h3{border:1px solid #ccc;border-right:0;border-left:none;padding:10px}.tl .top-section .title-acc .acc .current .toggle-icon{border:1px solid #ccc;border-left:0;padding-right:10px}.tl .top-section .title-acc .acc .current .toggle-icon path,.tl .top-section .title-acc .acc .current .toggle-icon svg{margin-left:5px;height:42px}.tl .top-section .title-acc .acc .popup{position:absolute;top:0;width:calc(100% + 19px);padding:10px;margin:-10px;background-color:#fff;border:1px solid #ccc}.tl .top-section .title-acc .acc .popup .top{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.tl .top-section .title-acc .acc .popup .top path,.tl .top-section .title-acc .acc .popup .top svg{margin-left:auto}.tl .top-section .title-acc .acc .popup .top h3{padding:10px}.tl .top-section .title-acc .acc .popup .line{border-bottom:1px solid #2172BA}.tl .top-section .title-acc .acc .popup .txn-acc-list{max-height:200px;margin:10px 0}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;font-size:12px;line-height:20px;padding:10px 5px}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.all{color:#2172BA}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item:hover{background:#f2f2f2}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item .name{display:inline-block;max-width:calc(100% - 70px)}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item .ext-id{display:inline-block;margin-left:auto;font-weight:700}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item span.symbol{display:inline-block;width:20px;height:20px;text-align:center;border-radius:10px;margin-right:5px;background:#10807E;color:#fff;font-weight:700;vertical-align:top}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.corporate span.symbol{background:#441E4C;color:#fff;font-weight:700}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.corporate .ext-id{color:#441E4C}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.dis span.symbol{background:#f16321;color:#fff;font-weight:700}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.dis .ext-id{color:transparent}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.reserved span.symbol{background:#cd202c;color:#fff;font-weight:700}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.reserved .ext-id{color:#cd202c}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.agency .ext-id{color:#10807E}.tl .top-section .title-acc .acc .popup .txn-acc-list .list-item.agency span.symbol{background:#10807E;color:#fff;font-weight:700}.tl .top-section .action-group{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.tl .top-section .action-group .action-item.export{margin-left:auto;margin-right:20px}.tl .top-section .txn-ref-no{margin-top:20px}.tl .top-section .txn-ref-no .input-group.custom{float:left;width:100%}.tl .top-section .txn-ref-no .input-group.custom.short{width:calc(100% - 120px)}.tl .top-section .txn-ref-no .input-group.custom .form-control{z-index:1}.tl .top-section .txn-ref-no input[type=button]{margin-left:20px;display:inline-block;width:100px}.tl .filter-section>div,.tl .tl-header .flex-center h1{display:block}.tl .filter-section{position:relative;padding:20px;background-color:#fff;border:3px solid #2172BA}.tl .filter-section>div span.filter-label{margin:0 10px}.tl .filter-section>div .filter-button{margin-top:10px}.tl .summary-section>div{padding:10px 20px 20px;text-align:center;background-color:#fff;border:1px solid #ccc;border-bottom:0}.tl .summary-section>div:last-child{border-bottom:1px solid #ccc}.tl .tl-header{position:relative;padding:20px 0;height:130px;background-color:#edb72b}.tl .tl-header .tl-option{position:absolute;bottom:0;z-index:1;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.tl .tl-header .tl-option>a{text-align:center;color:#002F57;padding:10px;text-transform:uppercase;font-weight:700;border-bottom:4px solid transparent}.tl .tl-header .tl-option>a.selected{border-bottom:4px solid #fff}.tl .tl-header:before{content:'';display:block;position:absolute;width:999999px;height:130px;left:-999px;top:0;background:#edb72b;z-index:0}.tl #tl-detail-info .detail-content,.tl .tl-debits .debit-table,.tl .tl-summary .summary-table{background-color:#fff;border:1px solid #ccc}.tl .tl-summary .summary-table .accordian-header{height:80px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.tl .tl-summary .summary-table .accordian-header>div{padding-left:20px}.tl .tl-summary .summary-table .accordian-header .total{text-align:right}.tl .tl-summary .summary-table .accordian-body{padding:0 20px}.tl .tl-debits .debit-table{padding:20px;position:relative}.tl .tl-debits .debit-table .table-footer>div .pagination{margin:0;color:#ccc;text-align:center}.tl .tl-debits .debit-table .table-footer>div .pagination a{color:#2172BA;display:inline-block;font-weight:700;padding:0 5px;vertical-align:middle}.tl .tl-debits .debit-table .table-footer>div .pagination span.current{display:inline-block;padding:0 5px;color:#333;vertical-align:middle;font-weight:700}.tl .tl-debits .debit-table .table-footer>div .pagination span.disabled{display:inline-block;padding:0 5px;color:#ccc;vertical-align:middle}.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.field-block{margin:0}.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.field-block .col-sm-12,.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.field-block .col-sm-6{padding:0}.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.field-block span.filter-label{margin:0 10px}.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.button-row{margin:0 -10px}.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.button-row .col-xs-6{padding:0 10px}.tl #tl-export-modal .flatpickr{width:calc(50% - 9px)}.tl #tl-detail-info .detail-title{padding:20px 10px 20px 0}.tl #tl-detail-info .detail-title a{margin-left:30px}.tl #tl-detail-info .detail-title .flex-center{margin-top:10px}.tl #tl-detail-info .detail-title .flex-center :first-child{width:25px;margin-right:5px}.tl #tl-detail-info .detail-title .flex-center :last-child{margin-left:auto}.tl #tl-detail-info .detail-title .slds-button__icon{color:#2172BA}.tl #tl-detail-info .detail-content{padding:20px}.tl #tl-detail-info .detail-content .label-text{color:#999}.tl #tl-detail-info .detail-content .email-section{margin:20px 0 10px;background-color:#f2f2f2;padding:20px;display:block}.tl #tl-detail-info .detail-content .email-section .resend-email .action-item,.tl #tl-detail-info .detail-content .email-section .send-other .action-item{margin-left:auto!important}.tl #tl-detail-info .detail-content .email-section .send-other,.tl #tl-detail-info .detail-content .email-section .send-other .label1{margin-top:10px}.tl #tl-detail-info .detail-content .email-section .resend-email{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.tl #tl-detail-info .detail-content .email-section .send-other .row{width:100%}.tl #tl-detail-info .detail-content .email-section .send-other .send-btn{width:230px}.tl #tl-detail-info .detail-content .email-section .send-other .send-btn2{max-width:230px}.tl #tl-detail-info .detail-content .email-section .send-other .fl-left{float:right}@media (min-width:544px){.tl .top-section .title-acc .acc .current .toggle-icon path,.tl .top-section .title-acc .acc .current .toggle-icon svg{height:48px}}@media (min-width:768px){.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.field-block .col-sm-12,.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.field-block .col-sm-6,.tl .filter-section>div [class*=col-]{padding:0 10px}.tl .top-section .title-acc{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.tl .top-section .title-acc h3.title{white-space:nowrap}.tl .top-section .title-acc .acc{margin-top:0}.tl .top-section .title-acc .acc .popup{width:400px}.tl .top-section .txn-ref-no{margin-top:-50px;float:left}.tl .top-section .txn-ref-no .input-group.custom{width:250px;float:left}.tl .top-section .txn-ref-no .input-group.custom.short{width:250px}.tl .filter-section>div{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin:0 -10px}.tl .filter-section>div .filter-button{margin-top:0}.tl .summary-section>div{border:1px solid #ccc;border-right:0}.tl .summary-section>div:last-child{border-right:1px solid #ccc}.tl .tl-summary .top-section .title-acc .acc{width:calc(100% - 130px)}.tl .tl-debits .top-section .title-acc .acc{width:calc(100% - 230px)}.tl .tl-debits .debit-table{background-color:#fff;border:1px solid #ccc}.tl .tl-debits .debit-table .table-header>div{width:11.5%}.tl .tl-debits .debit-table .table-header>div:last-child{width:8%}.tl .tl-debits .debit-table .table-header .slds-button__icon{transition:all .3s ease-in-out}.tl .tl-debits .debit-table .table-header .slds-button__icon.asc{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg)}.tl .tl-debits .debit-table .table-header .slds-button__icon.desc{transform:rotate(0);-webkit-transform:rotate(0);-ms-transform:rotate(0)}.tl .tl-debits .debit-table .table-header.static{position:fixed;top:0;background-color:#fff;z-index:1;border-bottom:1px solid #e6e6e6}.tl .tl-debits .debit-table .table-row>div{width:11.5%}.tl .tl-debits .debit-table .table-row>div:last-child{width:8%}.tl .tl-debits .debit-table .table-footer>div{text-align:right}.tl #tl-export-modal>.modal-container>.modal-dialog>.modal-content>.modal-body .row.field-block{margin:0 -10px}.tl #tl-detail-info .detail-content .email-section{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.tl #tl-detail-info .detail-content .email-section .resend-email .action-item{margin-right:20px!important}.tl #tl-detail-info .detail-content .email-section .send-other{margin-top:0}.tl #tl-detail-info .detail-content .email-section .send-other .fl-left{float:left}.tl #tl-detail-info .detail-content .email-section .send-other .action-item{margin-left:initial!important}.tl #tl-detail-info .detail-content .ats-table .table-footer>div,.tl #tl-detail-info .detail-content .ats-table .table-header>div,.tl #tl-detail-info .detail-content .ats-table .table-row>div,.tl #tl-detail-info .detail-content .ep-table .table-footer>div,.tl #tl-detail-info .detail-content .ep-table .table-header>div,.tl #tl-detail-info .detail-content .ep-table .table-row>div{-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0}}@media (min-width:992px){.tl .top-section .txn-ref-no .input-group.custom,.tl .top-section .txn-ref-no .input-group.custom.short{width:300px}}#tc{margin:10px}#tc .t-and-c-ul{padding:10px;font-size:12px}#tc .step-container{padding-top:20px;border-bottom:2px solid #ccc;display:block}#tc .step-container #step-3-container .radio-row{min-height:30px}#tc .step-container .open-details{transform:rotate(180deg);-ms-transform:rotate(180deg);-moz-transform:rotate(180deg);-webkit-transform:rotate(180deg);-o-transform:rotate(180deg);transition:all .3s}#tc .add-certificate{background-color:#eee;padding:20px;display:block}#tc .add-certificate>div{padding:5px 0}#tc .add-certificate>div:first-child{padding-top:0}#tc .add-certificate>div:last-child{padding-bottom:0}#tc .add-certificate .input-num-group{padding-top:5px}#tc .add-certificate .input-num-group input{height:40px;text-align:center}#tc .add-certificate .input-num-group .input-group-addon{border-radius:0;background-color:#eee;height:40px;width:40px;font-weight:700;font-size:22px;padding:0;transition:all .3s;-moz-transition:all .3s;-webkit-transition:all .3s;-o-transition:all .3s}#tc .add-certificate .input-num-group .input-group-addon.not-allow-mp{cursor:not-allowed}#tc .add-certificate .input-num-group .input-group-addon.highlight-mp{color:#009CDE}#tc .add-certificate .input-num-group .input-group-addon:hover{color:#fff;background-color:#2172BA;transition:all .3s;-moz-transition:all .3s;-webkit-transition:all .3s;-o-transition:all .3s}#tc .step-1-panel{display:block}#tc .step-1-panel>div{padding:5px 0}#tc .step-1-panel>div:first-child{padding-top:0}#tc .step-1-panel>div:last-child{padding-bottom:0}#tc .certificate-list{margin:0 -10px}#tc .certificate-list .tc-dir-body{padding:10px}#tc .certificate-list .tc-dir-body>div{background-color:#eee;padding:20px;position:relative}#tc .button-group .col-sm-3:first-child,#tc .padding-right-10,#tc .padding-right-20{padding-right:0}#tc .certificate-list .tc-dir-body>div .remove-btn{color:#1C5CAB;font-weight:700;text-transform:uppercase;position:absolute;right:20px;bottom:20px}#tc #travel-certificate-clear-modal .highlight,#tc #travel-certificate-confirm-modal .highlight,#uc #united-club-confirm-modal .highlight{color:#f16321}#tc .padding-top-10{padding-top:10px}#tc .required-icon-no-border{cursor:none;border:none}#tc .button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#tc #travel-certificate-clear-modal .row.button .col-xs-6:first-child,#tc #travel-certificate-confirm-modal .row.button .col-xs-6:first-child{padding-right:10px}#tc #travel-certificate-clear-modal .row.button .col-xs-6:last-child,#tc #travel-certificate-confirm-modal .row.button .col-xs-6:last-child{padding-left:10px}@media (min-width:768px){#tc .add-certificate>div.count-label,#tc .step-1-panel>div.count-label{text-align:right}#tc .add-certificate{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#tc .add-certificate>div{padding:0 10px}#tc .add-certificate>div:first-child{padding-left:0}#tc .add-certificate>div:last-child{padding-right:0}#tc .add-certificate .input-num-group{padding-top:0}#tc .add-certificate .input-num-group>input[type=number]{-moz-appearance:textfield}#tc .add-certificate .input-num-group>input[type=number]::-webkit-inner-spin-button,#tc .add-certificate .input-num-group>input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}#tc .step-1-panel{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}#tc .step-1-panel>div{padding:0 10px}#tc .step-1-panel>div:first-child{padding-left:0}#tc .step-1-panel>div:last-child{padding-right:0}#tc .padding-right-20{padding-right:20px}#tc .button-group .col-sm-3:first-child,#tc .padding-right-10{padding-right:10px}#tc .button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}}#uc #confirm-united-club{margin-top:10px}#uc #confirm-united-club .button-group .col-sm-3:first-child{padding-right:0}#uc #confirm-united-club .button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#uc #united-club-confirm-modal .row.button .col-xs-6:first-child{padding-right:10px}#uc #united-club-confirm-modal .row.button .col-xs-6:last-child{padding-left:10px}@media (min-width:768px){#uc{padding:0 10px}#uc #confirm-united-club .button-group .col-sm-3:first-child{padding-right:10px}#uc #confirm-united-club .button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}}#ug #apply-upgrades{margin-top:10px}#ug #apply-upgrades .glyphicon{color:#62a9e3;margin-right:10px}#ug #apply-upgrades .up-balance{background-color:#f2f2f2;border:1px solid #e6e6e6;margin:10px;padding:10px 20px}#ug #apply-upgrades .up-balance svg{margin-top:-4px;transition:all .3s ease-in-out;color:#2172BA}#ug #apply-upgrades .up-balance.expanded{background-color:#fff}#ug #apply-upgrades .up-balance.expanded svg{transform:rotate(-180deg);-webkit-transform:rotate(-180deg);-ms-transform:rotate(-180deg)}#ug #apply-upgrades .up-purchase{border:1px solid #e6e6e6;margin:10px;padding:20px}#ug #apply-upgrades .up-purchase .col-xs-8 *{display:block}#ug #apply-upgrades .input-num>input[type=number]::-webkit-inner-spin-button,#ug #apply-upgrades .input-num>input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}#ug #apply-upgrades .balance-tooltip img{height:15px;width:15px;margin-right:3px;margin-left:10px}#ug #apply-upgrades .balance-tooltip .tooltip-container{margin-left:-120px;margin-top:-80px;font-size:11px}#ug #apply-upgrades #terms-and-conditions{height:60vh;overflow-y:auto;font-size:12px}#ug #apply-upgrades #terms-and-conditions .header-under{text-decoration:underline;margin-bottom:5px}#ug #apply-upgrades #terms-and-conditions .pl30{padding-left:30px}#ug #apply-upgrades #terms-and-conditions ul{list-style-type:disc;padding-left:30px}#ug #confirm-upgrades{margin-top:10px}#ug #confirm-upgrades .ps-note img{height:20px;width:20px;margin-right:10px}#ug #confirm-upgrades .button-group .col-sm-3:first-child{padding-right:0}#ug #confirm-upgrades .button-group .col-sm-3:last-child{margin-top:10px;padding-left:0}#ug #complete-upgrades .icon01{height:38px;margin-right:10px}#ug #complete-upgrades .icon02,#ug #complete-upgrades path,#ug #complete-upgrades svg{height:20px;margin-top:-2px;margin-left:10px}#ug #complete-upgrades .email{padding:20px;background-color:#f2f2f2}#ug #complete-upgrades .email .email-addr{color:#2172BA}#ug #upgrades-confirm-modal .highlight{color:#f16321}#ug #upgrades-confirm-modal .row.button .col-xs-6:first-child{padding-right:10px}#ug #upgrades-confirm-modal .row.button .col-xs-6:last-child{padding-left:10px}@media (min-width:768px){#ug{padding:0 10px}#ug #confirm-upgrades .button-group .col-sm-3:first-child{padding-right:10px}#ug #confirm-upgrades .button-group .col-sm-3:last-child{margin-top:0;padding-left:10px}#ug #complete-upgrades .responsive-table .table-row:last-child{border-bottom:1px solid #e6e6e6}} 
</style></span>
  
</head>

<body ng-class="bodyClass" ng-controller="headerController">


<noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-KR3G7XJ" style="display:none;visibility:hidden" width="0"></iframe></noscript>


<div class="emulation-bar ng-cloak" ng-show="$root.IsImpersonation">
  <h6 class="ng-cloak">{{$root.currentUser.emulatorName}} emulating as {{$root.currentUser.name}}</h6>
</div>

<header role="banner">
  <div class="header-wrap ng-cloak">

    <div class="c-logo pull-left" ng-click="clickLogo($root.currentUser)">
      <div class="img-wrap">
        <img alt="ua-logo" src="/resource/Sip_img_logo" />
      </div>
    </div>

    <div class="c-menu pull-left">
      <span class="menu-item ng-cloak" ng-repeat="item in dataBundle">
        <a class="menu-link no-text-selection" ng-bind="item.menu.Name | uppercase" ng-class="{'active':item.menu.Id==menuId&amp;&amp;shownPanel==='megaMenu'}" ng-click="triggerClick('megaMenu',item.menu.Id); $root.showSearchPanel=false;"></a>
      </span>
    </div>

    <div class="c-sign-out pull-right ng-cloak" ng-show="$state.current.name=='login-stopover'">
      <a ng-click="setSignOut()">Sign Out</a>
    </div>

    <div class="c-user pull-right ng-cloak" ng-click="triggerClick('signOutShow'); $root.showSearchPanel=false;" ng-hide="$state.current.name == 'login' || $state.current.name == 'login-stopover' || !$root.currentUser">
      <div class="user-wrap-new">
        <span class="item user-info no-text-selection">
          <p ng-bind="$root.currentUser.name"></p>
          <p ng-bind="$root.currentUser.accName"></p>
        </span>
        <span class="item user-face">
          <img alt="User profile image" class="img-circle" ng-src="{{$root.currentUser.smallPhotoUrl}}" />
        </span>
        <span class="item user-more">
          <svg aria-hidden="true" class="slds-button__icon white {{shownPanel=='signOutShow' ? ' open' : ''}}"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#down" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
          <span class="slds-assistive-text">Toggle user option</span>
        </span>
      </div>
    </div>

    <div class="c-sign-in pull-right ng-cloak" ng-show="!$root.currentUser &amp;&amp; $state.current.name!='login-stopover'">
      <a href="#/login" ng-mouseenter="triggerClick('signInShow')">Sign In</a>
    </div>

    <div class="c-hamburger pull-right ng-cloak" ng-click="triggerClick('mobileMore')" role="button">
      <i class="c-icon-more" ng-hide="shownPanel==='mobileMore'"></i>
      <i class="c-icon-close" ng-show="shownPanel==='mobileMore'"></i>
    </div>

    <div class="c-notification pull-right ng-cloak" ng-click="triggerClick('notificationShow')" ng-hide="$state.current.name == 'login' || $state.current.name == 'login-stopover' || !$root.currentUser">

      <div ng-class="{'has-msgs': sumOfMsg &amp;&amp; $root.currentUser, 'empty-msgs': !sumOfMsg &amp;&amp; $root.currentUser}">
        <span class="notes-count-wrapper" ng-click="toggleShow('notificationShow');$root.showSearchPanel=false;">
          <span class="notes-count no-text-selection" ng-bind="sumOfMsg" ng-class="{'empty':!sumOfMsg}" ng-show="$root.currentUser"></span>
        </span>
      </div>
      <div class="arrow" ng-show="shownPanel==='notificationShow'"></div>
    </div>

    <div class="c-search pull-right" ng-click="searchClick();" role="button">
      <svg aria-hidden="true" class="slds-button__icon slds-button__icon--large white" style="width: 20px;"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#search" xmlns:xlink="http://www.w3.org/1999/xlink">
        </use></svg>
      <span class="slds-assistive-text">Search button</span>
    </div>
  </div>
</header>

<div class="container-fluid ng-cloak" id="content-container">
  <rex-spinner id="main-spinner" ng-show="$root.mainSpinner"></rex-spinner>

  <div class="message-panel{{$root.messagePanelType=='alert'?               ' alert-msg':               ($root.messagePanelType=='success'?'success-msg':'info-msg')}}" ng-show="$root.showMessagePanel&amp;&amp;!$root.IsImpersonation">
    <img alt="Notification" class="img-icon" src="/resource/Sip_img_info_white" />
    <span class="message-panel-content" ng-bind-html="$root.messagePanelContent | to_trusted"></span>
    <svg aria-hidden="true" class="slds-button__icon slds-button__icon--large white" ng-click="$root.showMessagePanel=false"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#close" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
    <span class="slds-assistive-text">Close message panel</span>
  </div>

  <div class="search-panel" ng-keypress="searchKeyPress($event)" ng-show="$root.showSearchPanel">
    <div class="input-group">
      <label for="txt-search" style="display: none;">search text</label>
      <input autocomplete="off" autofocus="autofocus" class="form-control no-right-border" id="txt-search" ng-model="searchKeyword" placeholder="Search topics and keywords here" type="text" />
      <span class="input-group-addon" ng-click="$state.go('global-search', {param : searchKeyword});$root.showSearchPanel=!$root.showSearchPanel;">
            <svg aria-hidden="true" class="slds-button__icon slds-button__icon--large"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#search" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
            <span class="slds-assistive-text">Search</span>
        </span>
    </div>
  </div>

  <ui-view></ui-view>
</div>


<div class="c-panel" ng-class="{'up-80px':$root.IsImpersonation}" ng-show="shownPanel">
  <div class="c-panel-wrap">
    
    

    <div class="menu-more ng-cloak" ng-show="shownPanel==='mobileMore'">
      <div>
        <div class="row" id="tree-row">
          <div class="col-sm-6">
            <div id="tree-root" ui-tree="true">
              <ol ng-model="data" ng-repeat="set in sets" ui-tree-nodes="true">
                <li class="one-layer" ng-include="'nodes_renderer.html'" ng-repeat="node in set" ng-show="visible(node)" ui-tree-node="true">
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="mega-menu ng-cloak" ng-show="shownPanel==='megaMenu'">
      
      <span class="menu-level2">
        <a ng-class="{'active':tier2.Id==subMenuId}" ng-click="clickSubMenu(tier2)" ng-repeat="tier2 in currentDataBranch.menuTier2">{{tier2.Name | uppercase}}
        </a>
      </span>
      
      <div class="menu-level3" style="min-height:{{currentDataBranch.menuTier2.length*60}}px;">
        <h2 class="menu3-title">{{menu3Name?menu3Name:'empty'}}</h2>

        <div class="menu3-wrap">
          <div class="menu3-item" id="{{t3.Id}}" ng-click="clickT3(t3)" ng-repeat="t3 in currentDataTier3">
            <div class="menu4-wrap">
              <p class="title" data-record="{{t3.RecordTypeId}}" ng-bind-html="t3.Name | to_trusted"></p>
              <svg aria-hidden="true" class="slds-button__icon new-window-icon" ng-if="t3.SIP_Link_To_External_URL__c"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#new_window" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
            </div>
            <p class="content" ng-bind-html="t3.Description__c | to_trusted"></p>
          </div>
        </div>
      </div>
    </div>

    <div class="login-directive-container ng-cloak" ng-if="$state.current.name != 'login'" ng-show="shownPanel==='signInShow'">
      <login-comp is-popup="true"></login-comp>
    </div>

    <div class="notification-panel-parent" ng-show="shownPanel==='notificationShow'">
      <ul class="notification-panel ng-cloak">
        <li class="note-card">
          <h6 class="note-header" ng-show="sumOfMsg">MY NOTIFICATIONS</h6>
          <h6 class="note-header" ng-show="!sumOfMsg">NO NOTIFICATIONS</h6>
        </li>
        <li class="note-card" ng-repeat="oneNote in Notes">
          <div class="note-wrap">
            <p class="note-title" ng-bind="oneNote.Notification__r.Name"></p>
            <p class="note-date" ng-bind="oneNote.CreatedDate | date:'MMM dd,yyyy | hh:mm a'"></p>
            <p class="note-content" ng-bind="oneNote.Notification__r.Description__c"></p>
          </div>
          <div class="close-btn" ng-click="hideOneMsg(oneNote.Id,$index)" ng-if="!$root.IsImpersonation">&#9587;</div>
        </li>
      </ul>
    </div>

    <ul class="user-drop-panel ng-cloak" ng-show="shownPanel=='signOutShow'">
      <li class="mobile-user-face ng-cloak">
        <div class="wrap">
          <span class="user-face item">
              <img alt="User profile image" class="img-circle" ng-src="{{$root.currentUser.smallPhotoUrl}}" />
          </span>
          <span class="user-info item no-text-selection">
            <div ng-if="$root.IsImpersonation">User emulating as</div>
            <div ng-bind="$root.currentUser.name"></div>
            <div ng-bind="$root.currentUser.accName"></div>
          </span>
          <button ng-click="setSignOut()">Sign Out</button>
        </div>
      </li>
      <li ng-if="!$root.currentUser.isInternalUser">
        <a href="#/my-profile">My Profile</a>
      </li>
      <li ng-if="($root.currentUser.permission.SIP_AD75__c ||          $root.currentUser.permission.SIP_Agency_EPP_Performance_Report__c ||          $root.currentUser.permission.SIP_Marketing_Fund_Program__c ||          $root.currentUser.permission.SIP_Ticketing_Funds_Program__c||          $root.currentUser.permission.SIP_ITOT_Exhibits__c) &amp;&amp;          $root.currentUser.profileName != $root.PROFILE_TYPE.corp">
        <a href="#/my-incentives">My Programs</a>
      </li>
      <li ng-if="$root.currentUser.permission.SIP_Manage_Users__c &amp;&amp; !$root.IsImpersonation">
        <a ng-click="$state.go('user-management.home')">My Users</a>
      </li>
      <li id="my-sales-contacts-li" ng-if="!$root.currentUser.isInternalUser">
        <a class="sales-contacts" href="#/my-sales-contacts" style="color: #fff;">My Contacts</a>
      </li>
      <li class="desktop-signout" ng-click="setSignOut()" ng-if="!$root.IsImpersonation">
        <a>Sign Out</a>
      </li>
    </ul>
  </div>
</div>

<div class="c-back ng-cloak" ng-click="shownPanel=''" ng-show="shownPanel"></div>

<footer class="ng-cloak" id="footer" ng-controller="footerController" ng-init="initFooter()" role="contentinfo">
  <div class="container-fluid footer-wrapper ng-cloak">
    <div class="row link">
      <div class="col-md-3 col-sm-4 col-xs-12 column">
        <ul>
          <li class="footer-item" ng-repeat="x in footerCol1">
            <a href="{{::x.url}}" target="{{::x.target}}">{{::x.name}}</a>
            <svg aria-hidden="true" class="slds-button__icon new-window-icon" ng-if="x.isExternal==true"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#new_window" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
          </li>
        </ul>
      </div>
      <div class="col-md-3 col-sm-4 col-xs-12 column">
        <ul>
          <li class="footer-item" ng-repeat="y in footerCol2">
            <a href="{{::y.url}}" target="{{::y.target}}">{{::y.name}}</a>
            <svg aria-hidden="true" class="slds-button__icon new-window-icon" ng-if="y.isExternal==true"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#new_window" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
          </li>
        </ul>
      </div>
      <div class="col-md-3 col-sm-4 col-xs-12 column social">
        <div>
          <span>Stay connected
           <svg aria-hidden="true" class="slds-button__icon new-window-icon"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#new_window" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
          </span>
          <ul>
            <li ng-repeat="z in footerCol3">
              <a href="{{::z.url}}" target="_blank">
                <img alt="{{::z.name}}" ng-src="{{::z.img}}" />
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div class="col-sm-12 hidden-md hidden-lg hidden-xs external-link-style flex-center">
        <svg aria-hidden="true" class="slds-button__icon new-window-icon"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#new_window" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
        <p>Indicates an external site that may or may not meet accessibility guidelines.</p>
      </div>

      <div class="col-md-3 col-sm-12 col-xs-12 column info">
        <div>
          <div class="star-alliance" height="16px" width="163px"></div>
          <p>Copyright &copy; 2017 United Airlines,Inc. All rights reserved.</p>
        </div>
      </div>
    </div>
    <div class="hidden-sm external-link-style flex-center">
      <svg aria-hidden="true" class="slds-button__icon new-window-icon"><use xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#new_window" xmlns:xlink="http://www.w3.org/1999/xlink"></use></svg>
      <p>Indicates an external site that may or may not meet accessibility guidelines.</p>
    </div>
  </div>
</footer>


<div aria-hidden="true" aria-labelledby="gohome-confirm-modal" class="modal fade" data-backdrop="static" data-keyboard="false" id="gohome-confirm-modal" role="dialog" tabindex="-1">
  <modal class="modal-container" type="alert">
    <h2>
      Are you sure want to go to HOME page? Any selection or unsaved changes will be lost.
    </h2>
    <div class="break-line-20px"></div>
    <div class="row button">
      <div class="col-xs-6">
        <div class="action-item secondary r-margin">
          <a class="uppercase-font" data-dismiss="modal">Cancel</a>
        </div>
      </div>
      <div class="col-xs-6">
        <div class="action-item tertiary l-margin">
          <a class="uppercase-font" ng-click="$root.goHome()">OK</a>
        </div>
      </div>
    </div>
  </modal>
</div>

<div aria-hidden="true" aria-labelledby="message-modal" class="modal fade" data-backdrop="static" data-keyboard="false" id="message-modal" role="dialog" tabindex="-1">
  <modal class="modal-container" type="{{$root.message.type}}">
    <h2>
      {{$root.message.text?$root.message.text:'empty'}}
    </h2>
    <div class="break-line-20px"></div>
    <p>{{$root.message.description}}</p>
    <div class="break-line-20px"></div>
    <div class="row">
      <div class="col-xs-3"></div>
      <div class="col-xs-6">
        <div class="action-item secondary">
          <a class="uppercase-font" data-dismiss="modal">OK</a>
        </div>
      </div>
      <div class="col-xs-3"></div>
    </div>
  </modal>
</div>



<script src="/resource/Sip_jquery_resize/jquery.ba-resize.min.js" type="text/javascript"></script>
<script src="/resource/Sip_jquery_pagination/jquery.page.js" type="text/javascript"></script>
<script src="/resource/Sip_bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/resource/Sip_angular/angular-ui-router.min.js" type="text/javascript"></script>
<script src="/resource/Sip_angular/angular-local-storage.min.js" type="text/javascript"></script>
<script src="/resource/Sip_angular/angular-aria.min.js" type="text/javascript"></script>
<script src="/resource/Sip_angular/angular-sanitize.min.js" type="text/javascript"></script>
<script src="/resource/Sip_lodash/dist/lodash.min.js" type="text/javascript"></script>
<script src="/resource/Sip_angular_tree/angular-ui-tree.min.js" type="text/javascript"></script>
<script src="/resource/Sip_svg4everybody/dist/svg4everybody.min.js" type="text/javascript"></script>
<script src="/resource/Sip_es6_promise_master/es6-promise-master/dist/es6-promise.js" type="text/javascript"></script>
<script src="/resource/Sip_powerbi_client/dist/powerbi.js" type="text/javascript"></script>
<script src="/resource/Sip_angular_powerbi/dist/angular-powerbi.js" type="text/javascript"></script>
<script src="/resource/Sip_powerbi_models/dist/models.js" type="text/javascript"></script>
<script src="/resource/Sip_tinyscrollbar/tinyscrollbar-2.5.0/simple/jquery.tinyscrollbar.min.js" type="text/javascript"></script>
<script src="/resource/Sip_flatpickr/dist/flatpickr.min.js" type="text/javascript"></script>
<script src="/resource/Sip_custom_scrollbar/jquery.mCustomScrollbar.concat.min.js" type="text/javascript"></script>
<script src="/resource/Sip_custom_scrollbar/scrollbars.min.js" type="text/javascript"></script><span id="j_id0:j_id32">
<script type="text/javascript"> (function () {
  'use strict';

  //3rd party plugins should inject to uaCommonModule instead of uaApp
  //so i delect 'powerbi' module , if u have any question ,contact Ming.
  angular.module('uaApp', ['portalModule', 'bankingModule'])
    .controller('headerController', headerController)
    .controller('footerController', footerController)
    .factory('menuShowHideFactory', function () {
      var factory = function (list) {
        return new menuShowHideService(list);
      };
      return factory;
    })
    .config(config)
    .run(run);

  headerController.$inject = ['$rootScope', '$scope', '$log', '$window', '$state', 'menuShowHideFactory', '$interval', 'SecurityService', 'CMSService', 'session', 'APP_CONFIG', '$sce'];
  function headerController($rootScope, $scope, $log, $window, $state, menuShowHideFactory, $interval, SecurityService, CMSService, session, APP_CONFIG, $sce) {

    $rootScope.activeTravelWaiverFlg = false;
    $scope.jumpToActiveTravelWaiver = function () {

      $rootScope.activeTravelWaiverFlg = true;
      $state.go('all-travel-waiver');
    };

    var panelList = ['signInShow', 'notificationShow', 'signOutShow', 'menuDropShow', 'moreIcon'];
    var menuService = menuShowHideFactory(panelList);

    $scope.sumOfMsg = 0;
    /****************************
     * key model:{string}
     * whether dropdown is visible
     * which sub tree is current
     ***************************/
    $scope.menuItem = '';
    $scope.currentDataTier3 = [];
    $scope.currentDataBranch = {};

    $scope.searchClick = function () {

      $rootScope.showSearchPanel = !$rootScope.showSearchPanel;
      $scope.shownPanel = '';
      $scope.bodyClass = '';
    };

    $scope.setSignOut = function () {

      $scope.shownPanel = false;
      session.clear();
      $rootScope.currentUser = null;

      if ($rootScope.APP_CONFIG.env == 'dev') {
        SecurityService.localLogout().then(function () {
          window.location.hash = '#/public-landing';
        })
      }
      else {
        var url = '/secur/logout.jsp?retUrl=';
        $window.open(url, "_self");
      }
    };

    /* for global search*/
    $scope.searchKeyPress = function (e) {

      if (e.keyCode == 13) {
        $state.go('global-search', {param: $scope.searchKeyword});
        $rootScope.showSearchPanel = !$rootScope.showSearchPanel;
      }
    };

    $scope.hideOneMsg = function (id, index) {

      $scope.Notes.splice(index, 1);
      if ($scope.sumOfMsg > 0) {
        $scope.sumOfMsg -= 1;
      }
      if ($scope.sumOfMsg == 0) {
        menuService.closePanel();
      }

      CMSService.UpdateUserNotification(id).then(function (value) {
      });
    };

    function clickMenuService(menuId) {

      // set root menu item name
      $scope.menuId = menuId;

      // switch container content
      $scope.currentDataBranch = ($scope.dataBundle).filter(function (value) {

        return value.menu.Id == $scope.menuId;
      });

      $scope.currentDataBranch = $scope.currentDataBranch[0];

      //init others tier
      var defaultSubMenu = (function () {

        return $scope.currentDataBranch.menuTier2[0];
      })();

      $scope.clickSubMenu(defaultSubMenu);
    }

    CMSService.getHomePageHeaderValues().then(function (value) {

      $scope.dataBundle = (function (_, DATA) {
        return DATA.map(function (item) {

          var singleWrap = {};
          singleWrap['menu'] = item.HomePageHeaderWrapper;
          singleWrap['menuTier2'] = (item.HomePageChildWrapper).map(function (obj) {

            return _.omit(obj, 'Child_Sub_Links__r');
          });
          singleWrap['menuTier3'] = (item.HomePageChildWrapper).map(function (obj) {
            if (typeof obj.Child_Sub_Links__r != 'undefined' && "records" in obj.Child_Sub_Links__r) {
              return obj.Child_Sub_Links__r.records;
            }
            return obj.Child_Sub_Links__r;
          });
          singleWrap['menuTier3'] = _.flatten(singleWrap['menuTier3']);
          return singleWrap;
        })
      })(_, value);
    });

    $scope.clickSubMenu = function (item) {

      $scope.subMenuId = item.Id;
      $scope.menu3Name = item.Name;

      if (typeof $scope.currentDataBranch.menuTier3 == 'undefined') {
        $scope.currentDataTier3 = []
      }
      else {
        try {
          $scope.currentDataTier3 =
            ($scope.currentDataBranch.menuTier3).filter(function (value) {
              if (typeof value != 'undefined') {
                return value.Parent_Link__c == $scope.subMenuId;
              }
            });
        }
        catch (e) {
          $log.log(e)
        }
      }
    };

    $scope.clickLogo = function (user) {

      //WT-01484
      if (menuService.getShownPanel()) {
        //if the panel is shown than it will close the it.
        $scope.menuId = '';
        menuService.closePanel();
        return;
      }

      if (!user) {
        $window.open('#/public-landing', '_self');
        return;
      }
      else {
        $window.open('#/secure-landing/home/init', '_self');
      }
    };

    if (APP_CONFIG.env !== 'dev') {
      $interval(function () {
        if ($rootScope.currentUser) {
          CMSService.getUserNotification($rootScope.currentUser.id).then(function (value) {

            if (value.UserId) {
              //PRODUCTION ENV
              $scope.Notes = value.Notifications || [];
              $scope.sumOfMsg = $scope.Notes.length;

              var userId = value.UserId;
              if ($rootScope.currentUser && $rootScope.currentUser.id != userId) {

                // server session expired
                $rootScope.$broadcast('sessionExpired', {});
              }
            } else {
              // server session expired
              $rootScope.$broadcast('sessionExpired', {});
            }
          }).catch(function (error) {

            // console.debug(error);
          });
        }
      }, 1000);
    }

    $scope.$on('setSignOutEvent', function (event, data) {

      $scope.setSignOut();
    });

    $scope.$on('resetMenuPanel', function (event, data) {

      $scope.shownPanel = '';
      $scope.bodyClass = '';
      var source = data.source;
      if (source == 'jquery') {
        $scope.$apply();
      }
    });

    $rootScope.$on('$stateChangeSuccess', function (event, toState, toParams) {

      $scope.shownPanel = '';
      $scope.bodyClass = '';
    });

    $scope.$on('clickCenter', function (event, obj) {

      if (!obj) return;
      var isSameEl = $scope.shownPanel == obj.name;
      if (!isSameEl) {
        $scope.shownPanel = obj.name;
      } else {
        if (typeof obj['menuId'] != undefined && obj['menuId']) {
          return;
        }
        $scope.shownPanel = '';
        $scope.bodyClass = '';
      }
    });

    $scope.closePanel = false;
    $scope.triggerClick = function (name, menuId) {

      if ($(window).width() < 768) {
        //set bg color or other
        switch (name) {
          case 'megaMenu':
            clickMenuService(menuId);
            break;
        }
        $scope.bodyClass = 'menu-open-mobile';
      }
      else {
        //set bg color or other
        switch (name) {
          case 'megaMenu':
            clickMenuService(menuId);
            $scope.bodyClass = 'menu-open';
            break;
          case 'notificationShow':
          case 'signOutShow':
          case 'signInShow':
            $scope.bodyClass = 'menu-open-transparent';
            break;
          case 'mobileMore':
            $scope.bodyClass = 'menu-open-mobile';
            break;
        }
      }

      //toggle panel
      $scope.$broadcast('clickCenter', {name: name, menuId: menuId});
    };

    //tree merge
    $scope.clickT3 = function (addressObj, mobileItem) {
      if (addressObj && addressObj['Child_Sub_Links__r']) {
        $scope.toggle(mobileItem);
        return false;
      }

      if (!addressObj || !typeof addressObj === 'undefined') {
        return false;
      }

      if (addressObj.SIP_Open_In_A_Separate_Tab__c == 'Yes') {
        //external link

        if ('true' == 'true') {

          if ($rootScope.currentUser) {
            dataLayer.push({
              'event': 'ngRouteChange',
              'attributes': {
                'route': addressObj.Sub_Link_URL__c
              },
              'myUser': $rootScope.currentUser.name,
              'myAccount': $rootScope.currentUser.accName || ' ',
              'myRole': $rootScope.currentUser.profileName

            });
          } else {
            dataLayer.push({
              'event': 'ngRouteChange',
              'attributes': {
                'route': addressObj.Sub_Link_URL__c
              },
              'myUser': 'Guest',
              'myAccount': ' ',
              'myRole': 'Guest'

            });
          }
        }

        $window.open(addressObj.Sub_Link_URL__c);
      } else {
        //internal link
        //3 step to close all panel
        if (addressObj.Sub_Link_URL__c) {
          var internalUrl = addressObj.Sub_Link_URL__c.split("/")[1];
          // internalUrl = addressObj.Sub_Link_URL__c.replace("#/", '');
          $state.go(internalUrl);
        } else {
          $state.go('sub-link', {'linkId': addressObj.Id});
        }
      }
    };

    $scope.toggle = function (scope) {

      scope.toggle();
    };

    $scope.visible = function (item) {

      return !($scope.query && $scope.query.length > 0
      && item.title.indexOf($scope.query) == -1);
    };

    CMSService.getHomePageHeaderValues().then(function (value) {
        if (!value) {
          return false;
        }

        var json = (function (data) {
          return data.map(function (item, index) {
            item['id'] = index + 1;
            item['title'] = item['HomePageHeaderWrapper']['Name'];
            item['nodes'] = item['HomePageChildWrapper'];

            item['nodes'].forEach(function (item2, index) {
              item2['id'] = item['id'] * 10 + (index + 1);
              item2['title'] = item2['Name'];

              if ("records" in item2.Child_Sub_Links__r) {
                item2['nodes'] = item2['Child_Sub_Links__r']['records'];
              } else {
                item2['nodes'] = item2['Child_Sub_Links__r'];
              }
              item2['nodes'].length > 1 && item2['nodes'].forEach(function (item3, index) {
                item3['id'] = item2['id'] * 10 + (index + 1);
                item3['title'] = item3['Name'];
                item3['nodes'] = [];
              })
            });

            return item;
          })
        })(value);

        // $scope.data = json;
        $scope.data = json;
        var sets = json.map(function (item) {

          return item['nodes'];
        });

        $scope.sets = sets;

        setTimeout(function () {
          var arr = $('#tree-root>ol');
          Array.prototype.forEach.call(arr, function (item, index) {
            var el = $('<div class="tree-title">' + json[index].title + '</div>');
            $(item).before(el);
          });
        }, 0);
      }
    );
  }

  footerController.$inject = ['$scope', 'CMSService'];
  function footerController($scope, CMSService) {

    CMSService.getFooterValues().then(function (value) {

      if (!value) {
        return false;
      }
      var getFooterColContent = function (items) {
        if (!items) {
          throw new Error('CMS footer data missing!')
        }
        var arrRes = [];

        items.forEach(function (item) {
          arrRes.push({
            'name': item['Name'],
            'url': item['URL__c'],
            'target': item['SIP_Open_in_a_Separate_Tab__c'] == 'Yes' ? '_blank' : '_self',
            'img': item['Sip_Social_Media_Icons__c'],
            'isExternal': item['SIP_Link_To_External_URL__c']
          });
        });

        return arrRes;
      };

      $scope.footerCol1 = getFooterColContent(value[0]);
      $scope.footerCol2 = getFooterColContent(value[1]);
      $scope.footerCol3 = getFooterColContent(value[2]);
    });

    function adjustFooter() {

      // Ryan 20170422: Method refine
      var standardHeight = window.innerHeight - $('header').height() - $('footer').height() - 80; // 80 footer padding
      // if(navigator.userAgent.indexOf('Chrome') > -1){
      //   standardHeight+=1;
      // }

      $('#content-container').css('min-height', standardHeight + 'px');
    }

    //GA tracking code
    $scope.routeChangeForGA = function (href) {
      if ('true' == 'true') {

        if ($rootScope.currentUser) {
          dataLayer.push({
            'event': 'ngRouteChange',
            'attributes': {
              'route': href
            },
            'myUser': $rootScope.currentUser.name,
            'myAccount': $rootScope.currentUser.accName || ' ',
            'myRole': $rootScope.currentUser.profileName

          });
        } else {
          dataLayer.push({
            'event': 'ngRouteChange',
            'attributes': {
              'route': href
            },
            'myUser': 'Guest',
            'myAccount': ' ',
            'myRole': 'Guest'

          });
        }


      }
    };

    $scope.initFooter = initFooter;
    function initFooter() {

      window.onresize = function () {

        adjustFooter();
      };

      // Ryan 20170422: redundant and causing recursive resize on wrapper
      // $('#content-container').resize(function () {
      //
      //   adjustFooter();
      // });

      $('#footer').resize(function () {

        adjustFooter();
      });

      adjustFooter();
    }
  }

  //config needn't inject
  function config($urlRouterProvider, $locationProvider, treeConfig) {

    treeConfig.defaultCollapsed = true; // collapse nodes by default
    $urlRouterProvider.otherwise('/public-landing');
    // $locationProvider.html5Mode(true);
  }

  function run($rootScope, $state, session) {

    $rootScope.currentUser = session.currentUser();
    $rootScope.$state = $state;

    $rootScope.$on('$stateChangeSuccess', function() {
      document.body.scrollTop = document.documentElement.scrollTop = 0;
    });
  }

  function menuShowHideService(list) {
    var service = this,
      listOfPanelProperty = list,
      shownPanel = '';

    service.setOneShow = function (strItem) {
      strItem && listOfPanelProperty.forEach(function (value, index) {
        if (value == strItem) {
          shownPanel = value;
        }
      })
    };

    service.closePanel = function () {
      shownPanel = '';
    };

    service.getShownPanel = function () {
      return shownPanel;
    }
  }
})
();
 
</script></span><span id="j_id0:j_id35">
<script type="text/javascript"> (function () {
  'use strict';

  angular.module('portalModule', ['commonModule', 'ui.router'])
    .config(routeConfig)
    .factory('stateFactory', stateFactory)
    .run(run);

  routeConfig.$inject = ['$urlRouterProvider', '$stateProvider'];
  function routeConfig($urlRouterProvider, $stateProvider) {

    $urlRouterProvider.when('/secure-landing', '/secure-landing/home');

    $stateProvider
      .state('login', {
        url: '/login',
        templateUrl: 'Sip_LoginTemplate',
        controller: 'loginController'
      })
      .state('login-stopover', {
        url: '/login-stopover',
        templateUrl: 'Sip_LoginStopoverTemplate',
        controller: 'loginStopoverController'
      })
      .state('public-landing', {
        url: '/public-landing',
        templateUrl: 'Sip_PublicLandingTemplate',
        controller: 'publicLandingController'
      })
      .state('marketing-detail', {
        url: '/marketing-detail/:id',
        templateUrl: 'Sip_MarketingDetailTemplate',
        controller: 'marketingDetailController'
      })
      .state('news-detail', {
        url: '/news-detail/:id',
        templateUrl: 'Sip_NewsDetailTemplate',
        controller: 'newsDetailController'
      })
      .state('news-list', {
        url: '/news-list',
        templateUrl: 'Sip_NewsListTemplate',
        controller: 'newsListController'
      })
      .state('term-condition', {
        url: '/term-condition',
        templateUrl: 'Sip_TermConditionTemplate',
        controller: 'termConditionController'
      })
      .state('web-to-case', {
        url: '/web-to-case',
        templateUrl: 'Sip_WebToCaseTemplate',
        controller: 'webToCaseController'
      })
      .state('acquisition', {
        url: '/acquisition/:step',
        params: {
          step: {value: 'step1'}
        },
        templateUrl: 'Sip_AcquisitionTemplate',
        controller: 'acquisitionController'
      })
      .state('sub-link', {
        url: '/sub-link/:linkId',
        templateUrl: 'Sip_SubMenuPageTemplate',
        controller: 'subMenuPageController'
      })
      .state('single-power-bi', {
        url: '/single-power-bi',
        templateUrl: 'Sip_SinglePowerBiFrameTemplate',
        controller: 'powerbiReportController',
        params: {
          dataObj: null
        }
      })
      .state('my-incentives', {
        url: '/my-incentives',
        templateUrl: 'Sip_MyIncentivesTemplate',
        controller: 'myIncentivesController',
      })
      .state('all-travel-waiver', {
        url: '/all-travel-waiver',
        templateUrl: 'Sip_AllTravelWaiverTemplate',
        controller: 'allTravelWaiverController',
        params: {
          param: null
        }
      })
      .state('registration', {
        url: '/registration',
        templateUrl: 'Sip_RegistrationTemplate',
        controller: 'registrationController'
      })
      .state('ui-reference', {
        url: '/ui-reference',
        templateUrl: 'test/uiReference/templ2.html',
        controller: 'uiReferenceController'
      })
      .state('ui-form', {
        url: '/ui-form',
        templateUrl: 'test/uiForm/templ2.html',
        controller: 'uiFormController'
      })
      // .state('script-test', {
      //   url: '/script-test',
      //   templateUrl: 'test/ScriptTest/templ2.html',
      //   controller: 'scriptTestController'
      // })
      .state('user-management', {
        url: '/user-management',
        templateUrl: 'Sip_UserManagementTemplate',
        controller: 'userManagementController as vm'
      })
      .state('user-management.home', {
        url: '/home',
        templateUrl: 'Sip_UserManagement_HomeTemplate',
        controller: 'userManagementController.home',
        params: {
          name: null,
          iata: null,
          accId: null,
          dashboardViewUser: false //click VIEW SELECTED USER PROFILE from Dashboard page
        }
      })
      .state('user-management.fund', {
        url: '/fund',
        templateUrl: 'Sip_UserManagement_FundTemplate',
        controller: 'userManagementController.fund as vm'
      })
      .state('user-management.agencies', {
        url: '/agencies',
        templateUrl: 'Sip_UserManagement_AgenciesTemplate',
        controller: 'userManagementController.agencies as vm'
      })
      .state('user-management.branch', {
        url: '/branch',
        templateUrl: 'Sip_UserManagement_BranchTemplate',
        controller: 'userManagementController.branch'
      })
      .state('user-management.dashboard', {
        url: '/dashboard/:userId',
        params: {
          step: {value: '0'}
        },
        templateUrl: 'Sip_UserManagement_DashboardTemplate',
        controller: 'userManagementController.dashboard'
      })
      .state('user-management-create', {
        url: '/create-new-user',
        templateUrl: 'Sip_UserManagement_CreateTemplate',
        controller: 'userCreateController'
      })
      .state('user-management-create.one', {
        url: '/basic-info',
        templateUrl: 'Sip_UserManagement_Create_oneTemplate',
        controller: 'createOneController',
        params: {
          stepOne: null,
          needBinding: false
        }
      })
      .state('user-management-create.two', {
        url: '/type',
        templateUrl: 'Sip_UserManagement_Create_twoTemplate',
        controller: 'createTwoController',
        params: {
          stepTwo: null
        }
      })
      .state('user-management-create.three', {
        url: '/submit',
        templateUrl: 'Sip_UserManagement_Create_threeTemplate',
        controller: 'createThreeController',
        params: {
          stepThree: null
        }
      })
      .state('user-management-mass-result', {
        url: '/mass-result',
        templateUrl: 'Sip_MassUploadResultTemplate',
        controller: 'massResultController',
        params: {
          errorObj: null,
          arcNumber: null
        }
      })
      .state('my-sales-contacts', {
        url: '/my-sales-contacts',
        templateUrl: 'Sip_MySalesContactsTemplate',
        controller: 'mySalesContactsController'
      })
      .state('global-search', {
        url: '/global-search',
        templateUrl: 'Sip_GlobalSearchTemplate',
        controller: 'globalSearchController',
        params: {
          param: null
        }
      })
      .state('view-ticket', {
        url: '/view-ticket/:searchVal',
        templateUrl: 'Sip_ViewTicketTemplate',
        controller: 'viewTicketController',
        params: {
          searchVal: null
        }
      })
      .state('my-profile', {
        url: '/my-profile',
        templateUrl: 'Sip_MyProfileTemplate',
        controller: 'myProfileController',
      })
      .state('certification-form', {
        url: '/certification-form/:step',
        params: {
          step: {value: 'step1'}
        },
        templateUrl: 'Sip_CertificationFormTemplate',
        controller: 'certificationController'
      })
      .state('secure-landing', {
        url: '/secure-landing',
        templateUrl: 'Sip_SecureLandingTemplate',
        controller: 'secureLandingController'
      })
      .state('secure-landing-home', {
        url: '/home/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_SecureLandingHomeTemplate',
            controller: 'secureLandingHomeController'
          }
        }
      })
  }

  run.$inject = ['$log', '$rootScope', 'session', 'stateFactory', '$state'];
  function run($log, $rootScope, session, stateFactory, $state) {

    // use to center popup
    function reposition() {

      var modal = $(this);
      var dialog = modal.find('.modal-dialog');
      modal.css('display', 'block');

      // Dividing by two centers the modal exactly, but dividing by three
      // or four works better for larger screens.
      dialog.css("margin-top", Math.max(0, (window.innerHeight - dialog.height()) / 2));
    }

    $rootScope.isRoutePrevented = false;
    $rootScope.$on('$stateChangeStart', function (event, toState, toParams, fromState, fromParams, options) {

      //close the search panel when change to another url
      $rootScope.showSearchPanel = false;

      if (!$rootScope.currentUser) {

        if (!$rootScope.isRoutePrevented) {
          $rootScope.isRoutePrevented = true;
          event.preventDefault();

          stateFactory.checkSession(function () {

            stateFactory.checkState(event, toState, toParams);
          });
        }
        else {
          $rootScope.isRoutePrevented = false;
          stateFactory.checkState(event, toState, toParams);
        }
      }
      else {
        $rootScope.isRoutePrevented = false;
        stateFactory.checkState(event, toState, toParams);
      }
    });

    $rootScope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {
      switch (toState.name) {
        case 'login':
          $('#content-container').css('background-color', '');
          $('body').css('background-image', 'url(/resource/Sip_sign_in_background)');
          break;
        case 'news-detail' :
        case 'all-travel-waiver' :
        case 'marketing-detail' :
        case 'user-management-create.one' :
        case 'user-management-create.two' :
        case 'user-management-create.three' :
        case 'secure-landing-penalty-waiver' :
        case 'secure-landing-all-waiver-favor' :
        case 'secure-landing-seat-assignment' :
        case 'secure-landing-united-club' :
        case 'secure-landing-status-nomination' :
        case 'secure-landing-upgrades' :
        // case 'transaction-log' :
        case 'global-search' :
        case 'acquisition'  :
        case 'registration'  :
        case 'user-management-mass-result'  :
        case 'sub-link'  :
        case 'view-ticket' :
        case 'single-power-bi':
        case 'my-sales-contacts':
        case 'certification-form':
        case 'web-to-case':
        case 'secure-landing-banking-fund-transfer':
        case 'secure-landing-banking-account-summary':
        case 'secure-landing-bonus-miles':
        case 'secure-landing-travel-certificate':
        case 'secure-landing-beverage-coupons':
          $('#content-container').css('background-color', '#fff');
          $('body').css('background-image', '');
          break;
        case 'user-management' :
        case 'user-management-branch' :
          $('#content-container').css('background-color', '#f2f2f2');
          $('body').css('background-image', '');
          break;
        default:
          $('#content-container').css('background-color', '');
          $('body').css('background-image', '');
          break;
      }

      // Reposition when a modal is shown
      $("*").delegate('.modal', 'show.bs.modal', reposition);

      //use in um dashboard
      $rootScope.fromUrl = fromState.url;
    });

    $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, error) {

      switch (error.status) {
        case 401 : // unauthorized
          $state.go('public-landing');
          break;
        default:
          break;
      }
    });

    // Reposition when the window is resized
    $rootScope.currentGrid = '';
    $(window).on('resize', function (e) {

      var resetFlg = false;
      $('.modal:visible').each(reposition);
      // $rootScope.$broadcast('resetMenuPanel', {source: 'jquery'});

      var width = $(window).width();
      if (width >= 992) {
        $rootScope.bootstrapGrid = "lg";
      }
      else if (width >= 768) {
        $rootScope.bootstrapGrid = "md";
      }
      else if (width >= 576) {
        resetFlg = false;
        $rootScope.bootstrapGrid = "sm";
      }
      else {
        resetFlg = false;
        $rootScope.bootstrapGrid = "xs";
      }

      if ($rootScope.currentGrid) {

        if (($rootScope.bootstrapGrid == 'md' || $rootScope.bootstrapGrid == 'lg') &&
          ($rootScope.currentGrid == 'sm' || $rootScope.currentGrid == 'xs')) {
          resetFlg = true;
        }
        else if (($rootScope.bootstrapGrid == 'sm' || $rootScope.bootstrapGrid == 'xs') &&
          ($rootScope.currentGrid == 'md' || $rootScope.bootstrapGrid == 'lg')) {
          resetFlg = true;
        }

        $rootScope.currentGrid = $rootScope.bootstrapGrid;
      }
      else {
        $rootScope.currentGrid = $rootScope.bootstrapGrid;
      }

      if (resetFlg) {
        $rootScope.$broadcast('resetMenuPanel', {source: 'jquery'});
      }
    });
  }

  stateFactory.$inject = ['$rootScope', '$state', 'SecurityService', 'session', '$window'];
  function stateFactory($rootScope, $state, SecurityService, session, $window) {
    var factory = {};

    factory.checkSession = function (callback) {
      return new checkSession($rootScope, SecurityService, session, callback, $window);
    };

    factory.checkState = function (event, toState, toParams) {
      return new checkState($rootScope, $state, event, toState, toParams);
    };

    return factory;
  }

  function checkSession($rootScope, SecurityService, session, callback, $window) {

    retrieveCurrentUser($rootScope, SecurityService, session, callback, $window);
  }

  function checkState($rootScope, $state, event, toState, toParams) {

    if (!$rootScope.currentUser) {

      if (toState.parent == 'secure-landing') {
        if (!$rootScope.isRoutePrevented) event.preventDefault();
        $state.go('public-landing');
      }
      else if ($rootScope.isRoutePrevented) {
        $state.go(toState, toParams);
      }
    }
    else {

      //Sasi emulation
      var agreeValue = false;
      if ($rootScope.IsImpersonation) {
        agreeValue = false;
      } else {
        agreeValue = !$rootScope.currentUser.isAgreed;
      }


      if (toState.name != 'login-stopover' && agreeValue) {
        if (!$rootScope.isRoutePrevented) event.preventDefault();
        $state.go('login-stopover');
      } else {

        if (toState.name == 'public-landing') {
          if (!$rootScope.isRoutePrevented) event.preventDefault();
          $state.go('secure-landing-home', {feature: 'init'});
        }
        else if ($rootScope.isRoutePrevented) {
          $state.go(toState, toParams);
        }

        if (!$rootScope.isRoutePrevented) {
          try {

            var securityPageArr = $rootScope.noAuthorizationPages;
            var paramName = (function (argument) {
              for (var i in toParams) {
                return toParams[i];
              }
            })();

            var flgParent = securityPageArr.some(function (value) {
              return toState.name == value;
            });

            var flgSon = securityPageArr.some(function (value) {
              return toState.name + '/' + paramName == value;
            });
            if (flgParent || flgSon) {
              event.preventDefault();
              $state.go('public-landing');
              return false;
            }
          } catch (e) {
            throw new Error(e);
          }
        }
      }
    }
  }

  function retrieveCurrentUser($rootScope, SecurityService, session, callback, $window) {

    var contactId = '';
    if ($rootScope.IsImpersonation) {
      contactId = $rootScope.impersonationContactId;
    }

    // if is impersonation; contact id will be used to retrieve user info, internal user will be the session
    // otherwise, contact id will be null and populate user info by session
    SecurityService.getUserInfoExtension(contactId).then(function (value) {
      if (value && value[0]) {
        var permission = value[0].userPermissionMap;
        var reportPermission = value[0].reportPermission;
        var isPasswordExpireSoon = value[0].isPasswordExpireSoon;
        var passwordExpireSoonDays = value[0].passwordExpireSoonDays;
        var user = value[0].currentUser;
        var mgrUser = value[0].salesManagerUser;
        if (mgrUser) {
          var mgrName = mgrUser.Name;
          var mgrEmail = mgrUser.Email;
          var mgrPhone = mgrUser.Phone;
          var mgrPhotoUrl = mgrUser.SmallPhotoUrl;
          var mgrMobilePhone = mgrUser.MobilePhone;
        }
        if (user.Account) {
          var accId = user.AccountId;
          var accName = user.Account.Name;
          var accArcNumber = user.Account.SIP_ARC_Number__c;
        }
        var id = user.Id;
        var firstName = user.FirstName;
        var lastName = user.LastName;
        var name = user.Name;
        var fullPhotoUrl = user.FullPhotoUrl;
        var smallPhotoUrl = user.SmallPhotoUrl;
        var isAgreed = user.Agree__c;
        var email = user.Email;
        var dashboard = user.SIP_Dashboard__c;
        var emulatorName = value[0].EmulatorName;
        var profileName = value[0].profileName;
        var isInternalUser = value[0].isInternalUser;

        session.create(accId, accName, accArcNumber, profileName, id, firstName, lastName, name, fullPhotoUrl, smallPhotoUrl, isAgreed, email, mgrName, mgrEmail, mgrPhone, mgrPhotoUrl, mgrMobilePhone, isPasswordExpireSoon, passwordExpireSoonDays, permission, emulatorName, reportPermission, dashboard, isInternalUser);
        $rootScope.currentUser = session.currentUser();
        //Ming : store page authorization page
        $rootScope.noAuthorizationPages = value[0].accountId ? value[0].noAuthorizationPages : [];
      } else {
        $rootScope.currentUser = null;
        $rootScope.noAuthorizationPages = [];
      }

      if (callback) {
        callback();
        // var tmpFlag = false;
        // var kickUserFlag = !($rootScope.currentUser && ($rootScope.currentUser.id == '00536000004zTPUAA2' || $rootScope.currentUser.id == '00536000005bbMOAAY' || $rootScope.currentUser.id == '00536000005bbT0AAI' || $rootScope.currentUser.id == '00536000002qNH4AAM' || $rootScope.currentUser.id == '00536000005bbewAAA' || $rootScope.currentUser.id == '00536000005bbgYAAQ' || $rootScope.currentUser.id == '00536000005bbpuAAA' || $rootScope.currentUser.id == '00536000005bbpkAAA' || $rootScope.currentUser.id == '00536000005bbgiAAA' ));
        // if (kickUserFlag && $rootScope.currentUser != null) {
        //   var url = '/secur/logout.jsp?retUrl=';
        //   $window.open(url, "_self");
        // }
        // else {
        //   callback();
        // }
      }
    });
  }
})();


 
</script></span><span id="j_id0:j_id38">
<script type="text/javascript"> (function () {
  'use strict';

  angular.module('bankingModule', ['commonModule', 'ui.router'])
    .config(routeConfig)
    .constant('ts_name', {
      "advancePurchase": "Advance Purchase",
      "classConversion": "Class Conversion",
      "extendEticketValidity": "Extend Eticket Validity",
      "fareMatch": "Fare Match",
      "guaranteeAirfareMissedTicketing": "Guarantee Airfare / Missed Ticketing",
      "nameChange": "Name Change",
      "nameCorrection": "Name Correction",
      "offshoreCtoAgentError": "Offshore CTO Agent Error",
      "offshoreCtoFees": "Offshore CTO Fees",
      "penaltyWaiverAndNameChange": "Penalty Waiver and Name Change",
      "refundDuplicateTicket": "Refund Duplicate Ticket",
      "reissuePenaltyFee": "Reissue Penalty Fee",  //trans log no need
      "seatAssignment": "Seat Assignment",         //trans log no need
      "suspendedTicket": "Suspended Ticket",
      "ticketRevalidation": "Ticket Revalidation",
      "timeStay": "Time / Stay",
      "upgradeInventoryConversion": "Upgrade Inventory Conversion"
    })
    .constant('ts_field', {
      //fields for all traveler services (order by alphabet)
      "cityPair": {
        "Key": "cityPair",
        "Display": "City pair / route",
        "IsInput": true,
        "Type": "string",
        "Placeholder": "Ex: IAHORD"
      },
      "customAmount": {
        "Key": "customAmount",
        "Display": "Cost",
        "IsInput": true,
        "Type": "decimal"
      },
      "Cost": {
        "Display": "Cost",
        "Key": "Cost",
        "Type": "price"
      },
      "CostDiff": {
        "Display": "Cost (Fare Differential)",
        "Key": "Cost",
        "Type": "price"
      },
      "descOfError": {
        "Key": "descOfError",
        "Display": "Description of error",
        "IsInput": true,
        "Type": "string"
      },
      "domesticOrInternational": {
        "Key": "domesticOrInternational",
        "Display": "Domestic or international",
        "IsInput": true,
        "Type": "string"
      },
      "fareBasis": {
        "Key": "fareBasis",
        "Display": "Fare basis",
        "IsInput": true,
        "Type": "string"
      },
      "marketingFlightNumber": {
        "Key": "marketingFlightNumber",
        "Display": "Flight number",
        "IsInput": true,
        "Type": "string"
      },
      "matchedAirline": {
        "Key": "matchedAirline",
        "Display": "Matched airline",
        "IsInput": true,
        "Type": "string",
        "Placeholder": "Ex: OA"
      },
      "matchedFare": {
        "Key": "matchedFare",
        "Display": "Matched fare",
        "IsInput": true,
        "Type": "string"
      },
      "newBookingClass": {
        "Key": "newBookingClass",
        "Display": "New booking class",
        "IsInput": true,
        "Type": "string"
      },
      "newName": {
        "Key": "newName",
        "Display": "New name",
        "IsInput": true,
        "Type": "string",
        "Placeholder": "Last Name / First Name"
      },
      "newReturnDate": {
        "Key": "newReturnDate",
        "Display": "New return date",
        "IsInput": true,
        "Type": "string",
        "Placeholder": "mm/dd/yyyy"
      },
      "originalFare": {
        "Key": "originalFare",
        "Display": "Original fare",
        "IsInput": true,
        "Type": "string"
      },
      "oldFareBasis": {
        "Key": "oldFareBasis",
        "Display": "Original fare basis",
        "IsInput": true,
        "Type": "string"
      },
      "oldName": {
        "Key": "oldName",
        "Display": "Old name",
        "IsInput": true,
        "Type": "string",
        "Placeholder": "Last Name / First Name"
      },
      "originalReturnDate": {
        "Key": "originalReturnDate",
        "Display": "Original return date",
        "IsInput": true,
        "Type": "string",
        "Placeholder": "mm/dd/yyyy"
      },
      "originalBookingClass": {
        "Key": "originalBookingClass",
        "Display": "Original booking class",
        "IsInput": true,
        "Type": "string"
      },
      "PassengerName": { // fields for fee waiver (ticket level)
        "Display": "Passenger name",
        "Key": "PassengerName",
        "Type": "string"
      },
      "qualifyingFare": {
        "Key": "qualifyingFare",
        "Display": "Qualifying fare",
        "IsInput": true,
        "Type": "decimal"
      },
      "quantity": {
        "Key": "quantity",
        "Display": "Quantity",
        "IsInput": true,
        "Type": "decimal"
      },
      "Quantity": {
        "Key": "Quantity",
        "Display": "Quantity",
        "IsInput": true,
        "Type": "decimal"
      },
      "requestFare": {
        "Key": "requestFare",
        "Display": "Authorized fare",
        "IsInput": true,
        "Type": "decimal"
      },
      "reason": {
        "Key": "reason",
        "Display": "Reason",
        "IsInput": true,
        "Type": "string"
      },
      "SeatNumbers": {
        "Display": "Seat Numbers",
        "Key": "assignedSeat",
        "IsInput": true,
        "Type": "string",
        "Placeholder": "Ex: 2A, 3A"
      },
      "TicketNumber": {
        "Key": "TicketNumber",
        "Display": "Ticket number",
        "IsInput": false,
        "Type": "string"
      },
      "waiverType": {
        "Key": "waiverType",
        "Display": "Waiver type",
        "IsInput": true,
        "Type": "string"
      },
      "WaiverFavorType": {
        "Display": "Waiver / favor type",
        "Key": "WaiverFavorType",
        "Type": "string"
      }
    })
    .run(run);

  routeConfig.$inject = ['$stateProvider'];
  function routeConfig($stateProvider) {

    $stateProvider
      .state('secure-landing-penalty-waiver', {
        url: '/penalty-waiver/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_PenaltyWaiverTemplate',
            controller: 'penaltyWaiverController'
          }
        }
      })
      .state('secure-landing-all-waiver-favor', {
        url: '/all-waiver-favor/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_AllWaiverFavorTemplate',
            controller: 'allWaiverFavorController'
          }
        }
      })
      .state('secure-landing-seat-assignment', {
        url: '/seat-assignment/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_SeatAssignmentTemplate',
            controller: 'seatAssignmentController'
          }
        }
      })
      .state('secure-landing-united-club', {
        url: '/united-club/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_UnitedClubTemplate',
            controller: 'unitedClubController'
          }
        }
      })
      .state('secure-landing-status-nomination', {
        url: '/status-nomination/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_StatusNominationTemplate',
            controller: 'statusNominationController'
          }
        }
      })
      .state('secure-landing-upgrades', {
        url: '/upgrades/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_UpgradesTemplate',
            controller: 'upgradesController'
          }
        }
      })
      .state('transaction-log', {
        url: '/transaction-log/:switch',
        params: {
          switch: {value: 'summary'}
        },
        templateUrl: 'Sip_TransactionLogTemplate',
        controller: 'transactionLogController'
      })
      .state('secure-landing-bonus-miles', {
        url: '/bonus-miles/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_BonusMilesTemplate',
            controller: 'bonusMileControl'
          }
        }
      })
      .state('secure-landing-travel-certificate', {
        url: '/travel-certificate/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_TravelCertificateTemplate',
            controller: 'travelCertificateControl'
          }
        }
      })
      .state('secure-landing-beverage-coupons', {
        url: '/beverage-coupons/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_BeverageCouponsTemplate',
            controller: 'beverageCouponsControl'
          }
        }
      })
      .state('secure-landing-banking', {
        url: '/banking',
        parent: 'secure-landing',
        views: {
          'content': {
            templateUrl: 'Sip_BankingTemplate',
            controller: 'bankingController'
          }
        }
      })
      .state('secure-landing-banking-account-summary', {
        url: '/account-summary/:feature',
        parent: 'secure-landing-banking',
        params: {
          feature: {value: 'init'}
        },
        views: {
          'bankingcontent': {
            templateUrl: 'Sip_AccountSummaryTemplate',
            controller: 'accountSummaryController'
          }
        }
      })
      .state('secure-landing-banking-fund-transfer', {
        url: '/fund-transfer/:feature',
        params: {
          feature: {value: 'init'}
        },
        parent: 'secure-landing-banking',
        views: {
          'bankingcontent': {
            templateUrl: 'Sip_FundTransferTemplate',
            controller: 'fundTransferController'
          }
        }
      })
  }

  run.$inject = ['$log', '$rootScope'];
  function run($log, $rootScope) {

    $rootScope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      if (toState.parent == 'secure-landing' || toState.parent == 'secure-landing-banking') {

        var tab = $('#tab');
        var tabContent = $('#tab-content');
        var feature = toParams.feature;

        switch (feature) {
          case 'apply-waiver' :
          case 'apply-waiver-favor' :
          case 'apply-eplus' :
          case 'apply-status-nomination' :
          case 'apply-upgrades' :
          case 'apply-bonus-miles':
          case 'apply-travel-certificate':
          case 'apply-beverage-coupons':
          case 'confirm-bonus-miles':
          case 'confirm-travel-certificate':
          case 'confirm-beverage-coupons':
          case 'apply-fund-transfer' :
          case 'banking-summary':
            tab.hide();
            tabContent.show();
            break;
          case 'confirm-waiver':
          case 'confirm-waiver-favor' :
          case 'confirm-eplus' :
          case 'complete-eplus' :
          case 'confirm-membership' :
          case 'confirm-otp-membership' :
          case 'confirm-otp-email' :
          case 'confirm-status-nomination' :
          case 'confirm-upgrades' :
          case 'complete-upgrades' :
          case 'confirm-fund-transfer' :
            tab.hide();
            tabContent.hide();
            break;
          default:
            tab.show();
            tabContent.show();
            break;
        }
      }
    });
  }
})();

 
</script></span><span id="j_id0:j_id41">
<script type="text/javascript"> (function () {
  'use strict';

  angular.module('commonModule', ['LocalStorageModule', 'ngAria', 'ngSanitize', 'powerbi', 'ui.tree', 'ngMessages', 'ngScrollbars'])
    .constant('PROFILE_TYPE', {
      agent: 'Agent',
      agtMgr: 'Agency Manager',
      corp: 'Corporate'
    })
    .constant('ACC_TYPE', {
      agency: 'Agency',
      agencyBranch: 'Agency_Branch',
      corp: 'Corporate',
      dis: 'Discretionary',
      aor: 'AOR_Transaction',
      resv: 'Reserved_Agency_HOL',
      psuedo: 'Psuedo'
    })
    .constant('APP_CONFIG', {
      env: 'prod'
    })
    .value('LOG_CONFIG', {
      enable: true
    })
    .config(config)
    .run(run);

  config.$inject = ['localStorageServiceProvider', 'ScrollBarsProvider'];
  function config(localStorageServiceProvider, ScrollBarsProvider) {

    // local storage config
    localStorageServiceProvider
      .setPrefix('SIP')
      .setStorageType('localStorage')
      .setStorageCookie(30, '/')
      .setNotify(true, true);

    // scrollbar config
    ScrollBarsProvider.defaults = {
      autoHideScrollbar: false,
      scrollInertia: 0,
      axis: 'y',
      advanced: {
        updateOnContentResize: true
      },
      scrollButtons: {
        scrollAmount: 'auto', // scroll amount when button pressed
        enable: false // enable scrolling buttons by default
      }
    };
  }

  run.$inject = ['$rootScope', '$state', '$location', 'PROFILE_TYPE', 'ACC_TYPE', 'APP_CONFIG', 'session', '$timeout'];
  function run($rootScope, $state, $location, PROFILE_TYPE, ACC_TYPE, APP_CONFIG, session, $timeout) {

    session.clear();
    $rootScope.IsImpersonation = false;
    $rootScope.impersonationContactId = '';
    $rootScope.PROFILE_TYPE = PROFILE_TYPE;
    $rootScope.ACC_TYPE = ACC_TYPE;
    $rootScope.APP_CONFIG = APP_CONFIG;
    $rootScope._ = _;
    svg4everybody();

    $rootScope.getQueryString = function (name) {

      name = name.replace(/[\[]/, '\\\[').replace(/[\]]/, '\\\]');
      var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)');
      var r = window.location.search.substr(1).match(reg);
      if (r != null)return unescape(r[2].replace('/', ''));
      return null;
    };

    if('true' == 'true'){

      // track pageview on state change
      $rootScope.$on('$stateChangeSuccess', function() {

        if ($rootScope.currentUser) {
          dataLayer.push({
            'event': 'ngRouteChange',
            'attributes': {
              'route': $location.path()
            },
            'myUser': $rootScope.currentUser.name,
            'myAccount': $rootScope.currentUser.accName || ' ',
            'myRole': $rootScope.currentUser.profileName

          });
        } else {
          dataLayer.push({
            'event': 'ngRouteChange',
            'attributes': {
              'route': $location.path()
            },
            'myUser': 'Guest',
            'myAccount': ' ',
            'myRole': 'Guest'

          });
        }

      });
    }

    $rootScope.$on('$stateChangeStart', function (event, toState, toParams, fromState, fromParams, options) {

      var absUrl = $location.absUrl();
      if (_.toLower(absUrl).indexOf('impersonation=true') > -1) {
        $rootScope.IsImpersonation = $rootScope.getQueryString('impersonation');
      }
      else {
        $rootScope.IsImpersonation = false;
      }
      if (_.toLower(absUrl).indexOf('contactid') > -1) {
        $rootScope.impersonationContactId = $rootScope.getQueryString('contactid');
      }
      else {
        $rootScope.impersonationContactId = '';
      }
    });

    $rootScope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams, options) {

      // prevent dropdown collapse during scroll
      $(document).on('click', '.dropdown-menu .mCSB_draggerContainer', function (e) {
        e.stopPropagation();
      });
    });

    $rootScope.goHome = function () {

      $('.modal').modal('hide');
      $state.go('public-landing');
    };
    $rootScope.$on('goHome', function (event, data) {

      if ($rootScope.currentUser &&
        $rootScope.currentUser.isAgreed) {

        var needConfirm = data.needConfirm;
        if (needConfirm) {
          $('#gohome-confirm-modal').modal();
        }
        else {
          $rootScope.goHome();
        }
      }
    });
    $rootScope.$on('showMessage', function (event, data) {

      $rootScope.message = {
        type: data.type, // alert, info, success
        text: data.text,
        description: data.description
      };

      $('.modal').modal('hide');
      $timeout($('#message-modal').modal());
    });
    $rootScope.$on('sessionExpired', function (event, data) {

      $rootScope.message = {
        type: 'alert',
        text: 'Your current session has expired. Please sign in to continue.'
      };

      // Ryan 20170308 - Hide message panel when session expired
      if ($rootScope.currentUser) {
        $rootScope.showMessagePanel = false;
        $rootScope.IsImpersonation = false;
        $rootScope.impersonationContactId = '';
        $('.modal').modal('hide');
        $timeout($('#message-modal').modal());
        session.clear();
        $rootScope.currentUser = null;
        $state.go('public-landing');
      }
    });
  }
})();

(function () {
  // https://tc39.github.io/ecma262/#sec-array.prototype.find
  if (!Array.prototype.find) {
    Object.defineProperty(Array.prototype, 'find', {
      value: function (predicate) {
        // 1. Let O be ? ToObject(this value).
        if (this == null) {
          throw new TypeError('"this" is null or not defined');
        }

        var o = Object(this);

        // 2. Let len be ? ToLength(? Get(O, "length")).
        var len = o.length >>> 0;

        // 3. If IsCallable(predicate) is false, throw a TypeError exception.
        if (typeof predicate !== 'function') {
          throw new TypeError('predicate must be a function');
        }

        // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.
        var thisArg = arguments[1];

        // 5. Let k be 0.
        var k = 0;

        // 6. Repeat, while k < len
        while (k < len) {
          // a. Let Pk be ! ToString(k).
          // b. Let kValue be ? Get(O, Pk).
          // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).
          // d. If testResult is true, return kValue.
          var kValue = o[k];
          if (predicate.call(thisArg, kValue, k, o)) {
            return kValue;
          }
          // e. Increase k by 1.
          k++;
        }

        // 7. Return undefined.
        return undefined;
      }
    });
  }
})(); 
</script></span><span id="j_id0:j_id44">
<script type="text/javascript"> (function () {
  'use strict';
  angular.module('bankingModule')
    .controller('accountSummaryController', controller);

  controller.$inject = ['$rootScope', '$scope', '$timeout', 'util', 'AccountService','$document'];
  function controller($rootScope, $scope, $timeout, util, AccountService, $document) {

    $scope.$watch('data.preSelectedAccount.accountId', function (newVal, oldVal, scope) {

      $scope.loadAccountSummary();
    });

    $scope.loadAccountSummary = function () {

      if ($scope.data && $scope.data.preSelectedAccount) {

        if (!$rootScope.mainSpinner) {
          $rootScope.mainSpinner = true;
          AccountService.getAccountSummaryById(
            $scope.data.preSelectedAccount.accountId, $rootScope.currentUser.id
          ).then(function (value) {

            $rootScope.mainSpinner = false;
            if (util.isSuccessService(value)) {

              $scope.accountSummary = value;
              //20170802 use preselect account global service 
              $scope.accountSummary.GlobalService = $scope.data.preSelectedAccount.globalService;
            }
          }, function (err) {

            console.debug(err);
            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
        }
      }
    };
    $scope.loadAccountSummary();

    $scope.isEditFlg = false;
    $scope.onClickEditNotify = function () {
      $scope.isEditFlg = true;
      $timeout(function () {
        $('#txt-acc-notity-limit').focus();
        $('#txt-acc-notity-limit').select();
      }, 200);
    };

    $scope.confirmEdit = function () {

      AccountService.updateSFNotificationAmount(
        $scope.data.preSelectedAccount.accountId, $scope.accountSummary.BalanceNotificationLimit
      ).then(function (value) {

        if (util.isSuccessService(value)) {
          $scope.isEditFlg = false;
        }
      });
    };

    var dataBeforeChange = '';

    angular.element('#acc-summary').on('click',function (e) {

      if(!document.getElementById('txt-acc-notity-limit').contains(e.target) && !document.getElementById('save-btn').contains(e.target) && !document.getElementById('pencil-btn').contains(e.target)){
        $scope.$apply(function(){
          if($scope.isEditFlg == true){
            $scope.accountSummary.BalanceNotificationLimit = dataBeforeChange;
          }
          $scope.isEditFlg = false;
        })
      }else if(document.getElementById('save-btn').contains(e.target)){
        $scope.confirmEdit();
      }else if(document.getElementById('pencil-btn').contains(e.target)){
        $scope.onClickEditNotify();
        dataBeforeChange = $scope.accountSummary.BalanceNotificationLimit;
      }
    });

    $scope.onInputDown = function ($event) {

      if ($event.keyCode == 13) {
        $scope.confirmEdit();
      }
    };
  }
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('allWaiverFavorController', controller);

  controller.$inject = ['$rootScope', '$scope', '$state', 'util', '$timeout',
    'AmenityService', 'AccountService', 'ts_name', 'ts_field'];
  function controller($rootScope, $scope, $state, util, $timeout,
                      AmenityService, AccountService, ts_name, ts_field) {

    $scope.ts_name = ts_name;
    $scope.ts_field = ts_field;
    $scope.confirmModal = $('#waiver-favor-confirm-modal');
    $scope.successModal = $('#waiver-favor-success-modal');
    $scope.messageModal = $('#message-modal');

    $scope.confirmTicketInfo = [];
    $scope.forms = {};
    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: '',
      isValidFundOption: true,
      enableFund: true,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ? 1 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ? 1 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp ? 2 : 1) :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ? 1 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: 'SIP_All_waivers_and_favours__c'
    };

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;
      if ($scope.data.widgetFeature == 'confirm-waiver-favor') {

        if ($scope.data.selectedWF && $scope.data.charge.remark == '') {
          $scope.data.charge.remark = $scope.data.selectedWF.pnrRemarks;
        }

        $scope.populateConfirmTicketInfo();
        $scope.fundCheck();
      }
      else if ($scope.data.widgetFeature == 'apply-waiver-favor') {
        $scope.checkTicketSelection();
      }
    });

    /***********
     * apply waiver start
     ***********/
    $scope.selectAllClick = function () {

      if ($scope.data.PNR) {
        var sTickets = _.filter($scope.data.PNR.SalesReservationDetail.TicketInfo, function (t) {

          return _.toLower(t.IsSelectable) === 'true' || t.IsSelectable == true;
        });

        _.forEach(sTickets, function (t) {

          t.IsSelected = $scope.isSelectAll;
        });

        if ($scope.isSelectAll) {
          $scope.data.selectedPrimaryTicketCount = sTickets.length;
        }
        else {
          $scope.data.selectedPrimaryTicketCount = 0;
        }
      }
    };
    $scope.checkTicketSelection = function () {

      var sTickets = _.filter($scope.data.PNR.SalesReservationDetail.TicketInfo, function (t) {

        return _.toLower(t.IsSelectable) === 'true' || t.IsSelectable == true;
      });

      $scope.isSelectAll = (sTickets.length > 0) && sTickets.length == $scope.data.selectedPrimaryTicketCount;
    };
    $scope.selectableTicket = function (ticket) {

      if (_.toLower(ticket.IsSelectable) === 'true' || ticket.IsSelectable == true) {
        return true;
      }
      else {
        return false;
      }
    };
    $scope.notSelectableTicket = function (ticket) {

      if (_.toLower(ticket.IsSelectable) === 'true' || ticket.IsSelectable == true) {
        return false;
      }
      else {
        return true;
      }
    };
    $scope.toggleTicket = function (ticket) {

      if (ticket) {

        if (ticket.IsSelectable) {
          ticket.IsSelected = ticket.IsSelected ? false : true;
        }

        if (ticket.IsSelected) {
          $scope.data.selectedPrimaryTicketCount++;
          $scope.data.selectedTicketCount++;
        }
        else {
          $scope.data.selectedPrimaryTicketCount--;
          $scope.data.selectedTicketCount--;
        }

        _(ticket.ConjunctiveTickets).forEach(function (conjunctiveTicket) {

          conjunctiveTicket.IsSelected = ticket.IsSelected;
          if (conjunctiveTicket.IsSelected) {
            $scope.data.selectedTicketCount++;
          }
          else {
            $scope.data.selectedTicketCount--;
          }
        });

        $scope.checkTicketSelection();
      }
    };
    $scope.removeTicket = function (index) {

      $scope.confirmTicketInfo.splice(index, 1);
      $scope.data.selectedPrimaryTicketCount = 0;
      $scope.data.selectedTicketCount = 0;

      _.forEach($scope.data.PNR.SalesReservationDetail.TicketInfo, function (ticket) {

        if (ticket.IsSelected) {
          var isRemain = false;
          _.forEach($scope.confirmTicketInfo, function (tic) {

            if (ticket.TicketNumber == tic.TicketNumber) {
              isRemain = true;
              $scope.data.selectedPrimaryTicketCount++;
              $scope.data.selectedTicketCount++;
            }
          });
          ticket.IsSelected = isRemain;

          _(ticket.ConjunctiveTickets).forEach(function (conjunctiveTicket) {

            conjunctiveTicket.IsSelected = ticket.IsSelected;
            if (conjunctiveTicket.IsSelected) {
              $scope.data.selectedTicketCount++;
            }
          });
        }
      });

      $scope.fundCheck();
      $scope.checkTicketSelection();
    };
    $scope.addTicket = function () {

      $scope.confirmTicketInfo.push({"IsSelected": false});
      $scope.fundCheck();
    };

    $scope.applyWaiver = function () {

      $state.go($state.current.parent + '-all-waiver-favor', {feature: 'confirm-waiver-favor'});

      // if ($scope.data.selectedPrimaryTicketCount > 0) {
      //
      //   $rootScope.mainSpinner = true;
      //   AmenityService.proceedTickets(
      //     $scope.data.PNR
      //   ).then(function (value) {
      //
      //     $rootScope.mainSpinner = false;
      //     $scope.data.PNR = value;
      //     $state.go($state.current.parent + '-all-waiver-favor', {feature: 'confirm-waiver-favor'});
      //
      //   }, function (err) {
      //
      //     console.debug(err);
      //     $rootScope.mainSpinner = false;
      //     $rootScope.$broadcast('showMessage',
      //       {
      //         type: 'alert',
      //         text: 'Sorry, an error has occurred. Please contact United for further assistance.'
      //       });
      //   });
      // }
    };
    /***********
     * apply waiver end
     ***********/

    /***********
     * confirm waiver start
     ***********/
    $scope.populateConfirmTicketInfo = function () {

      $scope.currField = _.cloneDeep($scope.data.tsField);
      $scope.confirmTicketInfo = [];
      if ($scope.data.PNR) {
        _.forEach($scope.data.PNR.SalesReservationDetail.TicketInfo, function (ticket) {

          if (ticket.IsSelected) {
            $scope.confirmTicketInfo.push(ticket);
          }
        });
      }

      if ($scope.confirmTicketInfo.length == 0) {
        $scope.addTicket();

        // var tIndex = -1;
        // if ($scope.currField) {
        //   _.forEach($scope.currField.Fields, function (f, $index) {
        //
        //     if (f.Key == 'TicketNumber') {
        //       tIndex = $index;
        //       return false;
        //     }
        //   });
        //
        //   if (tIndex > -1) {
        //     $scope.currField.Fields.splice(tIndex, 1);
        //   }
        // }
      }
    };
    $scope.back = function () {

      $state.go($state.current.parent + '-all-waiver-favor', {feature: 'apply-waiver-favor'});
    };
    $scope.confirmWaiver = function () {

      if ($rootScope.IsImpersonation) {
        return;
      }

      var canConfirm = true;
      if ($scope.data.selectedWF.category == $scope.ts_name.seatAssignment ||
        $scope.data.selectedWF.category == $scope.ts_name.upgradeInventoryConversion ||
        $scope.data.selectedWF.category == $scope.ts_name.classConversion ||
        $scope.data.selectedWF.category == $scope.ts_name.fareMatch ||
        $scope.data.selectedWF.category == $scope.ts_name.guaranteeAirfareMissedTicketing) {

        _.forEach($scope.confirmTicketInfo, function (tInfo) {

          if (!tInfo.quantity || tInfo.quantity == 0) {
            canConfirm = false;
            return false;
          }
        })
      }

      if (canConfirm) {
        $scope.confirmModal.modal();
      }
      else {
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Please enter quantity for all line item(s).'
          });
      }
    };

    $scope.comfirmMessage = false;
    $scope.confirmApplyWaiver = function () {

      if ($scope.confirmTicketInfo.length > 0) {

        var comment = $scope.data.charge.comment;
        var remark = $scope.data.charge.remark;
        var payerId = $scope.data.charge.accSearchId;
        var beneficiaryId = $scope.data.charge.beneficiarySearchId;
        var callerId = '';
        var callerFirstName = '';
        var callerLastName = '';
        if ($scope.data.callerAccount) {
          callerId = $scope.data.callerAccount.accountId;
          callerFirstName = $scope.data.callerAccount.callerFirstName;
          callerLastName = $scope.data.callerAccount.callerLastName;
        }

        $rootScope.mainSpinner = true; // 1. recheck fund availability
        AccountService.getAccountById(
          payerId, $rootScope.currentUser.id
        ).then(function (value) {

          var fund = value.Fund;
          $rootScope.mainSpinner = false;
          if ($scope.confirmTicketInfo.length > 0 &&
            fund >= $scope.data.charge.chargeAmount) {

            $rootScope.mainSpinner = true; // 2. send request to confirm waiver
            $scope.data.PNR.SalesReservationDetail.tickets = $scope.confirmTicketInfo;
            AmenityService.confirmAllTravelerServices(
              $scope.data.PNR,
              $rootScope.currentUser.id,
              payerId,
              beneficiaryId,
              callerId,
              $scope.data.selectedWF.productCode,
              comment,
              callerFirstName,
              callerLastName,
              remark
            ).then(function (value) {

              $rootScope.mainSpinner = false;
              if (value.errors && value.errors.length > 0) {
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: value.errors[0]
                  });
              }
              else {
                $scope.data.transactionEntity = value;
                $scope.confirmModal.modal('hide');
                $scope.successModal.modal();

                $scope.canDismiss = true;
                if ($rootScope.currentUser.isInternalUser) {
                  $scope.canDismiss = false;
                }

                $scope.waiverCode = $scope.data.transactionEntity.ticketInfos[0].waiverFavorId;
                $scope.data.remarkMessage = '';
                AmenityService.sendRemarks(
                  $scope.data.PNR,
                  $rootScope.currentUser.id,
                  $scope.waiverCode,
                  $scope.data.selectedWF.productCode,
                  remark
                ).then(function (value) {

                  if (value.success) {
                    if (value.messages.length > 0) {
                      $scope.data.remarkMessage = value.messages[0];
                    }
                  }
                  else {
                    $scope.data.remarkMessage = 'Failed to send remarks. Please document the record in EZR.';
                  }
                  $scope.canDismiss = true;
                }, function (err) {

                  $scope.data.remarkMessage = 'Failed to send remarks. Please document the record in EZR.';
                  $scope.canDismiss = true;
                });
              }
            }, function (err) {

              $rootScope.mainSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: err
                });
            });
          }
          else {
            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Insufficient funds, please select another account.'
              });
          }
        }, function (err) {

          console.debug(err);
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        });
      }
    };
    $scope.fundCheck = function () {

      if ($scope.data.selectedWF) {
        if ($scope.data.selectedWF.category == $scope.ts_name.advancePurchase) {
          var total = 0;
          _.forEach($scope.confirmTicketInfo, function (ticket) {

            ticket.customAmount = 0;
            if (_.isNumber(ticket.qualifyingFare) && _.isNumber(ticket.requestFare)) {
              ticket.customAmount = ticket.qualifyingFare - ticket.requestFare;
            }
            total += ticket.customAmount;
          });
          $scope.data.charge.chargeAmount = total;
        }
        else if ($scope.data.selectedWF.category == $scope.ts_name.offshoreCtoAgentError) {
          var total = 0;
          _.forEach($scope.confirmTicketInfo, function (ticket) {

            if (_.isNumber(ticket.customAmount)) {
              total += ticket.customAmount;
            }
          });
          $scope.data.charge.chargeAmount = total;
        }
        else if ($scope.data.selectedWF.category == $scope.ts_name.seatAssignment ||
          $scope.data.selectedWF.category == $scope.ts_name.upgradeInventoryConversion ||
          $scope.data.selectedWF.category == $scope.ts_name.classConversion ||
          $scope.data.selectedWF.category == $scope.ts_name.fareMatch ||
          $scope.data.selectedWF.category == $scope.ts_name.guaranteeAirfareMissedTicketing) {
          var total = 0;
          _.forEach($scope.confirmTicketInfo, function (ticket) {

            if (_.isNumber(ticket.quantity)) {
              ticket.customAmount = $scope.data.selectedWF.price * ticket.quantity;
            }
            else {
              ticket.customAmount = 0;
            }
            total += ticket.customAmount;
          });
          $scope.data.charge.chargeAmount = total;
        }
        else {
          $scope.data.charge.chargeAmount = $scope.confirmTicketInfo.length * $scope.data.selectedWF.price;
        }
        $rootScope.$broadcast('fundCheck', {});
      }
      else {
        $scope.data.charge.chargeAmount = '';
      }
    };

    $scope.lineStringValChanged = function ($event) {

    };
    $scope.lineNumberValChanged = function ($event) {

      $timeout(function () {
        $scope.fundCheck();
      }, 100);
    };
    $scope.messageModal.on('hidden.bs.modal', function (e) {

      if ($scope.comfirmMessage) {
        $scope.comfirmMessage = false;

        $scope.fundCheck();
      }
    });
    /***********
     * confirm waiver end
     ***********/

    /***********
     * clipboard start
     ***********/
    $scope.initCopyToClipboard = function (el) {

      var id = 'wc-' + el.ticketNumber + el.waiverFavorId;
      var element = document.getElementById(id);

      if (document.body.createTextRange) { // ie

        $('.copied').removeClass('copied');
        $(element).addClass("copied");
        window.clipboardData.setData('Text', element.innerHTML);
      }
      else if (window.getSelection) { // moz, opera, webkit

        var selection = window.getSelection();
        var range = document.createRange();
        range.selectNodeContents(element);
        selection.removeAllRanges();
        selection.addRange(range);
        document.execCommand("Copy");
      }
      document.body.onclick = function (e) {

        if ($(e.target.previousElementSibling).attr("id") === id) {
          return;
        }
        $(element).removeClass("copied");
      };
    };
    /***********
     * clipboard end
     ***********/

    /***********
     * email start
     ***********/
    // $scope.popup = {
    //   sendMeEmail: false,
    //   sendOtherEmail: false,
    //   otherEmailAddr: '',
    //   isInvalidEmail: false
    // };
    $scope.dismissWaiver = function () {

      $scope.successModal.modal('hide');
      // if ($scope.popup.sendMeEmail) {
      //   AmenityService.sendEmail(
      //     $rootScope.currentUser.id,
      //     $scope.data.transactionEntity.referenceNumber
      //   ).then(function () {
      //
      //     $scope.successModal.modal('hide');
      //   }, function (err) {
      //
      //     console.debug(err);
      //     $scope.successModal.modal('hide');
      //   })
      // }
      // else {
      //   $scope.successModal.modal('hide');
      // }
    };
    /***********
     * email end
     ***********/

    $scope.successModal.on('hidden.bs.modal', function (e) {

      $state.go($state.current.parent + '-home', {feature: 'init'});
    });

    $scope.goHome = function () {

      $rootScope.$broadcast('goHome', {needConfirm: true});
    };
  }
})();
(function () {
  'use strict';

  angular.module('bankingModule')
    .directive('amenityWidget', [function () {

      var widgetController = ['$rootScope', '$scope', '$window', '$timeout', '$state', '$stateParams', 'util',
        'PNRService', 'ProductService', 'AccountService', 'UnitedClubService', 'BonusMilesService',
        'UpgradeService', 'StatusNominationService', 'TravelCertificateService',
        'AmenityService', 'ts_name', 'ts_field',
        function ($rootScope, $scope, $window, $timeout, $state, $stateParams, util,
                  PNRService, ProductService, AccountService, UnitedClubService, BonusMilesService,
                  UpgradeService, StatusNominationService, TravelCertificateService,
                  AmenityService, ts_name, ts_field) {

          $scope.consentAgreed = $rootScope.currentUser.permission.SIP_Amenity_Consent__c ||
            $rootScope.currentUser.isInternalUser ||
            $rootScope.IsImpersonation;

          $scope.reviewConsent = function () {

            $rootScope.isAmenityConsent = true;
            $state.go('login-stopover')
          };

          $scope.amenityPermission = $rootScope.currentUser.permission.SIP_Penalty_Waiver__c ||
            $rootScope.currentUser.permission.SIP_All_waivers_and_favours__c ||
            $rootScope.currentUser.permission.SIP_Economy_Plus__c ||
            $rootScope.currentUser.permission.SIP_Bonus_Miles__c ||
            $rootScope.currentUser.permission.SIP_Travel_Certificates__c ||
            $rootScope.currentUser.permission.SIP_Regional_Premier_Upgrades__c ||
            $rootScope.currentUser.permission.SIP_Global_Premier_Upgrades__c ||
            $rootScope.currentUser.permission.SIP_United_Club_Membership__c ||
            $rootScope.currentUser.permission.SIP_United_Club_Passes__c ||
            $rootScope.currentUser.permission.SIP_Silver_Status_Nominations__c ||
            $rootScope.currentUser.permission.SIP_Gold_Status_Nominations__c ||
            $rootScope.currentUser.permission.SIP_Platinum_Status_Nominations__c ||
            $rootScope.currentUser.permission.SIP_1K_Status_Nominations__c ||
            $rootScope.currentUser.permission.SIP_Global_Service_Status_Nominations__c ||
            $rootScope.currentUser.permission.SIP_Beverage_Vouchers__c;

          $scope.bankingPermission = $rootScope.currentUser.permission.SIP_Account_Summary__c ||
            $rootScope.currentUser.permission.SIP_Funds_Transfer__c || $rootScope.currentUser.permission.SIP_Funds_Transfer_Reserved_Account__c;

          $scope.edPermission = $rootScope.currentUser.permission.SIP_Executive_Desk_Related_Access__c;
          $scope.specialLoad = $rootScope.currentUser.isInternalUser &&
            ($rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ||
            $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c);

          // Ryan: testing purpose
          // $scope.edPermission = true;
          // $scope.specialLoad = false;
          // $scope.amenityPermission = true;
          // $scope.bankingPermission = true;
          // $scope.consentAgreed = true;
          // $rootScope.currentUser.permission.SIP_Summary_Report__c = false;
          // $rootScope.currentUser.permission.SIP_Banking_Transactional_Reports__c = false;

          // for EZR / ED
          $scope.datasource.callerAccount = {};
          $scope.ezr = {
            accountnumber: $rootScope.getQueryString('accountnumber'),
            recordlocator: $rootScope.getQueryString('recordlocator'),
            mpnumber: $rootScope.getQueryString('mpnumber')
          };

          $scope.wfSearchValue = '';
          $scope.listLimitTo = 500;
          $scope.amenityOrBanking = '';
          $scope.amenityTargetDisplaySteps = [
            'amenity',
            'amenity-fee-waivers',
            'amenity-ep-seat-assignment',
            'amenity-united-club',
            'amenity-united-club-membership',
            'amenity-united-club-otp',
            'amenity-status-nomination',
            'amenity-upgrades',
            'amenity-bonus-miles',
            'amenity-all-waivers-favors'
          ];
          $scope.widget = $('#amenity-widget');
          $scope.optionDiv = $scope.widget.find('#amenity-option');
          $scope.resetStep = 'init';
          $scope.datasource = $scope.datasource || {};
          $scope.datasource.widgetFeature = $stateParams.feature;

          $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

            $scope.wfSearchValue = '';
            $scope.tooltips = -1;
            $scope.widgetSpinner = false;
            $scope.datasource.widgetFeature = toParams.feature;

            if ($scope.datasource.widgetFeature == 'init') {
              $scope.initWidget();
            }

            if ($scope.datasource.widgetFeature == 'amenity') {
              if ($scope.datasource.preSelectedAccount &&
                $scope.datasource.preSelectedAccount.accountId) {
                _($scope.optionDiv.find('.col-xs-6.col-sm-3')).forEach(function (tile) {
                  $(tile).show();
                  $(tile).addClass('animate-scale-up');
                });
              }
              else {
                $scope.reset();
              }
            }

            if ($scope.datasource.widgetFeature == 'amenity-upgrades') {
              if ($scope.upgradesForm.txtUpgradeAccount) {
                $timeout(function () {
                  $scope.upgradesForm.txtUpgradeAccount.$validate();
                }, 1000);
              }
            }
          });

          $scope.getAccClass = function (accType) {

            var result;
            switch (accType) {
              case $rootScope.ACC_TYPE.agency:
              case $rootScope.ACC_TYPE.agencyBranch:
                result = 'agency';
                break;
              case $rootScope.ACC_TYPE.resv:
                result = 'reserved';
                break;
              case $rootScope.ACC_TYPE.corp:
              case $rootScope.ACC_TYPE.aor:
                result = 'corporate';
                break;
              case $rootScope.ACC_TYPE.dis:
                result = 'dis';
                break;
              default:
                result = '';
                break;
            }
            return result;
          };
          $scope.getAccSymbol = function (accType) {

            var result;
            switch (accType) {
              case $rootScope.ACC_TYPE.agency:
                result = 'H';
                break;
              case $rootScope.ACC_TYPE.agencyBranch:
                result = 'A';
                break;
              case $rootScope.ACC_TYPE.resv:
                result = 'R';
                break;
              case $rootScope.ACC_TYPE.corp:
              case $rootScope.ACC_TYPE.aor:
                result = 'C';
                break;
              case $rootScope.ACC_TYPE.dis:
                result = 'D';
                break;
              default:
                result = '';
                break;
            }
            return result;
          };
          $scope.getAccTitle = function (accType) {

            var result;
            switch (accType) {
              case $rootScope.ACC_TYPE.agency:
                result = 'HOL';
                break;
              case $rootScope.ACC_TYPE.agencyBranch:
                result = 'Agency';
                break;
              case $rootScope.ACC_TYPE.resv:
                result = 'Reserved';
                break;
              case $rootScope.ACC_TYPE.corp:
              case $rootScope.ACC_TYPE.aor:
                result = 'Corporate';
                break;
              case $rootScope.ACC_TYPE.dis:
                result = 'Discretionary';
                break;
              default:
                result = '';
                break;
            }
            return result;
          };

          $scope.purgePreSelectedAccount = function () {

            $scope.datasource.preSelectedAccount = {
              accountId: '',
              accountName: '',
              typeName: '',
              extId: '',
              balance: 0,
              instrument: 0,
              globalService: 0,
              isTestAccount: false,
              bankingBalanceAccess: false,
              mileagePlusNumberOfCompany: '',
              comment: ''
            };
            $scope.accountSymbol = '';
          };
          $scope.purgeCallerAccount = function (isPurgeName) {

            if (!$scope.datasource.callerAccount) {
              $scope.datasource.callerAccount = {};
            }

            $scope.datasource.callerAccount.accountId = '';
            $scope.datasource.callerAccount.accountName = '';
            $scope.datasource.callerAccount.typeName = '';
            $scope.datasource.callerAccount.extId = '';
            if (isPurgeName) {
              $scope.datasource.callerAccount.callerFirstName = '';
              $scope.datasource.callerAccount.callerLastName = '';
            }
          };
          $scope.clearContext = function (isClearCompanyAgency) {

            // fee waiver / economy plus
            $scope.pnrSearchValue = '';
            $scope.pnrSearchNameValue = '';

            // united club
            $scope.membershipLastName = '';
            $scope.membershipMPlusNumber = '';
            $scope.otpLastName = '';
            $scope.otpMPlusNumber = '';
            $scope.otpCount = '';
            $scope.otpEmail = '';
            $scope.otpEmailConfirm = '';
            $scope.otpEmailCount = '';

            // status nomination
            $scope.snMPlusNumber = '';
            $scope.snLastName = '';

            // upgrades
            $scope.upgradeAccount = {};

            //Bonus Miles
            $scope.milePlusNum_bm = '';
            $scope.lastName_bm = '';

            // p.s.... add all widget search variable

            if ($scope.edPermission) {

              if ($scope.ezr.recordlocator) {
                $scope.pnrSearchValue = $scope.ezr.recordlocator;
              }
              if ($scope.ezr.mpnumber) {
                $scope.membershipMPlusNumber = $scope.ezr.mpnumber;
                $scope.otpMPlusNumber = $scope.ezr.mpnumber;
                $scope.snMPlusNumber = $scope.ezr.mpnumber;
                $scope.milePlusNum_bm = $scope.ezr.mpnumber;
              }
            }

            if ($scope.datasource) {
              // fee waiver
              $scope.datasource.pnrSearchValue = '';
              $scope.datasource.pnrSearchNameValue = '';
              $scope.datasource.PNR = {};
              $scope.datasource.selectedPrimaryTicketCount = 0;
              $scope.datasource.selectedTicketCount = 0;
              $scope.datasource.selectedTicketNumber = [];
              $scope.datasource.transactionEntity = {};

              // united club
              $scope.datasource.membershipData = {};
              $scope.datasource.otpMembershipData = {};
              $scope.datasource.otpEmailData = {};

              // status nomination
              $scope.datasource.statusNomData = {};

              // upgrades
              $scope.datasource.upgradeData = {};

              // bonus Miles
              $scope.datasource.bonusMilesData = {};

              //beverage coupons
              $scope.datasource.beverageCouponsData = {};

              //travel certificate
              $scope.datasource.travelCertificateData = {};

              // all waivers favors
              $scope.datasource.selectedWF = '';
            }

            if (isClearCompanyAgency) {
              $scope.isValidAccount = false;
              $scope.amenitySearchValue = '';
              $scope.bankingSearchValue = '';
              $scope.callerSearchValue = '';
              if ($scope.datasource) {
                $scope.purgePreSelectedAccount();
                $scope.purgeCallerAccount(true);
              }
            }
          };
          $scope.clearContext(true);
          $scope.reset = function () {

            $scope.clearContext(true);
            $state.go('secure-landing-home', {
              feature: $scope.resetStep
            });
          };
          $scope.resetOption = function () {

            $scope.clearContext();
            $state.go('secure-landing-home', {
              feature: 'amenity'
            });
          };
          $scope.nextStep = function ($event) {

            //abe modify amenity widget permission based on currentuser and account.
            $scope.amenityWidgetAccessPermission = {
              PenaltyWaiver: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                $scope.datasource.preSelectedAccount.accountTilePermission.PenaltyWaiver :
                ($rootScope.currentUser.permission.SIP_Penalty_Waiver__c &&
                $scope.datasource.preSelectedAccount.accountTilePermission.PenaltyWaiver),

              AllWaiversAndFavours: $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr ?
                true :
                $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor ?
                  $scope.datasource.preSelectedAccount.accountTilePermission.AllWaiversAndFavours :
                  ($rootScope.currentUser.permission.SIP_All_waivers_and_favours__c &&
                  $scope.datasource.preSelectedAccount.accountTilePermission.AllWaiversAndFavours),

              EconomyPlus: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                $scope.datasource.preSelectedAccount.accountTilePermission.EconomyPlus :
                ($rootScope.currentUser.permission.SIP_Economy_Plus__c &&
                $scope.datasource.preSelectedAccount.accountTilePermission.EconomyPlus),

              BonusMiles: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                $scope.datasource.preSelectedAccount.accountTilePermission.BonusMiles :
                ($rootScope.currentUser.permission.SIP_Bonus_Miles__c &&
                $scope.datasource.preSelectedAccount.accountTilePermission.BonusMiles),

              TravelCertificates: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                $scope.datasource.preSelectedAccount.accountTilePermission.TravelCertificates :
                ($rootScope.currentUser.permission.SIP_Travel_Certificates__c &&
                $scope.datasource.preSelectedAccount.accountTilePermission.TravelCertificates),

              Upgrades: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                ($scope.datasource.preSelectedAccount.accountTilePermission.RegionalPremierUpgrades ||
                $scope.datasource.preSelectedAccount.accountTilePermission.GlobalPremierUpgrades) :
              ($rootScope.currentUser.permission.SIP_Regional_Premier_Upgrades__c &&
              $scope.datasource.preSelectedAccount.accountTilePermission.RegionalPremierUpgrades) ||
              ($rootScope.currentUser.permission.SIP_Global_Premier_Upgrades__c &&
              $scope.datasource.preSelectedAccount.accountTilePermission.GlobalPremierUpgrades),

              UnitedClubMembership: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                $scope.datasource.preSelectedAccount.accountTilePermission.UnitedClubMembership :
                ($rootScope.currentUser.permission.SIP_United_Club_Membership__c &&
                $scope.datasource.preSelectedAccount.accountTilePermission.UnitedClubMembership),

              UnitedClubPasses: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                $scope.datasource.preSelectedAccount.accountTilePermission.UnitedClubPasses :
                ($rootScope.currentUser.permission.SIP_United_Club_Passes__c &&
                $scope.datasource.preSelectedAccount.accountTilePermission.UnitedClubPasses),

              TicketSuspension: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                $scope.datasource.preSelectedAccount.accountTilePermission.TicketSuspension :
                ($rootScope.currentUser.permission.SIP_Ticket_Suspension__c &&
                $scope.datasource.preSelectedAccount.accountTilePermission.TicketSuspension),

              Nominations: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                ($scope.datasource.preSelectedAccount.accountTilePermission.SilverStatusNominations ||
                $scope.datasource.preSelectedAccount.accountTilePermission.GoldStatusNominations ||
                $scope.datasource.preSelectedAccount.accountTilePermission.PlatinumStatusNominations ||
                $scope.datasource.preSelectedAccount.accountTilePermission.KStatusNominations ||
                $scope.datasource.preSelectedAccount.accountTilePermission.GlobalServiceStatusNominations) :
              ($rootScope.currentUser.permission.SIP_Silver_Status_Nominations__c &&
              $scope.datasource.preSelectedAccount.accountTilePermission.SilverStatusNominations) ||
              ($rootScope.currentUser.permission.SIP_Gold_Status_Nominations__c &&
              $scope.datasource.preSelectedAccount.accountTilePermission.GoldStatusNominations) ||
              ($rootScope.currentUser.permission.SIP_Platinum_Status_Nominations__c &&
              $scope.datasource.preSelectedAccount.accountTilePermission.PlatinumStatusNominations) ||
              ($rootScope.currentUser.permission.SIP_1K_Status_Nominations__c &&
              $scope.datasource.preSelectedAccount.accountTilePermission.KStatusNominations) ||
              ($rootScope.currentUser.permission.SIP_Global_Service_Status_Nominations__c &&
              $scope.datasource.preSelectedAccount.accountTilePermission.GlobalServiceStatusNominations),

              BeverageVouchers: (($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agent ||
              $rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.agtMgr) &&
              $scope.datasource.preSelectedAccount.typeName == $rootScope.ACC_TYPE.aor) ?
                $scope.datasource.preSelectedAccount.accountTilePermission.BeverageVouchers :
                ($rootScope.currentUser.permission.SIP_Beverage_Vouchers__c &&
                $scope.datasource.preSelectedAccount.accountTilePermission.BeverageVouchers)
            };

            var feature = $stateParams.feature;
            var next;
            switch (feature) {
              case 'init' :
                $scope.clearContext();
                next = 'amenity';

                $scope.travelerServices = [];
                AccountService.getCategoriesByAccountId(
                  $scope.datasource.preSelectedAccount.accountId
                ).then(function (value) {

                  $scope.travelerServices = value;
                  $scope.travelerServices = _.orderBy($scope.travelerServices, ['name'], ['asc']);
                });

                $state.go('secure-landing-home', {
                  feature: next
                });
                break;
              case 'amenity' :
                next = $event.currentTarget.id;
                if (next === 'amenity-learn-more') {
                  var pdf = $rootScope.currentUser.profileName === $rootScope.PROFILE_TYPE.corp ?
                    '/resource/1499498488000/Sip_United_Services_Fund_Corporate' :
                    '/resource/1491022983000/Sip_United_Services_Fund_TMC';
                  $window.open(pdf, '_blank');
                }
                else {
                  $scope.clearContext();

                  if (next == 'amenity-upgrades') {

                    var found = false;
                    _.forEach($scope.upgradeAccounts, function (uAcc) {

                      if (uAcc.Name === $scope.amenitySearchValue) {
                        found = true;
                      }
                    });

                    if (!found) {
                      $scope.upgradeAccounts = [{
                        'Id': $scope.datasource.preSelectedAccount.accountId,
                        'Name': $scope.datasource.preSelectedAccount.accountName,
                        'ExtId': $scope.datasource.preSelectedAccount.extId,
                        'AccountType': $scope.datasource.preSelectedAccount.typeName,
                        'BankingBalanceAccess': $scope.datasource.preSelectedAccount.bankingBalanceAccess,
                        'Fund': $scope.datasource.preSelectedAccount.balance,
                        'Instrument': $scope.datasource.preSelectedAccount.instrument,
                        'GlobalService': $scope.datasource.preSelectedAccount.globalService,
                        'IsTestAccount': $scope.datasource.preSelectedAccount.isTestAccount,
                        'MileagePlusNumberOfCompany': $scope.datasource.preSelectedAccount.mileagePlusNumberOfCompany
                      }];
                    }
                  }

                  $state.go('secure-landing-home', {
                    feature: next
                  });
                }
                break;
              default :
                next = $event.currentTarget.id;
                $state.go('secure-landing-home', {
                  feature: next
                });
                break;
            }
          };
          $scope.back = function () {

            var feature = $stateParams.feature;
            var prev;

            switch (feature) {
              case 'amenity-united-club-membership':
              case 'amenity-united-club-otp':
                prev = 'amenity-united-club';
                break;
              default:
                prev = 'amenity';
                break;
            }

            $state.go('secure-landing-home', {
              feature: prev
            });
          };
          $scope.initWidget = function () {

            var initOption = !$scope.amenityPermission && $scope.bankingPermission ? 'banking' : 'amenity';
            $scope.amenityOrBankingToggle(initOption);
            $scope.reset();

            $scope.getAmenityAccounts();
            $scope.getBankingAccounts();
            $scope.getCallerAccounts();
            $scope.getUpgradeAccountList(true);
          };

          $scope.getUpgradeAccountList = function (skipSpinner) {

            var searchValue = '';
            if ($scope.specialLoad && $scope.amenitySearchValue.length >= 1) {
              searchValue = $scope.amenitySearchValue;
            }
            var extId = '';
            if ($scope.datasource.callerAccount.extId) {
              extId = $scope.datasource.callerAccount.extId;
            }
            $scope.upgradeAccounts = [];

            if (!skipSpinner) {
              $scope.widgetSpinner = true;
            }
            AccountService.getAccountsForUpgrades(
              $rootScope.currentUser.id, searchValue, extId
            ).then(function (value) {
              if (value.Accounts.length == 0 && searchValue != '') {
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'No results found. Please change your search parameters and try again.'
                  });
              }

              if (!skipSpinner) {
                $scope.widgetSpinner = false;
              }
              $scope.upgradeAccounts = value.Accounts;
            }, function (err) {

              if (!skipSpinner) {
                $scope.widgetSpinner = false;
              }
              console.debug(err);
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };

          $scope.getAmenityAccounts = function (txtId) {

            var searchValue = '';
            if ($scope.specialLoad && $scope.amenitySearchValue.length >= 1) {
              searchValue = $scope.amenitySearchValue;
            }
            var extId = '';
            if ($scope.datasource.callerAccount.extId) {
              extId = $scope.datasource.callerAccount.extId;
            }

            $scope.aAccountList = [];
            $scope.widgetSpinner = true;
            AccountService.getAccounts(
              $rootScope.currentUser.id, '', searchValue, extId
            ).then(function (value) {
              if (value.Accounts.length == 0 && searchValue != '') {
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'No results found. Please change your search parameters and try again.'
                  });
              }
              $scope.widgetSpinner = false;
              $scope.aAccountList = value.Accounts;
              if (txtId) {
                $('#' + txtId).dropdown('toggle');
              }
            }, function (err) {

              console.debug(err);
              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };
          $scope.getBankingAccounts = function () {

            $scope.bAccountList = [];
            AccountService.getFromAccountsForFundsTx(
              $rootScope.currentUser.id, $rootScope.currentUser.accId
            ).then(function (value) {

              $scope.bAccountList = value.Accounts;
            }, function (err) {

              console.debug(err);
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };
          $scope.getCallerAccounts = function (txtId) {

            $scope.cAccountList = [];

            if ($scope.edPermission) {
              if ($scope.callerSearchValue && $scope.callerSearchValue.length >= 1) {

                $scope.widgetSpinner = true;
                AccountService.getAccounts(
                  $rootScope.currentUser.id, '', $scope.callerSearchValue, ''
                ).then(function (value) {
                  if (value.Accounts.length == 0 && $scope.callerSearchValue != '') {
                    $rootScope.$broadcast('showMessage',
                      {
                        type: 'alert',
                        text: 'No results found. Please change your search parameters and try again.'
                      });
                  }

                  $scope.widgetSpinner = false;
                  var accs = value.Accounts;

                  // remove discretionary account from list
                  $scope.cAccountList = accs.filter(function (item) {
                    return item.AccountType !== $rootScope.ACC_TYPE.dis;
                  });

                  if (txtId) {
                    $('#' + txtId).dropdown('toggle');
                  }
                }, function (err) {

                  console.debug(err);
                  $scope.widgetSpinner = false;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
              }
              else if ($scope.ezr.accountnumber) {

                // ed: populate caller account from query string
                AccountService.getAccountByIATA(
                  $scope.ezr.accountnumber,
                  $rootScope.currentUser.id
                ).then(function (value) {

                  // 1) get caller account
                  var callerAccount = value;

                  if (callerAccount.Id) {

                    // 2) add into list
                    $scope.cAccountList.push(callerAccount);

                    // 3) populate variable
                    $scope.datasource.callerAccount.accountId = callerAccount.Id;
                    $scope.datasource.callerAccount.accountName = callerAccount.Name;
                    $scope.datasource.callerAccount.typeName = callerAccount.AccountType;
                    $scope.datasource.callerAccount.extId = callerAccount.ExtId;
                    $scope.callerSearchValue = callerAccount.Name;

                    // 4) reload amenity account based on caller account .....
                    $scope.getAmenityAccounts();
                  }
                  else {
                    // 5) display only discretionary account
                    $scope.datasource.callerAccount.accountId = '';
                    $scope.datasource.callerAccount.accountName = '';
                    $scope.datasource.callerAccount.typeName = '';
                    $scope.datasource.callerAccount.extId = '';
                    $scope.getAmenityAccounts();
                  }
                }, function (err) {

                  console.debug(err);
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
              }
            }
          };
          $scope.amenityOrBankingToggle = function (type) {

            switch (type) {
              case 'amenity':
                if ($scope.amenityOrBanking != 'amenity') {
                  $scope.amenityOrBanking = 'amenity';
                  $scope.syncB2ASelection();
                }
                break;

              case 'banking':
                if ($scope.amenityOrBanking != 'banking') {
                  $scope.amenityOrBanking = 'banking';
                  $scope.syncA2BSelection();
                }
                break;
            }
          };
          $scope.syncA2BSelection = function () {

            if ($scope.datasource.preSelectedAccount &&
              $scope.datasource.preSelectedAccount.accountId) {

              var recordFound = false;
              _($scope.bAccountList).forEach(function (listItem) {

                if (listItem.Id === $scope.datasource.preSelectedAccount.accountId) {
                  $scope.bankingSearchValue = listItem.Name;
                  recordFound = true;
                  return false;
                }
              });

              if (!recordFound) {
                $scope.purgePreSelectedAccount();
              }
            }
            else {
              $scope.bankingSearchValue = '';
            }
          };
          $scope.syncB2ASelection = function () {

            if ($scope.datasource.preSelectedAccount &&
              $scope.datasource.preSelectedAccount.accountId) {

              var recordFound = false;
              _($scope.aAccountList).forEach(function (listItem) {

                if (listItem.Id === $scope.datasource.preSelectedAccount.accountId) {
                  $scope.amenitySearchValue = listItem.Name;
                  recordFound = true;
                  return false;
                }
              });

              if (!recordFound) {
                $scope.purgePreSelectedAccount();
              }
            }
            else {
              $scope.amenitySearchValue = '';
            }
          };
          $scope.bankingAccSummary = function () {

            if ($rootScope.currentUser.permission.SIP_Account_Summary__c) {
              $state.go($state.current.parent + '-banking-account-summary', {
                feature: 'banking-summary'
              });
            } else {
              $scope.bankingFundTransfer();
            }
          };
          $scope.bankingFundTransfer = function () {

            $state.go($state.current.parent + '-banking-fund-transfer', {
              feature: 'apply-fund-transfer'
            });
          };

          //Jason changed 20170622
          $scope.tsFieldCatalog = [
            {
              Category: ts_name.advancePurchase,
              Fields: [
                ts_field.TicketNumber,
                ts_field.qualifyingFare,
                ts_field.requestFare,
                ts_field.cityPair,
                ts_field.domesticOrInternational
              ]
            },
            {
              Category: ts_name.classConversion,
              Fields: [
                ts_field.TicketNumber,
                ts_field.marketingFlightNumber,
                ts_field.originalBookingClass,
                ts_field.newBookingClass,
                ts_field.cityPair,
                ts_field.quantity
              ]
            },
            {
              Category: ts_name.extendEticketValidity,
              Fields: [
                ts_field.TicketNumber
              ]
            },
            {
              Category: ts_name.fareMatch,
              Fields: [
                ts_field.TicketNumber,
                ts_field.matchedAirline,
                ts_field.matchedFare,
                ts_field.fareBasis,
                ts_field.cityPair,
                ts_field.quantity
              ]
            },
            {
              Category: ts_name.guaranteeAirfareMissedTicketing,
              Fields: [
                ts_field.TicketNumber,
                ts_field.originalFare,
                ts_field.oldFareBasis,
                ts_field.cityPair,
                ts_field.quantity
              ]
            },
            {
              Category: ts_name.nameChange,
              Fields: [
                ts_field.TicketNumber,
                ts_field.oldName,
                ts_field.newName
              ]
            },
            {
              Category: ts_name.nameCorrection,
              Fields: [
                ts_field.TicketNumber,
                ts_field.oldName,
                ts_field.newName
              ]
            },
            {
              Category: ts_name.offshoreCtoAgentError,
              Fields: [
                ts_field.TicketNumber,
                ts_field.descOfError,
                ts_field.waiverType,
                ts_field.customAmount
              ]
            },
            {
              Category: ts_name.offshoreCtoFees,
              Fields: [
                ts_field.TicketNumber,
                ts_field.reason
              ]
            },
            {
              Category: ts_name.penaltyWaiverAndNameChange,
              Fields: [
                ts_field.TicketNumber,
                ts_field.oldName,
                ts_field.newName
              ]
            },
            {
              Category: ts_name.refundDuplicateTicket,
              Fields: [
                ts_field.TicketNumber
              ]
            },
            {
              Category: ts_name.reissuePenaltyFee,
              Fields: [
                ts_field.TicketNumber
              ]
            },
            {
              Category: ts_name.seatAssignment,
              Fields: [
                ts_field.TicketNumber,
                ts_field.SeatNumbers,
                ts_field.quantity
              ]
            },
            {
              Category: ts_name.suspendedTicket,
              Fields: [
                ts_field.TicketNumber
              ]
            },
            {
              Category: ts_name.ticketRevalidation,
              Fields: [
                ts_field.TicketNumber
              ]
            },
            {
              Category: ts_name.timeStay,
              Fields: [
                ts_field.TicketNumber,
                ts_field.originalReturnDate,
                ts_field.newReturnDate
              ]
            },
            {
              Category: ts_name.upgradeInventoryConversion,
              Fields: [
                ts_field.TicketNumber,
                ts_field.marketingFlightNumber,
                ts_field.originalBookingClass,
                ts_field.newBookingClass,
                ts_field.cityPair,
                ts_field.quantity
              ]
            }
          ];

          $scope.selectTravelerService = function (type) {

            $scope.clearContext();
            $scope.datasource.selectedWF = type;

            $scope.datasource.tsField = null;
            _.forEach($scope.tsFieldCatalog, function (c) {

              if (c.Category == type.category) {
                $scope.datasource.tsField = c;
                return false;
              }
            });

            if ($scope.datasource.tsField) {
              $state.go('secure-landing-home', {
                feature: 'amenity-all-waivers-favors'
              });
            }
          };

          /***********
           * account fund search start
           ***********/
          $scope.amenityInit = $scope.widget.find('#amenity-init');
          $scope.isValidAccount = false;
          $scope.txtAccountKeyup = function ($event) {

            switch ($event.keyCode) {
              case 13 : // enter key trigger search
                var txt = $event.target;
                $(txt).dropdown('toggle');
                $scope.searchAccount(txt.id);
                break;

              case 40 :
                var txt = $event.target;
                var ddl = $(txt).attr('aria-describedby');
                var li = $('#' + ddl).find('li:first');
                if (li.hasClass('list-limit-exceeded')) {
                  li = li.next();
                }
                li.focus();
                break;

              default:
                var txtId = $event.target.id;
                switch (txtId) {
                  case 'txt-caller-account':
                    $scope.purgeCallerAccount();
                    break;

                  case 'txt-amenity-account' :
                  case 'txt-upgrade-account' :
                  case 'txt-banking-account' :
                  case 'txt-banking-account-mini' :
                    $scope.purgePreSelectedAccount();
                    $scope.checkAccount();
                    break;
                }
                break;
            }
          };
          $scope.ddlAccountKeyup = function ($event) {

            switch ($event.keyCode) {
              case 38 :
                var prev = $($event.target).prev();
                if (prev.length > 0) {
                  prev.focus();
                }
                break;

              case 40 :
                var next = $($event.target).next();
                if (next.length > 0) {
                  next.focus();
                }
                break;
            }
          };

          //make the amenity input disabled when the caller input is invalid
          $scope.$watch('callerSearchValue', function () {
            if ($scope.edPermission) {
              var validFlg = false;
              _($scope.cAccountList).forEach(function (item) {
                if (item.Name == $scope.callerSearchValue) {
                  validFlg = true;
                }
              });

              if ($scope.callerSearchValue && validFlg) {
                $('#txt-amenity-account').prop('disabled', false);
                $('#txt-amenity-account').prop('readonly', false);
              } else {
                $('#txt-amenity-account').prop('disabled', true);
                $('#txt-amenity-account').prop('readonly', true);
              }
            }
          });

          $scope.selectAccount = function (id, name, extId, accountType, txtId, bankingBalanceAccess) {
            $('#' + txtId).dropdown('toggle');
            switch (txtId) {
              case 'txt-caller-account':
                $scope.datasource.callerAccount.accountId = id;
                $scope.datasource.callerAccount.accountName = name;
                $scope.datasource.callerAccount.typeName = accountType;
                $scope.datasource.callerAccount.extId = extId;
                $scope.callerSearchValue = name;
                if ($scope.amenityForm.txtCallerAccount) {
                  $scope.amenityForm.txtCallerAccount.$validate();
                }
                $scope.getAmenityAccounts();
                break;

              case 'txt-amenity-account' :
              case 'txt-upgrade-account' :
              case 'txt-banking-account' :
              case 'txt-banking-account-mini' :
                $scope.datasource.preSelectedAccount = {
                  accountId: id,
                  accountName: name,
                  typeName: accountType,
                  extId: extId,
                  balance: 0,
                  instrument: 0,
                  globalService: 0,
                  bankingBalanceAccess: bankingBalanceAccess,
                  comment: ''
                };
                $scope.accountSymbol = accountType;
                if (txtId == 'txt-amenity-account') {
                  $scope.amenitySearchValue = name;
                  if ($scope.amenityForm.txtAmenityAccount) {
                    $scope.amenityForm.txtAmenityAccount.$validate();
                  }
                  if ($scope.upgradesForm.txtUpgradeAccount) {
                    $scope.upgradesForm.txtUpgradeAccount.$validate();
                  }
                }
                else if (txtId == 'txt-upgrade-account') {
                  $scope.amenitySearchValue = name;
                  if ($scope.amenityForm.txtAmenityAccount) {
                    $scope.amenityForm.txtAmenityAccount.$validate();
                  }
                  if ($scope.upgradesForm.txtUpgradeAccount) {
                    $scope.upgradesForm.txtUpgradeAccount.$validate();
                  }
                }
                else if (txtId == 'txt-banking-account') {
                  $scope.bankingSearchValue = name;
                  if ($scope.amenityForm.txtBankingAccount) {
                    $scope.amenityForm.txtBankingAccount.$validate();
                  }
                }
                else if (txtId == 'txt-banking-account-mini') {
                  $scope.bankingSearchValue = name;
                  if ($scope.amenityForm.txtBankingAccount) {
                    $scope.amenityForm.txtBankingAccount.$validate();
                  }
                }
                $scope.getAccountAndProductById();
                break;
            }
          };
          $scope.getAccountAndProductById = function () {

            // call remote action to get balance
            $scope.widgetSpinner = true;
            AccountService.getAccountById(
              $scope.datasource.preSelectedAccount.accountId,
              $rootScope.currentUser.id
            ).then(function (value) {

              $scope.widgetSpinner = false;
              $scope.datasource.preSelectedAccount.accountName = value.Name;
              $scope.datasource.preSelectedAccount.typeName = value.AccountType;
              $scope.datasource.preSelectedAccount.extId = value.ExtId;
              $scope.datasource.preSelectedAccount.balance = value.Fund;
              $scope.datasource.preSelectedAccount.instrument = value.Instrument;
              $scope.datasource.preSelectedAccount.globalService = value.GlobalService;
              $scope.datasource.preSelectedAccount.mileagePlusNumberOfCompany = value.MileagePlusNumberOfCompany;
              $scope.datasource.preSelectedAccount.isTestAccount = value.IsTestAccount;
              $scope.datasource.preSelectedAccount.accountTilePermission = value.AccountTilePermission;
              $scope.datasource.preSelectedAccount.bankingBalanceAccess = value.BankingBalanceAccess;
              $scope.datasource.preSelectedAccount.comment = value.UnitedServicesFundComment;
              $scope.checkAccount();
            }, function (err) {

              console.debug(err);
              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage', {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
            });

            ProductService.getAmenityProductList(
              $scope.datasource.preSelectedAccount.accountId
            ).then(function (value) {

              if (util.isSuccessService(value)) {
                $scope.datasource.products = value.products;
                $scope.prodMembership = ProductService.getProductByCode($scope.datasource.products, 'Membership');
                $scope.prodOTP = ProductService.getProductByCode($scope.datasource.products, 'OTP');
                $scope.prodOneK = ProductService.getProductByCode($scope.datasource.products, '1K');
                $scope.prodPlatinum = ProductService.getProductByCode($scope.datasource.products, '1P');
                $scope.prodGold = ProductService.getProductByCode($scope.datasource.products, '1G');
                $scope.prodSilver = ProductService.getProductByCode($scope.datasource.products, '1S');
                $scope.prodGPU = ProductService.getProductByCode($scope.datasource.products, 'GPU');
                $scope.prodRPU = ProductService.getProductByCode($scope.datasource.products, 'RPU');
                $scope.bonusMilesProduct = ProductService.getProductByCode($scope.datasource.products, 'BM500');
                $scope.beverageCouponProduct = ProductService.getProductByCode($scope.datasource.products, 'BV');

                $scope.prodX90 = ProductService.getProductByCode($scope.datasource.products, 'X90');
                $scope.prodX91 = ProductService.getProductByCode($scope.datasource.products, 'X91');
              }
            }, function (err) {

              $rootScope.$broadcast('showMessage', {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
            });
          };
          $scope.searchAccount = function (txtId) {

            switch (txtId) {
              case 'txt-caller-account':
                $scope.purgeCallerAccount();
                $scope.getCallerAccounts(txtId);
                break;
              case 'txt-amenity-account' :
                if ($scope.specialLoad) {
                  $scope.purgePreSelectedAccount();
                  $scope.getAmenityAccounts(txtId);
                }
                else {
                  $scope.searchAccountInfo(txtId);
                }
                break;
              case 'txt-upgrade-account' :
                if ($scope.specialLoad) {
                  $scope.purgePreSelectedAccount();
                  $scope.getUpgradeAccountList();
                }
                else {
                  $scope.searchAccountInfo(txtId);
                }
                break;
              case 'txt-banking-account' :
              case 'txt-banking-account-mini' :
                $scope.searchAccountInfo(txtId);
                break;
            }
          };
          $scope.searchAccountInfo = function (txtId) {

            // search button
            // find corresponding company from array
            var record;

            switch (txtId) {
              case 'txt-caller-account':
                _($scope.cAccountList).forEach(function (listItem) {

                  if (listItem.Name === $scope.callerSearchValue) {
                    record = listItem;
                    return false;
                  }
                });
                break;

              case 'txt-amenity-account' :
                _($scope.aAccountList).forEach(function (listItem) {

                  if (listItem.Name === $scope.amenitySearchValue) {
                    record = listItem;
                    return false;
                  }
                });
                break;
              case 'txt-upgrade-account' :
                _($scope.upgradeAccounts).forEach(function (listItem) {

                  if (listItem.Name === $scope.amenitySearchValue) {
                    record = listItem;
                    return false;
                  }
                });
                break;

              case 'txt-banking-account' :
              case 'txt-banking-account-mini' :
                _($scope.bAccountList).forEach(function (listItem) {

                  if (listItem.Name === $scope.bankingSearchValue) {

                    record = listItem;
                    return false;
                  }
                });
                break;
            }

            if (record) {
              switch (txtId) {
                case 'txt-caller-account':
                  $scope.datasource.callerAccount.accountId = record.Id;
                  $scope.datasource.callerAccount.accountName = record.Name;
                  $scope.datasource.callerAccount.typeName = record.AccountType;
                  $scope.datasource.callerAccount.extId = record.ExtId;
                  $scope.getAmenityAccounts();
                  break;

                case 'txt-amenity-account' :
                case 'txt-upgrade-account' :
                case 'txt-banking-account' :
                case 'txt-banking-account-mini' :
                  $scope.datasource.preSelectedAccount = {
                    accountId: record.Id,
                    accountName: record.Name,
                    typeName: record.AccountType,
                    extId: record.ExtId,
                    balance: 0,
                    instrument: 0,
                    globalService: 0,
                    bankingBalanceAccess: record.BankingBalanceAccess,
                    comment: ''
                  };

                  $scope.getAccountAndProductById();
                  break;
              }
            }
            else {
              switch (txtId) {
                case 'txt-caller-account':
                  $scope.purgeCallerAccount();
                  break;

                case 'txt-amenity-account' :
                case 'txt-upgrade-account' :
                case 'txt-banking-account' :
                case 'txt-banking-account-mini' :
                  $scope.purgePreSelectedAccount();
                  $scope.checkAccount();
                  break;
              }
            }
          };
          $scope.filterAccount = function (txtId) {

            return function (item) {

              var text = '';
              switch (txtId) {
                case 'txt-caller-account':
                  text = $scope.callerSearchValue;
                  break;
                case 'txt-amenity-account' :
                case 'txt-upgrade-account' :
                  text = $scope.amenitySearchValue;
                  break;
                case 'txt-banking-account' :
                case 'txt-banking-account-mini' :
                  text = $scope.bankingSearchValue;
                  break;
              }

              if ((_.toLower(item.Name)).indexOf((_.toLower(text))) >= 0 ||
                (item.ExtId && item.ExtId.indexOf(text)) >= 0) {
                return true;
              }
              else {
                return false;
              }
            };
          };
          $scope.checkAccount = function () {

            switch ($scope.amenityOrBanking) {
              case 'amenity':
                $scope.isValidAccount = $scope.amenitySearchValue != '';
                break;

              case 'banking':
                $scope.isValidAccount = $scope.bankingSearchValue != '';
                break;
            }
          };
          /***********
           * account fund search end
           ***********/

          /***********
           * united club start
           ***********/
          $scope.membershipOtpSelection = 'memberplus'; // memberplus / email
          $scope.searchUnitedClubMembership = function () {

            $scope.widgetSpinner = true;
            UnitedClubService.retrievePremierQualification(
              $scope.membershipLastName,
              $scope.membershipMPlusNumber,
              $scope.datasource.preSelectedAccount.isTestAccount,
              $rootScope.currentUser.id
            ).then(function (value1) {

              $scope.widgetSpinner = false;
              if (util.isSuccessService(value1)) {
                $scope.widgetSpinner = true;
                //Shan 20170522 Should be preselected account
                UnitedClubService.retrieveSubscription(
                  value1,
                  $scope.datasource.preSelectedAccount.accountId,
                  'unitedClubMembership',
                  $rootScope.currentUser.id
                ).then(function (value2) {

                  $scope.widgetSpinner = false;
                  if (util.isSuccessService(value2)) {
                    $scope.datasource.membershipData = value2;
                    $state.go($state.current.parent + '-united-club', {
                      feature: 'confirm-membership'
                    });
                  }
                }, function (err) {

                  $scope.widgetSpinner = false;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
              }
            }, function (err) {

              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };
          $scope.searchOTPByName = function () {

            $scope.widgetSpinner = true;
            UnitedClubService.retrievePremierQualification(
              $scope.otpLastName,
              $scope.otpMPlusNumber,
              $scope.datasource.preSelectedAccount.isTestAccount,
              $rootScope.currentUser.id
            ).then(function (value1) {

              $scope.widgetSpinner = false;
              if (util.isSuccessService(value1)) {
                $scope.widgetSpinner = true;
                //20170522 should be preselected account
                UnitedClubService.retrieveSubscription(
                  value1,
                  $scope.datasource.preSelectedAccount.accountId,
                  'unitedClubOTPWithMP',
                  $rootScope.currentUser.id
                ).then(function (value2) {

                  $scope.widgetSpinner = false;
                  if (util.isSuccessService(value2)) {
                    //20170418: Shan Add One More Parameter
                    var requestInfoForPassDetailService = {
                      'userId': $rootScope.currentUser.id, //For Emulation
                      'emailAddressInputByUser': '',
                      'numberOfPassInputByUser': $scope.otpCount
                    };
                    $scope.widgetSpinner = true;
                    //20170522 Should be preselected account
                    UnitedClubService.getPassDetail(
                      requestInfoForPassDetailService,
                      value2,
                      $scope.datasource.preSelectedAccount.accountId
                    ).then(function (value3) {

                      $scope.widgetSpinner = false;
                      if (util.isSuccessService(value3)) {
                        $scope.datasource.otpMembershipData = value3;
                        $scope.datasource.otpMembershipData.NumberOfPasses = $scope.otpCount;
                        $scope.datasource.otpMembershipData.Email = '';
                        $scope.datasource.otpMembershipData.retriveQual = value1;
                        $state.go($state.current.parent + '-united-club', {
                          feature: 'confirm-otp-membership'
                        });
                      }
                    }, function (err) {

                      $scope.widgetSpinner = false;
                      $rootScope.$broadcast('showMessage',
                        {
                          type: 'alert',
                          text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                        });
                    });
                  }
                }, function (err) {

                  $scope.widgetSpinner = false;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
              }
            }, function (err) {

              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };
          $scope.searchOTPByEmail = function () {

            //20170418: Shan - Added One Parameter
            var requestInfoForPassDetailService = {
              'userId': $rootScope.currentUser.id, //For Emulation
              'emailAddressInputByUser': $scope.otpEmail,
              'numberOfPassInputByUser': $scope.otpEmailCount
            };
            //20170522 shan should be preselected account
            UnitedClubService.getPassDetailWitEmail(
              requestInfoForPassDetailService,
              $scope.datasource.preSelectedAccount.accountId
            ).then(function (value1) {

              if (util.isSuccessService(value1)) {
                //20170418 Shan
                $scope.datasource.otpEmailData = value1;
                $scope.EmailTo = $rootScope.currentUser.email;
                $state.go($state.current.parent + '-united-club', {
                  feature: 'confirm-otp-email'
                });
              }
            }, function (err) {

              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };
          /***********
           * united club end
           ***********/

          /***********
           * status nomination start
           ***********/
          $scope.snCheckStatus = function () {

            $scope.widgetSpinner = true;
            UnitedClubService.retrievePremierQualification(
              $scope.snLastName,
              $scope.snMPlusNumber,
              $scope.datasource.preSelectedAccount.isTestAccount,
              $rootScope.currentUser.id
            ).then(function (value1) {

              $scope.widgetSpinner = false;
              if (util.isSuccessService(value1)) {
                $scope.widgetSpinner = true;
                StatusNominationService.getCurrentPremierLevelStatus(
                  value1
                ).then(function (value2) {

                  $scope.widgetSpinner = false;
                  if (util.isSuccessService(value2)) {
                    $scope.datasource.statusNomData = value2;
                    $state.go($state.current.parent + '-status-nomination', {
                      feature: 'apply-status-nomination'
                    });
                  }
                }, function (err) {

                  $scope.widgetSpinner = false;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
              }
            }, function (err) {

              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };
          /***********
           * status nomination end
           ***********/

          /***********
           * pnr start
           ***********/
          // Invoke Validate PNR to retrieve PNR data.
          $scope.searchSystem = function (systemType) {

            if (!$scope.pnrSearchValue) {
              return;
            }

            if ($scope.pnrSearchValue.length < 6 && systemType === 'HOST') {
              return;
            }

            if ($scope.pnrSearchValue) {
              $scope.pnrSearchValue = _.toUpper($scope.pnrSearchValue);
              console.debug('Search PNR: ' + $scope.pnrSearchValue);
              if ($scope.pnrSearchValue) {

                var feature = $stateParams.feature;
                switch (feature) {
                  case 'amenity-fee-waivers' :
                  case 'apply-waiver' :
                    $scope.WaiverPNR(systemType);
                    break;
                  case 'amenity-all-waivers-favors' :
                  case 'apply-waiver-favor' :
                    $scope.WaiverFavorPNR(systemType);
                    break;
                  case 'amenity-ep-seat-assignment' :
                  case 'apply-eplus' :

                    if ($rootScope.currentUser.profileName === $rootScope.PROFILE_TYPE.corp) {
                      if (!$scope.pnrSearchNameValue) {
                        return;
                      }
                    }

                    $scope.EPlusPNR(systemType);
                    break;
                }
              }
            }
          };
          $scope.EPlusPNR = function (systemType) {

            if ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp) {
              $scope.widgetSpinner = true;
              PNRService.generatePNRViewModelForEPlusCorporateUser(
                $scope.pnrSearchValue,
                systemType,
                $scope.pnrSearchNameValue,
                $rootScope.currentUser.id).then(function (value) {

                console.debug(value);
                $scope.widgetSpinner = false;
                $scope.datasource.pnrSearchValue = $scope.pnrSearchValue;
                $scope.datasource.PNR = value;
                $scope.datasource.selection = {
                  selectedTravelerIndex: -1,
                  selectedSegmentIndex: -1,
                  selectedLegIndex: -1,
                  selectable: false,
                  restricted: false,
                  seatExpired: false,
                  currentAirSegment: null,
                  segmentSeatMaps: [], // array of seat map object for selected segment
                  currentSegmentSeatMap: null, // current selected leg's seat map object
                  isAllowReset: false
                };
                // this is to cache all seat map response ever retrieve for each segment
                // reusable for final seat assignment price recalculation
                // key, value (segmentIndex, segmentSeatMaps)
                $scope.datasource.seatMapMemories = [];
                $scope.datasource.cart = {
                  total: 0,
                  items: [],
                  dummyItems: [],
                  showCart: false
                };
                $scope.datasource.showETicket = false;
                $state.go($state.current.parent + '-seat-assignment', {
                  feature: 'apply-eplus'
                });

              }, function (err) {

                console.debug(err);
                $scope.widgetSpinner = false;
                $rootScope.$broadcast('showMessage', {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
              });
            } else {

              var callerAccId = '';
              if ($scope.datasource.callerAccount && $scope.datasource.callerAccount.accountId) {
                callerAccId = $scope.datasource.callerAccount.accountId;
              }

              $scope.widgetSpinner = true;
              PNRService.getEPlusPNRDetail(
                $scope.pnrSearchValue,
                systemType,
                $rootScope.currentUser.id,
                callerAccId).then(
                function (value) {

                  console.debug(value);
                  $scope.widgetSpinner = false;
                  $scope.datasource.pnrSearchValue = $scope.pnrSearchValue;
                  $scope.datasource.PNR = value;
                  $scope.datasource.selection = {
                    selectedTravelerIndex: -1,
                    selectedSegmentIndex: -1,
                    selectedLegIndex: -1,
                    selectable: false,
                    restricted: false,
                    seatExpired: false,
                    currentAirSegment: null,
                    segmentSeatMaps: [], // array of seat map object for selected segment
                    currentSegmentSeatMap: null, // current selected leg's seat map object
                    isAllowReset: false
                  };
                  // this is to cache all seat map response ever retrieve for each segment
                  // reusable for final seat assignment price recalculation
                  // key, value (segmentIndex, segmentSeatMaps)
                  $scope.datasource.seatMapMemories = [];
                  $scope.datasource.cart = {
                    total: 0,
                    items: [],
                    dummyItems: [],
                    showCart: false
                  };
                  $scope.datasource.showETicket = false;
                  $state.go($state.current.parent + '-seat-assignment', {feature: 'apply-eplus'});

                }, function (err) {

                  console.debug(err);
                  $scope.widgetSpinner = false;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
            }
          };
          $scope.WaiverPNR = function (systemType) {

            var callerAccId = '';
            if ($scope.datasource.callerAccount && $scope.datasource.callerAccount.accountId) {
              callerAccId = $scope.datasource.callerAccount.accountId;
            }

            $scope.widgetSpinner = true;
            PNRService.getPNRInfo(
              $scope.pnrSearchValue,
              systemType,
              $rootScope.currentUser.accId,
              $rootScope.currentUser.id,
              callerAccId
            ).then(function (value) {

              console.debug(value);
              $scope.widgetSpinner = false;
              $scope.datasource.pnrSearchValue = $scope.pnrSearchValue;
              $scope.datasource.PNR = value;
              $scope.checkCallerTicketRestriction();
              $scope.datasource.showSegment = false;

              $('.coupon').hide();
              $('.coupon-toggle-cell svg').removeClass('open');

              $scope.datasource.selectedPrimaryTicketCount = 0;
              $scope.datasource.selectedTicketCount = 0;
              $scope.datasource.selectedTicketNumber = [];
              $state.go($state.current.parent + '-penalty-waiver', {feature: 'apply-waiver'});
            }, function (err) {

              console.debug(err);
              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };
          $scope.WaiverFavorPNR = function (systemType) {

            var callerAccId = '';
            if ($scope.datasource.callerAccount && $scope.datasource.callerAccount.accountId) {
              callerAccId = $scope.datasource.callerAccount.accountId;
            }

            $scope.widgetSpinner = true;
            AmenityService.getPNRInfo(
              $scope.pnrSearchValue,
              systemType,
              $rootScope.currentUser.accId,
              $rootScope.currentUser.id,
              callerAccId
            ).then(function (value) {

              console.debug(value);
              $scope.widgetSpinner = false;
              $scope.datasource.pnrSearchValue = $scope.pnrSearchValue;
              $scope.datasource.PNR = value;
              $scope.checkCallerTicketRestriction();
              $scope.datasource.showSegment = false;

              $('.coupon').hide();
              $('.coupon-toggle-cell svg').removeClass('open');

              $scope.datasource.selectedPrimaryTicketCount = 0;
              $scope.datasource.selectedTicketCount = 0;
              $scope.datasource.selectedTicketNumber = [];
              $state.go($state.current.parent + '-all-waiver-favor', {feature: 'apply-waiver-favor'});
            }, function (err) {

              console.debug(err);
              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };
          $scope.validatePNRText = function ($event) {

            var pattern = '^[a-zA-Z0-9]+$';
            var regex = new RegExp(pattern);
            var key = String.fromCharCode(!$event.charCode ? $event.which : $event.charCode);
            if (!regex.test(key)) {
              event.preventDefault();
              return false;
            }
          };
          // $scope.validateNameText = function ($event) {
          //
          //   var pattern = '^[a-zA-Z0-9 ]+$';
          //   var regex = new RegExp(pattern);
          //   var key = String.fromCharCode(!$event.charCode ? $event.which : $event.charCode);
          //   if (!regex.test(key)) {
          //     event.preventDefault();
          //     return false;
          //   }
          // };
          $scope.checkCallerTicketRestriction = function () {

            if ($scope.datasource.callerAccount &&
              $scope.datasource.callerAccount.accountId &&
              $scope.datasource.callerAccount.accountName &&
              $scope.datasource.callerAccount.typeName &&
              $scope.datasource.PNR &&
              $scope.datasource.PNR.SalesReservationDetail &&
              $scope.datasource.PNR.SalesReservationDetail.TicketInfo) {

              var ticketMsg = 'Ticket is restricted for the caller';
              _.forEach($scope.datasource.PNR.SalesReservationDetail.TicketInfo, function (ticket) {

                if (ticket.isSelectableForCaller === false) {
                  if (ticket.ticketLevelErrorMsg == undefined) {
                    ticket.ticketLevelErrorMsg = [];
                  }
                  ticket.ticketLevelErrorMsg.push(ticketMsg);
                }
              });
            }
          };
          /***********
           * pnr end
           ***********/

          /***********
           * upgrades request start
           ***********/
          $scope.continueUpgrades = function () {

            var requestInfoToUpgradeService = {
              "MileagePlusNumberOfCompany": $scope.datasource.preSelectedAccount.mileagePlusNumberOfCompany
            };

            //abe add validation
            if (!$scope.datasource.preSelectedAccount.mileagePlusNumberOfCompany) {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Please contact your Sales Manager to get a new CUB/SUB account created'
                });
              return;
            }

            $scope.widgetSpinner = true;
            UpgradeService.getUpgradeBalance(
              requestInfoToUpgradeService, $rootScope.currentUser.id
            ).then(function (value1) {

              $scope.widgetSpinner = false;
              if (util.isSuccessService(value1)) {
                $scope.datasource.upgradeData = {
                  UpgradeAccountName: $scope.datasource.preSelectedAccount.accountName,
                  UpgradeAccountId: $scope.datasource.preSelectedAccount.accountId,
                  UpgradeAccountType: $scope.datasource.preSelectedAccount.typeName,
                  UpgradeAccountExtId: $scope.datasource.preSelectedAccount.extId,
                  GPUUnitCost: $scope.prodGPU.UnitPrice,
                  RPUUnitCost: $scope.prodRPU.UnitPrice,
                  GPUBalance: value1.GPUBalance,
                  RPUBalance: value1.RPUBalance,
                  GPUs: value1.vGPUDetail,
                  RPUs: value1.vRPUDetail,
                  //20170615 Add Expiration Date (CST)
                  ExpiryDate: value1.newExpirationDateShownInUI
                };
                $state.go($state.current.parent + '-upgrades', {
                  feature: 'apply-upgrades'
                });
              }
            }, function (err) {

              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };

          /***********
           * upgrades request end
           ***********/

          /************
           * Bonus Miles ------- abe modified*
           * ***********/
          $scope.bonusContinue = function () {

            $scope.widgetSpinner = true;

            BonusMilesService.retrievePremierQualification(
              $scope.lastName_bm, $scope.milePlusNum_bm, $scope.datasource.preSelectedAccount.isTestAccount, $rootScope.currentUser.id
            ).then(function (value1) {

              $scope.widgetSpinner = false;
              if (util.isSuccessService(value1)) {
                $scope.datasource.bonusMilesData = value1;
                $scope.widgetSpinner = true;

                BonusMilesService.getBonusmilesQuota(
                  value1, $rootScope.currentUser.id
                ).then(function (value2) {

                  $scope.widgetSpinner = false;
                  $scope.datasource.bonusMilesData.maxBonusQuota = Number(value2.BousMilesQuota);
                  if (util.isSuccessService(value2)) {
                    $scope.datasource.bonusMilesData.UnitPrice = $scope.bonusMilesProduct.UnitPrice / 500;
                    $state.go($state.current.parent + '-bonus-miles', {
                      feature: 'apply-bonus-miles'
                    });
                  }
                }, function (err) {

                  $scope.widgetSpinner = false;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
              }
            }, function (err) {

              $scope.widgetSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
          };

          /********travel certificate service call***********/
          $scope.travelCertificateClick = function () {
            //data from service
            $scope.datasource.travelCertificateData = {
              transactionNumber: 0,
              checkedEmail: false,
              entity: '',
              entityList: [],
              bookingClass: '',
              bookingClassList: [],
              entityName: '',
              bookingClassName: '',
              costPerCredit: 0,
              infoData: [],
              costValue: {},
              maxBudgetNum: 0,
              totalCreditNum: 0,
              failureMessages: [],
              reasonCode: '',
              reasonCodeFull: '',
              reasonCodeList: [],
              divi: '',
              diviList: [],
              auth: '',
              authList: [],
              effDate: '',
              currentDate: '',
              recipientInfo: {
                lastName: '',
                firstName: '',
                email: '',
                emailRetype: '',
                street: '',
                city: '',
                state: '',
                ZIP: '',
                country: '',
                organisationName: '',
                sendCertificateType: 'Organization'
              }
            };
            //save this might need in the furture (W9 to company modal)
            /*  if ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp) {
             angular.element('#travel-certificate-modal').modal();
             } else {
             $scope.travelCertMainService();
             }*/

            $scope.travelCertMainService();
          };
          $scope.travelCertMainService = function () {
            //angular.element('#travel-certificate-modal').modal('hide');
            $scope.widgetSpinner = true;
            TravelCertificateService.getCertAllocationByEmpID()
              .then(function (value1) {

                $scope.widgetSpinner = false;
                if (util.isSuccessService(value1)) {
                  $scope.datasource.travelCertificateData.budget = value1.vSAAllocationInventoryMap;
                  $scope.datasource.travelCertificateData.certAllocationByEmpID = value1;
                  $scope.datasource.travelCertificateData.reasonCodeList = value1.ReasonCodeList;
                  $scope.datasource.travelCertificateData.authList = value1.AuthorizerList;
                  $scope.datasource.travelCertificateData.diviList = value1.DivisionList;
                  $scope.datasource.travelCertificateData.currentDate = value1.CurrentUserToday;

                  // sorting
                  $scope.datasource.travelCertificateData.reasonCodeList = _.sortBy($scope.datasource.travelCertificateData.reasonCodeList, ['TravelCertReasonCode', 'TravelCertReasonCodeDefinition']);
                  $scope.datasource.travelCertificateData.authList = _.sortBy($scope.datasource.travelCertificateData.authList, ['Authorizer_Full_Name__c']);
                  $scope.datasource.travelCertificateData.diviList = _.sortBy($scope.datasource.travelCertificateData.diviList);

                  //get all entity and booking class and each value
                  $scope.widgetSpinner = true;
                  ProductService.getTravelCertificate($scope.datasource.preSelectedAccount.accountId)
                    .then(function (value2) {

                      if (util.isSuccessService(value2)) {
                        $scope.datasource.travelCertificateData.entityList = [];
                        $scope.datasource.travelCertificateData.bookingClassList = [];
                        $scope.datasource.travelCertificateData.costValue = value2.costValue;
                        var classList = value2.classList, entityList = value2.entityList;
                        for (var i = 0, len = classList.length; i < len; i++) {
                          //20170628 Change from "~" to "-"
                          var each = classList[i].split(" - ");
                          $scope.datasource.travelCertificateData.bookingClassList.push({
                            name: each[0],
                            detail: each[1]
                          });
                        }
                        for (var i = 0, len = entityList.length; i < len; i++) {
                          var each = entityList[i].split(" - ");
                          $scope.datasource.travelCertificateData.entityList.push({
                            name: each[0],
                            detail: each[1]
                          });
                        }
                        //go to travel certificate
                        $state.go($state.current.parent + '-travel-certificate', {
                          feature: 'apply-travel-certificate'
                        });
                        $scope.widgetSpinner = false;
                      }
                    }, function (err) {

                      $scope.widgetSpinner = false;
                      $rootScope.$broadcast('showMessage',
                        {
                          type: 'alert',
                          text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                        });
                    });
                }
              }, function (err) {

                $scope.widgetSpinner = false;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                  });
              });
          };
          /********end of travel certificate service call***********/
          /********beverage coupon service call***********/
          $scope.beverageCouponsClick = function () {
            $scope.widgetSpinner = true;

            $scope.datasource.beverageCouponsData = {
              lastName: '',
              firstName: '',
              city: '',
              state: '',
              street: '',
              country: '',
              ZIP: '',
              phoneNumber: '',
              email: '',
              emailRetype: '',
              checkedEmail: false,
              transactionNumber: 0,
              eachCost: $scope.beverageCouponProduct.UnitPrice,
              couponNumber: 25,
            };
            //$scope.datasource.beverageCouponsData.eachCost = $scope.beverageCouponProduct.UnitPrice;
            $scope.widgetSpinner = false;

            $state.go($state.current.parent + '-beverage-coupons', {
              feature: 'apply-beverage-coupons'
            });
          };
          /********end of beverage service call***********/

          $scope.initWidget();
        }];

      return {
        restrict: 'E',
        scope: {
          datasource: '=datasource'
        },
        controller: widgetController,
        templateUrl: 'Sip_AmenityWidgetTemplate'
      };
    }
    ]);
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('bankingController', controller);

  controller.$inject = ['$rootScope', '$scope', '$state'];
  function controller($rootScope, $scope, $state) {

    /** account summary **/

    /** account summary **/

    /*** fund transfer start **/
    $scope.fundTx = {
      account: '',
      amount: 0,
      transferFromFund: '',
      fundTransferComment: '',
      totalAmount: 0,
      lines: []
    };
    /*** fund transfer stop **/
  }
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('beverageCouponsControl', controller);

  controller.$inject = ['$rootScope', '$scope', '$state', '$interval', '$timeout',
    'BeverageCouponService', 'CMSService', 'AmenityService'];
  function controller($rootScope, $scope, $state, $interval, $timeout,
                      BeverageCouponService, CMSService, AmenityService) {

    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: '',
      isValidFundOption: true,
      enableFund: true,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ? 1 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ? 1 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp ? 2 : 1) :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ? 1 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: 'SIP_Beverage_Vouchers__c'
    };

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;

      if ($scope.data.widgetFeature == 'apply-beverage-coupons') {
        $scope.data.charge.chargeAmount = '';

        if (!$scope.countryList) {
          //get country list
          CMSService.getCountryList().then(function (val) {
            var list = val;
            for (var i = 0, len = list.length - 1; i < len; i++) {
              if (list[i].value === 'U.S.A.') {
                list.splice(i, 1);
              }
            }
            list.unshift({
              disabled: false,
              value: 'USA',
              label: 'USA'
            });
            $scope.countryList = list;
            if ($scope.recipientForm && $scope.recipientForm.country) {
              $timeout(function () {
                $scope.recipientForm.country.$validate();
              }, 1000);
            }
          });
        }
        else {
          if ($scope.recipientForm && $scope.recipientForm.country) {
            $timeout(function () {
              $scope.recipientForm.country.$validate();
            }, 1000);
          }
        }
      }
      else if ($scope.data.widgetFeature == 'confirm-beverage-coupons') {
        $scope.data.charge.chargeAmount = $scope.data.beverageCouponsData.eachCost * $scope.data.beverageCouponsData.couponNumber;
      }
    });

    $scope.showDropDown = function (event) {
      $(event.target).siblings('ul').dropdown('toggle');
    };

    $scope.countrySelect = function (c) {
      $scope.data.beverageCouponsData.country = c;
    };

    $scope.clearCountryList = function () {
      $scope.data.beverageCouponsData.country = '';
    };

    //add coupon number
    $scope.addBeverage = function () {

      $scope.data.beverageCouponsData.couponNumber += 5;
    };

    //minus coupon number
    $scope.minusBeverage = function () {
      if ($scope.data.beverageCouponsData.couponNumber > 25) {
        $scope.data.beverageCouponsData.couponNumber -= 5;
      }
    };

    //keep adding coupon number
    $scope.addHold = function () {

      $scope.keyHoldInterval = $interval(function () {

        $scope.addBeverage();
      }, 300);
    };

    //keep mining coupon number
    $scope.minusHold = function () {

      $scope.keyHoldInterval = $interval(function () {

        $scope.minusBeverage();
      }, 300);
    };

    $scope.clearHoldInterval = function () {
      $interval.cancel($scope.keyHoldInterval);
    };

    $scope.confirmContinue = function () {

      $state.go($state.current.parent + '-beverage-coupons', {
        feature: 'confirm-beverage-coupons'
      });
    };

    $scope.goBack = function () {

      $state.go($state.current.parent + '-beverage-coupons', {feature: 'apply-beverage-coupons'});
    };

    //purchase beverage coupon
    $scope.purchase = function () {

      angular.element('#beverage-coupons-confirm-modal').modal();
    };

    // confirm purchase coupon
    $scope.confirmPurchase = function () {

      //proceed purchase call service
      angular.element('#beverage-coupons-confirm-modal').modal('hide');
      $rootScope.mainSpinner = true;

      var comment = $scope.data.charge.comment;
      var payerId = $scope.data.charge.accSearchId;
      var beneficiaryId = $scope.data.charge.beneficiarySearchId;

      var param = {
        FirstName: $scope.data.beverageCouponsData.firstName,
        LastName: $scope.data.beverageCouponsData.lastName,
        PhoneNumber: $scope.data.beverageCouponsData.phoneNumber,
        StreetAddress: $scope.data.beverageCouponsData.street,
        BeverageCoutry: $scope.data.beverageCouponsData.country,
        BeverageCity: $scope.data.beverageCouponsData.city,
        BeverageState: $scope.data.beverageCouponsData.state,
        BeverageZIP: $scope.data.beverageCouponsData.ZIP,
        NumberOfCoupons: $scope.data.beverageCouponsData.couponNumber,
        BeverageEmailAddress: $scope.data.beverageCouponsData.email
      };

      var totalcost = $scope.data.beverageCouponsData.eachCost * $scope.data.beverageCouponsData.couponNumber;
      //purchase
      AmenityService.preDeductAccountBalance(payerId, totalcost, $rootScope.currentUser.id).then(function (value) {
        if (value.success) {
          BeverageCouponService.purchaseBeverageCoupons(param, payerId, beneficiaryId, $scope.data.callerAccount.accountId, comment, $rootScope.currentUser.id, totalcost, value.pendingAmountObjId)
            .then(function (value) {
              $rootScope.mainSpinner = false;
              if (value.success) {
                $scope.data.beverageCouponsData.transactionNumber = value.transactionNumber;
                angular.element('#beverage-coupons-success-modal').modal();
              } else {
                $scope.shouldCheckBalance = true;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: value.messages[0]
                  });
              }

            }, function (e) {
              $rootScope.mainSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
        } else {
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.messages[0]
            });
        }
      }, function (err) {

        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
      });
    };

    angular.element('#message-modal').on('hidden.bs.modal', function (e) {

      if ($scope.shouldCheckBalance) {
        $scope.shouldCheckBalance = false;

        $rootScope.$broadcast('refreshSelectedAccount', {});
      }
    });

    angular.element('#beverage-coupons-success-modal').on('hidden.bs.modal', function (e) {

      if ($scope.data.beverageCouponsData.checkedEmail) {
        AmenityService.sendEmail(
          $rootScope.currentUser.id,
          $scope.data.beverageCouponsData.transactionNumber
        ).then(function () {

          $state.go($state.current.parent + '-home', {feature: 'init'});
        }, function (err) {

          console.debug(err);
          $state.go($state.current.parent + '-home', {feature: 'init'});
        })
      }
      else {
        $state.go($state.current.parent + '-home', {feature: 'init'});
      }
    });
  }
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('bonusMileControl', controller);

  controller.$inject = ['$rootScope', '$scope', '$state', '$interval',
    'BonusMilesService', 'AmenityService'];
  function controller($rootScope, $scope, $state, $interval,
                      BonusMilesService, AmenityService) {

    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: '',
      isValidFundOption: true,
      enableFund: true,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ? 1 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ? 1 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp ? 2 : 1) :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ? 1 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: 'SIP_Bonus_Miles__c'
    };

    $scope.bonusMilesNum = 0;
    $scope.bonusMiles = $scope.bonusMilesNum + ' Miles';
    //$scope.checkedEmail123=false;

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;

      if ($scope.data.widgetFeature == 'apply-bonus-miles') {
        $scope.data.charge.chargeAmount = '';
      }
      else if ($scope.data.widgetFeature == 'confirm-bonus-miles') {
        $scope.data.charge.chargeAmount = $scope.data.bonusMilesData.UnitPrice * $scope.data.bonusMilesData.bonusMilesNum;
      }
    });

    $scope.addMiles = function () {

      if ($scope.bonusMilesNum >= 10000 || $scope.bonusMilesNum >= $scope.data.bonusMilesData.maxBonusQuota || $scope.data.bonusMilesData.maxBonusQuota <= 0) {
        return;
      } else {
        $scope.bonusMilesNum += 500;
        $scope.bonusMiles = $scope.bonusMilesNum.toLocaleString() + ' Miles';
        $scope.data.bonusMilesData.bonusMilesNum = $scope.bonusMilesNum;
      }
    };
    $scope.minusMiles = function () {

      if ($scope.bonusMilesNum < 500) {
        $scope.bonusMiles = 0 + ' Miles';
      } else {
        $scope.bonusMilesNum -= 500;
        $scope.bonusMiles = $scope.bonusMilesNum.toLocaleString() + ' Miles';
        $scope.data.bonusMilesData.bonusMilesNum = $scope.bonusMilesNum;
      }
    };

    //hold button add quick
    $scope.addMilesContinue = function () {

      $scope.continueInterval = $interval(function () {
        $scope.addMiles();
      }, 300);
    };
    //hold button minus quick
    $scope.minusMilesContinue = function () {

      $scope.continueInterval = $interval(function () {
        $scope.minusMiles();
      }, 300);
    };
    //release button
    $scope.clearAddMinusInterval = function () {

      $interval.cancel($scope.continueInterval);
    };


    $scope.confirmBonusMiles = function () {

      $state.go($state.current.parent + '-bonus-miles', {
        feature: 'confirm-bonus-miles'
      });
    };

    $scope.goBack = function () {

      $state.go($state.current.parent + '-bonus-miles', {feature: 'apply-bonus-miles'});
    };

    //purchase bonus miles
    $scope.purchase = function () {

      angular.element('#bonus-miles-confirm-modal').modal();
    };
    // confirm purchase bonus miles

    $scope.confirmPurchase = function () {

      $rootScope.mainSpinner = true;

      var comment = $scope.data.charge.comment;
      var payerId = $scope.data.charge.accSearchId;
      var beneficiaryId = $scope.data.charge.beneficiarySearchId;
      var totalcost = $scope.data.bonusMilesData.UnitPrice * $scope.data.bonusMilesData.bonusMilesNum;

      //proceed purchase
      AmenityService.preDeductAccountBalance(payerId, totalcost, $rootScope.currentUser.id).then(function (value) {
        if(value.success){
            //20170620 add pendingAmountObjId
          BonusMilesService.getAwardMiles(
            $rootScope.currentUser.accId,
            payerId,
            $scope.data.bonusMilesData.bonusMilesNum.toString(),
            $scope.data.bonusMilesData.MileagePlusNumber,
            beneficiaryId,
            comment,
            $rootScope.currentUser.id,
            $scope.data.bonusMilesData.CurrentPremierLevel,
            $scope.data.bonusMilesData.FirstName,
            $scope.data.bonusMilesData.LastName,
            $scope.data.callerAccount.accountId,
            totalcost,
            value.pendingAmountObjId
          ).then(function (value) {

              $rootScope.mainSpinner = false;
              angular.element('#bonus-miles-confirm-modal').modal('hide');
              if (value.success) {
                $scope.data.bonusMilesData.transactionNumber = value.transactionNumber;
                $scope.beneficiaryName = value.BeneficiaryName || "";
                angular.element('#bonus-miles-success-modal').modal();
              } else {
                $scope.shouldCheckBalance = true;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: value.messages[0]
                  });
              }
            },
            function (err) {

              $rootScope.mainSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            });
        } else {
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.messages[0]
            });
        }
      }, function (err) {

        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
      });
    };
    angular.element('#message-modal').on('hidden.bs.modal', function (e) {

      if ($scope.shouldCheckBalance) {
        $scope.shouldCheckBalance = false;

        $rootScope.$broadcast('refreshSelectedAccount', {});
      }
    });
    angular.element('#bonus-miles-success-modal').on('hidden.bs.modal', function (e) {

      if ($scope.data.bonusMilesData.checkedEmail) {
        AmenityService.sendEmail(
          $rootScope.currentUser.id,
          $scope.data.bonusMilesData.transactionNumber
        ).then(function () {

          $state.go($state.current.parent + '-home', {feature: 'init'});
        }, function (err) {

          console.debug(err);
          $state.go($state.current.parent + '-home', {feature: 'init'});
        })
      }
      else {
        $state.go($state.current.parent + '-home', {feature: 'init'});
      }
    });
  }
})();
(function () {
  "use strict";

  angular.module('bankingModule')
    .component('eTicketComp', {
      templateUrl: 'Sip_ETicketCompTemplate',
      controller: controller,
      bindings: {
        pnr: '=',
        ticket: '=',
        isSelectable: '<',
        toggleticket: '&'
      }
    });

  controller.$inject = [];
  function controller() {

    var $ctrl = this;

    $ctrl.formatDate = function (date) {

      var dateOut = new Date(date);
      return dateOut;
    };
    $ctrl.formatDate2 = function (date) {

      var year = date.substring(0, 4);
      var month = date.substring(4).substring(0, 2);
      var day = date.substring(6);
      var dateOut = new Date(year + '/' + month + '/' + day);
      return dateOut;
    };

    $ctrl.toggleCoupon = function (ticket) {

      ticket.showDetail = ticket.showDetail ? false : true;
    };

    $ctrl.toggleTicket = function (ticket) {

      if ($ctrl.isSelectable) {
        if ($ctrl.toggleticket) {
          $ctrl.toggleticket({ticket: ticket});
        }
      }
    }
  }

})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('fundTransferController', controller);

  controller.$inject = ['$rootScope', '$scope', '$state', 'AccountService', '$timeout'];
  function controller($rootScope, $scope, $state, AccountService, $timeout) {
    $scope.fundTx.iata = '';
    $scope.fundTx.accountSearchValue = '';
    $scope.fundTx.amount = 0;
    $scope.fundTx.maxTransferAmount = 0;
    $scope.$watch('data.preSelectedAccount.accountId', function (newVal, oldVal) {

      if (oldVal != newVal) {
        $scope.loadTargetAccounts();
        $scope.getMaxAmount();
      }
    });
    $scope.$watch('fundTx.transferFromFund', function (newVal, oldVal) {

      $scope.getMaxAmount();
    });

    $scope.listLimitTo = 500;

    $scope.specialLoad = $rootScope.currentUser.isInternalUser;

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;

      if ($scope.data.widgetFeature == 'apply-fund-transfer') {
        $scope.fundTx.lines = [];
        $scope.fundTx.totalAmount = 0;
        $scope.fundTx.transferFromFund = 'Expiring first';
        $scope.fundTx.fundTransferComment = '';
        $scope.txAccountList = [];
        $scope.loadTargetAccounts();
        $scope.getMaxAmount();
      }

      if ($scope.data.widgetFeature == 'confirm-fund-transfer') {
        $scope.fundTx.totalAmount = 0;
        _($scope.fundTx.lines).forEach(function (item) {

          $scope.fundTx.totalAmount += parseInt(item.amount);
        });
      }
    });

    $scope.searchAccount = function () {
      $("#txt-fund-transfer").dropdown('toggle');
      if ($scope.specialLoad) {
        $scope.loadTargetAccounts();
      } else {
        $scope.searchAccountInfo();
      }
    };
    $scope.lineNumberValChanged = function ($event) {

      $timeout(function () {
        $scope.fundTx.totalAmount = 0;
        _($scope.fundTx.lines).forEach(function (item) {

          $scope.fundTx.totalAmount += parseInt(item.amount);
        });
      }, 100);
    };
    $scope.getMaxAmount = function () {
      var expire = $scope.fundTx.transferFromFund == 'Expiring first';
      AccountService.getTransferLimit(
        $scope.data.preSelectedAccount.accountId, expire
      ).then(function (value) {
        $scope.fundTx.maxTransferAmount = value;
      });
    };
    $scope.loadTargetAccounts = function () {

      var searchValue = '';

      if ($scope.specialLoad && $scope.fundTx.accountSearchValue.length >= 1) {
        searchValue = $scope.fundTx.accountSearchValue;
      }
      $scope.widgetSpinner = true;
      if ($scope.data.preSelectedAccount && $scope.data.preSelectedAccount.accountId) {
        AccountService.getSelectableAccountsForFundsTxMultiple(
          $rootScope.currentUser.id, $scope.data.preSelectedAccount.accountId, searchValue
        ).then(function (value) {
          if (value.Accounts.length == 0 && searchValue != '') {
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'No results found. Please change your search parameters and try again.'
              });
          }
          $scope.widgetSpinner = false;
          $scope.txAccountList = value.Accounts;
          $('#txt-fund-transfer').dropdown('toggle');

        }, function (err) {
          $scope.widgetSpinner = false;
          console.debug(err);
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        });
      }
    };
    $scope.txtAccountKeyup = function ($event) {

      switch ($event.keyCode) {
        case 13 : // enter key trigger search
          var txt = $event.target;
          $(txt).dropdown('toggle');
          if ($scope.specialLoad) {
            $scope.loadTargetAccounts();
          } else {
            $scope.searchAccountInfo();
          }
          break;

        case 40 :
          var txt = $event.target;
          var ddl = $(txt).attr('aria-describedby');
          $('#' + ddl).find('li:first').focus();
          break;

        default:
          $scope.fundTx.account = null;
          $scope.accountSymbol = '';
          break;
      }
    };
    $scope.ddlAccountKeyup = function ($event) {

      switch ($event.keyCode) {
        case 38 :
          var prev = $($event.target).prev();
          if (prev.length > 0) {
            prev.focus();
          }
          break;

        case 40 :
          var next = $($event.target).next();
          if (next.length > 0) {
            next.focus();
          }
          break;
      }
    };
    $scope.selectAccount = function (acc, txtId) {
      $scope.accountSymbol = acc.AccountType;
      $('#' + txtId).dropdown('toggle');
      $scope.fundTx.account = acc;
      $scope.fundTx.accountSearchValue = acc.Name;
      $scope.fundTx.iata = acc.ExtId;
    };
    $scope.searchAccountInfo = function () {

      // search button
      // find corresponding company from array
      var recordFound = false;
      _($scope.txAccountList).forEach(function (listItem) {

        if (listItem.Name === $scope.fundTx.accountSearchValue) {
          recordFound = true;
          $scope.fundTx.account = listItem;
        }
      });

      if (!recordFound) {
        $scope.fundTx.account = null;
      }
    };
    $scope.filterAccount = function (item) {

      if ((_.toLower(item.Name)).indexOf((_.toLower($scope.fundTx.accountSearchValue))) >= 0 ||
        (item.AccountType !== $rootScope.ACC_TYPE.corp && item.ExtId && item.ExtId.indexOf($scope.fundTx.accountSearchValue) >= 0 )) {
        return true;
      }
      else {
        return false;
      }
    };

    $scope.addFundLineItem = function () {

      if ($scope.fundTx.account != null) {

        var isValidAccount = true;
        _($scope.fundTx.lines).forEach(function (item) {

          if ($scope.fundTx.account.Id == item.account.Id) {
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'You can not add two records with the same account.'
              });
            isValidAccount = false;
            return false;
          }
        });

        if (isValidAccount) {
          $scope.fundTx.lines.push({
            index: $scope.fundTx.lines.length + 1,
            account: $scope.fundTx.account,
            amount: $scope.fundTx.amount
          });
          $scope.fundTx.account = null;
          $scope.fundTx.accountSearchValue = '';
          $scope.fundTx.iata = '';
          $scope.fundTx.amount = 0;
          $scope.fundTx.totalAmount = 0;
          _($scope.fundTx.lines).forEach(function (item) {

            $scope.fundTx.totalAmount += parseInt(item.amount);
          });
        }
      }
    };
    $scope.removeFundLineItem = function (index) {

      $scope.fundTx.lines.splice(index - 2, 1);
      _($scope.fundTx.lines).each(function (item, idx) {
        item.index = idx;
      });
    };

    $scope.continueTransfer = function () {

      $state.go($state.current.parent + '-fund-transfer', {feature: 'confirm-fund-transfer'});
    };

    $scope.confirmModal = $('#fund-transfer-confirm-modal');
    $scope.successModal = $('#fund-transfer-success-modal');

    $scope.transfer = function () {

      $scope.confirmModal.modal();
    };

    $scope.confirmTransfer = function () {

      if ($scope.fundTx.totalAmount > $scope.data.preSelectedAccount.balance) {
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Insufficient fund for transfer.'
          });

        return false;
      }

      // combine the obj
      $scope.transferObj = {};
      $scope.transferObj.RequestItems = [];
      $scope.transferObj.Order = $scope.fundTx.transferFromFund;
      $scope.transferObj.Comments = $scope.fundTx.fundTransferComment;

      for (var i = 0; i < $scope.fundTx.lines.length; i++) {

        $scope.transferObj.RequestItems.push({
          ReceiverId: $scope.fundTx.lines[i].account.Id,
          PayerId: $scope.data.preSelectedAccount.accountId,
          Amount: $scope.fundTx.lines[i].amount
        })
      }

      $rootScope.mainSpinner = true;
      AccountService.submitFundsTransfer($scope.transferObj).then(function (value) {

        AccountService.getAccountById($scope.data.preSelectedAccount.accountId, $rootScope.currentUser.id).then(function (value) {
          $scope.data.preSelectedAccount.balance = value.Fund;
          $rootScope.mainSpinner = false;
          $scope.getMaxAmount();
          $scope.confirmModal.modal('hide');
          $scope.successModal.modal();
          $scope.transferObj = '';
        }, function (err) {

          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        })
      }, function (err) {

        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
      })
    };
    $scope.successModal.on('hidden.bs.modal', function (e) {
      if ($rootScope.currentUser.permission.SIP_Account_Summary__c) {
        $state.go($state.current.parent + '-account-summary', {
          feature: 'banking-summary'
        });
      } else {
        $state.go($state.current.parent + '-fund-transfer', {
          feature: 'apply-fund-transfer'
        });
      }
    });
  }
})();
(function () {
  "use strict";

  angular.module('bankingModule')
    .component('passengerComp', {
      templateUrl: 'Sip_PassengerCompTemplate',
      controller: controller,
      bindings: {
        passengers: '=',
        isShowHeader: '='
      }
    });

  controller.$inject = ['$rootScope'];
  function controller($rootScope) {

    var $ctrl = this;

    this.$onInit = function () {

      console.debug($ctrl.passengers);
    };
  }
})();
(function () {
  "use strict";

  angular.module('bankingModule')
    .component('paymentOptionComp', {
      templateUrl: 'Sip_PaymentOptionCompTemplate',
      controller: controller,
      bindings: {
        forms: '=',
        accountType: '=', // company, agency, discretionary,
        accSearchValue: '=',
        accSearchId: '=',
        accSearchExtId: '=',
        beneficiarySearchValue: '=',
        beneficiarySearchId: '=',
        preSelectedAccount: '=',
        callerAccount: '=',
        chargeAmount: '=',
        chargeType: '=',
        comment: '=',
        remark: '=',
        isValidFundOption: '=',
        enableFund: '=',
        enableIns: '=',
        enableGs: '=',
        companyOption: '=', // 1 = enable, 2 = disable (hide), 3 = readonly
        agencyOption: '=', // 1 = enable, 2 = disable (hide), 3 = readonly
        disOption: '=', // 1 = enable, 2 = disable (hide), 3 = readonly
        amenityType: '='
      }
    });

  controller.$inject = ['$rootScope', 'AccountService', 'util'];
  function controller($rootScope, AccountService, util) {

    var $ctrl = this;

    $ctrl.listLimitTo = 500;
    $ctrl.poSpinner = false;

    $ctrl.specialLoad = $rootScope.currentUser.isInternalUser &&
      ($rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ||
      $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c);

    $ctrl.companySearchValue = '';
    $ctrl.companySearchId = '';
    $ctrl.companySearchExtId = '';
    $ctrl.companyAccType = '';

    $ctrl.agencySearchValue = '';
    $ctrl.agencySearchId = '';
    $ctrl.agencySearchExtId = '';
    $ctrl.agencyAccType = '';

    $ctrl.disSearchValue = '';
    $ctrl.disSearchId = '';
    $ctrl.disSearchExtId = '';
    $ctrl.disAccType = '';

    $ctrl.companyBalance = '';
    $ctrl.companyIns = '';
    $ctrl.companyGs = '';
    $ctrl.agencyBalance = '';
    $ctrl.agencyIns = '';
    $ctrl.agencyGs = '';
    $ctrl.disBalance = '';
    $ctrl.disIns = '';
    $ctrl.disGs = '';

    $ctrl.companyBalanceAccess = false;
    $ctrl.agencyBalanceAccess = false;
    $ctrl.disBalanceAccess = false;

    $ctrl.isCompanyReadOnly = false;
    $ctrl.isAgencyReadOnly = false;
    $ctrl.isDiscretionaryReadOnly = false;

    $ctrl.isValidCompanyFund = false;
    $ctrl.isValidAgencyFund = false;
    $ctrl.isValidDiscretionaryFund = false;

    $ctrl.isValidCompanyIns = false;
    $ctrl.isValidAgencyIns = false;
    $ctrl.isValidDiscretionaryIns = false;

    $ctrl.isValidCompanyGs = false;
    $ctrl.isValidAgencyGs = false;
    $ctrl.isValidDiscretionaryGs = false;

    $ctrl.accounts = [];
    $ctrl.corpAccounts = [];
    $ctrl.agtAccounts = [];
    $ctrl.disAccounts = [];
    $ctrl.agtBeneficiaries = [];
    $ctrl.disBeneficiaries = [];

    $ctrl.agtBeneficiary = '';
    $ctrl.agtBeneficiaryId = '';
    $ctrl.agtBeneficiaryAccType = '';
    $ctrl.agtBeneficiaryExtId = '';
    $ctrl.agtBeneficiaries = [];

    $ctrl.disBeneficiary = '';
    $ctrl.disBeneficiaryId = '';
    $ctrl.disBeneficiaryAccType = '';
    $ctrl.disBeneficiaryExtId = '';
    $ctrl.disBeneficiaries = [];

    $ctrl.beneficiaryRequired = false;

    $ctrl.txtAgency = $('#txt-agency');
    $ctrl.ddlAgency = $('#ddl-agency');
    $ctrl.txtAgencyBeneficiary = $('#txt-agency-beneficiary');
    $ctrl.ddlAgencyBeneficiary = $('#ddl-agency-beneficiary');
    $ctrl.txtCompany = $('#txt-company');
    $ctrl.ddlCompany = $('#ddl-company');
    $ctrl.txtDiscretionary = $('#txt-dis');
    $ctrl.ddlDiscretionary = $('#ddl-dis');
    $ctrl.txtDiscretionaryBeneficiary = $('#txt-dis-beneficiary');
    $ctrl.ddlDiscretionaryBeneficiary = $('#ddl-dis-beneficiary');

    $rootScope.$on('checkAccount', function (event, data) {

      $ctrl.checkAccount();
    });
    $rootScope.$on('fundCheck', function (event, data) {

      $ctrl.fundCheck();
    });
    $rootScope.$on('refreshSelectedAccount', function (event, data) {

      $ctrl.getAccountById();
    });

    this.$onInit = function () {

      $ctrl.accounts = [];
      if ($ctrl.specialLoad) {
        if ($ctrl.preSelectedAccount) {
          $ctrl.accounts = [{
            'Id': $ctrl.preSelectedAccount.accountId,
            'Name': $ctrl.preSelectedAccount.accountName,
            'ExtId': $ctrl.preSelectedAccount.extId,
            'AccountType': $ctrl.preSelectedAccount.typeName,
            'BankingBalanceAccess': $ctrl.preSelectedAccount.bankingBalanceAccess,
            'Fund': $ctrl.preSelectedAccount.balance,
            'Instrument': $ctrl.preSelectedAccount.instrument,
            'GlobalService': $ctrl.preSelectedAccount.globalService,
            'IsTestAccount': $ctrl.preSelectedAccount.isTestAccount,
            'MileagePlusNumberOfCompany': $ctrl.preSelectedAccount.mileagePlusNumberOfCompany
          }];
          $ctrl.arrangeAcc();
        }
      }
      $ctrl.loadAccounts();
      //abe edit 0822 add assist text
      $ctrl.showBenefiLabel = $rootScope.currentUser.isInternalUser;
    };
    $ctrl.arrangeAcc = function (skipCheck) {

      $ctrl.corpAccounts = util.filterAccountByType($ctrl.accounts,
        [$rootScope.ACC_TYPE.corp, $rootScope.ACC_TYPE.aor]);
      $ctrl.agtAccounts = util.filterAccountByType($ctrl.accounts,
        [$rootScope.ACC_TYPE.agency, $rootScope.ACC_TYPE.agencyBranch, $rootScope.ACC_TYPE.resv]);
      $ctrl.disAccounts = util.filterAccountByType($ctrl.accounts,
        [$rootScope.ACC_TYPE.dis]);

      var corp = util.filterAccountByType($ctrl.beneficiaryAccounts,
        [$rootScope.ACC_TYPE.corp, $rootScope.ACC_TYPE.psuedo]);
      var agt = util.filterAccountByType($ctrl.beneficiaryAccounts,
        [$rootScope.ACC_TYPE.agency, $rootScope.ACC_TYPE.agencyBranch]);

      $ctrl.agtBeneficiaries = _.cloneDeep(corp);
      $ctrl.disBeneficiaries = _.concat(_.cloneDeep(corp), _.cloneDeep(agt));

      if (!skipCheck) {
        $ctrl.checkAccount();
      }
    };
    $ctrl.loadAccounts = function (txtId) {
      if ($ctrl.amenityType && _.isNumber($ctrl.chargeAmount)) {

        var searchText = '';
        var extId = '';

        if ($ctrl.specialLoad) {
          switch (txtId) {
            case 'txt-company':
              searchText = $ctrl.companySearchValue;
              break;
            case 'txt-agency':
              searchText = $ctrl.agencySearchValue;
              break;
            case 'txt-dis':
              searchText = $ctrl.disSearchValue;
              break;
            case 'txt-agency-beneficiary':
              searchText = $ctrl.agtBeneficiary;
              break;
            case 'txt-dis-beneficiary':
              searchText = $ctrl.disBeneficiary;
              break;
          }

          if ($ctrl.callerAccount) {
            if ($ctrl.callerAccount.extId) {
              extId = $ctrl.callerAccount.extId;
            }
          }
        }

        $ctrl.poSpinner = true;

        if (!txtId) {

          AccountService.getBeneficiaryAccounts(
            $rootScope.currentUser.id, $ctrl.amenityType, searchText
          ).then(function (value) {

            $ctrl.poSpinner = false;
            $ctrl.beneficiaryAccounts = value.Accounts;
          }, function (err) {

            $ctrl.poSpinner = false;
            console.debug(err);
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });

          AccountService.getAccounts(
            $rootScope.currentUser.id, $ctrl.amenityType, searchText, extId
          ).then(function (value) {

            $ctrl.poSpinner = false;
            $ctrl.accounts = value.Accounts;
          }, function (err) {

            $ctrl.poSpinner = false;
            console.debug(err);
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
          if ($ctrl.specialLoad) {
            $ctrl.arrangeAcc(true);
            if (txtId) {
              $ctrl.searchAccInfo(txtId);
            }
          }
          else {
            $ctrl.arrangeAcc();
          }
        }

        if (txtId == 'txt-agency-beneficiary' ||
          txtId == 'txt-dis-beneficiary') {
          AccountService.getBeneficiaryAccounts(
            $rootScope.currentUser.id, $ctrl.amenityType, searchText
          ).then(function (value) {
            if (value.Accounts.length == 0 && searchText != '') {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'No results found. Please change your search parameters and try again.'
                });
            }
            $ctrl.poSpinner = false;
            // var acc = value.Accounts;
            // $ctrl.accounts = _.merge($ctrl.accounts, acc);
            $ctrl.beneficiaryAccounts = value.Accounts;
            if ($ctrl.specialLoad) {
              $ctrl.arrangeAcc(true);
              if (txtId) {
                $ctrl.searchAccInfo(txtId);
              }
            }
            else {
              $ctrl.arrangeAcc();
            }
          }, function (err) {

            $ctrl.poSpinner = false;
            console.debug(err);
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          })
        } else {
          AccountService.getAccounts(
            $rootScope.currentUser.id, $ctrl.amenityType, searchText, extId
          ).then(function (value) {
            if (value.Accounts.length == 0 && searchText != '') {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'No results found. Please change your search parameters and try again.'
                });
            }
            $ctrl.poSpinner = false;
            // var acc = value.Accounts;
            // $ctrl.accounts = _.merge($ctrl.accounts, acc);
            $ctrl.accounts = value.Accounts;

            if ($ctrl.specialLoad) {
              $ctrl.arrangeAcc(true);
              if (txtId) {
                $ctrl.searchAccInfo(txtId);
              }
            }
            else {
              $ctrl.arrangeAcc();
            }
          }, function (err) {

            $ctrl.poSpinner = false;
            console.debug(err);
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
        }
      }
    };
    $ctrl.checkAccount = function () {

      $ctrl.txtAgency = $('#txt-agency');
      $ctrl.ddlAgency = $('#ddl-agency');
      $ctrl.txtCompany = $('#txt-company');
      $ctrl.ddlCompany = $('#ddl-company');
      $ctrl.txtDiscretionary = $('#txt-dis');
      $ctrl.ddlDiscretionary = $('#ddl-dis');

      if ($ctrl.preSelectedAccount && $ctrl.preSelectedAccount.accountName !== '') {

        if ($ctrl.preSelectedAccount.typeName === $rootScope.ACC_TYPE.corp) {

          $ctrl.accountType = $rootScope.ACC_TYPE.corp;
          $ctrl.companyAccType = $rootScope.ACC_TYPE.corp;
          $ctrl.companySearchValue = $ctrl.preSelectedAccount.accountName;
          $ctrl.companySearchId = $ctrl.preSelectedAccount.accountId;
          $ctrl.companySearchExtId = $ctrl.preSelectedAccount.extId;
          $ctrl.companyBalance = $ctrl.preSelectedAccount.balance;
          $ctrl.companyIns = $ctrl.preSelectedAccount.instrument;
          $ctrl.companyGs = $ctrl.preSelectedAccount.globalService;
          $ctrl.companyBalanceAccess = $ctrl.preSelectedAccount.bankingBalanceAccess;
          $ctrl.isCompanyReadOnly = true;
          $ctrl.txtCompany.prop('readonly', true);
          $ctrl.txtCompany.prop('disabled', true);
          $ctrl.accSearchValue = $ctrl.companySearchValue;
          $ctrl.accSearchId = $ctrl.companySearchId;
          $ctrl.accSearchExtId = $ctrl.companySearchExtId;
          $ctrl.chargeTypeClick('company');
        }
        else if ($ctrl.preSelectedAccount.typeName === $rootScope.ACC_TYPE.aor) {

          $ctrl.accountType = $rootScope.ACC_TYPE.aor;
          $ctrl.companyAccType = $rootScope.ACC_TYPE.aor;
          $ctrl.companySearchValue = $ctrl.preSelectedAccount.accountName;
          $ctrl.companySearchId = $ctrl.preSelectedAccount.accountId;
          $ctrl.companySearchExtId = $ctrl.preSelectedAccount.extId;
          $ctrl.companyBalance = $ctrl.preSelectedAccount.balance;
          $ctrl.companyIns = $ctrl.preSelectedAccount.instrument;
          $ctrl.companyGs = $ctrl.preSelectedAccount.globalService;
          $ctrl.companyBalanceAccess = $ctrl.preSelectedAccount.bankingBalanceAccess;
          $ctrl.isCompanyReadOnly = true;
          $ctrl.txtCompany.prop('readonly', true);
          $ctrl.txtCompany.prop('disabled', true);
          $ctrl.accSearchValue = $ctrl.companySearchValue;
          $ctrl.accSearchId = $ctrl.companySearchId;
          $ctrl.accSearchExtId = $ctrl.companySearchExtId;
          $ctrl.chargeTypeClick('company');
        }
        else if ($ctrl.preSelectedAccount.typeName === $rootScope.ACC_TYPE.agencyBranch) {

          $ctrl.accountType = $rootScope.ACC_TYPE.agencyBranch;
          $ctrl.agencyAccType = $rootScope.ACC_TYPE.agencyBranch;
          $ctrl.agencySearchValue = $ctrl.preSelectedAccount.accountName;
          $ctrl.agencySearchId = $ctrl.preSelectedAccount.accountId;
          $ctrl.agencySearchExtId = $ctrl.preSelectedAccount.extId;
          $ctrl.agencyBalance = $ctrl.preSelectedAccount.balance;
          $ctrl.agencyIns = $ctrl.preSelectedAccount.instrument;
          $ctrl.agencyGs = $ctrl.preSelectedAccount.globalService;
          $ctrl.agencyBalanceAccess = $ctrl.preSelectedAccount.bankingBalanceAccess;
          $ctrl.accSearchValue = $ctrl.agencySearchValue;
          $ctrl.accSearchId = $ctrl.agencySearchId;
          $ctrl.accSearchExtId = $ctrl.agencySearchExtId;
          $ctrl.chargeTypeClick('agency');
        }
        else if ($ctrl.preSelectedAccount.typeName === $rootScope.ACC_TYPE.agency) {

          $ctrl.accountType = $rootScope.ACC_TYPE.agency;
          $ctrl.agencyAccType = $rootScope.ACC_TYPE.agency;
          $ctrl.agencySearchValue = $ctrl.preSelectedAccount.accountName;
          $ctrl.agencySearchId = $ctrl.preSelectedAccount.accountId;
          $ctrl.agencySearchExtId = $ctrl.preSelectedAccount.extId;
          $ctrl.agencyBalance = $ctrl.preSelectedAccount.balance;
          $ctrl.agencyIns = $ctrl.preSelectedAccount.instrument;
          $ctrl.agencyGs = $ctrl.preSelectedAccount.globalService;
          $ctrl.agencyBalanceAccess = $ctrl.preSelectedAccount.bankingBalanceAccess;
          $ctrl.accSearchValue = $ctrl.agencySearchValue;
          $ctrl.accSearchId = $ctrl.agencySearchId;
          $ctrl.accSearchExtId = $ctrl.agencySearchExtId;
          $ctrl.chargeTypeClick('agency');
        }
        else if ($ctrl.preSelectedAccount.typeName === $rootScope.ACC_TYPE.resv) {

          $ctrl.accountType = $rootScope.ACC_TYPE.resv;
          $ctrl.agencyAccType = $rootScope.ACC_TYPE.resv;
          $ctrl.agencySearchValue = $ctrl.preSelectedAccount.accountName;
          $ctrl.agencySearchId = $ctrl.preSelectedAccount.accountId;
          $ctrl.agencySearchExtId = $ctrl.preSelectedAccount.extId;
          $ctrl.agencyBalance = $ctrl.preSelectedAccount.balance;
          $ctrl.agencyIns = $ctrl.preSelectedAccount.instrument;
          $ctrl.agencyGs = $ctrl.preSelectedAccount.globalService;
          $ctrl.agencyBalanceAccess = $ctrl.preSelectedAccount.bankingBalanceAccess;
          $ctrl.accSearchValue = $ctrl.agencySearchValue;
          $ctrl.accSearchId = $ctrl.agencySearchId;
          $ctrl.accSearchExtId = $ctrl.agencySearchExtId;
          $ctrl.chargeTypeClick('agency');
        }
        else if ($ctrl.preSelectedAccount.typeName === $rootScope.ACC_TYPE.dis) {

          $ctrl.accountType = $rootScope.ACC_TYPE.dis;
          $ctrl.disAccType = $rootScope.ACC_TYPE.dis;
          $ctrl.disSearchValue = $ctrl.preSelectedAccount.accountName;
          $ctrl.disSearchId = $ctrl.preSelectedAccount.accountId;
          $ctrl.disBalance = $ctrl.preSelectedAccount.balance;
          $ctrl.disIns = $ctrl.preSelectedAccount.instrument;
          $ctrl.disGs = $ctrl.preSelectedAccount.globalService;
          $ctrl.disBalanceAccess = $ctrl.preSelectedAccount.bankingBalanceAccess;
          $ctrl.accSearchValue = $ctrl.disSearchValue;
          $ctrl.accSearchId = $ctrl.disSearchId;
          $ctrl.accSearchExtId = $ctrl.disSearchExtId;
          $ctrl.chargeTypeClick('dis');
        }

        if ($ctrl.companyOption == 3) {
          $ctrl.isCompanyReadOnly = true;
          $ctrl.txtCompany.prop('readonly', true);
          $ctrl.txtCompany.prop('disabled', true);
        }

        if ($ctrl.agencyOption == 3) {
          $ctrl.isAgencyReadOnly = true;
          $ctrl.txtAgency.prop('readonly', true);
          $ctrl.txtAgency.prop('disabled', true);
        }

        if ($ctrl.disOption == 3) {
          $ctrl.isDiscretionaryReadOnly = true;
          $ctrl.txtDiscretionary.prop('readonly', true);
          $ctrl.txtDiscretionary.prop('disabled', true);
        }

        $ctrl.populateBeneficiary();
        $ctrl.getAccountById();
      }
    };
    $ctrl.chargeTypeClick = function (type) {

      $ctrl.accountType = '';
      $ctrl.chargeType = '';
      $ctrl.accSearchValue = '';
      $ctrl.accSearchId = '';
      $ctrl.accSearchExtId = '';

      switch (type) {
        case 'company' :
          $ctrl.accountType = $rootScope.ACC_TYPE.corp;
          if ($ctrl.companySearchId) {
            _($ctrl.corpAccounts).forEach(function (acc) {

              if (acc.Id == $ctrl.companySearchId) {
                $ctrl.accountType = acc.AccountType;
                $ctrl.accSearchValue = acc.Name;
                $ctrl.accSearchId = acc.Id;
                $ctrl.accSearchExtId = acc.ExtId;
                $ctrl.beneficiarySearchId = '';
                $ctrl.beneficiarySearchValue = '';
                return false;
              }
            });
          }
          if ($ctrl.enableFund) {
            $ctrl.chargeType = 'fund';
          }
          else if ($ctrl.enableGs) {
            $ctrl.chargeType = 'gs';
          }
          else if ($ctrl.enableIns) {
            $ctrl.chargeType = 'ins';
          }
          $ctrl.agtBeneficiaryId = '';
          $ctrl.agtBeneficiary = '';
          $ctrl.agtBeneficiaryExtId = '';
          $ctrl.disBeneficiaryId = '';
          $ctrl.disBeneficiary = '';
          $ctrl.disBeneficiaryExtId = '';
          break;
        case 'agency' :
          $ctrl.accountType = $rootScope.ACC_TYPE.agency;
          if ($ctrl.agencySearchId) {
            _($ctrl.agtAccounts).forEach(function (acc) {

              if (acc.Id == $ctrl.agencySearchId) {
                $ctrl.accountType = acc.AccountType;
                $ctrl.accSearchValue = acc.Name;
                $ctrl.accSearchId = acc.Id;
                $ctrl.accSearchExtId = acc.ExtId;
                $ctrl.beneficiarySearchId = $ctrl.agtBeneficiaryId;
                $ctrl.beneficiarySearchValue = $ctrl.agtBeneficiary;
                return false;
              }
            });
          }
          if ($ctrl.enableFund) {
            $ctrl.chargeType = 'fund';
          }
          else if ($ctrl.enableGs) {
            $ctrl.chargeType = 'gs';
          }
          else if ($ctrl.enableIns) {
            $ctrl.chargeType = 'ins';
          }
          $ctrl.disBeneficiaryId = '';
          $ctrl.disBeneficiary = '';
          $ctrl.disBeneficiaryExtId = '';
          break;
        case 'dis' :
          $ctrl.accountType = $rootScope.ACC_TYPE.dis;
          $ctrl.accSearchValue = $ctrl.disSearchValue;
          $ctrl.accSearchId = $ctrl.disSearchId;
          $ctrl.accSearchExtId = $ctrl.disSearchExtId;
          $ctrl.beneficiarySearchId = $ctrl.disBeneficiaryId;
          $ctrl.beneficiarySearchValue = $ctrl.disBeneficiary;
          if ($ctrl.enableFund) {
            $ctrl.chargeType = 'fund';
          }
          else if ($ctrl.enableGs) {
            $ctrl.chargeType = 'gs';
          }
          else if ($ctrl.enableIns) {
            $ctrl.chargeType = 'ins';
          }
          $ctrl.agtBeneficiaryId = '';
          $ctrl.agtBeneficiary = '';
          $ctrl.agtBeneficiaryExtId = '';
          break;
      }

      $ctrl.populateBeneficiary();
      $ctrl.fundCheck();
    };
    $ctrl.fundCheck = function () {

      $ctrl.isValidCompanyFund = _.isNumber($ctrl.chargeAmount) &&
        _.isNumber($ctrl.companyBalance) && $ctrl.companyBalance >= $ctrl.chargeAmount;
      $ctrl.isValidCompanyIns = _.isNumber($ctrl.companyIns) && $ctrl.companyIns > 0;
      $ctrl.isValidCompanyGs = _.isNumber($ctrl.companyGs) && $ctrl.companyGs > 0;

      $ctrl.isValidAgencyFund = _.isNumber($ctrl.chargeAmount) &&
        _.isNumber($ctrl.agencyBalance) && $ctrl.agencyBalance >= $ctrl.chargeAmount;
      $ctrl.isValidAgencyIns = _.isNumber($ctrl.agencyIns) && $ctrl.agencyIns > 0;
      $ctrl.isValidAgencyGs = _.isNumber($ctrl.agencyGs) && $ctrl.agencyGs > 0;

      $ctrl.isValidDisFund = _.isNumber($ctrl.chargeAmount) &&
        _.isNumber($ctrl.disBalance) && $ctrl.disBalance >= $ctrl.chargeAmount;
      $ctrl.isValidDisIns = _.isNumber($ctrl.disIns) && $ctrl.disIns > 0;
      $ctrl.isValidDisGs = _.isNumber($ctrl.disGs) && $ctrl.disGs > 0;

      switch ($ctrl.accountType) {
        case $rootScope.ACC_TYPE.corp:
        case $rootScope.ACC_TYPE.aor:
          switch ($ctrl.chargeType) {
            case 'fund':
              $ctrl.isValidFundOption = $ctrl.isValidCompanyFund;
              break;
            case 'ins' :
              $ctrl.isValidFundOption = $ctrl.isValidCompanyIns;
              break;
            case 'gs':
              $ctrl.isValidFundOption = $ctrl.isValidCompanyGs;
              break;
          }
          break;
        case $rootScope.ACC_TYPE.agency:
        case $rootScope.ACC_TYPE.agencyBranch:
        case $rootScope.ACC_TYPE.resv:
          switch ($ctrl.chargeType) {
            case 'fund':
              $ctrl.isValidFundOption = $ctrl.isValidAgencyFund;
              break;
            case 'ins' :
              $ctrl.isValidFundOption = $ctrl.isValidAgencyIns;
              break;
            case 'gs':
              $ctrl.isValidFundOption = $ctrl.isValidAgencyGs;
              break;
          }
          break;
        case $rootScope.ACC_TYPE.dis:
          switch ($ctrl.chargeType) {
            case 'fund':
              $ctrl.isValidFundOption = $ctrl.isValidDisFund;
              break;
            case 'ins' :
              $ctrl.isValidFundOption = $ctrl.isValidDisIns;
              break;
            case 'gs':
              $ctrl.isValidFundOption = $ctrl.isValidDisGs;
              break;
          }
          break;
      }
    };
    $ctrl.getAccountById = function () {

      var id = '';
      switch ($ctrl.accountType) {
        case $rootScope.ACC_TYPE.corp:
        case $rootScope.ACC_TYPE.aor:
          id = $ctrl.companySearchId;
          break;
        case $rootScope.ACC_TYPE.agency:
        case $rootScope.ACC_TYPE.agencyBranch:
        case $rootScope.ACC_TYPE.resv:
          id = $ctrl.agencySearchId;
          break;
        case $rootScope.ACC_TYPE.dis:
          id = $ctrl.disSearchId;
          break;
      }

      if (id) {
        $ctrl.poSpinner = true;
        AccountService.getAccountById(
          id,
          $rootScope.currentUser.id
        ).then(function (value) {

          $ctrl.poSpinner = false;
          $ctrl.accSearchValue = value.Name;
          $ctrl.accSearchId = value.Id;
          $ctrl.accSearchExtId = value.ExtId;
          switch ($ctrl.accountType) {
            case $rootScope.ACC_TYPE.corp:
            case $rootScope.ACC_TYPE.aor:
              $ctrl.companyBalance = value.Fund;
              $ctrl.companyIns = value.Instrument;
              $ctrl.companyGs = value.GlobalService;
              $ctrl.companyBalanceAccess = value.BankingBalanceAccess;
              if ($ctrl.companyBalance === null || $ctrl.companyIns === null || $ctrl.companyGs === null) {
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                  });
              }
              break;
            case $rootScope.ACC_TYPE.agency:
            case $rootScope.ACC_TYPE.agencyBranch:
            case $rootScope.ACC_TYPE.resv:
              $ctrl.agencyBalance = value.Fund;
              $ctrl.agencyIns = value.Instrument;
              $ctrl.agencyGs = value.GlobalService;
              $ctrl.agencyBalanceAccess = value.BankingBalanceAccess;
              if ($ctrl.agencyBalance === null || $ctrl.agencyIns === null || $ctrl.agencyGs === null) {
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                  });
              }
              break;
            case $rootScope.ACC_TYPE.dis:
              $ctrl.disBalance = value.Fund;
              $ctrl.disIns = value.Instrument;
              $ctrl.disGs = value.GlobalService;
              $ctrl.disBalanceAccess = value.BankingBalanceAccess;
              if ($ctrl.disBalance === null || $ctrl.disIns === null || $ctrl.disGs === null) {
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                  });
              }
              break;
          }

          if (value.Id == $ctrl.preSelectedAccount.accountId) {
            $ctrl.preSelectedAccount.balance = value.Fund;
            $ctrl.preSelectedAccount.instrument = value.Instrument;
            $ctrl.preSelectedAccount.globalService = value.GlobalService;
          }

          $ctrl.fundCheck();
        }, function (err) {

          console.debug(err);
          $ctrl.poSpinner = false;
          switch (type) {
            case $rootScope.ACC_TYPE.corp:
            case $rootScope.ACC_TYPE.aor:
              $ctrl.companyBalance = null;
              $ctrl.companyIns = null;
              $ctrl.companyGs = null;
              break;
            case $rootScope.ACC_TYPE.agency:
            case $rootScope.ACC_TYPE.agencyBranch:
            case $rootScope.ACC_TYPE.resv:
              $ctrl.agencyBalance = null;
              $ctrl.agencyIns = null;
              $ctrl.agencyGs = null;
              break;
            case $rootScope.ACC_TYPE.dis:
              $ctrl.disBalance = null;
              $ctrl.disIns = null;
              $ctrl.disGs = null;
              break;
          }
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        });
      }
    };
    $ctrl.populateBeneficiary = function () {

      switch ($ctrl.accountType) {
        case $rootScope.ACC_TYPE.corp :
        case $rootScope.ACC_TYPE.aor :
          $ctrl.beneficiaryRequired = false;
          break;
        case $rootScope.ACC_TYPE.agency:
        case $rootScope.ACC_TYPE.agencyBranch :
        case $rootScope.ACC_TYPE.resv :
          $ctrl.beneficiaryRequired = false;
          break;
        case $rootScope.ACC_TYPE.dis :
          $ctrl.beneficiaryRequired = true;
          break;
      }
    };

    $ctrl.txtClick = function ($event) {

      $event.target.select();
    };
    $ctrl.txtKeyup = function ($event) {

      var txt = $event.target;
      switch ($event.keyCode) {
        case 13 : // enter key trigger search
          $(txt).dropdown('toggle');
          switch (txt.id) {
            case 'txt-company':
            case 'txt-agency':
            case 'txt-dis':
            case 'txt-agency-beneficiary':
            case 'txt-dis-beneficiary':
              $ctrl.searchAcc(txt.id);
              break;
          }
          break;
        case 40 :
          var ddl = $(txt).attr('aria-describedby');
          var li = $('#' + ddl).find('li:first');
          if (li.hasClass('list-limit-exceeded')) {
            li = li.next();
          }
          li.focus();
          break;
        default:
          switch (txt.id) {
            case 'txt-company':
              $ctrl.purgeCompany();
              break;
            case 'txt-agency':
              $ctrl.purgeAgency();
              break;
            case 'txt-dis':
              $ctrl.purgeDis();
              break;
            case 'txt-agency-beneficiary':
              $ctrl.agtBeneficiaryAccType = '';
              $ctrl.agtBeneficiaryExtId = '';
              $ctrl.beneficiarySearchId = '';
              break;
            case 'txt-dis-beneficiary':
              $ctrl.disBeneficiaryAccType = '';
              $ctrl.disBeneficiaryExtId = '';
              $ctrl.beneficiarySearchId = '';
              break;
          }
          break;
      }
    };
    $ctrl.ddlKeyup = function ($event) {

      switch ($event.keyCode) {
        case 38 :
          var prev = $($event.target).prev();
          if (prev.length > 0) {
            prev.focus();
          }
          break;

        case 40 :
          var next = $($event.target).next();
          if (next.length > 0) {
            next.focus();
          }
          break;
      }
    };

    $ctrl.purgeCompany = function () {

      $ctrl.isValidFundOption = false;
      $ctrl.companyAccType = '';
      $ctrl.companySearchId = '';
      $ctrl.companySearchExtId = '';
      $ctrl.chargeType = '';
      $ctrl.companyBalance = '';
      $ctrl.companyIns = '';
      $ctrl.companyGs = '';
      $ctrl.companyBalanceAccess = false;
      $ctrl.accSearchValue = '';
      $ctrl.accSearchId = '';
      $ctrl.accSearchExtId = '';
    };
    $ctrl.purgeAgency = function () {

      $ctrl.isValidFundOption = false;
      $ctrl.chargeType = '';
      $ctrl.agencyAccType = '';
      $ctrl.agencySearchId = '';
      $ctrl.agencySearchExtId = '';
      $ctrl.agencyBalance = '';
      $ctrl.agencyIns = '';
      $ctrl.agencyGs = '';
      $ctrl.agencyBalanceAccess = false;
      $ctrl.accSearchValue = '';
      $ctrl.accSearchId = '';
      $ctrl.accSearchExtId = '';
    };
    $ctrl.purgeDis = function () {

      $ctrl.disAccType = '';
      $ctrl.isValidFundOption = false;
      $ctrl.disSearchId = '';
      $ctrl.chargeType = '';
      $ctrl.disBalance = '';
      $ctrl.disIns = '';
      $ctrl.disGs = '';
      $ctrl.disBalanceAccess = false;
      $ctrl.accSearchValue = '';
      $ctrl.accSearchId = '';
      $ctrl.accSearchExtId = '';
    };

    $ctrl.searchAcc = function (txtId) {

      if ($ctrl.specialLoad) {
        $ctrl.loadAccounts(txtId);
      }
      else {
        $ctrl.searchAccInfo(txtId);
      }
    };

    $ctrl.searchAccInfo = function (txtId) {

      var record;
      if (txtId == 'txt-company' || txtId == 'txt-agency' || txtId == 'txt-dis') {
        $ctrl.accSearchValue = '';
        $ctrl.accSearchId = '';
        $ctrl.accSearchExtId = '';
        switch (txtId) {
          case 'txt-company':
            $ctrl.purgeCompany();
            _($ctrl.corpAccounts).forEach(function (acc) {

              if ($ctrl.companySearchValue === acc.Name) {
                $ctrl.companySearchId = acc.Id;
                $ctrl.companySearchExtId = acc.ExtId;
                $ctrl.accountType = acc.AccountType;
                record = acc;
                return false;
              }
            });
            break;
          case 'txt-agency':
            $ctrl.purgeAgency();
            _($ctrl.agtAccounts).forEach(function (acc) {

              if ($ctrl.agencySearchValue === acc.ExtId || $ctrl.agencySearchValue === acc.Name) {
                $ctrl.agencySearchId = acc.Id;
                $ctrl.agencySearchExtId = acc.ExtId;
                $ctrl.accountType = acc.AccountType;
                record = acc;
                return false;
              }
            });
            break;
          case 'txt-dis':
            $ctrl.purgeDis();
            _($ctrl.disAccounts).forEach(function (acc) {

              if ($ctrl.disSearchValue === acc.Name) {
                $ctrl.disSearchId = acc.Id;
                $ctrl.disSearchExtId = acc.ExtId;
                $ctrl.accountType = acc.AccountType;
                record = acc;
                return false;
              }
            });
            break;
        }
        if ($ctrl.enableFund) {
          $ctrl.chargeType = 'fund';
        }
        else if ($ctrl.enableGs) {
          $ctrl.chargeType = 'gs';
        }
        else if ($ctrl.enableIns) {
          $ctrl.chargeType = 'ins';
        }
        if (record) {
          $ctrl.getAccountById();
        }
        else {
          $('#' + txtId).dropdown('toggle');
        }
      }
      else if (txtId == 'txt-agency-beneficiary') {

        var isMatch = false;
        $ctrl.beneficiarySearchId = '';
        $ctrl.beneficiarySearchValue = '';
        $ctrl.agtBeneficiaryAccType = '';
        $ctrl.agtBeneficiaryExtId = '';
        _($ctrl.agtBeneficiaries).forEach(function (b) {

          if (_.lowerCase($ctrl.agtBeneficiary) === _.lowerCase(b.Name)) {
            isMatch = true;
            $ctrl.beneficiarySearchValue = b.Name;
            $ctrl.beneficiarySearchId = b.Id;
            $ctrl.agtBeneficiaryId = b.Id;
            $ctrl.agtBeneficiaryAccType = b.AccountType;
            $ctrl.agtBeneficiaryExtId = b.ExtId;
            return false;
          }
        });
        if (!isMatch) {
          $ctrl.agtBeneficiaryId = '';
          $ctrl.agtBeneficiary = '';
          $('#' + txtId).dropdown('toggle');
        }
      }
      else if (txtId == 'txt-dis-beneficiary') {

        var isMatch = false;
        $ctrl.beneficiarySearchId = '';
        $ctrl.beneficiarySearchValue = '';
        $ctrl.disBeneficiaryAccType = '';
        $ctrl.disBeneficiaryExtId = '';
        _($ctrl.disBeneficiaries).forEach(function (b) {

          if (_.lowerCase($ctrl.disBeneficiary) === _.lowerCase(b.Name)) {
            isMatch = true;
            $ctrl.beneficiarySearchValue = b.Name;
            $ctrl.beneficiarySearchId = b.Id;
            $ctrl.disBeneficiaryId = b.Id;
            $ctrl.disBeneficiaryAccType = b.AccountType;
            $ctrl.disBeneficiaryExtId = b.ExtId;
            return false;
          }
        });
        if (!isMatch) {
          $ctrl.disBeneficiaryId = '';
          $ctrl.disBeneficiary = '';
          $('#' + txtId).dropdown('toggle');
        }
      }
    };
    $ctrl.selectAcc = function (acc, txtId) {

      if (txtId == 'txt-company' || txtId == 'txt-agency' || txtId == 'txt-dis') {
        switch (txtId) {
          case 'txt-company':
            // $ctrl.txtCompany.dropdown('toggle');
            $ctrl.purgeCompany();
            $ctrl.companySearchValue = acc.Name;
            $ctrl.companySearchId = acc.Id;
            $ctrl.companySearchExtId = acc.ExtId;
            $ctrl.companyAccType = acc.AccountType;
            $ctrl.forms.paymentOptForm.txtCompany.$validate();
            break;
          case 'txt-agency':
            // $ctrl.txtAgency.dropdown('toggle');
            $ctrl.purgeAgency();
            $ctrl.agencySearchValue = acc.Name;
            $ctrl.agencySearchId = acc.Id;
            $ctrl.agencySearchExtId = acc.ExtId;
            $ctrl.agencyAccType = acc.AccountType;
            $ctrl.forms.paymentOptForm.txtAgency.$validate();
            break;
          case 'txt-dis':
            // $ctrl.txtDiscretionary.dropdown('toggle');
            $ctrl.purgeDis();
            $ctrl.disSearchValue = acc.Name;
            $ctrl.disSearchId = acc.Id;
            $ctrl.disAccType = acc.AccountType;
            $ctrl.forms.paymentOptForm.txtDis.$validate();
            break;
        }
        $ctrl.accountType = acc.AccountType;
        if ($ctrl.enableFund) {
          $ctrl.chargeType = 'fund';
        }
        else if ($ctrl.enableGs) {
          $ctrl.chargeType = 'gs';
        }
        else if ($ctrl.enableIns) {
          $ctrl.chargeType = 'ins';
        }
        $ctrl.getAccountById();
      }
      else if (txtId == 'txt-agency-beneficiary') {
        $ctrl.txtAgencyBeneficiary.dropdown('toggle');
        $ctrl.beneficiarySearchId = acc.Id;
        $ctrl.beneficiarySearchValue = acc.Name;
        $ctrl.agtBeneficiaryId = acc.Id;
        $ctrl.agtBeneficiary = acc.Name;
        $ctrl.agtBeneficiaryAccType = acc.AccountType;
        $ctrl.agtBeneficiaryExtId = acc.ExtId;
        $ctrl.forms.paymentOptForm.txtAgtBeneficiary.$validate();
      }
      else if (txtId == 'txt-dis-beneficiary') {
        $ctrl.txtDiscretionaryBeneficiary.dropdown('toggle');
        $ctrl.beneficiarySearchId = acc.Id;
        $ctrl.beneficiarySearchValue = acc.Name;
        $ctrl.disBeneficiaryId = acc.Id;
        $ctrl.disBeneficiary = acc.Name;
        $ctrl.disBeneficiaryAccType = acc.AccountType;
        $ctrl.disBeneficiaryExtId = acc.ExtId;
        $ctrl.forms.paymentOptForm.txtDisBeneficiary.$validate();
      }
    };

    $ctrl.getAccClass = function (accType) {

      var result;
      switch (accType) {
        case $rootScope.ACC_TYPE.agency:
        case $rootScope.ACC_TYPE.agencyBranch:
          result = 'agency';
          break;
        case $rootScope.ACC_TYPE.resv:
          result = 'reserved';
          break;
        case $rootScope.ACC_TYPE.corp:
        case $rootScope.ACC_TYPE.aor:
          result = 'corporate';
          break;
        case $rootScope.ACC_TYPE.dis:
          result = 'dis';
          break;
      }
      return result;
    };
    $ctrl.getAccSymbol = function (accType) {

      var result;
      switch (accType) {
        case $rootScope.ACC_TYPE.agency:
          result = 'H';
          break;
        case $rootScope.ACC_TYPE.agencyBranch:
          result = 'A';
          break;
        case $rootScope.ACC_TYPE.resv:
          result = 'R';
          break;
        case $rootScope.ACC_TYPE.corp:
        case $rootScope.ACC_TYPE.aor:
          result = 'C';
          break;
        case $rootScope.ACC_TYPE.dis:
          result = 'D';
          break;
      }
      return result;
    };
    $ctrl.getAccTitle = function (accType) {

      var result;
      switch (accType) {
        case $rootScope.ACC_TYPE.agency:
          result = 'HOL';
          break;
        case $rootScope.ACC_TYPE.agencyBranch:
          result = 'Agency';
          break;
        case $rootScope.ACC_TYPE.resv:
          result = 'Reserved';
          break;
        case $rootScope.ACC_TYPE.corp:
        case $rootScope.ACC_TYPE.aor:
          result = 'Corporate';
          break;
        case $rootScope.ACC_TYPE.dis:
          result = 'Discretionary';
          break;
      }
      return result;
    };

    $ctrl.filterAccount = function (text) {

      return function (item) {

        if ((_.toLower(item.Name)).indexOf((_.toLower(text))) >= 0 ||
          (item.ExtId && item.ExtId.indexOf(text)) >= 0) {
          return true;
        }
        else {
          return false;
        }
      };
    };
  }
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('penaltyWaiverController', controller);

  controller.$inject = ['$rootScope', '$scope', '$state', 'formPattern', 'util',
    'PNRService', 'AccountService', 'AmenityService'];
  function controller($rootScope, $scope, $state, formPattern, util,
                      PNRService, AccountService, AmenityService) {

    $scope.formPattern = formPattern;
    $scope.confirmModal = $('#penalty-waiver-confirm-modal');
    $scope.successModal = $('#penalty-waiver-success-modal');
    $scope.messageModal = $('#message-modal');

    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: $rootScope.currentUser.isInternalUser ? 'Exchanging ticket 016-(Original Ticket Number)' : '',
      isValidFundOption: true,
      enableFund: true,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ? 1 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ? 1 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp ? 2 : 1) :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ? 1 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: 'SIP_Penalty_Waiver__c'
    };

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;
      if ($scope.data.widgetFeature == 'apply-waiver') {
        $scope.data.charge.chargeAmount = '';
      }
      else if ($scope.data.widgetFeature == 'confirm-waiver') {
        $scope.data.charge.chargeAmount = $scope.data.PNR ? $scope.data.PNR.SalesReservationDetail.SumWaiverFee : 0;
      }
    });

    /***********
     * apply waiver start
     ***********/
    $scope.formatDate = function (date) {

      var dateOut = new Date(date);
      return dateOut;
    };
    $scope.formatDate2 = function (date) {

      var year = date.substring(0, 4);
      var month = date.substring(4).substring(0, 2);
      var day = date.substring(6);
      var dateOut = new Date(year + '/' + month + '/' + day);
      return dateOut;
    };
    $scope.selectableTicket = function (ticket) {

      if (_.toLower(ticket.IsSelectable) === 'true' || ticket.IsSelectable == true) {
        return true;
      }
      else {
        return false;
      }
    };
    $scope.notSelectableTicket = function (ticket) {

      if (_.toLower(ticket.IsSelectable) === 'true' || ticket.IsSelectable == true) {
        return false;
      }
      else {
        return true;
      }
    };
    $scope.toggleTicket = function (ticket, performCostCalculation) {

      if (ticket) {

        if (ticket.IsSelectable) {
          ticket.IsSelected = ticket.IsSelected ? false : true;
        }

        if (ticket.IsSelected) {
          $scope.data.selectedPrimaryTicketCount++;
          $scope.data.selectedTicketCount++;
          $scope.data.selectedTicketNumber.push(ticket.TicketNumber);
        }
        else {
          $scope.data.selectedPrimaryTicketCount--;
          $scope.data.selectedTicketCount--;
          $scope.data.selectedTicketNumber.splice($scope.data.selectedTicketNumber.indexOf(ticket.TicketNumber), 1);
        }

        _(ticket.ConjunctiveTickets).forEach(function (conjunctiveTicket) {

          conjunctiveTicket.IsSelected = ticket.IsSelected;
          if (conjunctiveTicket.IsSelected) {
            $scope.data.selectedTicketCount++;
            $scope.data.selectedTicketNumber.push(conjunctiveTicket.TicketNumber);
          }
          else {
            $scope.data.selectedTicketCount--;
            $scope.data.selectedTicketNumber.splice($scope.data.selectedTicketNumber.indexOf(conjunctiveTicket.TicketNumber), 1);
          }
        });

        if (performCostCalculation) {
          $rootScope.mainSpinner = true;
          PNRService.applyWaiver($scope.data.PNR).then(function (value) {

            $rootScope.mainSpinner = false;
            $scope.data.PNR = value;
            $rootScope.$broadcast('fundCheck', {});
          }, function (err) {

            console.debug(err);
            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
        }
      }
    };
    $scope.applyWaiver = function () {

      if ($scope.data.selectedPrimaryTicketCount > 0) {

        $rootScope.mainSpinner = true;
        PNRService.applyWaiver(
          $scope.data.PNR
        ).then(function (value) {

          $rootScope.mainSpinner = false;
          $scope.data.PNR = value;
          $state.go($state.current.parent + '-penalty-waiver', {feature: 'confirm-waiver'});

        }, function (err) {

          console.debug(err);
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        });
      }
    };
    /***********
     * apply waiver end
     ***********/

    /***********
     * confirm waiver start
     ***********/
    $scope.back = function () {

      $state.go($state.current.parent + '-penalty-waiver', {feature: 'apply-waiver'});
    };
    $scope.confirmWaiver = function () {

      if ($rootScope.IsImpersonation) {
        return;
      }

      $scope.confirmModal.modal();
    };

    $scope.comfirmApplyWaiverMessage = false;
    $scope.confirmApplyWaiver = function () {

      if ($scope.data.selectedPrimaryTicketCount > 0) {

        var accountType = $scope.data.charge.accountType;
        var remark = $scope.data.charge.remark;
        var comment = $scope.data.charge.comment;
        var payerId = $scope.data.charge.accSearchId;
        var beneficiaryId = $scope.data.charge.beneficiarySearchId;
        var callerId = '';
        if ($scope.data.callerAccount) {
          callerId = $scope.data.callerAccount.accountId;
        }

        $rootScope.mainSpinner = true; // 1. recheck fund availability
        AccountService.getAccountById(
          payerId,
          $rootScope.currentUser.id
        ).then(function (value) {

          var fund = value.Fund;
          $rootScope.mainSpinner = false;
          if ($scope.data.selectedPrimaryTicketCount > 0 &&
            fund >= $scope.data.PNR.SalesReservationDetail.SumWaiverFee) {

            $rootScope.mainSpinner = true; // 2. send request to confirm waiver
            PNRService.confirmWaiverFavor(
              $scope.data.PNR,
              $rootScope.currentUser.id,
              payerId,
              beneficiaryId,
              callerId,
              comment,
              remark
            ).then(function (value) {

              $rootScope.mainSpinner = false;
              if (value.errors && value.errors.length > 0) {
                $scope.comfirmApplyWaiverMessage = true;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: value.errors[0]
                  });
              }
              else {
                $scope.data.transactionEntity = value;
                $scope.confirmModal.modal('hide');
                $scope.successModal.modal();

                $scope.canDismiss = true;
                if ($rootScope.currentUser.isInternalUser) {
                  $scope.canDismiss = false;
                }

                var waiverCode = $scope.data.transactionEntity.ticketInfos[0].waiverFavorId;

                $scope.data.remarkMessage = '';
                AmenityService.sendRemarks(
                  $scope.data.PNR,
                  $rootScope.currentUser.id,
                  waiverCode,
                  'x90',
                  remark
                ).then(function (value) {

                  if (value.success) {
                    if (value.messages.length > 0) {
                      $scope.data.remarkMessage = value.messages[0];
                    }
                  }
                  else {
                    $scope.data.remarkMessage = 'Failed to send remarks. Please document the record in EZR.';
                  }
                  $scope.canDismiss = true;
                }, function (err) {

                  $scope.data.remarkMessage = 'Failed to send remarks. Please document the record in EZR.';
                  $scope.canDismiss = true;
                });
              }
            }, function (err) {

              $rootScope.mainSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: err
                });
            });
          }
          else {
            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Insufficient funds, please select another account.'
              });
          }
        }, function (err) {

          console.debug(err);
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        });
      }
    };
    $scope.messageModal.on('hidden.bs.modal', function (e) {

      if ($scope.comfirmApplyWaiverMessage) {
        $scope.comfirmApplyWaiverMessage = false;

        $rootScope.$broadcast('refreshSelectedAccount', {});
      }
    });

    $scope.validateText1 = function ($event) {

      var pattern = '^[a-zA-Z0-9 \b]*$';
      var pRegex = new RegExp(pattern);

      var key = String.fromCharCode(!$event.charCode ? $event.which : $event.charCode);
      if (!pRegex.test(key)) {
        $event.preventDefault();
        return false;
      }
    };
    /***********
     * confirm waiver end
     ***********/

    /***********
     * clipboard start
     ***********/
    $scope.initCopyToClipboard = function (el) {

      var id = 'wc-' + el.ticketNumber + el.waiverFavorId;
      var element = document.getElementById(id);

      if (document.body.createTextRange) { // ie

        $('.copied').removeClass('copied');
        $(element).addClass("copied");
        window.clipboardData.setData('Text', element.innerHTML);
      }
      else if (window.getSelection) { // moz, opera, webkit

        var selection = window.getSelection();
        var range = document.createRange();
        range.selectNodeContents(element);
        selection.removeAllRanges();
        selection.addRange(range);
        document.execCommand("Copy");
      }
      document.body.onclick = function (e) {

        if ($(e.target.previousElementSibling).attr("id") === id) {
          return;
        }
        $(element).removeClass("copied");
      };
    };
    /***********
     * clipboard end
     ***********/

    /***********
     * email start
     ***********/
    $scope.popup = {
      sendMeEmail: false,
      sendOtherEmail: false,
      otherEmailAddr: '',
      isInvalidEmail: false
    };
    $scope.dismissWaiver = function () {

      if ($scope.popup.sendMeEmail) {

        var referenceNumber = $scope.data.transactionEntity.referenceNumber;
        var otherEmail = '';

        $rootScope.mainSpinner = true;
        PNRService.sendConfirmationEmail(
          referenceNumber,
          otherEmail,
          $scope.popup.sendMeEmail,
          $scope.popup.sendOtherEmail,
          $scope.data.PNR
        ).then(function () {

          $rootScope.mainSpinner = false;
          $scope.successModal.modal('hide');
        }, function (err) {

          console.debug(err);
          $rootScope.mainSpinner = false;
          $scope.successModal.modal('hide');
        });
      }
      else {
        $scope.successModal.modal('hide');
      }
    };
    /***********
     * email end
     ***********/

    $scope.successModal.on('hidden.bs.modal', function (e) {

      $state.go($state.current.parent + '-home', {feature: 'init'});
    });

    $scope.goHome = function () {

      $rootScope.$broadcast('goHome', {needConfirm: true});
    };
  }

})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('seatAssignmentController', controller);

  controller.$inject = ['$rootScope', '$scope', '$state', '$window', '$document',
    'PNRService', 'AccountService', 'AmenityService', 'util'];
  function controller($rootScope, $scope, $state, $window, $document,
                      PNRService, AccountService, AmenityService, util) {

    $scope.exitSeatDesc = '\u003Cul\u003E\u003Cli\u003EBe at least 15 years of age and able to perform all of the functions listed below without assistance.\u003C/li\u003E\u003Cli\u003ENot be traveling with: a customer who requires special care, such as a small child; a pet or emotional support animal ; a portable oxygen concentrator; or any other item or companion that may prevent you from performing any of the required functions listed.\u003C/li\u003E\u003Cli\u003ERead and speak well enough to understand the instructions, provided by United in printed or graphic form, for opening exits and other emergency procedures and give information during an emergency.\u003C/li\u003E' + '\u003Cli\u003ESee well enough to perform the emergency exit functions. Persons may wear glasses or contact lenses.\u003C/li\u003E\u003Cli\u003EUnderstand English well enough and hear well enough to understand crewmembers\' commands. Persons may wear a hearing aid.\u003C/li\u003E\u003Cli\u003EBe able to reach the emergency exit quickly and assist customers off an escape slide.\u003C/li\u003E\u003Cli\u003EBe able to use both hands, both arms and both legs, as well as maintain balance and be strong and flexible enough to operate the exit and any slide mechanism; open the exit and go quickly through it; stabilize the escape slide; assist others in getting off an escape slide; and clear the exit row of obstructions including window hatches as required. Some window hatches that must be lifted can weigh as much as 58 lbs. (26 kgs.).\u003C/li\u003E\u003C/ul\u003E';

    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: $rootScope.currentUser.isInternalUser ? 'Assigned Economy Plus seat __ on UA__  (Add more if necessary)' : '',
      isValidFundOption: true,
      enableFund: true,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ? 1 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ? 1 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp ? 2 : 1) :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ? 1 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: 'SIP_Economy_Plus__c'
    };

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;

      switch ($scope.data.widgetFeature) {
        case 'apply-eplus':
          $scope.data.charge.chargeAmount = '';
          AccountService.isInAmexFamily($rootScope.currentUser.accId).then(function (value) {

            $scope.isAmexUser = value;
          }, function (err) {

            console.debug(err);
          });
          break;
        case 'confirm-eplus':
          $scope.data.charge.chargeAmount = $scope.data.cart ? $scope.data.cart.total : 0;
          AccountService.isInAmexFamily($rootScope.currentUser.accId).then(function (value) {

            $scope.isAmexUser = value;
          }, function (err) {

            console.debug(err);
          });
          break;
      }
    });

    /***********
     * cart start
     ***********/
    $scope.changeSelectedSeat = function (segmentIndex, legIndex, travelerIndex, isToApplyPage) {

      $scope.data.cart.showCart = false;

      var isReloaded = false;
      if ($scope.data.selection.selectedSegmentIndex != segmentIndex) {

        $scope.data.selection.selectedSegmentIndex = segmentIndex;
        $scope.data.selection.currentAirSegment = $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.EPlusSegment[$scope.data.selection.selectedSegmentIndex];

        $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.previousSelectedFlightSegment = null;
        $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.selectedFlightSegment = $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.EPlusSegment[$scope.data.selection.selectedSegmentIndex];

        if (!isToApplyPage) {
          isReloaded = true;
          $scope.getSeatMap(legIndex, travelerIndex);
        }
      }
      else {
        $scope.data.selection.currentSegmentSeatMap = $scope.data.selection.segmentSeatMaps[$scope.data.selection.selectedLegIndex];
        $scope.data.selection.selectedTravelerIndex = travelerIndex;
      }

      $scope.showCart = false;

      if (isToApplyPage) {
        $state.go($state.current.parent + '-seat-assignment', {
          feature: 'apply-eplus'
        }).then(function () {
          if (!isReloaded) {
            $scope.getSeatMap(legIndex, travelerIndex);
          }
        });
      }
    };
    $document.on('scroll', function () {

      var eplus = $('#apply-eplus');
      var cart = $('#eplus-cart');

      if (eplus != undefined && cart != undefined &&
        eplus.length > 0 && cart.length > 0) {
        var y = $(eplus).position().top;
        var top = 0;

        if (($window.scrollY || document.documentElement.scrollTop) > y) {
          top = ($window.scrollY || document.documentElement.scrollTop) - y;
        }

        if (($window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth) > 768) {
          top = top - 60;
        }

        if (top < 0) {
          top = 0;
        }

        $(cart).css('top', top + 'px');
        if (top > 0) {
          $(cart).css('z-index', '2');
          $(cart).addClass('mdl-shadow--4dp');
        }
        else {
          $(cart).css('z-index', '1');
          $(cart).removeClass('mdl-shadow--4dp');
        }
      }
    });
    /***********
     * cart start
     ***********/

    /*********** Apply EPlus Start ***********/

    /***********
     * segment start
     ***********/
    $scope.$watch('data.selection.selectedLegIndex', function (newValue, oldValue, scope) {

      $scope.checkAvailability();
    }, true);
    $scope.$watch('data.selection.selectedTravelerIndex', function (newValue, oldValue, scope) {

      $scope.checkAvailability();
    }, true);
    $scope.checkAvailability = function () {

      // default as false
      if ($scope.data.selection) {
        $scope.data.selection.selectable = false;
        $scope.data.selection.restricted = false;

        if ($scope.data.selection.selectedSegmentIndex > -1 &&
          $scope.data.selection.selectedLegIndex > -1 &&
          $scope.data.selection.selectedTravelerIndex > -1 &&
          $scope.data.selection.segmentSeatMaps &&
          $scope.data.selection.currentSegmentSeatMap) {

          // 1. Check selected leg accessibility
          if (!$scope.data.selection.currentSegmentSeatMap.IsSeatMapDisabled) {

            // 20170217 Ryan; Upper cabin validation
            // When <Booking Class Cabin> not equal to "Y" and # of cabins>1, user shouldn't be able to interact with the map.
            // Passengers may or may not have a seat. Irrespective of the seats, you still make it non-interactable.
            // DF-00670
            if ($scope.data.selection.currentAirSegment.BookingClassCabin != 'Y' &&
              $scope.data.selection.currentSegmentSeatMap.Cabins.length > 1) {

              $scope.data.selection.currentSegmentSeatMap.IsSeatMapDisabled = true;
              $scope.data.selection.currentSegmentSeatMap.SeatMapDisabledType = 4;
              return;
            }
            else {
              $scope.data.selection.currentSegmentSeatMap.IsSeatMapDisabled = false;
              $scope.data.selection.currentSegmentSeatMap.SeatMapDisabledType = -1;
            }

            // 2. Check passenger restriction, check in status, etc
            for (var i = 0; i < $scope.data.selection.segmentSeatMaps.length; i++) {

              for (var j = 0; j < $scope.data.selection.segmentSeatMaps[i].Travelers.length; j++) {

                var traveler = $scope.data.selection.segmentSeatMaps[i].Travelers[j];
                var sTraveler = $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.EPlusTraveler[j];

                if (i == $scope.data.selection.selectedLegIndex) {

                  // is checkin
                  _.forEach(sTraveler.TravelerSegments, function (s) {

                    if (s.SegmentNumber == $scope.data.selection.currentAirSegment.SegmentNumber) {

                      traveler.IsCheckedIn = !s.AllowToSelectSeatSegmentLevel;
                      return false;
                    }
                  });

                  // is ssmf
                  _.forEach($scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.EPlusTraveler, function (et, etIndex) {

                    if (etIndex != j) {

                      if (et.PNRNameNumber == sTraveler.PNRNameNumber) {
                        traveler.IsSSMF = true;
                        return false;
                      }
                    }
                  });

                  // is restricted / not select on previous leg
                  if (i == 0) {
                    traveler.IsRestricted = false;
                  }
                  else {
                    var prevSegmentTraveler = $scope.data.selection.segmentSeatMaps[i - 1].Travelers[j];
                    traveler.IsRestricted = !(prevSegmentTraveler.SelectedSeat &&
                    prevSegmentTraveler.SelectedSeat.SeatNumber &&
                    prevSegmentTraveler.SelectedSeat.SeatNumber.length > 0);
                  }
                }
              }
            }

            // 2.2 Current selected passenger status / message
            var currTraveler = $scope.data.selection.currentSegmentSeatMap.Travelers[$scope.data.selection.selectedTravelerIndex];
            $scope.data.selection.restricted = currTraveler.IsRestricted;
            $scope.data.selection.seatExpired = currTraveler.SelectedSeat && currTraveler.SelectedSeat.IsSeatExpired;
            $scope.data.selection.isCheckedIn = currTraveler.IsCheckedIn;
            $scope.data.selection.isSSMF = currTraveler.IsSSMF;

            // 2.3 Current selected passenger privilege info
            var segmentSeatMap = $scope.data.selection.segmentSeatMaps[$scope.data.selection.selectedLegIndex];
            var isBundle = $scope.getIsBundle(segmentSeatMap);
            //var companionCount = $scope.getCompanionCount(segmentSeatMap);

            $scope.data.selection.privilegeText = '';
            //20170612 Passenger must have tier level in entailment
            if (currTraveler.tierlevelSeatMap && currTraveler.hasPrivilege) {
              $scope.data.selection.privilegeText = currTraveler.tierlevelSeatMap;
            }
            if (currTraveler.IsEPlusSubscriber) {
              if ($scope.data.selection.privilegeText) {
                $scope.data.selection.privilegeText += ' | ';
              }
              // $scope.data.selection.privilegeText += '\u003Cb\u003ESubscription\u003C/b\u003E';
              //20170613 subscription with region info
              $scope.data.selection.privilegeText += currTraveler.subscriptionSeatMap;
            }
            if (isBundle) {
              if ($scope.data.selection.privilegeText) {
                $scope.data.selection.privilegeText += ' | ';
              }
              $scope.data.selection.privilegeText += '\u003Cb\u003EEconomy Plus Bundle\u003C/b\u003E';
            }
            if (currTraveler.IsOTP) {
              if ($scope.data.selection.privilegeText) {
                $scope.data.selection.privilegeText += ' | ';
              }
              $scope.data.selection.privilegeText += '\u003Cb\u003EOne-Time Purchase\u003C/b\u003E';
            }
            if (currTraveler.CompanionCount > 0) {
              if ($scope.data.selection.privilegeText) {
                $scope.data.selection.privilegeText += ' | ';
              }
              var companionText = '{0} Companion(s) Eligible';
              companionText = companionText.replace('{0}', currTraveler.CompanionCount);
              $scope.data.selection.privilegeText += companionText;
            }

            $scope.data.selection.selectable = !$scope.data.selection.restricted && !$scope.data.selection.isCheckedIn && !$scope.data.selection.isSSMF;
          }

          // 3. Check accessibility
          //var isBundle = $scope.getIsBundle($scope.data.selection.currentSegmentSeatMap);
          var companionCount = $scope.getCompanionCount($scope.data.selection.currentSegmentSeatMap);

          // 3.1 Check each seat accessibility
          var traveler = $scope.data.selection.currentSegmentSeatMap.Travelers[$scope.data.selection.selectedTravelerIndex];
          //var nameIndex = traveler.TravelerNameIndex;
          var id = traveler.ID;

          $scope.data.selection.isOTPInaccessible = false;
          _.forEach($scope.data.selection.currentSegmentSeatMap.Cabins, function (cabin) {

            if (!cabin.IsUpperCabin) {
              _.forEach(cabin.HorizontalPlaneGroups, function (group) {

                _.forEach(group.HorizontalPlaneRows, function (row) {

                  _.forEach(row.Seats, function (seat) {

                    seat.IsAccessible = true;
                    seat.SeatPhraseology = '';
                    if (seat.IsAvailable) {

                      if (seat.IsAccessible) {
                        _.forEach(seat.BlankFareList, function (b) {

                          if (b.Name == id) {
                            seat.IsAccessible = seat.IsAccessible && b.Amount != -1;
                            if (!seat.IsAccessible) {

                              var type = _.lowerCase(b.Type);

                              if (type.indexOf('elf') != -1) {
                                seat.SeatPhraseology = 'Seat selection not available for Basic Economy fares.';
                              }
                              else if (type.indexOf('ssr') != -1) {
                                seat.SeatPhraseology = 'Seat selection not available for Special Service Requests';
                              }
                              else {
                                seat.SeatPhraseology = 'Unable to assign blocked seats.';
                              }
                            }
                            else {
                              seat.SeatPhraseology = '';
                            }
                          }
                        });
                      }

                      // Ryan 20170302
                      // fallback to check service fund for seat accessibility
                      if (seat.IsAccessible) {

                        _.forEach(seat.ServiceFundList, function (s) {

                          if (s.Name == id) {
                            seat.IsAccessible = seat.IsAccessible && s.Amount != -1;
                            if (!seat.IsAccessible) {

                              var type = _.lowerCase(s.Type);

                              if (type.indexOf('elf') != -1) {
                                seat.SeatPhraseology = 'Seat selection not available for Basic Economy fares.';
                              }
                              else if (type.indexOf('ssr') != -1) {
                                seat.SeatPhraseology = 'Seat selection not available for Special Service Requests';
                              }
                              else {
                                seat.SeatPhraseology = 'Unable to assign blocked seats.';
                              }
                            }
                            else {
                              seat.SeatPhraseology = '';
                            }
                          }
                        });
                      }

                      // if (seat.IsAccessible) {
                      //   _.forEach(seat.ServiceFundList, function (sf) {
                      //
                      //     if (sf.Name == id) {
                      //       seat.IsAccessible = seat.IsAccessible && sf.Amount != -1; // -1: ssr
                      //       if (!seat.IsAccessible) {
                      //         seat.SeatPhraseology = 'Seat selection not available for Special Service Requests';
                      //       }
                      //       else {
                      //         seat.SeatPhraseology = '';
                      //       }
                      //     }
                      //   });
                      // }

                      if (seat.IsAccessible && traveler.IsOTP && companionCount == 0) {

                        var travelerOTPAmount = traveler.CSLSelectedSeat.OTPSeatPrice;
                        var seatOTPAmount = null;
                        _.forEach(seat.USDList, function (price) {

                          if (price.Name == id) {
                            seatOTPAmount = price.Amount;
                          }
                        });

                        if (travelerOTPAmount) {
                          if (seatOTPAmount) {
                            // OTP, only accessible if seatOTOAmount <= travelerOTPAmount
                            seat.IsAccessible = (seatOTPAmount ? seatOTPAmount : 0) <= travelerOTPAmount;
                            if (!seat.IsAccessible) {
                              $scope.data.selection.isOTPInaccessible = true;
                            }
                          }
                        }
                      }

                      // if (!(traveler.IsBundle || traveler.IsEPlusSubscriber || traveler.hasPrivilege ||
                      //   (traveler.IsOTP && companionCount > 0))) {
                      //
                      //   var seatOTPAmount = null;
                      //   _.forEach(seat.USDList, function (price) {
                      //
                      //     if (price.Name == id) {
                      //       seatOTPAmount = price.Amount;
                      //     }
                      //   });
                      //
                      //   if (travelerOTPAmount) {
                      //     if (seatOTPAmount) {
                      //       // OTP, only accessible if seatOTOAmount <= travelerOTPAmount
                      //       seat.IsAccessible = (seatOTPAmount ? seatOTPAmount : 0) <= travelerOTPAmount;
                      //       if (!seat.IsAccessible) {
                      //         $scope.data.selection.isOTPInaccessible = true;
                      //       }
                      //     }
                      //   }
                      //   else {
                      //
                      //     _.forEach(seat.ELFFareList, function (elf) {
                      //
                      //       if (elf.Name == id) {
                      //         seat.IsAccessible = seat.IsAccessible && elf.Amount != -1; // -1: elf;
                      //         if (!seat.IsAccessible) {
                      //           seat.SeatPhraseology = 'Seat selection not available for Basic Economy fares.';
                      //         }
                      //         else {
                      //           seat.SeatPhraseology = '';
                      //         }
                      //       }
                      //     });
                      //
                      //     _.forEach(seat.ServiceFundList, function (sf) {
                      //
                      //       if (sf.Name == id) {
                      //         seat.IsAccessible = seat.IsAccessible && sf.Amount != -1; // -1: ssr
                      //         if (!seat.IsAccessible) {
                      //           seat.SeatPhraseology = 'Seat selection not available for Special Service Requests';
                      //         }
                      //         else {
                      //           seat.SeatPhraseology = '';
                      //         }
                      //       }
                      //     });
                      //   }
                      // }
                    }
                  });
                });
              });
            }
          });

          // check enable reset
          $scope.data.selection.isAllowReset = false;
          _.forEach($scope.data.selection.currentSegmentSeatMap.Travelers, function (t) {

            if (t.SelectedSeat) {
              if (!t.CSLSelectedSeat) {
                $scope.data.selection.isAllowReset = true;
                return false;
              }
              else if (t.SelectedSeat.SeatNumber != t.CSLSelectedSeat.SeatNumber) {
                $scope.data.selection.isAllowReset = true;
                return false;
              }
            }
          });
        }
      }
    };
    $scope.selectTraveler = function (index) {

      if (!$scope.data.selection.currentSegmentSeatMap.IsSeatMapDisabled) {
        $scope.data.selection.selectedTravelerIndex = index;
      }
    };
    $scope.selectLeg = function (index) {

      $scope.data.selection.currentSegmentSeatMap = $scope.data.selection.segmentSeatMaps[index];
      $scope.data.selection.selectedLegIndex = index;
      $scope.data.selection.selectedTravelerIndex = 0;
      $scope.syncSeatMapSegment(index);
    };
    $scope.selectSegment = function (index, isDisabled, callback) {

      if (isDisabled) {
        return;
      }

      if ($scope.data.selection.selectedSegmentIndex != -1) {
        $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.previousSelectedFlightSegment = $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.EPlusSegment[$scope.data.selection.selectedSegmentIndex];
      }
      else {
        $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.previousSelectedFlightSegment = null;
      }

      $scope.data.selection.selectedSegmentIndex = ($scope.data.selection.selectedSegmentIndex == index ? -1 : index);

      if ($scope.data.selection.selectedSegmentIndex != -1) {
        $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.selectedFlightSegment = $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.EPlusSegment[$scope.data.selection.selectedSegmentIndex];

        $scope.data.selection.currentAirSegment = $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.EPlusSegment[$scope.data.selection.selectedSegmentIndex];
      }
      else {
        $scope.data.PNR.PNRDetail.EPlusTravelerAndSegment.selectedFlightSegment = null;
        $scope.data.selection.currentAirSegment = null;
      }

      $scope.data.selection.selectedLegIndex = -1;
      $scope.data.selection.selectedTravelerIndex = -1;

      if ($scope.data.selection.segmentSeatMaps) {

        var prevTravelers = [];
        _.forEach($scope.data.selection.segmentSeatMaps, function (ssm) {

          _.forEach(ssm.Travelers, function (t) {

            prevTravelers.push(t);
          });
        });

        $rootScope.mainSpinner = true;
        PNRService.saveSelectedSeatsInfo($scope.data.PNR, prevTravelers, $rootScope.currentUser.id).then(function () {

          $rootScope.mainSpinner = false;
          $scope.getSeatMap(0, 0);

          if (callback) {
            callback();
          }
        }, function (err) {

          $rootScope.mainSpinner = false;
          console.log(err);
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        });
      }
      else {
        $scope.getSeatMap(0, 0);
      }
    };
    $scope.getSeatMap = function (targetLegIndex, targetTravelerIndex) {

      $scope.data.selection.segmentSeatMaps = [];
      $scope.data.selection.currentSegmentSeatMap = null;

      if ($scope.data.selection.selectedSegmentIndex != -1) {

        $rootScope.mainSpinner = true;

        PNRService.generateSeatMapViewModelForEPlus($scope.data.PNR, 0, $rootScope.currentUser.id).then(function (value) {

          $rootScope.mainSpinner = false;

          if (value && value.seatMaps && value.seatMaps.length > 0) {

            $rootScope.mainSpinner = true;

            $scope.data.selection.segmentSeatMaps = value.seatMaps;
            if ($scope.data.selection.segmentSeatMaps.length > 0) {
              $scope.data.selection.currentSegmentSeatMap = $scope.data.selection.segmentSeatMaps[targetLegIndex];
            }
            else {
              $scope.data.selection.currentSegmentSeatMap = null;
            }

            var memory = {
              'segmentIndex': $scope.data.selection.selectedSegmentIndex,
              'seatMaps': $scope.data.selection.segmentSeatMaps
            };

            var isNewRetrieve = true;
            _.forEach($scope.data.seatMapMemories, function (m, mIndex) {

              if (m.segmentIndex == memory.segmentIndex) {
                $scope.data.seatMapMemories[mIndex] = memory;
                isNewRetrieve = false;
                return false;
              }
            });
            if (isNewRetrieve) {
              $scope.data.seatMapMemories.push(memory);
            }

            $scope.syncSeatMapSegment(targetLegIndex);
            $scope.data.selection.selectedLegIndex = targetLegIndex;
            $scope.data.selection.selectedTravelerIndex = targetTravelerIndex;
            $scope.syncCart(targetLegIndex);

            $rootScope.mainSpinner = false;
          }
          else {

            $scope.data.selection.selectedSegmentIndex = -1;
            $scope.data.selection.selectedLegIndex = -1;
            $scope.data.selection.selectedTravelerIndex = -1;
            $scope.syncCart(targetLegIndex);
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Unable to retrieve seat map. Please contact United for further assistance.'
              });
          }
        }, function (err) {

          $scope.data.selection.selectedSegmentIndex = -1;
          $scope.data.selection.selectedLegIndex = -1;
          $scope.data.selection.selectedTravelerIndex = -1;
          $scope.syncCart(targetLegIndex);
          console.log(err);
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Unable to retrieve seat map. Please contact United for further assistance.'
            });
        });
      }
    };
    $scope.syncCart = function (legIndex) {

      if (legIndex == undefined) return;
      // sync cart with segment seat map response

      // 1) Remove current segment item from cart; will repopulate again later
      _.remove($scope.data.cart.items, function (n) {
        return (n.SegmentIndex == $scope.data.selection.selectedSegmentIndex && n.LegIndex == legIndex);
      });
      _.remove($scope.data.cart.dummyItems, function (n) {
        return (n.SegmentIndex == $scope.data.selection.selectedSegmentIndex);
      });
      $scope.data.cart.total = _.sumBy($scope.data.cart.items, 'CurrentSeatAmount');

      if (legIndex == $scope.data.selection.selectedLegIndex) {

        // 2) Go through travelers of each segment's seat map and repopulate cart item
        var dummyItems = [];
        var showItemInDummyCart = false;
        _.forEach($scope.data.selection.segmentSeatMaps, function (ssm, lIndex) {

          var items = [];
          var showItemInCart = false;
          _.forEach(ssm.Travelers, function (t, tIndex) {

            var stopIndex = ssm.StopIndex;
            var departureDate = ssm.DepartureDateInPNR;
            var departureTime = ssm.DepartureTimeInPNR;
            var flightNumber = ssm.FlightNumberInPNR;

            var memory = null;
            _.forEach($scope.data.seatMapMemories, function (m) {

              if (m.segmentIndex == $scope.data.selection.selectedSegmentIndex) {
                memory = m;
                return false;
              }
            });
            var cartItem = {
              'FlightNumber': flightNumber,
              'CarrierCode': $scope.data.selection.currentAirSegment.FirstMarketdFlightSegment.MarketingCarrierCode,
              'SegmentIndex': $scope.data.selection.selectedSegmentIndex,
              'SegmentNumber': $scope.data.selection.currentAirSegment.SegmentNumber,
              'LegIndex': lIndex,
              'StopIndex': stopIndex,
              'TravelerIndex': tIndex,
              'GivenName': t.GivenName,
              'Surname': t.Surname,
              'TravelerNameIndex': t.TravelerNameIndex,
              'Description': 'Economy Seat Assignment',
              'Origin': ssm.Origin, //20170825 changed to Origin of seat map
              'Destination': ssm.Destination, //20170825 changed to destination of seat map
              'DepartureDate': departureDate,
              'DepartureTime': departureTime,
              'CurrentSeatNumber': t.SelectedSeat && t.SelectedSeat.SeatNumber ? t.SelectedSeat.SeatNumber : '',
              'CurrentSeatAmount': t.SelectedSeat && t.SelectedSeat.SeatPrice ? t.SelectedSeat.SeatPrice : 0,
              'CurrentSeatCost': t.SelectedSeat && t.SelectedSeat.SeatPrice ? t.SelectedSeat.SeatPrice : 0,
              'CSLSeatNumber': t.CSLSelectedSeat && t.CSLSelectedSeat.SeatNumber ? t.CSLSelectedSeat.SeatNumber : '',
              'CSLSeatCost': t.CSLSelectedSeat && t.CSLSelectedSeat.SeatPrice ? t.CSLSelectedSeat.SeatPrice : 0,
              'CSLSeatAmount': t.CSLSelectedSeat && t.CSLSelectedSeat.SeatPrice ? t.CSLSelectedSeat.SeatPrice : 0,
              'IsInternational': $scope.data.selection.currentAirSegment.IsInternational,
              'DepartureDateGMT': $scope.data.selection.currentAirSegment.DepartureDateGMT,
              'DepartureTimeGMT': $scope.data.selection.currentAirSegment.DepartureTimeGMT,
              'BookingClass': $scope.data.selection.currentAirSegment.BookingClass,
              'CSLSeatCharacteristicCode': '',
              'DepartureAirport': $scope.data.selection.currentAirSegment.DepartureAirport,
              'ArrivalAirport': $scope.data.selection.currentAirSegment.ArrivalAirport,
              'IsCoGSegment': memory != null ? (memory.seatMaps.length > 1 ? true : false) : false
            };

            if (t.SelectedSeat && t.SelectedSeat.Characteristics) {
              _.forEach(t.SelectedSeat.Characteristics, function (item) {
                if (item.Code && item.Code == 'DisplaySeatType') {
                  cartItem.CurrentSeatType = item.Value;
                  cartItem.CurrentSeatCharacteristicCode = item.Code;
                }
              });
            }
            if (t.SelectedSeat && t.SelectedSeat.Characteristics) {
              _.forEach(t.SelectedSeat.Characteristics, function (item) {
                //Shan Feb 17 Need to know eliteseat and then determine Favor Code for seat Assignment
                if (item.Code && item.Code == 'IsEliteZoneSeat') {
                  cartItem.CurrentSeatIsEliteZoneSeat = true;
                }
              });
            }
            if (t.SelectedSeat && t.SelectedSeat.Characteristics) {
              _.forEach(t.SelectedSeat.Characteristics, function (item) {
                //Shan Feb 17 Need to know preferred seat and then determine Favor Code for seat Assignment
                if (item.Code && item.Code == 'IsPreferredSeat') {
                  cartItem.CurrentSeatIsPreferredSeat = true;
                }
              });
            }

            if (t.CSLSelectedSeat && t.CSLSelectedSeat.Characteristics) {
              _.forEach(t.CSLSelectedSeat.Characteristics, function (item) {
                if (item.Code && item.Code == 'DisplaySeatType') {
                  cartItem.CSLSeatType = item.Value;
                  cartItem.CSLSeatCharacteristicCode = item.Code;
                }
                //Shan Feb 17 Need to know elite or preferred seat and then determine Favor Code for seat Assignment
                else if (item.Code && item.Code == 'IsEliteZoneSeat' && item.value && item.value ==
                  'True') {
                  cartItem.CSLSeatIsEliteZoneSeat = true;
                } else if (item.Code && item.Code == 'IsPreferredSeat' && item.value && item.value ==
                  'True') {
                  cartItem.CSLIsPreferredSeat = true;
                }
              });
            }
            
            dummyItems.push(cartItem);
            if (cartItem.CurrentSeatNumber != cartItem.CSLSeatNumber) {
              showItemInDummyCart = true;
            }
            if (cartItem.CurrentSeatNumber) {
              if (legIndex == lIndex) {
                items.push(cartItem);
                if (cartItem.CurrentSeatNumber != cartItem.CSLSeatNumber) {
                  showItemInCart = true;
                }
              }
            }
          });

          if (showItemInCart && items.length > 0) {
            $scope.data.cart.items = $scope.data.cart.items.concat(items);
          }
        });

        if (showItemInDummyCart && dummyItems.length > 0) {
          $scope.data.cart.dummyItems = $scope.data.cart.dummyItems.concat(dummyItems);
        }
      }

      $scope.processPricing($scope.data.selection.selectedSegmentIndex, legIndex);

      $scope.data.cart.items = _.orderBy($scope.data.cart.items, ['SegmentIndex', 'LegIndex', 'TravelerIndex'], ['asc', 'asc', 'asc']);
    };
    $scope.getIsBundle = function (segmentSeatMap) {

      var isBundle = false;

      if (segmentSeatMap) {
        _.forEach(segmentSeatMap.Travelers, function (t) {

          isBundle = isBundle || (t.IsBundle ? true : false);
        });
      }

      return isBundle;
    };
    $scope.getCompanionCount = function (segmentSeatMap) {

      var companionCount = 0;
      var currentEPlusSeatCount = 0;

      if (segmentSeatMap) {
        _.forEach(segmentSeatMap.Travelers, function (t) {

          companionCount = companionCount + (t.CompanionCount ? t.CompanionCount : 0);

          // only for non privilege traveler where pre-selected seat is eplus
          if (!t.IsEPlusSubscriber && !t.IsBundle && !t.IsOTP && !t.hasPrivilege &&
            t.CSLSelectedSeat != null &&
            t.CSLSelectedSeat.IsEPlus) {
            currentEPlusSeatCount++;
          }
        });
        // Number of final companions (applied) = MAX(companionCount,currentEPlusSeatCount)
        companionCount = (companionCount > currentEPlusSeatCount) ? companionCount : currentEPlusSeatCount;
      }

      return companionCount;
    };
    $scope.processPricing = function (segmentIndex, legIndex) {

      // 0. get item in cart for the selected leg
      var items = [];
      _.forEach($scope.data.cart.items, function (item) {

        if (item.SegmentIndex == segmentIndex && item.LegIndex == legIndex) {
          item.CurrentSeatAmount = item.CurrentSeatCost;
          item.IsChanged = (item.CurrentSeatNumber != item.CSLSeatNumber) ? 1 : 0;
          items.push(item);
        }
      });

      var segmentSeatMap = $scope.data.selection.segmentSeatMaps[legIndex];
      // 1. Get is bundle
      var isBundle = $scope.getIsBundle(segmentSeatMap);
      // 2. Get companion count
      var companionCount = $scope.getCompanionCount(segmentSeatMap);

      // 3. Within a leg's item, calculated the chargeable amount of each item
      // 3.1 If it's bundle / aka absolute entitlement; all free (notes: it's either non or all travelers is bundle)
      if (isBundle) {
        _.forEach(items, function (item) {
          item.CurrentSeatAmount = 0;
        });
      }
      else {
        // 3.2 Based on privilege
        // 3.2.1 IsEPlusSubscriber : free
        // 3.2.2 IsOPT : no additional charge
        _.forEach(items, function (item) {

          var traveler = segmentSeatMap.Travelers[item.TravelerIndex];
          if (traveler.IsEPlusSubscriber) {
            item.CurrentSeatAmount = 0;
          }
          else if (traveler.hasPrivilege) {
            item.CurrentSeatAmount = 0;
          }
          else if (traveler.IsOTP) {
            item.CurrentSeatAmount = 0;
          }
        });

        // 3.2.3 If Companion count available; charge highest amount to 0
        if (companionCount > 0) {

          // 3.2.2.1 Sort order Amount
          items = _.orderBy(items, ['CurrentSeatAmount', 'IsChanged'], ['desc', 'asc']);
          _.forEach(items, function (item) {

            if (item.CurrentSeatAmount == 0) return false;
            item.CurrentSeatAmount = 0;
            companionCount--;
            if (companionCount <= 0) return false;
          });
        }
      }

      $scope.data.cart.total = _.sumBy($scope.data.cart.items, 'CurrentSeatAmount');
    };
    $scope.syncSeatMapSegment = function (legIndex) {

      if (legIndex == undefined) return;

      if ($scope.data.selection.segmentSeatMaps) {

        _.forEach($scope.data.selection.segmentSeatMaps, function (ssm, lIndex) {

          if (legIndex == lIndex) {

            var selectedSeats = [];
            _.forEach(ssm.Travelers, function (t) {

              if (t.SelectedSeat &&
                t.SelectedSeat.SeatNumber &&
                t.SelectedSeat.SeatNumber.length > 0) {
                selectedSeats.push(t.SelectedSeat.SeatNumber);
              }
            });

            _.forEach(ssm.Cabins, function (cabin) {

              _.forEach(cabin.HorizontalPlaneGroups, function (group) {

                _.forEach(group.HorizontalPlaneRows, function (row) {

                  _.forEach(row.Seats, function (seat) {

                    if (selectedSeats.indexOf(seat.Identifier) > -1) {

                      _.forEach(ssm.Travelers, function (t, tIndex) {

                        if (t.SelectedSeat &&
                          t.SelectedSeat.SeatNumber &&
                          t.SelectedSeat.SeatNumber.length > 0) {

                          if (seat.Identifier == t.SelectedSeat.SeatNumber) {

                            var targetIndex = tIndex + 1;
                            var targetClass = 'current' + targetIndex;

                            t.SelectedSeat.Characteristics = seat.Characteristics;

                            if (seat.SeatCssClass.indexOf('current') == -1) {
                              seat.ExistingClass = seat.SeatCssClass;
                            }

                            if (seat.IsAvailable) {
                              seat.SeatCssClass = seat.SeatCssClass.replace('available', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current1', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current2', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current3', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current4', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current5', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current6', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current7', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current8', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current9', targetClass);
                            }
                            else {
                              seat.SeatCssClass = seat.SeatCssClass.replace('occupied', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current1', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current2', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current3', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current4', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current5', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current6', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current7', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current8', targetClass);
                              seat.SeatCssClass = seat.SeatCssClass.replace('current9', targetClass);
                              if (t.SelectedSeat && t.CSLSelectedSeat) {
                                t.SelectedSeat.IsSeatExpired = t.SelectedSeat.SeatNumber != t.CSLSelectedSeat.SeatNumber;
                              }
                            }
                          }
                        }
                      });
                    }
                    else {

                      if (seat.ExistingClass && seat.ExistingClass != '' &&
                        (seat.SeatCssClass != seat.ExistingClass)) {
                        seat.SeatCssClass = seat.ExistingClass;
                      }
                    }
                  });
                });
              });
            });
          }
        });
      }
    };
    $scope.resetCurrentSegmentSeatMap = function () {

      if ($scope.data.selection.selectedSegmentIndex > -1 &&
        $scope.data.selection.selectedLegIndex > -1 &&
        $scope.data.selection.selectedTravelerIndex > -1 &&
        $scope.data.selection.segmentSeatMaps &&
        $scope.data.selection.currentSegmentSeatMap &&
        $scope.data.selection.isAllowReset) {

        $rootScope.mainSpinner = true;

        // restore traveler selected seat
        _.forEach($scope.data.selection.currentSegmentSeatMap.Travelers, function (traveler) {

          traveler.SelectedSeat = _.cloneDeep(traveler.CSLSelectedSeat);
        });

        // sync seat map with default seat selection
        $scope.syncSeatMapSegment($scope.data.selection.selectedLegIndex);
        $scope.syncCart($scope.data.selection.selectedLegIndex);

        $scope.data.selection.isAllowReset = false;
        $rootScope.mainSpinner = false;
      }
    };
    $scope.formatDate = function (date) {

      var dateOut = new Date(date);
      return dateOut;
    };

    $scope.applyEplus = function () {

      $scope.data.cart.showCart = false;
      if ($scope.data.cart.items.length > 0) {

        if ($scope.data.selection.selectedSegmentIndex != -1) {
          $scope.selectSegment($scope.data.selection.selectedSegmentIndex, $scope.data.selection.currentAirSegment.GreySeatAssignmentButton, function () {

            $state.go($state.current.parent + '-seat-assignment', {feature: 'confirm-eplus'});
          });
        }
        else {
          $state.go($state.current.parent + '-seat-assignment', {feature: 'confirm-eplus'});
        }
      }
    };
    /***********
     * segment end
     ***********/

    /*********** Apply EPlus End ***********/
    /*********** Confirm EPlus Start ***********/

    $scope.goBack = function () {

      $state.go($state.current.parent + '-seat-assignment', {feature: 'apply-eplus'});
    };

    $scope.confirmEPlusCheckModal = $('#eplus-confirm-modal');
    $scope.proceedEPlus = false;

    $scope.confirmEPlusCheck = function () {

      $scope.proceedEPlus = false;
      $scope.confirmEPlusCheckModal.modal();
    };
    $scope.confirmEPlus = function () {

      $scope.proceedEPlus = true;
      $scope.confirmEPlusCheckModal.modal('hide');
    };
    $scope.reprocessPricing = function (segmentIndex, legIndex) {

      // 0.1 get item in succeed seat for the selected leg
      var items = [];
      _.forEach($scope.data.eplusResult.SucceedSeats, function (s) {

        if (s.SegmentIndex == segmentIndex && s.LegIndex == legIndex) {

          _.forEach($scope.data.cart.items, function (i) {

            // 0.2 restore origin price; below will calculate again
            if (i.SegmentIndex == s.SegmentIndex &&
              i.LegIndex == s.LegIndex &&
              i.TravelerIndex == s.TravelerIndex) {

              s.Cost = i.CurrentSeatCost;
              return false;
            }
          });

          s.IsChanged = (s.CurrentSeat != s.SelectedSeat) ? 1 : 0;
          items.push(s);
        }
      });

      var memory = null;
      _.forEach($scope.data.seatMapMemories, function (m) {

        if (m.segmentIndex == segmentIndex) {
          memory = m;
          return false;
        }
      });
      var isBundle = false;
      var companionCount = 0;
      if (memory) {
        var segmentSeatMap = memory.seatMaps[legIndex];
        if (segmentSeatMap) {
          // 1. Get is bundle
          isBundle = $scope.getIsBundle(segmentSeatMap);
          // 2. Get companion count
          companionCount = $scope.getCompanionCount(segmentSeatMap);
        }
      }

      // 3. Within a leg's item, calculated the chargeable amount of each item
      // 3.1 If it's bundle / aka absolute entitlement; all free (notes: it's either non or all travelers is bundle)
      if (isBundle) {
        _.forEach(items, function (item) {
          item.Cost = 0;
        });
      }
      else {
        // 3.2 Based on privilege
        // 3.2.1 IsEPlusSubscriber : free
        // 3.2.2 IsOPT : no additional charge
        _.forEach(items, function (item) {

          var traveler = segmentSeatMap.Travelers[item.TravelerIndex];
          if (traveler.IsEPlusSubscriber) {
            item.Cost = 0;
          }
          else if (traveler.hasPrivilege) {
            item.Cost = 0;
          }
          else if (traveler.IsOTP) {
            item.Cost = 0;
          }
        });

        // 3.2.3 If Companion count available; charge highest amount to 0
        if (companionCount > 0) {

          // 3.2.2.1 Sort order Amount
          items = _.orderBy(items, ['Cost', 'IsChanged'], ['desc', 'asc']);
          _.forEach(items, function (item) {

            if (item.Cost == 0) return false;
            item.Cost = 0;
            companionCount--;
            if (companionCount <= 0) return false;
          });
        }
      }

      $scope.data.eplusResult.TotalCost = _.sumBy($scope.data.eplusResult.SucceedSeats, 'Cost');
    };
    $scope.confirmEPlusCheckModal.on('hidden.bs.modal', function (e) {

      if ($scope.proceedEPlus) {

        // 0. Validate fund balance
        var remark = $scope.data.charge.remark;
        var comment = $scope.data.charge.comment;
        var payerId = $scope.data.charge.accSearchId;
        var beneficiaryId = $scope.data.charge.beneficiarySearchId;
        var callerId = '';
        if ($scope.data.callerAccount) {
          callerId = $scope.data.callerAccount.accountId;
        }

        $rootScope.mainSpinner = true;
        AccountService.getAccountById(
          payerId,
          $rootScope.currentUser.id
        ).then(function (value1) {

          $rootScope.mainSpinner = false;
          var fund = value1.Fund;
          if (fund != null && fund != undefined && fund >= $scope.data.cart.total) {

            // 1. Submit seat assignment
            $rootScope.mainSpinner = true;
            AmenityService.preDeductAccountBalance(
              payerId,
              $scope.data.cart.total,
              $rootScope.currentUser.id
            ).then(function (value2) {

              $rootScope.mainSpinner = false;
              if (util.isSuccessService(value2)) {

                $rootScope.mainSpinner = true;
                PNRService.submitEPlus(
                  $scope.data.PNR,
                  $scope.data.cart.items,
                  $scope.data.cart.dummyItems,
                  value2.pendingAmountObjId
                ).then(function (value3) {

                  $rootScope.mainSpinner = false;
                  $scope.data.eplusResult = value3;

                  if ($scope.data.eplusResult.ErrorMessages &&
                    $scope.data.eplusResult.ErrorMessages.length > 0) {
                    $rootScope.$broadcast('showMessage',
                      {
                        type: 'alert',
                        text: $scope.data.eplusResult.ErrorMessages[0]
                      });
                  }
                  else {
                    // 2.1 If got failed seat assignment then need to recalculate fund
                    if ($scope.data.eplusResult.FailedSeats.length > 0) {

                      // 2.1.1 group segmentIndex, legIndex
                      // pricing are calculation in bundle (segmentIndex, legIndex)
                      if ($scope.data.eplusResult.SucceedSeats.length > 0) {
                        var arr = _.orderBy($scope.data.eplusResult.SucceedSeats,
                          ['SegmentIndex', 'LegIndex'], ['asc', 'asc']);

                        // below is just to find unique combination
                        var temp = [];
                        _.forEach(arr, function (s) {

                          temp.push(s.SegmentIndex + '_' + s.LegIndex);
                        });
                        var temp = _.uniq(temp);
                        _.forEach(temp, function (t) {

                          var segmentIndex = _.split(t, '_')[0];
                          var legIndex = _.split(t, '_')[1];
                          $scope.reprocessPricing(segmentIndex, legIndex);
                        });
                      }
                      else {
                        $scope.data.eplusResult.TotalCost = 0;
                      }
                    }
                    else {
                      $scope.data.eplusResult.TotalCost = $scope.data.cart.total;
                    }

                    if ($scope.data.eplusResult.SucceedSeats.length > 0) {

                      // 2.2 Submit fund
                      $rootScope.mainSpinner = true;
                      PNRService.submitEPlusFund(
                        $scope.data.eplusResult,
                        $scope.data.PNR,
                        payerId,
                        beneficiaryId,
                        callerId,
                        comment,
                        remark
                      ).then(function (value4) {

                        $rootScope.mainSpinner = false;
                        $scope.data.transactionResult = value4;
                        $scope.data.transactionResult.canDismiss = true;

                        if ($scope.data.transactionResult.errors &&
                          $scope.data.transactionResult.errors.length > 0) {
                          $rootScope.$broadcast('showMessage',
                            {
                              type: 'alert',
                              text: $scope.data.transactionResult.errors[0]
                            });
                        }
                        else {
                          // DF-00783
                          // purge cart
                          $scope.data.cart.items = [];
                          $scope.data.cart.dummyItems = [];

                          $scope.data.transactionResult.remark = remark;
                          if ($rootScope.currentUser.isInternalUser) {
                            $scope.data.transactionResult.canDismiss = false;
                          }

                          var waiverCode = $scope.data.transactionResult.ticketInfos[0].waiverFavorId;

                          $scope.data.transactionResult.remarkMessage = '';
                          PNRService.submitEPlusRemarks(
                            $scope.data.PNR,
                            $rootScope.currentUser.id,
                            remark,
                             $scope.data.transactionResult.referenceNumber
                          ).then(function (value5) {

                            if (value5.success) {
                              if (value5.messages.length > 0) {
                                $scope.data.transactionResult.remarkMessage = value5.messages[0];
                              }
                            }
                            else {
                              $scope.data.transactionResult.remarkMessage = 'Failed to send remarks. Please document the record in EZR.';
                            }
                            $scope.data.transactionResult.canDismiss = true;
                          }, function (err) {

                            $scope.data.transactionResult.remarkMessage = 'Failed to send remarks. Please document the record in EZR.';
                            $scope.data.transactionResult.canDismiss = true;
                          });

                          $state.go($state.current.parent + '-seat-assignment', {feature: 'complete-eplus'});
                        }
                      }, function (err) {

                        $rootScope.mainSpinner = false;
                        console.debug(err);
                        $rootScope.$broadcast('showMessage',
                          {
                            type: 'alert',
                            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                          });
                      });
                    }
                    else {
                      $scope.data.transactionResult = {};
                      $scope.data.transactionResult.canDismiss = true;
                      $scope.data.transactionResult.referenceNumber = '-';
                      $scope.data.transactionResult.seatAssignResult = $scope.data.eplusResult;

                      // DF-00783
                      // purge cart
                      $scope.data.cart.items = [];
                      $scope.data.cart.dummyItems = [];

                      $state.go($state.current.parent + '-seat-assignment', {feature: 'complete-eplus'});
                    }
                  }
                }, function (err) {

                  $rootScope.mainSpinner = false;
                  console.debug(err);
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
              }
            });
          }
          else {
            $rootScope.$broadcast('refreshSelectedAccount', {});
          }
        }, function (err) {

          $rootScope.mainSpinner = false;
          console.debug(err);
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        });
      }
    });
    $scope.validateText1 = function ($event) {

      var pattern = '^[a-zA-Z0-9 \b]*$';
      var pRegex = new RegExp(pattern);

      var key = String.fromCharCode(!$event.charCode ? $event.which : $event.charCode);
      if (!pRegex.test(key)) {
        $event.preventDefault();
        return false;
      }
    };
    /*********** Confirm EPlus End ***********/

    $scope.email = {
      sendMe: false,
      sendOther: false,
      sendOtherEmail: ''
    };
    $scope.sendEmail = function () {

      if ($scope.email.sendMe) {

        $rootScope.mainSpinner = true;
        PNRService.submitEPlusEmail(
          $scope.data.transactionResult.referenceNumberList,
          $scope.data.PNR,
          $scope.email.sendOtherEmail,
          $scope.email.sendMe,
          $scope.email.sendOther
        ).then(function (value) {

          $rootScope.mainSpinner = false;
          if (value) {
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Please provide a valid email address'
              });
          }
          else {
            $rootScope.$broadcast('showMessage',
              {
                type: 'info',
                text: 'Email sent.'
              });
          }
        }, function (err) {

          console.debug(err);
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Please provide a valid email address'
            });
        });
      }
    };
  }
})();
(function () {
  "use strict";

  angular.module('bankingModule')
    .component('seatMapComp', {
      templateUrl: 'Sip_SeatMapCompTemplate',
      controller: controller,
      bindings: {
        travelers: '=',
        selection: '=',
        cart: '=',
        synccart: '&',
        syncseatmapsegment: '&'
      }
    });

  controller.$inject = ['$rootScope'];
  function controller($rootScope) {

    var $ctrl = this;
    $ctrl.getTravelerUSD = function (seatIdentifier) {

      var usd = null;
      var traveler = $ctrl.selection.currentSegmentSeatMap.Travelers[$ctrl.selection.selectedTravelerIndex];
      //var nameIndex = traveler.TravelerNameIndex;
      var id = traveler.ID;

      // Get seat's service fund for the selected passenger
      _.forEach($ctrl.selection.currentSegmentSeatMap.Cabins, function (cabin) {

        if (!cabin.IsUpperCabin) {
          _.forEach(cabin.HorizontalPlaneGroups, function (group) {

            _.forEach(group.HorizontalPlaneRows, function (row) {

              _.forEach(row.Seats, function (seat) {

                if (seat.Identifier == seatIdentifier) {

                  _.forEach(seat.USDList, function (u) {

                    if (u.Name == id) {

                      usd = u;
                    }
                  });
                }
              });
            });
          });
        }
      });

      return usd;
    };
    $ctrl.getTravelerServiceFund = function (seatIdentifier) {

      var serviceFund = null;
      var traveler = $ctrl.selection.currentSegmentSeatMap.Travelers[$ctrl.selection.selectedTravelerIndex];
      //var nameIndex = traveler.TravelerNameIndex;
      var id = traveler.ID;

      // Get seat's service fund for the selected passenger
      _.forEach($ctrl.selection.currentSegmentSeatMap.Cabins, function (cabin) {

        if (!cabin.IsUpperCabin) {
          _.forEach(cabin.HorizontalPlaneGroups, function (group) {

            _.forEach(group.HorizontalPlaneRows, function (row) {

              _.forEach(row.Seats, function (seat) {

                if (seat.Identifier == seatIdentifier) {

                  _.forEach(seat.ServiceFundList, function (sFund) {

                    if (sFund.Name == id) {

                      serviceFund = sFund;
                    }
                  });
                }
              });
            });
          });
        }
      });

      return serviceFund;
    };
    $ctrl.selectSeat = function (seat) {

      if ($ctrl.selection.selectable &&
        seat.IsAvailable &&
        seat.IsAccessible) {

        var seatIdentifier = seat.Identifier;

        // if the seat selected by another traveler; reset another traveler seat
        _.forEach($ctrl.cart.items, function (item) {

          if (item.SegmentIndex == $ctrl.selection.selectedSegmentIndex &&
            item.LegIndex == $ctrl.selection.selectedLegIndex &&
            item.TravelerIndex != $ctrl.selection.selectedTravelerIndex &&
            item.CurrentSeatNumber == seatIdentifier) {

            var anotherT = $ctrl.selection.currentSegmentSeatMap.Travelers[item.TravelerIndex];
            anotherT.SelectedSeat.SeatNumber = anotherT.CSLSelectedSeat.SeatNumber;
            anotherT.SelectedSeat.SeatPrice = anotherT.CSLSelectedSeat.SeatPrice;
            return false;
          }
        });

        var serviceFund = $ctrl.getTravelerServiceFund(seatIdentifier);
        var usd = $ctrl.getTravelerUSD(seatIdentifier);
        var traveler = $ctrl.selection.currentSegmentSeatMap.Travelers[$ctrl.selection.selectedTravelerIndex];
        traveler.SelectedSeat.SeatNumber = seatIdentifier;

        traveler.SelectedSeat.DepartureAirport = $ctrl.selection.currentSegmentSeatMap.OriginInPNR;
        traveler.SelectedSeat.ArrivalAirport = $ctrl.selection.currentSegmentSeatMap.DestinationInPNR;
        traveler.SelectedSeat.FlightNumber = $ctrl.selection.currentSegmentSeatMap.FlightNumber;
        traveler.SelectedSeat.FlightNumberInPNR = $ctrl.selection.currentSegmentSeatMap.FlightNumberInPNR;
        traveler.SelectedSeat.FlightTimeInPNR =  $ctrl.selection.currentSegmentSeatMap.DepartureDateInPNR;
        traveler.SelectedSeat.FlightDateInPNR =  $ctrl.selection.currentSegmentSeatMap.DepartureTimeInPNR;

        if (traveler.IsOTP) {
          traveler.SelectedSeat.SeatPrice = usd && usd.Amount ? usd.Amount : 0;
        }
        else {
          traveler.SelectedSeat.SeatPrice = serviceFund && serviceFund.Amount ? serviceFund.Amount : 0;
        }

        $ctrl.syncseatmapsegment({
          legIndex: $ctrl.selection.selectedLegIndex
        });
        $ctrl.synccart({
          legIndex: $ctrl.selection.selectedLegIndex
        });
        $ctrl.nextTraveler();

        $ctrl.selection.isAllowReset = true;

        var isExitRow = false;
        _.forEach(seat.Characteristics, function (c) {

          if (_.lowerCase(c.Code) == 'is exit' && _.lowerCase(c.Value) == 'true') {
            isExitRow = true;
            return false;
          }
        });

        if (isExitRow) {
          $('#exit-seat-modal').modal();
        }
      }
    };
    $ctrl.nextTraveler = function () {

      $ctrl.selection.selectedTravelerIndex++;

      if ($ctrl.selection.selectedTravelerIndex >= $ctrl.selection.currentSegmentSeatMap.Travelers.length) {
        $ctrl.selection.selectedTravelerIndex = 0;
      }

      if (!$ctrl.isTravelerAvailable()) {
        $ctrl.nextTraveler();
      }
    };
    $ctrl.isTravelerAvailable = function () {

      var isAvailable = true;

      var traveler = $ctrl.travelers[$ctrl.selection.selectedTravelerIndex];
      _.forEach(traveler.TravelerSegments, function (s) {

        if (s.SegmentNumber == $ctrl.selection.selectedLegIndex + 1) {

          var traveler = $ctrl.selection.currentSegmentSeatMap.Travelers[$ctrl.selection.selectedTravelerIndex];
          var isRestricted = traveler.IsRestricted;
          var isSSMF = traveler.IsSSMF;
          var isCheckedIn = traveler.IsCheckedIn;
          var isSelectedUCSeat = traveler.SelectedSeat &&
            traveler.SelectedSeat.SeatCabinKey &&
            traveler.SelectedSeat.SeatCabinKey != 'Y' &&
            traveler.SelectedSeat.SeatCabinKey != 'C';

          isAvailable = !isRestricted && !isSSMF && !isCheckedIn && !isSelectedUCSeat;
          return false;
        }
      });

      return isAvailable;
    };
  }
})();
(function () {
  "use strict";

  angular.module('bankingModule')
    .component('segmentComp', {
      templateUrl: 'Sip_SegmentCompTemplate',
      controller: controller,
      bindings: {
        segments: '=',
        passengerCount: '=',
        isShowHeader: '='
      }
    });

  controller.$inject = ['$rootScope'];
  function controller($rootScope) {

    var $ctrl = this;

    $ctrl.formatDate = function (input) {

      var output = new Date(input);
      return output;
    };
  }
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('statusNominationController', controller);

  controller.$inject = ['$rootScope', '$scope', '$state', 'util',
    'ProductService', 'StatusNominationService', 'AmenityService'];
  function controller($rootScope, $scope, $state, util,
                      ProductService, StatusNominationService, AmenityService) {

    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: '',
      isValidFundOption: true,
      enableFund: false,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ? 1 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ? 1 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp ? 2 : 1) :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ? 1 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: ''
    };

    if ($scope.data.statusNomData && $scope.data.statusNomData.NewCode) {
      switch ($scope.data.statusNomData.NewCode) {
        case 'GS':
          $scope.data.charge.amenityType = 'SIP_Global_Service_Status_Nominations__c';
          break;
        case '1K':
          $scope.data.charge.amenityType = 'SIP_1K_Status_Nominations__c';
          break;
        case '1P':
          $scope.data.charge.amenityType = 'SIP_Platinum_Status_Nominations__c';
          break;
        case '1G':
          $scope.data.charge.amenityType = 'SIP_Gold_Status_Nominations__c';
          break;
        case '1S':
          $scope.data.charge.amenityType = 'SIP_Silver_Status_Nominations__c';
          break;
      }
    }

    $scope.productList = {
      globalService: ProductService.getProductByCode($scope.data.products, 'GS'),
      oneK: ProductService.getProductByCode($scope.data.products, '1K'),
      platinum: ProductService.getProductByCode($scope.data.products, '1P'),
      gold: ProductService.getProductByCode($scope.data.products, '1G'),
      silver: ProductService.getProductByCode($scope.data.products, '1S')
    };

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;
      if ($scope.data.widgetFeature == 'apply-status-nomination') {
        $scope.data.charge.chargeAmount = '';
      }
      else if ($scope.data.widgetFeature == 'confirm-status-nomination') {
        if ($scope.data.statusNomData) {
          $scope.data.charge.enableFund = $scope.data.statusNomData.NewCode != 'GS';
          $scope.data.charge.enableGS = $scope.data.statusNomData.NewCode == 'GS';
          $scope.data.charge.chargeAmount = $scope.data.statusNomData.TotalCost;
        }
      }
    });

    $scope.isAvailableOption = function (targetOption) {

      if ($scope.data.statusNomData) {
        switch (targetOption) {
          case 'GS':
            return $scope.data.statusNomData.CurrentPremierCode != 'GS';
            break;
          case '1K':
            return $scope.data.statusNomData.CurrentPremierCode != 'GS' &&
              $scope.data.statusNomData.CurrentPremierCode != '1K';
            break;
          case 'PL':
            return $scope.data.statusNomData.CurrentPremierCode != 'GS' &&
              $scope.data.statusNomData.CurrentPremierCode != '1K' &&
              $scope.data.statusNomData.CurrentPremierCode != 'PL';
            break;
          case 'GL':
            return $scope.data.statusNomData.CurrentPremierCode != 'GS' &&
              $scope.data.statusNomData.CurrentPremierCode != '1K' &&
              $scope.data.statusNomData.CurrentPremierCode != 'PL' &&
              $scope.data.statusNomData.CurrentPremierCode != 'GL';
            break;
          case 'SL':
            return $scope.data.statusNomData.CurrentPremierCode != 'GS' &&
              $scope.data.statusNomData.CurrentPremierCode != '1K' &&
              $scope.data.statusNomData.CurrentPremierCode != 'PL' &&
              $scope.data.statusNomData.CurrentPremierCode != 'GL' &&
              $scope.data.statusNomData.CurrentPremierCode != 'SL';
            break;
          default:
            return true;
            break;
        }
      }
      else {
        return false;
      }
    };
    $scope.selectOption = function (type) {

      $scope.data.statusNomData.NewCode = type.ProductCode;
      $scope.data.statusNomData.NewStatus = type.ProductName;
      $scope.data.statusNomData.TotalCost = type.UnitPrice;
      if ($scope.data.statusNomData.NewCode == 'GS') {
        $scope.data.statusNomData.TotalCost = 1;
      }
    };
    $scope.applyStatusNomination = function () {

      $rootScope.mainSpinner = true;
      StatusNominationService.calculateNewExpirationDateByPremierLevelCutOffDate($scope.data.statusNomData.NewCode)
        .then(function (value) {

          $rootScope.mainSpinner = false;

          if (util.isSuccessService(value)) {
            //abe add new expriation date
            $scope.data.statusNomData.NewExpiryDate = value.NewExpiryDate;
            $state.go($state.current.parent + '-status-nomination', {feature: 'confirm-status-nomination'});
          }
        }, function (err) {

          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        })

    };

    $scope.goBack = function () {

      $state.go($state.current.parent + '-status-nomination', {feature: 'apply-status-nomination'});
    };

    $scope.shouldRefreshBalance = false;
    $scope.msgModal = $('#message-modal');
    $scope.confirmModal = $('#status-nom-confirm-modal');
    $scope.successModal = $('#status-nom-success-modal');
    $scope.purchase = function () {

      $scope.confirmModal.modal();
    };
    $scope.confirmPurchase = function () {

      var comment = $scope.data.charge.comment;
      var payerId = $scope.data.charge.accSearchId;
      var beneficiaryId = $scope.data.charge.beneficiarySearchId;

      $rootScope.mainSpinner = true;
      //20170629 handle global service
      AmenityService.preDeductAccountBalanceForNomination(payerId, $scope.data.statusNomData.TotalCost, $scope.data.statusNomData.NewCode, $rootScope.currentUser.id).then(function (value) {
        //20170620 add pendingAmountObjId
        if(value.success){
          StatusNominationService.purchasePremierLevel(
            $scope.data.statusNomData, payerId, beneficiaryId, $scope.data.callerAccount.accountId, comment, $rootScope.currentUser.id, $scope.data.statusNomData.TotalCost, value.pendingAmountObjId).then(function (value) {

            $rootScope.mainSpinner = false;
            if (value.success) {
              $scope.confirmModal.modal('hide');
              $scope.data.statusNomData.transactionNumber = value.transactionNumber;
              //20170613 Use existing logic to show expiration date
              $scope.newSuccessExpriDate = $scope.data.statusNomData.NewExpiryDate;
              $scope.successModal.modal();
            } else {
              $scope.shouldRefreshBalance = true;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.messages[0]
                });
            }
          }, function (err) {

            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
        } else {
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.messages[0]
            });
        }
      }, function (err) {

        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
      });
    };
    $scope.msgModal.on('hidden.bs.modal', function (e) {

      if ($scope.shouldRefreshBalance) {
        $scope.shouldRefreshBalance = false;
        $rootScope.$broadcast('refreshSelectedAccount', {});
      }
    });
    angular.element('#status-nom-success-modal').on('hidden.bs.modal', function (e) {

      if ($scope.data.statusNomData.checkedEmail) {
        AmenityService.sendEmail(
          $rootScope.currentUser.id,
          $scope.data.statusNomData.transactionNumber
        ).then(function () {

          $state.go($state.current.parent + '-home', {feature: 'init'});
        }, function (err) {

          console.debug(err);
          $state.go($state.current.parent + '-home', {feature: 'init'});
        })
      }
      else {
        $state.go($state.current.parent + '-home', {feature: 'init'});
      }
    });
  }
})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('transactionLogController', controller);

  controller.$inject = ['$scope', '$rootScope', 'TransactionHistoryService', 'TravelCertificateService', '$q', '$timeout', 'util', '$window', '$document', 'ts_name', 'ts_field'];
  function controller($scope, $rootScope, TransactionHistoryService,
                      TravelCertificateService, $q, $timeout, util, $window, $document, ts_name, ts_field) {

    $scope.listLimitTo = 500;
    $scope.accountList = [];
    $scope.txnRefNo = '';
    $scope.ts_name = ts_name;

    if (!$rootScope.defAcc) {
      $rootScope.defAcc = {
        name: '',
        id: '',
        type: '',
        extId: ''
      };
    }
    if (!$rootScope.txnAcc) {
      $rootScope.txnAcc = {
        name: '',
        id: '',
        extId: ''
      };
    }
    // if (!$rootScope.txnAcc) {
    //   $rootScope.txnAcc = {
    //     name: $rootScope.currentUser.accName,
    //     id: $rootScope.currentUser.accId,
    //     extId: $rootScope.currentUser.accArcNumber
    //   };
    // }

    $scope.txtTxnAcc = '';
    $scope.isInPopup = false;
    $scope.showTxnAccPopup = false;
    $scope.pageSize = 15;
    $scope.debitMsg = '';

    $scope.specialLoad = $rootScope.currentUser.isInternalUser &&
      ($rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ||
      $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c);

    $scope.getAccounts = function () {

      /*      if ($scope.specialLoad && $scope.txtTxnAcc == '') {
       return false;
       }*/

      var searchValue = '';
      if ($scope.specialLoad && $scope.txtTxnAcc.length >= 1) {
        searchValue = $scope.txtTxnAcc;
      }

      $scope.accountList = [];
      $rootScope.mainSpinner = true;
      TransactionHistoryService.getAccountsForTransactionLog(
        $rootScope.currentUser.id, '', searchValue
      ).then(function (value) {
        if (value.Accounts.length == 0 && searchValue != '') {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'No results found. Please change your search parameters and try again.'
            });
        }
        $rootScope.mainSpinner = false;
        $scope.accountList = value.Accounts;
      }, function (err) {

        console.debug(err);
        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
      });
    };
    $scope.getAccounts();

    $scope.$watch('summaryFilter.fromDate', function (newValue, oldValue, scope) {

      if ($scope.summaryFilter && $scope.summaryFilter.fromDate && $scope.summaryFilter.toDate) {

        var from = new Date($scope.summaryFilter.fromDate);
        var to = new Date($scope.summaryFilter.toDate);
        if (from > to) {
          $scope.summaryFilter.fromDate = oldValue;
        }
      }
    }, true);
    $scope.$watch('summaryFilter.toDate', function (newValue, oldValue, scope) {

      if ($scope.summaryFilter && $scope.summaryFilter.fromDate && $scope.summaryFilter.toDate) {

        var from = new Date($scope.summaryFilter.fromDate);
        var to = new Date($scope.summaryFilter.toDate);
        if (from > to) {
          $scope.summaryFilter.toDate = oldValue;
        }
      }
    }, true);
    $scope.$watch('debitFilter.fromDate', function (newValue, oldValue, scope) {

      if ($scope.debitFilter && $scope.debitFilter.fromDate && $scope.debitFilter.toDate) {

        var from = new Date($scope.debitFilter.fromDate);
        var to = new Date($scope.debitFilter.toDate);
        if (from > to) {
          $scope.debitFilter.fromDate = oldValue;
        }
      }
    }, true);
    $scope.$watch('debitFilter.toDate', function (newValue, oldValue, scope) {

      if ($scope.debitFilter && $scope.debitFilter.fromDate && $scope.debitFilter.toDate) {

        var from = new Date($scope.debitFilter.fromDate);
        var to = new Date($scope.debitFilter.toDate);
        if (from > to) {
          $scope.debitFilter.toDate = oldValue;
        }
      }
    }, true);

    Date.prototype.mmddyyyy = function () {

      var d = new Date(this),
        month = '' + (d.getMonth() + 1),
        day = '' + d.getDate(),
        year = d.getFullYear();

      if (month.length < 2) month = '0' + month;
      if (day.length < 2) day = '0' + day;

      return [month, day, year].join('/');
    };

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      if (fromState.name != 'transaction-log') {
        $rootScope.defAcc = {
          name: '',
          id: '',
          type: '',
          extId: ''
        };
        $rootScope.txnAcc = {
          name: '',
          id: '',
          extId: ''
        };
      }
      $scope.switch = toParams.switch;
      $scope.exportType = 'PDF';
      $scope.loadData(true);
    });

    $scope.loadData = function (isRefreshFilter) {

      switch ($scope.switch) {

        case 'summary':
          $scope.summaryCSVUrl = '';
          $scope.summary = null;

          if (isRefreshFilter) {
            $scope.resetSummaryFilter();
          }
          $scope.getSummary();
          break;

        case 'debits':
          $scope.debitCSVUrl = '';
          $scope.debits = null;

          if (isRefreshFilter) {
            $rootScope.mainSpinner = true;
            TransactionHistoryService.getDebitFilterConfig(
              $rootScope.currentUser.id,
              $rootScope.txnAcc.id
            ).then(function (value) {

              $rootScope.mainSpinner = false;
              $scope.debitsFilterConfig = value;
              $scope.resetDebitFilter();
              $scope.getDebit();
            }, function (err) {

              $rootScope.mainSpinner = false;
              console.debug(err);
            });
          }
          else {
            $scope.getDebit();
          }
          break;
      }
    };
    $scope.formatDate = function (date) {

      var result = '';
      if (date) {
        var dateArray = date.split('/');
        result = dateArray[2] + '-' + dateArray[0] + '-' + dateArray[1];
      }
      return result;
    };
    $scope.getDefaultDate = function () {

      var today = new Date();
      var start = new Date();
      var end = new Date();

      start.setFullYear(today.getFullYear(), today.getMonth() - 1, today.getDate());
      end.setFullYear(today.getFullYear(), today.getMonth(), today.getDate());

      return {
        from: start.mmddyyyy(),
        to: end.mmddyyyy()
      }
    };

    $scope.resetSummaryFilter = function () {

      var defaultDate = $scope.getDefaultDate();
      // $('#input-summary-from-date').flatpickr().setDate(defaultDate.fromDate);
      // $('#input-summary-to-date').flatpickr().setDate(defaultDate.toDate);
      $scope.summaryFilter = {
        fromDate: defaultDate.from,
        toDate: defaultDate.to
      };
    };
    $scope.resetDebitFilter = function () {

      var defaultDate = $scope.getDefaultDate();
      $scope.debitFilter = {
        fromDate: defaultDate.from,
        toDate: defaultDate.to,
        amenityType: 'All',
        payerFund: {
          payerFundName: 'All',
          payerFundId: ''
        },
        executedBy: {
          executedByName: 'All',
          executedById: ''
        },
        cost: 'All',
        orderField: 'date',
        orderBy: 'desc',
        recordsNumber: $scope.pageSize
      };
    };

    $scope.trackingtxnAccId = '';
    $scope.resetDebitSearch = function () {

      $rootScope.txnAcc.id = $scope.trackingtxnAccId;
      $scope.trackingtxnAccId = '';
      $scope.getDebit();
    };

    $scope.getSummary = function () {

      var req = {};
      if ($scope.summaryFilter.fromDate && $scope.summaryFilter.fromDate != '') {
        req.fromDate = $scope.formatDate($scope.summaryFilter.fromDate);
      }
      if ($scope.summaryFilter.toDate && $scope.summaryFilter.toDate != '') {
        req.toDate = $scope.formatDate($scope.summaryFilter.toDate);
      }

      $rootScope.mainSpinner = true;
      TransactionHistoryService.getSummaryByFilter(
        req,
        $rootScope.currentUser.id,
        $rootScope.txnAcc.id
      ).then(function (value) {

        $rootScope.mainSpinner = false;
        if (value) {
          if (value.errorMessages) {
            $rootScope.$broadcast('showMessage', {
              type: 'alert',
              text: value.errorMessages
            });
          } else {
            $scope.summary = value;

            if (!$rootScope.defAcc.name && !$rootScope.defAcc.id && !$rootScope.defAcc.extId && !$rootScope.defAcc.type) {
              $rootScope.defAcc.name = $scope.summary.accountName;
              $rootScope.defAcc.id = $scope.summary.accountId;
              $rootScope.defAcc.extId = $scope.summary.accountExtId;
              $rootScope.defAcc.type = $scope.summary.accountType;
            }
            $scope.accountSymbol = $scope.summary.accountType;
            $rootScope.txnAcc.name = $scope.summary.accountName;
            $rootScope.txnAcc.id = $scope.summary.accountId;
            $rootScope.txnAcc.extId = $scope.summary.accountExtId;
          }
        }
      }, function (err) {

        console.error(err);
        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage', {
          type: 'alert',
          text: 'Sorry, an error has occurred. Please contact United for further assistance.'
        });
      });
    };
    $scope.getDebitByRefNo = function () {

      if ($scope.txnRefNo) {

        if ($rootScope.txnAcc.id) {
          $scope.trackingtxnAccId = $rootScope.txnAcc.id;
        }

        $scope.resetDebitFilter();
        $rootScope.mainSpinner = true;
        TransactionHistoryService.getDebitsByTransactionNumber(
          $rootScope.currentUser.id,
          $scope.txnRefNo
        ).then(function (value) {

          $rootScope.mainSpinner = false;
          if (value) {
            if (value.errorMessages) {
              $rootScope.$broadcast('showMessage', {
                type: 'alert',
                text: value.errorMessages
              });
            } else {
              $scope.debits = value;
              _($scope.debits.transactionHistoryLineItems).forEach(function (debitItemList) {

                _(debitItemList).forEach(function (debitItem) {

                  var dateAdded = new Date(debitItem.dateAdded);
                  debitItem.formattedDateAdded = dateAdded.mmddyyyy();
                });
              });
              $scope.accountSymbol = $scope.debits.accountType;
              $rootScope.txnAcc.name = $scope.debits.accountName;
              $rootScope.txnAcc.id = $scope.debits.accountId;
              $rootScope.txnAcc.extId = $scope.debits.accountExtId;

              $scope.debits.page = $scope.debits.transactionHistoryLineItems[0];
              $scope.debits.pageCount = $scope.debits.transactionHistoryLineItems.length;
              $scope.debits.pageIndex = 1;

              $('#detail-pagination').unbind();
              $('#detail-pagination').createPage({
                pageCount: $scope.debits.pageCount,
                current: $scope.debits.pageIndex,
                backFn: function (p) {

                  $scope.debits.pageIndex = p;
                  $scope.debits.page = $scope.debits.transactionHistoryLineItems[p - 1];
                  $scope.$apply();
                }
              });
            }
          }
        }, function (err) {

          console.error(err);
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage', {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
        });
      }
    };
    $scope.getDebit = function () {
      var req = {
        payerFund: {
          payerFundName: $scope.debitFilter.payerFund.payerFundName == 'All' ? '' :
            $scope.debitFilter.payerFund.payerFundName,
          payerFundId: $scope.debitFilter.payerFund.payerFundId
        },
        executedBy: {
          executedByName: $scope.debitFilter.executedBy.executedByName == 'All' ? '' :
            $scope.debitFilter.executedBy.executedByName,
          executedById: $scope.debitFilter.executedBy.executedById
        },
        amenityType: $scope.debitFilter.amenityType == 'All' ? '' : $scope.debitFilter.amenityType,
        cost: $scope.debitFilter.cost == 'All' ? '' : $scope.debitFilter.cost,
        orderField: $scope.debitFilter.orderField,
        orderBy: $scope.debitFilter.orderBy,
        recordsNumber: $scope.debitFilter.recordsNumber
      };
      if ($scope.debitFilter.fromDate && $scope.debitFilter.fromDate != '') {
        req.fromDate = $scope.formatDate($scope.debitFilter.fromDate);
      }
      if ($scope.debitFilter.toDate && $scope.debitFilter.toDate != '') {
        req.toDate = $scope.formatDate($scope.debitFilter.toDate);
      }

      $scope.txnRefNo = '';
      $rootScope.mainSpinner = true;
      TransactionHistoryService.getDebitsByAccId(
        req,
        $rootScope.currentUser.id,
        $rootScope.txnAcc.id
      ).then(function (value) {

        $rootScope.mainSpinner = false;
        if (value) {
          if (value.success) {

            $scope.debitMsg = '';
            if (value.errorMessages) {
              $scope.debitMsg = value.errorMessages[0];
            }
            $scope.debits = value;

            if (!$rootScope.defAcc.name && !$rootScope.defAcc.id && !$rootScope.defAcc.extId && !$rootScope.defAcc.type) {
              $rootScope.defAcc.name = $scope.debits.accountName;
              $rootScope.defAcc.id = $scope.debits.accountId;
              $rootScope.defAcc.extId = $scope.debits.accountExtId;
              $rootScope.defAcc.type = $scope.debits.accountType;
            }

            _($scope.debits.transactionHistoryLineItems).forEach(function (debitItemList) {

              _(debitItemList).forEach(function (debitItem) {

                var dateAdded = new Date(debitItem.dateAdded);
                debitItem.formattedDateAdded = dateAdded.mmddyyyy();
              });
            });
            $scope.accountSymbol = $scope.debits.accountType;
            $rootScope.txnAcc.name = $scope.debits.accountName;
            $rootScope.txnAcc.id = $scope.debits.accountId;
            $rootScope.txnAcc.extId = $scope.debits.accountExtId;
            $scope.debits.page = $scope.debits.transactionHistoryLineItems[0];
            $scope.debits.pageCount = $scope.debits.transactionHistoryLineItems.length;
            $scope.debits.pageIndex = 1;

            $('#detail-pagination').unbind();
            $('#detail-pagination').createPage({
              pageCount: $scope.debits.pageCount,
              current: $scope.debits.pageIndex,
              backFn: function (p) {

                $scope.debits.pageIndex = p;
                $scope.debits.page = $scope.debits.transactionHistoryLineItems[p - 1];
                $scope.$apply();
              }
            });
          }
          else if (value.errorMessages) {
            $rootScope.$broadcast('showMessage', {
              type: 'alert',
              text: value.errorMessages
            });
          }
        }
      }, function (err) {

        console.error(err);
        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage', {
          type: 'alert',
          text: 'Sorry, an error has occurred. Please contact United for further assistance.'
        });
      });
    };
    // $scope.findDefAccType = function () {
    //
    //   if ($scope.defAccId) {
    //     _.forEach($scope.accountList, function (acc) {
    //
    //       if (acc.Id === $scope.defAccId) {
    //         $scope.defAccType = acc.AccountType;
    //         return false;
    //       }
    //     });
    //   }
    // };
    $scope.sortDebit = function (column) {

      if ($scope.debitFilter.orderField == column) {
        $scope.debitFilter.orderBy = $scope.debitFilter.orderBy == 'asc' ? 'desc' : 'asc';
      } else {
        $scope.debitFilter.orderField = column;
        $scope.debitFilter.orderBy = 'asc';
      }
      $scope.getDebit();
    };


    //dynamic table mapping for all waivers
    //Display is the field for table header
    //Key is the value field for matching service response; {key:value} (from getTransactionDetail())

    $scope.allWaiverTableCatag = [
      {
        Category: ts_name.advancePurchase,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.qualifyingFare,
          ts_field.requestFare,
          ts_field.cityPair,
          ts_field.CostDiff
        ]
      },
      {
        Category: ts_name.classConversion,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.marketingFlightNumber,
          ts_field.originalBookingClass,
          ts_field.newBookingClass,
          ts_field.cityPair,
          ts_field.Quantity,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.extendEticketValidity,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.fareMatch,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.matchedAirline,
          ts_field.matchedFare,
          ts_field.fareBasis,
          ts_field.cityPair,
          ts_field.Quantity,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.guaranteeAirfareMissedTicketing,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.originalFare,
          ts_field.oldFareBasis,
          ts_field.cityPair,
          ts_field.Quantity,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.nameChange,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.oldName,
          ts_field.newName,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.nameCorrection,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.oldName,
          ts_field.newName,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.offshoreCtoAgentError,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.descOfError,
          ts_field.waiverType,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.offshoreCtoFees,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.reason,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.penaltyWaiverAndNameChange,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.oldName,
          ts_field.newName,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.refundDuplicateTicket,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.suspendedTicket,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.ticketRevalidation,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.timeStay,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.originalReturnDate,
          ts_field.newReturnDate,
          ts_field.Cost
        ]
      },
      {
        Category: ts_name.upgradeInventoryConversion,
        Fields: [
          ts_field.PassengerName,
          ts_field.TicketNumber,
          ts_field.WaiverFavorType,
          ts_field.marketingFlightNumber,
          ts_field.originalBookingClass,
          ts_field.newBookingClass,
          ts_field.cityPair,
          ts_field.Quantity,
          ts_field.Cost
        ]
      }
    ];
    $scope.detail = {};
    $scope.detailId = '';
    $scope.showDetail = function (transactionId) {

      $scope.showOther = false;
      $scope.detailId = transactionId;
      TransactionHistoryService.getTransactionDetail(
        transactionId,
        $rootScope.currentUser.id
      ).then(function (value) {

        if (value.errorMessages) {

          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage', {
            type: 'alert',
            text: value.errorMessages
          });
        } else {
          $scope.detail = value;

          //dynamic table header for all waiver
          _.forEach($scope.allWaiverTableCatag, function (item) {
            if (item.Category == $scope.detail.LayoutType) {
              $scope.allWaiverTableLine = item.Fields;
              return false;
            }
          });
        }
      }, function (err) {

        console.error(err);
        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage', {
          type: 'alert',
          text: 'Sorry, an error has occurred. Please contact United for further assistance.'
        });
      });
    };

    $scope.showExport = function () {

      $scope.getFamilyReportUrl();
    };
    $scope.executeExport = function () {

      if ($scope.exportType) {
        switch ($scope.exportType) {
          case 'PDF':
            window.open($scope.getPDF());
            break;
          case 'CSV':
            $scope.getCSV();
            break;
        }
        $('#tl-export-modal').modal('hide');
      }
    };
    $scope.familySummaryReportUrl = '';
    $scope.familyDetailReportUrl = '';
    $scope.isAllowFamilyReport = false;
    $scope.getFamilyReportUrl = function () {

      $scope.familySummaryReportUrl = '';
      $scope.familyDetailReportUrl = '';
      $scope.isAllowFamilyReport = false;

      TransactionHistoryService.getFamilyReportUrl(
        $rootScope.txnAcc.id,
        $rootScope.currentUser.accId
      ).then(function (value) {

        if (util.isSuccessService(value)) {
          $scope.isAllowFamilyReport = value.isSameFamily;
          $scope.familySummaryReportUrl = value.summaryUrl;
          $scope.familyDetailReportUrl = value.detailUrl;
          $('#tl-export-modal').modal();
        }
      }, function (err) {

        console.debug(err);
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
      });
    };
    $scope.executeExportFamily = function () {

      if ($scope.familySummaryReportUrl && $scope.familyDetailReportUrl) {
        switch ($scope.switch) {
          case 'summary' :
            window.open($scope.familySummaryReportUrl);
            break;
          case 'debits':
            window.open($scope.familyDetailReportUrl);
            break;
        }
        $('#tl-export-modal').modal('hide');
      }
    };
    $scope.getPDF = function () {

      $scope.debitsPDFUrl = '';
      $scope.summaryPDFUrl = '';

      var pdfUrl = '';
      switch ($scope.switch) {
        case 'summary' :
          if ($scope.summaryFilter.fromDate) {
            pdfUrl += '&fromDate=' + $scope.formatDate($scope.summaryFilter.fromDate);
          }
          if ($scope.summaryFilter.fromDate) {
            pdfUrl += '&toDate=' + $scope.formatDate($scope.summaryFilter.toDate);
          }
          pdfUrl += '&reportType=' + 'summary';
          pdfUrl += '&userId=' + $rootScope.currentUser.id;
          if ($rootScope.txnAcc.id) {
            pdfUrl += '&accId=' + $rootScope.txnAcc.id;
          }
          // pdfUrl = encodeURIComponent(pdfUrl);
          return "/Sip_TransactionSummaryPDF?" + pdfUrl.substr(1);
          break;

        case 'debits':
          if ($scope.debitFilter.fromDate) {
            pdfUrl += '&fromDate=' + $scope.formatDate($scope.debitFilter.fromDate);
          }
          if ($scope.debitFilter.toDate) {
            pdfUrl += '&toDate=' + $scope.formatDate($scope.debitFilter.toDate);
          }
          if ($scope.debitFilter.amenityType && $scope.debitFilter.amenityType != 'All') {
            pdfUrl += '&amenityType=' + $scope.debitFilter.amenityType;
          }
          if ($scope.debitFilter.payerFund && $scope.debitFilter.payerFund.payerFundId) {
            pdfUrl += '&payerFundId=' + $scope.debitFilter.payerFund.payerFundId;
          }
          if ($scope.debitFilter.executedBy && $scope.debitFilter.executedBy.executedById) {
            pdfUrl += '&executedById=' + $scope.debitFilter.executedBy.executedById;
          }
          if ($scope.debitFilter.cost) {
            pdfUrl += '&cost=' + $scope.debitFilter.cost;
          }
          if ($scope.debitFilter.orderBy) {
            pdfUrl += '&orderBy=' + $scope.debitFilter.orderBy;
          }
          if ($scope.debitFilter.orderField) {
            pdfUrl += '&orderField=' + $scope.debitFilter.orderField;
          }
          pdfUrl += '&reportType=' + 'Details';
          pdfUrl += '&userId=' + $rootScope.currentUser.id;
          if ($rootScope.txnAcc.id) {
            pdfUrl += '&accId=' + $rootScope.txnAcc.id;
          }
          if ($scope.txnRefNo) {
            pdfUrl += '&tranNumber=' + $scope.txnRefNo;
          }
          // pdfUrl = encodeURIComponent(pdfUrl);
          return "/Sip_TransactionHistoryAttachment?" + pdfUrl.substr(1);
          break;
      }
    };
    $scope.getCSV = function () {

      var req;
      switch ($scope.switch) {
        case 'summary':
          req = {};
          if ($scope.summaryFilter.fromDate && $scope.summaryFilter.fromDate != '') {
            req.fromDate = $scope.formatDate($scope.summaryFilter.fromDate);
          }
          if ($scope.summaryFilter.toDate && $scope.summaryFilter.toDate != '') {
            req.toDate = $scope.formatDate($scope.summaryFilter.toDate);
          }

          var summaryUrl = window.open('');
          TransactionHistoryService.getTransactionSummaryCSVUrl(
            req,
            $rootScope.currentUser.id,
            $rootScope.txnAcc.id
          ).then(
            function (value) {

              if (value) {
                if (value.errorMessages) {
                  $rootScope.$broadcast('showMessage', {
                    type: 'alert',
                    text: value.errorMessages
                  });
                } else {
                  summaryUrl.location = value;
                }
              }
            },
            function (err) {

              console.error(err);
              $rootScope.mainSpinner = false;
              $rootScope.$broadcast('showMessage', {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
            });
          break;

        case 'debits':
          req = {
            payerFund: {
              payerFundName: $scope.debitFilter.payerFund.payerFundName == 'All' ? '' :
                $scope.debitFilter.payerFund.payerFundName,
              payerFundId: $scope.debitFilter.payerFund.payerFundId
            },
            executedBy: {
              executedByName: $scope.debitFilter.executedBy.executedByName == 'All' ? '' :
                $scope.debitFilter.executedBy.executedByName,
              executedById: $scope.debitFilter.executedBy.executedById
            },
            amenityType: $scope.debitFilter.amenityType == 'All' ? '' : $scope.debitFilter.amenityType,
            cost: $scope.debitFilter.cost == 'All' ? '' : $scope.debitFilter.cost,
            orderField: $scope.debitFilter.orderField,
            orderBy: $scope.debitFilter.orderBy,
            recordsNumber: $scope.debitFilter.recordsNumber
          };
          if ($scope.debitFilter.fromDate && $scope.debitFilter.fromDate != '') {
            req.fromDate = $scope.formatDate($scope.debitFilter.fromDate);
          }
          if ($scope.debitFilter.toDate && $scope.debitFilter.toDate != '') {
            req.toDate = $scope.formatDate($scope.debitFilter.toDate);
          }

          var accId = '';
          var txnRefNo = '';

          if ($scope.txnRefNo) {
            txnRefNo = $scope.txnRefNo;
          }
          else {
            accId = $rootScope.txnAcc.id;
          }

          var debitUrl = window.open('');
          TransactionHistoryService.getTransactionDebitCSVUrl(
            req,
            $rootScope.currentUser.id,
            accId,
            txnRefNo
          ).then(
            function (value) {

              if (value) {
                if (value.errorMessages) {
                  $rootScope.$broadcast('showMessage', {
                    type: 'alert',
                    text: value.errorMessages
                  });
                } else {
                  debitUrl.location = value;
                }
              }
            },
            function (err) {

              console.error(err);
              $rootScope.$broadcast('showMessage', {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
            });

          break;
      }
    };

    $scope.sendOtpEmail = function (email) {

      if (email) {
        $rootScope.mainSpinner = true;
        TransactionHistoryService.resendOTPEmail(
          email,
          $scope.detail.TransactionId,
          $rootScope.currentUser.id
        ).then(function (value) {

          $rootScope.mainSpinner = false;
          if (util.isSuccessService(value)) {
            $scope.showOther = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'success',
                text: 'Email sent.'
              });

            if ($scope.detailId) {
              $scope.showDetail($scope.detailId);
            }
          }
        }, function (err) {

          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Failed to send email'
            });
        });
      }
    };
    $scope.sendTcEmail = function (otherEmailAddr) {

      $rootScope.mainSpinner = true;
      TransactionHistoryService.resendTravelCertEmail(
        $scope.detail.TransactionId,
        otherEmailAddr || ''
      ).then(function (value1) {

        if (util.isSuccessService(value1)) {
          var emailList = value1.vSACertificateEmail, promiseList = [];
          for (var i = 0, len = emailList.length; i < len; i++) {
            var promoCode = emailList[i].PromoID || ' ',
              pin = emailList[i].PIN || ' ',
              offCode = emailList[i].OfferCode || ' ',
              credits = emailList[i].Credits || ' ',
              effDate = emailList[i].EffTravelDate || ' ',
              expDate = emailList[i].ExpRedmDate || ' ',
              travelArea = value1.TravelArea || ' ',
              bookingClass = value1.ServiceClass || ' ',
              cabin = value1.CabinOfService || ' ',
              orgName = value1.OrganizationName || '',
              //20170612 Use new field IndividualName
              travelName = value1.IndividualName || ' ',
              //20170628 use ArcNumber
              arcNum = value1.ArcNumber || ' ',
              issueBy = value1.IssueByFullName || ' ',
              authBy = value1.Authorizer || ' ';

            var myEmailHtml = '<!DOCTYPE html><html><body><div style="padding:5px; font-size:12px; width:100%; color:#000">' +
              '<h4 style="font-weight: bold; text-transform:uppercase">' +
              'ER1181 ELECTRONIC CERTIFICATE' +
              '</h4>' +
              '<div style="padding-left:10px; margin-top:10px">Please note: This certificate is not a ticket</div>' +
              '<div style="width:800px; margin: 10px 0 10px 3px; border-bottom:1px solid #000;border-top:1px solid #000;padding:10px;">' +
              '<h4 style="font-weight: bold; text-transform:uppercase">' +
              'Certificate details' +
              '</h4>' +
              '<table align="center" style="margin-top:10px;width:100%; text-align:center;">' +
              '<tr style="text-decoration:underline; font-weight:bold;">' +
              '<th>Promotion Code</th>' +
              '<th>PIN</th>' +
              '<th>Offer Code</th>' +
              '<th>Credits</th>' +
              '<th>Effective Travel Date</th>' +
              '<th>Expiration Travel Date</th>' +
              '</tr>' +
              '<tr>' +
              '<td>' + promoCode + '</td>' +
              '<td>' + pin + '</td>' +
              '<td>' + offCode + '</td>' +
              '<td>' + credits + '</td>' +
              '<td>' + effDate + '</td>' +
              '<td>' + expDate + '</td>' +
              '</tr>' +
              '</table>' +
              '<div style="margin-top:10px;">' +
              '<b>Travel Area 1: </b>' + travelArea + '</span>' +
              '</div>' +
              '<div><b>Travel Area 2: </b>' + travelArea + '</span></div>' +
              '<table align="center" style="margin-top:10px;width:100%; text-align:center;">' +
              '<tr style="text-decoration:underline; font-weight:bold;">' +
              '<th>Booking Class</th>' +
              '<th>Cabin of Service</th>' +
              '<th>Geographic Restrictions</th>' +
              '</tr>' +
              '<tr>' +
              '<td>' + bookingClass + '</td>' +
              '<td>' + cabin + '</td>' +
              '<td></td>' +
              '</tr>' +
              '</table>' +
              '<div style="margin-top:10px;">' +
              '<b>Note: </b><span>Travel valid between Area 1 and Area 2 unless noted otherwise in Geographic restrictions.</span>' +
              '</div>' +
              '<div style="width:100%; height:20px; border-bottom:1px solid #000; margin-bottom:20px;"></div>' +
              '<h4 style="font-weight: bold; text-transform:uppercase">' +
              'Customer information' +
              '</h4>' +
              '<table align="center" style="margin:10px 0 10px 0;width:100%; text-align:center;">' +
              '<tr style="text-decoration:underline; font-weight:bold;">' +
              '<th>Company / Organization</th>' +
              '<th>Traveler Name</th>' +
              '<th>ARC-IATA/UA Corp Id</th>' +
              '<th>Issued By</th>' +
              '<th>Authorized By</th>' +
              '</tr>' +
              '<tr>' +
              '<td>' + orgName + '</td>' +
              '<td>' + travelName + '</td>' +
              '<td>' + arcNum + '</td>' +
              '<td>' + issueBy + '</td>' +
              '<td>' + authBy + '</td>' +
              '</tr>' +
              '</table>' +
              '</div>' +
              '<h4 style="font-weight: bold; margin-top:10px;">Reservation and Ticketing</h4>' +
              '<ul style="margin:10px 5px 0 0;width:800px; list-style-type:none;">' +
              '<li>1. On the united.com homepage, enter origin, destination, travel dates and any other search criteria. Select' +
              'the ?All search options? link </li>' +
              '<li>2. Enter your promotion code, plus the PIN provided, in the ?Promotions and certificates? field. Please do' +
              'not include any spaces. Select the ?Search? button</li>' +
              '<li>3. In your search results, flights displaying ?Special offer? are eligible for your discount. The price' +
              'shown is the discounted price.</li>' +
              '<li>4. Choose your seats and book your flights.</li>' +
              '<li>5. For online certificate status and terms and conditions, go to united.com, select "Promotional programs' +
              'and certificates" from the Deals and Offers dropdown menu, enter promotion code and PIN in the Offer Code box, and click "Submit".</li>' +
              '<li>6. Reservations and ticketing must be done online at united.com or by calling United Reservations at' +
              '1-800-864-8331. A reservation may be held for 24 hours from the time of booking. If you choose to ticket by calling United Reservations, a Reservation Ticketing' +
              'Service Fee will apply. Tickets are not permitted through airport ticketing or a travel agent.</li>' +
              '<li>7. After ticket issuance, itinerary changes are permitted in the same booking class. Ticket reissues do not' +
              'extend travel validity dates which need to be completed no later than expiration date listed in the certificate details.</li>' +
              '<li>8. Refunds of wholly unused tickets/related taxes may be requested. Note that refunding makes the ticket' +
              'null and void.</li>' +
              '</ul>' +
              '<div style="width:100%; height:20px; border-bottom:1px solid #000; margin-bottom:20px;"></div>' +
              '<h4 style="font-weight: bold;">Term and conditions</h4>' +
              '<ul style="margin:10px 5px 0 0;width:800px; list-style-type:none;">' +
              '<li>1. This certificate is valid for the number of confirmed roundtrip ticket(s) as defined under credits in the' +
              'authorization details. If issued for one-way travel, any unused portion will be forfeited.</li>' +
              '<li>2. Offer valid only on flights operated by United or operated by other airlines and branded ?United Express?.' +
              'Otherwise, it is not valid on flights operated by other airlines, such as United-Marketed code share and Star Alliance flights.</li>' +
              '<li>3. Itinerary must be a published fare routing.</li>' +
              '<li>4. All travel must be completed by the expiration date listed under authorization details. Extension of the' +
              'expiration date is not permitted under any circumstances.</li>' +
              '<li>5. Open jaws are permitted.</li>' +
              '<li>6. Stopovers and circle trip combinations are not permitted.</li>' +
              '<li>7. Open tickets are not permitted.</li>' +
              '<li>8. United reserves the right to limit the number of seats available for travel in conjunction with this offer.</li>' +
              '<li>9. Customer is liable for all applicable taxes, fees and surcharges.</li>' +
              '<li>10. MileagePlus miles will not be awarded.</li>' +
              '<li>11. Space-available upgrade certificates may be used on day of departure provided all terms of the upgrade are' +
              'met. All other upgrades, including MileagePlus and purchased are not permitted. </li>' +
              '<li>12. This certificate may not be used in conjunction with any other award, discount or offer. Customer will be' +
              'required to provide positive identification. </li>' +
              '<li>13. This offer is subject to any government approval and is invalid where prohibited by law.</li>' +
              '<li>14. This certificate is nontransferable and is void if sold or exchanged for compensation. If this certificate' +
              'is purchased, it is subject to confiscation and will not be accepted for travel.</li>' +
              '<li>15. In the event of flight irregularity, alternate travel will be provided in the indicated class of service' +
              '(subject to availability) only on' +
              'United flights. United assumes no responsibility for any expenses, or tax liability in conjunction with the use' +
              'of this offer and associated ticket(s) including, but not limited to expenses for accommodations, food or circumstances beyond the' +
              'control of United.</li>' +
              '<li>16. If you choose to ticket by calling United Reservations, please note that there will be a Reservation' +
              'Ticketing Service Fee.' +
              'Please advise the agent that you will be using an electronic ER1181 authorization (reference: GG Promo EER). Beprepared' +
              'to provide the agent the promotion code, certificate PIN, class and travel area application listed under the' +
              'authorization details.</li>' +
              '<li>17. Not eligible for denied boarding compensation.</li>' +
              '<li>18. Should you need to reissue, refund or void a ticket after you?ve redeemed your PIN credit(s), you will not' +
              'receive a redeposit of the redeemed PIN credit(s).</li>' +
              '<li>19. United reserves the right to change the terms and conditions of this offer without prior notice.</li>' +
              '<li>20. United\'s Contract of Carriage will be applicable to all travel undertaken, hereby.</li>' +
              '</ul>' +
              '<div style="margin-top:10px;">Copyright © United Airlines, Inc. All rights reserved.</div>' +
              '</div></body></html>';
            //20170628 add transaction number
            promiseList.push(TravelCertificateService.sendTravelCertEmails(myEmailHtml, value1.RecipientEmail, $rootScope.currentUser.id, $scope.detail.TransactionId))
          }

          $q.all(promiseList).then(function (value2) {
            $rootScope.mainSpinner = false;
            var failureItem = [], failureMessage = '';
            for (var j = 0, len = value2.length; j < len; j++) {
              if (!value2[j].success) {
                failureItem.push(value2);
                failureMessage += value2[j].messages[0];
              }
            }
            if (failureItem.length == 0) {
              $scope.showOther = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'success',
                  text: 'Email sent.'
                });

              if ($scope.detailId) {
                $scope.showDetail($scope.detailId);
              }
            } else {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: failureMessage
                });
            }
          }, function () {
            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Failed to send email'
              });
          });
        }
      }, function (err) {

        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Failed to send email'
          });
      });
    };

    $scope.txtKeyup = function ($event) {

      var txt = $event.target;
      switch ($event.keyCode) {
        case 13 : // enter key trigger search

          if (txt.id == 'txt-ref-no') {
            $scope.getDebitByRefNo();
          }
          else {
            if ($scope.specialLoad) {
              $scope.getAccounts();
            }
          }
          break;
      }
    };
    $scope.searchByExtId = function () {

      if ($scope.specialLoad) {
        $scope.getAccounts();
      }
    };
    $scope.selectTxnAcc = function (name, id, extId, accountType) {
      $scope.accountSymbol = accountType;
      $scope.txtTxnAcc = '';
      $scope.showFilter = false;
      $rootScope.txnAcc.name = name;
      $rootScope.txnAcc.id = id;
      $rootScope.txnAcc.extId = extId;
      $scope.showTxnAccPopup = false;
      $scope.loadData(true);
    };
    $scope.hideAcc = function () {

      $timeout(function () {

        if (!$scope.isInPopup && $rootScope.mainSpinner == false) {
          $scope.showTxnAccPopup = false;
        }
      }, 500);
    };

    $scope.accFilter = function (item) {

      var result = true;
      if ($rootScope.txnAcc.id && item.Id == $rootScope.txnAcc.id) {
        result = false;
      }
      else if ($rootScope.defAcc.id && item.Id == $rootScope.defAcc.id) {
        result = false;
      }
      else if ($scope.txtTxnAcc) {
        if ((_.toLower(item.Name)).indexOf((_.toLower($scope.txtTxnAcc))) >= 0 ||
          (item.ExtId && item.ExtId.indexOf($scope.txtTxnAcc)) >= 0) {
          result = true;
        }
        else {
          result = false;
        }
      }
      return result;
    };

    $scope.showOtherFunction = function () {
      if (!$rootScope.IsImpersonation) {
        $scope.showOther = true;
      }
    };

    $scope.viewEmailHistory = function () {

      $('#tl-email-history-modal').modal();
    };
    $scope.getDisplayTimeString = function (value) {

      var result = '';
      if (value) {

        var part = value.split(':');
        var ampm = 'AM';
        var h = part[0];
        var m = part[1];
        var s = part[2];

        if (h > 12) {
          ampm = 'PM';
          h = h - 12;
        }

        result = h + ':' + m + ' ' + ampm;
      }

      return result;
    };

    $document.on('scroll', function () {

      if ($scope.switch == 'debits') {
        var scrollPosition = 0;
        if ($window.scrollY || document.documentElement.scrollTop) {
          scrollPosition = ($window.scrollY || document.documentElement.scrollTop);
        }

        if ($('.debit-table').length > 0) {
          if (scrollPosition > 0) {
            if (scrollPosition > $('.debit-table').position().top + 81) {
              if (!$('.debit-table .table-header').hasClass('static')) {
                $('.debit-table .table-header').addClass('static');
                $('.debit-table .table-header').css('width', $('.debit-table').width() + 'px');
              }
            }
            else {
              if ($('.debit-table .table-header').hasClass('static')) {
                $('.debit-table .table-header').removeClass('static');
                $('.debit-table .table-header').css('width', 'auto');
              }
            }
          }
        }
      }
    });

    $(window).on('resize', function (e) {

      if ($('.debit-table').length > 0) {
        if ($('.debit-table .table-header').hasClass('static')) {
          $('.debit-table .table-header').css('width', $('.debit-table').width() + 'px');
        }
      }
    });

    $scope.getAccClass = function (accType) {

      var result;
      switch ($rootScope.currentUser.profileName) {
        case $rootScope.ACC_TYPE.agent:
        case $rootScope.ACC_TYPE.agtMgr:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
            case $rootScope.ACC_TYPE.agencyBranch:
              result = 'agency';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'reserved';
              break;
            case $rootScope.ACC_TYPE.corp:
            case $rootScope.ACC_TYPE.aor:
              result = 'corporate';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'dis';
              break;
          }
          break;
        case $rootScope.ACC_TYPE.corp:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
            case $rootScope.ACC_TYPE.agencyBranch:
            case $rootScope.ACC_TYPE.aor:
              result = 'agency';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'reserved';
              break;
            case $rootScope.ACC_TYPE.corp:
              result = 'corporate';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'dis';
              break;
          }
          break;
        default:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
            case $rootScope.ACC_TYPE.agencyBranch:
              result = 'agency';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'reserved';
              break;
            case $rootScope.ACC_TYPE.corp:
            case $rootScope.ACC_TYPE.aor:
              result = 'corporate';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'dis';
              break;
          }
          break;
      }
      return result;
    };
    $scope.getAccSymbol = function (accType) {

      var result;
      switch ($rootScope.currentUser.profileName) {
        case $rootScope.ACC_TYPE.agent:
        case $rootScope.ACC_TYPE.agtMgr:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
              result = 'H';
              break;
            case $rootScope.ACC_TYPE.agencyBranch:
              result = 'A';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'R';
              break;
            case $rootScope.ACC_TYPE.corp:
            case $rootScope.ACC_TYPE.aor:
              result = 'C';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'D';
              break;
          }
          break;
        case $rootScope.ACC_TYPE.corp:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
            case $rootScope.ACC_TYPE.aor:
              result = 'H';
              break;
            case $rootScope.ACC_TYPE.agencyBranch:
              result = 'A';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'R';
              break;
            case $rootScope.ACC_TYPE.corp:
              result = 'C';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'D';
              break;
          }
          break;
        default:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
              result = 'H';
              break;
            case $rootScope.ACC_TYPE.agencyBranch:
              result = 'A';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'R';
              break;
            case $rootScope.ACC_TYPE.corp:
            case $rootScope.ACC_TYPE.aor:
              result = 'C';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'D';
              break;
          }
          break;
      }
      return result;
    };
    $scope.getAccTitle = function (accType) {

      var result;
      switch ($rootScope.currentUser.profileName) {
        case $rootScope.ACC_TYPE.agent:
        case $rootScope.ACC_TYPE.agtMgr:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
              result = 'HOL';
              break;
            case $rootScope.ACC_TYPE.agencyBranch:
              result = 'Agency';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'Reserved';
              break;
            case $rootScope.ACC_TYPE.corp:
            case $rootScope.ACC_TYPE.aor:
              result = 'Corporate';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'Discretionary';
              break;
          }
          break;
        case $rootScope.ACC_TYPE.corp:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
            case $rootScope.ACC_TYPE.aor:
              result = 'HOL';
              break;
            case $rootScope.ACC_TYPE.agencyBranch:
              result = 'Agency';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'Reserved';
              break;
            case $rootScope.ACC_TYPE.corp:
              result = 'Corporate';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'Discretionary';
              break;
          }
          break;
        default:
          switch (accType) {
            case $rootScope.ACC_TYPE.agency:
              result = 'HOL';
              break;
            case $rootScope.ACC_TYPE.agencyBranch:
              result = 'Agency';
              break;
            case $rootScope.ACC_TYPE.resv:
              result = 'Reserved';
              break;
            case $rootScope.ACC_TYPE.corp:
            case $rootScope.ACC_TYPE.aor:
              result = 'Corporate';
              break;
            case $rootScope.ACC_TYPE.dis:
              result = 'Discretionary';
              break;
          }
          break;
      }
      return result;
    };
  }
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('travelCertificateControl', controller);

  controller.$inject = ['$rootScope', '$scope', '$state', '$interval',
    'TravelCertificateService', '$q', 'CMSService', '$timeout', 'AmenityService'];
  function controller($rootScope, $scope, $state, $interval,
                      TravelCertificateService, $q, CMSService, $timeout, AmenityService) {

    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: '',
      isValidFundOption: true,
      enableFund: true,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ? 1 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ? 1 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp ? 2 : 1) :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ? 1 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: 'SIP_Travel_Certificates__c'
    };

    $scope.creditNumber = 0;
    $scope.totalCreditNum = 0;
    $scope.infoData = [];
    $scope.budgetKey = '';
    $scope.hasBudgeKey = true;

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;

      if ($scope.data.widgetFeature == 'apply-travel-certificate') {
        //keep the value when return back
        $scope.data.charge.chargeAmount = '';
        if ($scope.data.travelCertificateData) {
          if ($scope.data.travelCertificateData.infoData.length != 0) {
            $scope.infoData = $scope.data.travelCertificateData.infoData;
            $scope.totalCreditNum = $scope.data.travelCertificateData.totalCreditNum;
            $scope.nextStep(3);
          }
        }

        if (!$scope.countryList) {
          //get country list
          CMSService.getCountryList().then(function (val) {

            var list = val;
            for (var i = 0, len = list.length - 1; i < len; i++) {
              if (list[i].value === 'U.S.A.') {
                list.splice(i, 1);
              }
            }
            list.unshift({
              disabled: false,
              value: 'USA',
              label: 'USA'
            });
            $scope.countryList = list;

            if ($scope.recipientForm && $scope.recipientForm.country) {
              $timeout(function () {
                $scope.recipientForm.country.$validate();
              }, 1000);
            }
          });
        }
      } else if ($scope.data.widgetFeature == 'confirm-travel-certificate') {
        $scope.data.charge.chargeAmount = $scope.data.travelCertificateData.totalCreditNum * $scope.data.travelCertificateData.costPerCredit;
      }
    });

    $scope.activePanel = 1;
    $scope.activeMiniPanel1 = false;
    $scope.activeMiniPanel2 = false;
    $scope.isModifyEntityBookingClass = false;

    //click next and back between steps
    $scope.nextStep = function (step) {

      switch (step) {
        case 1:
          $scope.isModifyEntityBookingClass = false;
          $scope.activePanel = 1;
          $scope.activeMiniPanel1 = false;
          $scope.activeMiniPanel2 = false;
          break;
        case 2:
          if ($scope.isModifyEntityBookingClass && $scope.infoData.length > 0) {
            angular.element('#travel-certificate-clear-modal').modal();
          } else {
            $scope.activePanel = 2;
          }
          $scope.activeMiniPanel1 = true;
          $scope.activeMiniPanel2 = false;
          break;
        case 3:
          $scope.isModifyEntityBookingClass = false;
          $scope.activePanel = 3;
          $scope.activeMiniPanel1 = true;
          $scope.activeMiniPanel2 = true;
          break;
      }
    };

    $scope.toggleMiniPanel = function (step) {

      switch (step) {
        case 1:
          $scope.activeMiniPanel1 = !$scope.activeMiniPanel1;
          break;
        case 2:
          $scope.activeMiniPanel2 = !$scope.activeMiniPanel2;
          break;
      }
    };

    $scope.showDropDown = function (event) {

      $(event.target).siblings('ul').dropdown('toggle');
    };

    $scope.countrySelect = function (c) {

      $scope.data.travelCertificateData.recipientInfo.country = c;
    };

    $scope.entitySelect = function (item) {

      //see if entity changes
      if (((item.name + ' - ' + item.detail) != $scope.data.travelCertificateData.entity) && !$scope.isModifyEntityBookingClass) {
        $scope.isModifyEntityBookingClass = true;
      } else {
        $scope.isModifyEntityBookingClass = false;
      }

      $scope.data.travelCertificateData.entity = item.name + ' - ' + item.detail;
      $scope.data.travelCertificateData.entityName = item.name;

      if ($scope.data.travelCertificateData.bookingClassName.length > 0) {
        //is entity and booking class included in budget/ get max number of budgets
        $scope.budgetKey = $scope.data.travelCertificateData.entityName + $scope.data.travelCertificateData.bookingClassName;
        if ($scope.data.travelCertificateData.budget.hasOwnProperty($scope.budgetKey)) {
          $scope.hasBudgeKey = true;
          $scope.data.travelCertificateData.maxBudgetNum = Number($scope.data.travelCertificateData.budget[$scope.budgetKey].Quantity);
        } else {
          $scope.hasBudgeKey = false;
        }
      }

      //calculate cost per credit
      $scope.data.travelCertificateData.costPerCredit = 0;
      $scope.productCode = $scope.data.travelCertificateData.entityName[0] + $scope.data.travelCertificateData.entityName[$scope.data.travelCertificateData.entityName.length - 1] + $scope.data.travelCertificateData.bookingClassName;
      if ($scope.data.travelCertificateData.costValue.hasOwnProperty($scope.productCode)) {
        $scope.data.travelCertificateData.costPerCredit = $scope.data.travelCertificateData.costValue[$scope.productCode];
      }
    };

    //select booking class
    $scope.bookingClassSelect = function (item) {

      //see if booking class changes
      if (((item.name + ' - ' + item.detail) != $scope.data.travelCertificateData.bookingClass) && !$scope.isModifyEntityBookingClass) {
        $scope.isModifyEntityBookingClass = true;
      } else {
        $scope.isModifyEntityBookingClass = false;
      }
      $scope.data.travelCertificateData.bookingClass = item.name + ' - ' + item.detail;
      $scope.data.travelCertificateData.bookingClassName = item.name;

      //is entity and booking class included in budget/ get max number of budgets
      if ($scope.data.travelCertificateData.entityName.length > 0) {
        $scope.budgetKey = $scope.data.travelCertificateData.entityName + $scope.data.travelCertificateData.bookingClassName;
        if ($scope.data.travelCertificateData.budget.hasOwnProperty($scope.budgetKey)) {
          $scope.hasBudgeKey = true;
          $scope.data.travelCertificateData.maxBudgetNum = Number($scope.data.travelCertificateData.budget[$scope.budgetKey].Quantity);
        } else {
          $scope.hasBudgeKey = false;
        }
      }

      //calculate cost per credit
      $scope.data.travelCertificateData.costPerCredit = 0;
      $scope.productCode = $scope.data.travelCertificateData.entityName[0] + $scope.data.travelCertificateData.entityName[$scope.data.travelCertificateData.entityName.length - 1] + $scope.data.travelCertificateData.bookingClassName;
      if ($scope.data.travelCertificateData.costValue.hasOwnProperty($scope.productCode)) {
        $scope.data.travelCertificateData.costPerCredit = $scope.data.travelCertificateData.costValue[$scope.productCode];
      }
    };

    $scope.clearEntity = function () {

      $scope.data.travelCertificateData.entity = '';
    };

    $scope.clearBookingClass = function () {

      $scope.data.travelCertificateData.bookingClass = '';
    };

    $scope.clearCountryList = function () {

      $scope.data.travelCertificateData.recipientInfo.country = '';
    };

    $scope.clearReasonCode = function () {

      $scope.data.travelCertificateData.reasonCode = '';
      $scope.data.travelCertificateData.reasonCodeFull = '';
    };

    $scope.clearAuthorizer = function () {

      $scope.data.travelCertificateData.auth = '';
    };

    $scope.clearDivision = function () {

      $scope.data.travelCertificateData.divi = '';
    };

    //if user changes entity/bookingclass clear existing certificates
    $scope.confirmClearInfoData = function () {

      $scope.infoData = [];
      $scope.totalCreditNum = 0;
      $scope.creditNumber = 0;
      $scope.activePanel = 2;
      angular.element('#travel-certificate-clear-modal').modal('hide');
    };

    $scope.addCredit = function () {

      //below maximum budget number
      if ($scope.data.travelCertificateData.maxBudgetNum > ($scope.creditNumber + $scope.totalCreditNum)) {
        $scope.creditNumber++;
      }
    };

    $scope.minusCredit = function () {

      if ($scope.creditNumber > 0) {
        $scope.creditNumber--;
      }
    };

    $scope.authSelect = function (auth) {

      $scope.data.travelCertificateData.auth = auth;
    };

    $scope.reasonSelect = function (rea) {

      $scope.data.travelCertificateData.reasonCode = rea.TravelCertReasonCode;
      $scope.data.travelCertificateData.reasonCodeFull = rea.TravelCertReasonCode + "-" + rea.TravelCertReasonCodeDefinition;
    };

    $scope.diviSelect = function (divi) {

      $scope.data.travelCertificateData.divi = divi;
    };

    $scope.addHold = function () {

      $scope.keyHoldInterval = $interval(function () {
        $scope.addCredit();
      }, 300);
    };

    $scope.minusHold = function () {

      $scope.keyHoldInterval = $interval(function () {
        $scope.minusCredit();
      }, 300);
    };

    $scope.clearHoldInterval = function () {

      $interval.cancel($scope.keyHoldInterval);
    };

    //add certificates button
    $scope.addCertificateSection = function () {

      $scope.infoData.push({
        Entity: $scope.data.travelCertificateData.entityName,
        ServiceClass: $scope.data.travelCertificateData.bookingClassName,
        Quantity: $scope.creditNumber,
        CreditCount: $scope.data.travelCertificateData.costPerCredit * $scope.creditNumber
      });

      //called when amount changes calculates total cost
      if ($scope.infoData.length > 0) {
        $scope.totalCreditNum = 0;
        for (var i = 0, len = $scope.infoData.length; i < len; i++) {
          $scope.totalCreditNum += $scope.infoData[i].Quantity;
        }
      } else {
        $scope.totalCreditNum = 0;
      }
    };

    //click remove button on each certificate
    $scope.removeSelf = function (index) {

      if ($scope.infoData.length > 0) {
        $scope.infoData.splice(index, 1);
        //calculates total credit number
        $scope.totalCreditNum = 0;
        for (var i = 0, len = $scope.infoData.length; i < len; i++) {
          $scope.totalCreditNum += $scope.infoData[i].Quantity;
        }
      } else {
        $scope.totalCreditNum = 0
      }
    };

    $scope.confirmContinue = function () {

      $scope.data.travelCertificateData.infoData = $scope.infoData;
      $scope.data.travelCertificateData.totalCreditNum = $scope.totalCreditNum;
      $state.go($state.current.parent + '-travel-certificate', {
        feature: 'confirm-travel-certificate'
      });
    };

    $scope.goBack = function () {

      $scope.infoData = $scope.data.travelCertificateData.infoData;
      $scope.totalCreditNum = $scope.data.travelCertificateData.totalCreditNum;
      $state.go($state.current.parent + '-travel-certificate', {feature: 'apply-travel-certificate'});
    };

    $scope.purchase = function () {

      angular.element('#travel-certificate-confirm-modal').modal();
    };

    //proceed purchase
    $scope.confirmPurchase = function () {

      //generate certificate value and count
      var creditCountQuantityList = [], creditCountList = [], hash = {};
      for (var i = 0, len = $scope.data.travelCertificateData.infoData.length; i < len; i++) {
        var eachCreditCount = $scope.data.travelCertificateData.infoData[i].Quantity;
        creditCountList.push(eachCreditCount);
      }
      if (creditCountList.length > 0) {
        for (var j = 0, len = creditCountList.length; j < len; j++) {
          var key = creditCountList[j];
          if (hash[key]) {
            hash[key]++;
          } else {
            hash[key] = 1;
          }
        }
        for (var item in hash) {
          creditCountQuantityList.push({
            Quantity: hash[item],
            CreditCount: item
          });
        }
      }
      //last parameters used
      var comment = $scope.data.charge.comment;
      var payerId = $scope.data.charge.accSearchId;
      var beneficiaryId = $scope.data.charge.beneficiarySearchId;
      //first parameter used for service
      var params = {
        FirstName: $scope.data.travelCertificateData.recipientInfo.sendCertificateType == 'Individual' ? $scope.data.travelCertificateData.recipientInfo.firstName : "",
        LastName: $scope.data.travelCertificateData.recipientInfo.sendCertificateType == 'Individual' ? $scope.data.travelCertificateData.recipientInfo.lastName : "",
        RecipientEmailAddress: $scope.data.travelCertificateData.recipientInfo.email,
        Address: $scope.data.travelCertificateData.recipientInfo.street,
        CityName: $scope.data.travelCertificateData.recipientInfo.city,
        StateName: $scope.data.travelCertificateData.recipientInfo.state,
        ZIPCode: $scope.data.travelCertificateData.recipientInfo.ZIP,
        CountryName: $scope.data.travelCertificateData.recipientInfo.country,
        ReasonCode: $scope.data.travelCertificateData.reasonCode,
        Division: $scope.data.travelCertificateData.divi,
        EffectiveDateFromUI: $scope.data.travelCertificateData.effDate,
        Authorizer: $scope.data.travelCertificateData.auth,
        Comments: comment + 'Transaction Processed in United Jetstream',
        Entity: $scope.data.travelCertificateData.entityName,
        TravelArea: $scope.data.travelCertificateData.entity.split(' - ')[1],
        CabinOfService: $scope.data.travelCertificateData.bookingClass.split(' - ')[1],
        ServiceClass: $scope.data.travelCertificateData.bookingClassName,
        OrganizationName: $scope.data.travelCertificateData.recipientInfo.sendCertificateType == 'Organization' ? $scope.data.travelCertificateData.recipientInfo.organisationName : "",
        cTravelCertDetails: creditCountQuantityList
      };
      //20170616 Call activate cert after pre deduct
      var totalcost = $scope.data.travelCertificateData.totalCreditNum * $scope.data.travelCertificateData.costPerCredit;

      //complete all promises calling service
      $rootScope.mainSpinner = true;
      AmenityService.preDeductAccountBalance(
        payerId,
        totalcost,
        $rootScope.currentUser.id
      ).then(function (value) {

        $rootScope.mainSpinner = false;
        if (value.success) {
          //20170620 add pendingAmountObjId
          $scope.pendingAmountObjId = value.pendingAmountObjId;
          //20170616 Call activate cert after pre deduct
          var promiseList = [];
          for (var times = 0, len = creditCountQuantityList.length; times < len; times++) {
            promiseList.push(TravelCertificateService.activateTravelCert(params, $scope.data.travelCertificateData.certAllocationByEmpID, times, payerId, beneficiaryId, comment, $rootScope.currentUser.id, totalcost));
          }

          $rootScope.mainSpinner = true;
          $q.all(promiseList).then(function (value1) {

            $rootScope.mainSpinner = false;
            angular.element('#travel-certificate-confirm-modal').modal('hide');
            $scope.allResp = [];
            $scope.successItems = [];
            $scope.failureItems = [];
            //for all the messages/+ credits
            for (var i = 0; i < value1.length; i++) {
              for (var j = 0; j < value1[i].vSACertificate.length; j++) {
                $scope.allResp.push(value1[i].vSACertificate[j]);
              }
              //for success data
              if (value1[i].success) {
                $scope.successItems.push(value1[i]);
              } else {
                $scope.failureItems.push(value1[i]);
              }
            }

            if ($scope.failureItems.length !== value1.length) {
              var productCode = $scope.data.travelCertificateData.entityName[0] + $scope.data.travelCertificateData.entityName[$scope.data.travelCertificateData.entityName.length - 1] + $scope.data.travelCertificateData.bookingClassName;

              var totalcost = $scope.data.travelCertificateData.totalCreditNum * $scope.data.travelCertificateData.costPerCredit;

              $rootScope.mainSpinner = true;
              TravelCertificateService.commitTravelCertsTransaction(
                $scope.successItems,
                productCode,
                payerId,
                beneficiaryId,
                $scope.data.callerAccount.accountId,
                comment,
                $rootScope.currentUser.id,
                totalcost,
                $scope.pendingAmountObjId)
                .then(function (value2) {

                  $rootScope.mainSpinner = false;
                  if (value2.success) {
                    $scope.data.travelCertificateData.transactionNumber = value2.transactionNumber;
                    angular.element('#travel-certificate-success-modal').modal();
                  } else {
                    $scope.shouldCheckBalance = true;
                    $rootScope.$broadcast('showMessage',
                      {
                        type: 'alert',
                        text: value.messages[0]
                      });
                  }
                }, function (e) {

                  $rootScope.mainSpinner = false;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                    });
                });
            } else {

              $rootScope.mainSpinner = false;
              //20170616 redefine total cost
              var totalcost = $scope.data.travelCertificateData.totalCreditNum * $scope.data.travelCertificateData.costPerCredit;

              $rootScope.mainSpinner = true;
              AmenityService.addAmount(
                payerId,
                totalcost,
                $rootScope.currentUser.id,
                $scope.pendingAmountObjId
              ).then(function (value) {

                $rootScope.mainSpinner = false;
                if (value.success) {
                  //20170616 show activate cert error msg when add amount finish
                  var eMessageList = [];
                  for (var i = 0; i < $scope.failureItems.length; i++) {
                    eMessageList.push($scope.failureItems[i].messages[0]);
                  }
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: eMessageList
                    });
                } else {
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: 'Sorry, an error has occurred. Please contact United for further assistance.' + '. ' + value.messages[0]
                    });
                }
              }, function (e) {

                $rootScope.mainSpinner = false;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                  });
              });
            }
          }, function (e) {

            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
        } else {

          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.messages[0]
            });
        }
      }, function (err) {

        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
      })
    };

    angular.element('#travel-certificate-success-modal').on('show.bs.modal', function (e) {

      $('.entity-email').html($scope.data.travelCertificateData.entity.split(' - ')[1]);
      $('#booking-class-tc').html($scope.data.travelCertificateData.bookingClassName);
      $('#cabin').html($scope.data.travelCertificateData.bookingClass.split(' - ')[1]);
      if ($scope.data.travelCertificateData.recipientInfo.sendCertificateType == 'Organization') {
        $('#org').html($scope.data.travelCertificateData.recipientInfo.organisationName);
      } else {
        $('#org').html('');
      }
      if ($scope.data.travelCertificateData.recipientInfo.sendCertificateType == 'Individual') {
        $('#tc-name').html($scope.data.travelCertificateData.recipientInfo.lastName + " ," + $scope.data.travelCertificateData.recipientInfo.firstName);
      } else {
        $('#tc-name').html('');
      }
      $('#arc-num').html($scope.data.preSelectedAccount.extId);
      $('#issue-by').html($rootScope.currentUser.name);
      $('#auth-by').html($scope.data.travelCertificateData.auth);
      var emailPromiseList = [];
      for (var i = 0; i < $scope.allResp.length; i++) {
        $('#promo-code').html($scope.allResp[i].PromoID);
        $('#pin').html($scope.allResp[i].PIN);
        $('#offer-code').html($scope.allResp[i].OfferCode);
        $('#credits-email').html($scope.allResp[i].Credits);
        $('#ef-date').html($scope.allResp[i].EffTravelDate);
        $('#ex-date').html($scope.allResp[i].ExpRedmDate);

        var onePageDiv = $('#send-email-content').prop('outerHTML'),
          onePage = '<!DOCTYPE html><html><body>' + onePageDiv + '</body></html>';
        //promise list
        //20170628 add transaction number
        emailPromiseList.push(TravelCertificateService.sendTravelCertEmails(onePage, $scope.data.travelCertificateData.recipientInfo.email, $rootScope.currentUser.id, $scope.data.travelCertificateData.transactionNumber));
      }

      //proceed send email service
      //20170616 send travel cert email error handle
      $rootScope.mainSpinner = true;
      $q.all(emailPromiseList).then(function (value) {

        $rootScope.mainSpinner = false;
        var failureItem = [], failureMessage = '';
        for (var i = 0; i < value.length; i++) {
          if (!value[i].success) {
            failureItem.push(value);
            failureMessage += value[i].messages[0];
          }
        }
        if (failureItem.length > 0) {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: failureMessage
            });
        }
      }, function (e) {

        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Sorry, an error has occurred. Please contact United for further assistance.'
          });
      });
    });

    angular.element('#message-modal').on('hidden.bs.modal', function (e) {

      if ($scope.shouldCheckBalance) {
        $scope.shouldCheckBalance = false;

        $rootScope.$broadcast('refreshSelectedAccount', {});
      }
    });

    angular.element('#travel-certificate-success-modal').on('hidden.bs.modal', function () {
      if ($scope.data.travelCertificateData.checkedEmail) {
        $rootScope.mainSpinner = true;
        AmenityService.sendEmail(
          $rootScope.currentUser.id,
          $scope.data.travelCertificateData.transactionNumber
        ).then(function () {
          $rootScope.mainSpinner = false;
          $state.go($state.current.parent + '-home', {feature: 'init'});
        }, function (err) {
          $rootScope.mainSpinner = false;
          console.debug(err);
          $state.go($state.current.parent + '-home', {feature: 'init'});
        })
      }
      else {
        $state.go($state.current.parent + '-home', {feature: 'init'});
      }
    });
  }
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('unitedClubController', controller);

  controller.$inject = ['$rootScope', '$scope', '$state',
    'util', 'UnitedClubService', 'ProductService', 'AmenityService'];
  function controller($rootScope, $scope, $state,
                      util, UnitedClubService, ProductService, AmenityService) {

    $scope.forms = {};
    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: '',
      isValidFundOption: true,
      enableFund: true,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ? 1 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ? 1 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp ? 2 : 1) :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ? 1 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: ''
    };

    $scope.prodMembership = ProductService.getProductByCode($scope.data.products, 'Membership');
    $scope.prodOTP = ProductService.getProductByCode($scope.data.products, 'OTP');

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;

      if ($scope.data.widgetFeature == 'confirm-membership' ||
        $scope.data.widgetFeature == 'confirm-otp-membership' ||
        $scope.data.widgetFeature == 'confirm-otp-email') {

        if ($scope.data.widgetFeature == 'confirm-membership') {
          $scope.data.charge.chargeAmount = $scope.data.membershipData ? $scope.data.membershipData.TotalCost : 0;
          $scope.data.charge.amenityType = 'SIP_United_Club_Membership__c';
        }
        else if ($scope.data.widgetFeature == 'confirm-otp-membership') {
          $scope.data.charge.chargeAmount = $scope.data.otpMembershipData ? $scope.data.otpMembershipData.TotalCost : 0;
          $scope.data.charge.amenityType = 'SIP_United_Club_Passes__c';
        }
        else {
          $scope.data.charge.chargeAmount = $scope.data.otpEmailData ? $scope.data.otpEmailData.TotalCost : 0;
          $scope.data.charge.amenityType = 'SIP_United_Club_Passes__c';
        }
      }
      else {
        $scope.data.charge.chargeAmount = '';
      }
    });

    $scope.goBack = function () {

      var backTo = '';
      if ($scope.data.widgetFeature == 'confirm-membership') {
        backTo = 'amenity-united-club-membership';
      }
      else {
        backTo = 'amenity-united-club-otp';
      }
      $state.go($state.current.parent + '-home', {feature: backTo});
    };

    $scope.shouldCheckBalance = false;
    $scope.msgModal = $('#message-modal');
    $scope.confirmModal = $('#united-club-confirm-modal');
    $scope.successModal = $('#united-club-success-modal');
    $scope.purchase = function () {

      $scope.confirmModal.modal();
    };
    $scope.confirmPurchase = function () {

      var comment = $scope.data.charge.comment;
      var payerId = $scope.data.charge.accSearchId;
      var beneficiaryId = $scope.data.charge.beneficiarySearchId;

      switch ($scope.data.widgetFeature) {

        case 'confirm-membership':

          $rootScope.mainSpinner = true;
          //20170418 Yang/Shan Change from DataSource To Data

          AmenityService.preDeductAccountBalance(payerId, $scope.data.membershipData.TotalCost, $rootScope.currentUser.id).then(function (value) {
            if(value.success){
                //20170620 add pendingAmountObjId
              UnitedClubService.submitUCMEnrollment(
                $scope.data.membershipData,
                payerId,
                beneficiaryId,
                $scope.data.callerAccount.accountId,
                comment,
                $rootScope.currentUser.id,
                $scope.data.membershipData.TotalCost,
                value.pendingAmountObjId).then(function (value) {

                $rootScope.mainSpinner = false;
                if (value.success) {
                  $scope.confirmModal.modal('hide');
                  $scope.data.membershipData.transactionNumber = value.transactionNumber;
                  $scope.successModal.modal();
                } else {
                  $scope.shouldCheckBalance = true;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: value.messages[0]
                    });
                }
              }, function (err) {

                $rootScope.mainSpinner = false;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                  });
              });
            } else {
              $rootScope.mainSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.messages[0]
                });
            }
          }, function (err) {

            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
          break;
        //20170418 Shan Issue Pass For OTP With MP
        case 'confirm-otp-membership':

          $rootScope.mainSpinner = true;
          var requestInfoForOTPMember = {
            'emailToSent': ''
          }, valueStructure = {
            Email: $scope.data.otpMembershipData.Email,
            FirstName: $scope.data.otpMembershipData.FirstName,
            LastName: $scope.data.otpMembershipData.LastName,
            MileagePlusNumber: $scope.data.otpMembershipData.MileagePlusNumber,
            NewEffectiveDate: $scope.data.otpMembershipData.NewEffectiveDate,
            NewExpiryDate: $scope.data.otpMembershipData.NewExpiryDate,
            NumberOfPasses: $scope.data.otpMembershipData.NumberOfPasses,
            OtpBalance: $scope.data.otpMembershipData.OtpBalance,
            TotalCost: $scope.data.otpMembershipData.TotalCost,
            UnitCost: $scope.data.otpMembershipData.UnitCost,
            messages: $scope.data.otpMembershipData.messages,
            success: $scope.data.otpMembershipData.success,
            //20170531
            EdocIdList: $scope.data.otpMembershipData.EdocIdList
          };

          AmenityService.preDeductAccountBalance(payerId, $scope.data.otpMembershipData.TotalCost, $rootScope.currentUser.id).then(function (value) {
            if (value.success) {
                //20170620 add pendingAmountObjId
              UnitedClubService.retrieveIssuePassWithMP(
                $scope.data.otpMembershipData.retriveQual,
                requestInfoForOTPMember,
                valueStructure,
                payerId,
                beneficiaryId,
                $scope.data.callerAccount.accountId,
                comment,
                $rootScope.currentUser.id,
                $scope.data.otpMembershipData.TotalCost,
                value.pendingAmountObjId).then(function (value) {

                $rootScope.mainSpinner = false;
                if (value.success) {
                  $scope.confirmModal.modal('hide');
                  $scope.data.otpMembershipData.transactionNumber = value.transactionNumber;
                  $scope.successModal.modal();
                } else {
                  $scope.shouldCheckBalance = true;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: value.messages[0]
                    });
                }
              }, function (err) {

                $rootScope.mainSpinner = false;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                  });
              });
            } else {
              $rootScope.mainSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.messages[0]
                });
            }
          }, function (err) {

            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
          break;
        //20170418 Shan Issue Pass For OTP Without MP
        case 'confirm-otp-email':

          $rootScope.mainSpinner = true;

          AmenityService.preDeductAccountBalance(payerId, $scope.data.otpEmailData.TotalCost, $rootScope.currentUser.id).then(function (value) {
            if (value.success) {
                //20170620 add pendingAmountObjId
              UnitedClubService.retrieveIssuePassWithoutMP(
                $scope.data.otpEmailData,
                payerId,
                beneficiaryId,
                $scope.data.callerAccount.accountId,
                comment,
                $rootScope.currentUser.id,
                $scope.data.otpEmailData.TotalCost,
                value.pendingAmountObjId).then(function (value) {

                $rootScope.mainSpinner = false;
                if (value.success) {
                  $scope.confirmModal.modal('hide');
                  $scope.data.otpEmailData.transactionNumber = value.transactionNumber;
                  $scope.successModal.modal();
                } else {
                  $scope.shouldCheckBalance = true;
                  $rootScope.$broadcast('showMessage',
                    {
                      type: 'alert',
                      text: value.messages[0]
                    });
                }
              }, function (err) {

                $rootScope.mainSpinner = false;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                  });
              });
            } else {
              $rootScope.mainSpinner = false;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.messages[0]
                });
            }
          }, function (err) {

            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
          break;
      }
    };
    $scope.msgModal.on('hidden.bs.modal', function (e) {

      if ($scope.shouldCheckBalance) {
        $scope.shouldCheckBalance = false;
      }
      $rootScope.$broadcast('refreshSelectedAccount', {});
    });
    angular.element('#united-club-success-modal').on('hidden.bs.modal', function (e) {

      if ($scope.data.membershipData.checkedEmail) {
        AmenityService.sendEmail(
          $rootScope.currentUser.id,
          $scope.data.membershipData.transactionNumber
        ).then(function () {

        }, function (err) {

          console.debug(err);
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Failed to send email'
            });
        })
      }

      if ($scope.data.otpMembershipData.checkedEmail) {
        AmenityService.sendEmail(
          $rootScope.currentUser.id,
          $scope.data.otpMembershipData.transactionNumber
        ).then(function () {

        }, function (err) {

          console.debug(err);
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Failed to send email'
            });
        })
      }

      if ($scope.data.otpEmailData.checkedEmail) {
        AmenityService.sendEmail(
          $rootScope.currentUser.id,
          $scope.data.otpEmailData.transactionNumber
        ).then(function () {

          $state.go($state.current.parent + '-home', {feature: 'init'});
        }, function (err) {

          console.debug(err);
          $state.go($state.current.parent + '-home', {feature: 'init'});
        })
      }
      else {
        $state.go($state.current.parent + '-home', {feature: 'init'});
      }
    });
  }
})();
(function () {
  'use strict';
  angular.module('bankingModule')
    .controller('upgradesController', controller);
  //20170503 Shan added AccountService and ProductService (After Upgrade Review 1) - Added but not used ???
  controller.$inject = ['$rootScope', '$scope', '$state', 'util',
    'AccountService', 'ProductService', 'UpgradeService', 'AmenityService'];
  function controller($rootScope, $scope, $state, util,
                      AccountService, ProductService, UpgradeService, AmenityService) {

    $scope.data.charge = {
      forms: '',
      accSearchValue: '',
      accSearchId: '',
      accSearchExtId: '',
      beneficiarySearchValue: '',
      beneficiarySearchId: '',
      chargeAmount: '',
      chargeType: '',
      accountType: '',
      comment: '',
      remark: '',
      isValidFundOption: true,
      enableFund: true,
      enableIns: false,
      enableGS: false,
      companyOption: !$rootScope.currentUser.isInternalUser ?
        _.indexOf([$rootScope.ACC_TYPE.corp, $rootScope.ACC_TYPE.aor],
          $scope.data.preSelectedAccount.typeName) > -1 ? 3 : 2 :
        $rootScope.currentUser.permission.SIP_Use_All_Corporate_Service_Funds__c ?
          _.indexOf([$rootScope.ACC_TYPE.corp, $rootScope.ACC_TYPE.aor],
            $scope.data.preSelectedAccount.typeName) > -1 ? 3 : 2 : 2,
      agencyOption: !$rootScope.currentUser.isInternalUser ?
        _.indexOf([$rootScope.ACC_TYPE.agency, $rootScope.ACC_TYPE.agencyBranch, $rootScope.ACC_TYPE.resv],
          $scope.data.preSelectedAccount.typeName) > -1 ? 3 : 2 :
        $rootScope.currentUser.permission.Sip_Use_Agency_s_HOL_s_Service_Funds__c ?
          _.indexOf([$rootScope.ACC_TYPE.agency, $rootScope.ACC_TYPE.agencyBranch, $rootScope.ACC_TYPE.resv],
            $scope.data.preSelectedAccount.typeName) > -1 ? 3 : 2 : 2,
      disOption: $rootScope.currentUser.isInternalUser ? 1 : 2,
      amenityType: ''
    };

    if ($scope.data.upgradeData) {
      if ($scope.data.upgradeData.RPUCount > 0) {
        $scope.data.charge.amenityType = 'SIP_Regional_Premier_Upgrades__c';
      }
      if ($scope.data.upgradeData.GPUCount > 0) {
        if ($scope.data.charge.amenityType) {
          $scope.data.charge.amenityType += ',SIP_Global_Premier_Upgrades__c';
        }
        else {
          $scope.data.charge.amenityType = 'SIP_Global_Premier_Upgrades__c';
        }
      }
    }

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

      $scope.data.widgetFeature = toParams.feature;

      if ($scope.data.widgetFeature == 'apply-upgrades') {
        $scope.data.charge.chargeAmount = '';
      }
      else if ($scope.data.widgetFeature == 'confirm-upgrades') {
        $scope.data.charge.chargeAmount = 0;
        if ($scope.data.upgradeData) {
          $scope.data.upgradeData.GPUTotal = ($scope.data.upgradeData.GPUCount ? $scope.data.upgradeData.GPUCount : 0) * $scope.data.upgradeData.GPUUnitCost;
          $scope.data.upgradeData.RPUTotal = ($scope.data.upgradeData.RPUCount ? $scope.data.upgradeData.RPUCount : 0) * $scope.data.upgradeData.RPUUnitCost;
          $scope.data.upgradeData.TotalCost = $scope.data.upgradeData.GPUTotal + $scope.data.upgradeData.RPUTotal;
          $scope.data.charge.chargeAmount = $scope.data.upgradeData.TotalCost;
          //abe modified add upgrade expire date
        }
      }
    });

    $scope.applyUpgrades = function () {

      $state.go($state.current.parent + '-upgrades', {feature: 'confirm-upgrades'});
    };

    $scope.goBack = function () {

      $state.go($state.current.parent + '-upgrades', {feature: 'apply-upgrades'});
    };

    $scope.proceed = false;
    $scope.msgModal = $('#message-modal');
    $scope.confirmModal = $('#upgrades-confirm-modal');
    $scope.purchase = function () {

      $scope.confirmModal.modal();
    };
    $scope.confirmPurchase = function () {

      $scope.proceed = true;
      $scope.confirmModal.modal('hide');
      $rootScope.mainSpinner = true;
    };

    $scope.showTermConditionModal = function () {

      angular.element('#term-condition-modal').modal();
    };

    $scope.checkResult = function (reqCounter, result) {

      var comment = $scope.data.charge.comment;
      var payerId = $scope.data.charge.accSearchId;
      var beneficiaryId = $scope.data.charge.beneficiarySearchId;

      if (reqCounter == 0) {
        if (result.Msgs.length > 0) {
          AmenityService.addAmount(
            payerId,
            $scope.data.upgradeData.TotalCost,
            $rootScope.currentUser.id,
            $scope.pendingAmountObjId
          ).then(function (value) {
            if (value.success) {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.'
                });
            } else {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: 'Sorry, an error has occurred. Please contact United for further assistance.' + '. ' + value.messages[0]
                });
            }
          }, function (e) {
            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
        }
        else {
          //abe add service
          //20170620 add pendingAmountObjId
          UpgradeService.commitUpgradeTransaction(
            $scope.commitTranscationSuccessItem,
            payerId,
            beneficiaryId,
            $scope.data.callerAccount.accountId,
            comment,
            $rootScope.currentUser.id,
            $scope.data.upgradeData.TotalCost,
            $scope.pendingAmountObjId
          ).then(function (value3) {
            $rootScope.mainSpinner = false;
            if (value3.success) {
              $scope.data.upgradeData.transactionNumber = value3.transactionNumber;
              $state.go($state.current.parent + '-upgrades', {feature: 'complete-upgrades'});
            } else {
              $scope.shouldCheckBalance = true;
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.messages[0]
                });
            }
          }, function (e) {
            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          });
          //$rootScope.mainSpinner = false;
          //$state.go($state.current.parent + '-upgrades', {feature: 'complete-upgrades'});
        }
      }
    };
    $scope.confirmModal.on('hidden.bs.modal', function (e) {

      if ($scope.proceed) {

        var comment = $scope.data.charge.comment;
        var payerId = $scope.data.charge.accSearchId;
        var beneficiaryId = $scope.data.charge.beneficiarySearchId;

        var CM_RequestInfoToWSSWUFromUI = {
          'GPUCount': $scope.data.upgradeData.GPUCount,
          'RPUCount': $scope.data.upgradeData.RPUCount,
          'MileagePlusNumberOfCompany': $scope.data.preSelectedAccount.mileagePlusNumberOfCompany
        };

        $scope.data.upgradeResult = {
          'SuccessItems': [],
          'FailedItems': [],
          'MileagePlusNumberOfCompany': $scope.data.preSelectedAccount.mileagePlusNumberOfCompany,
          'Msgs': []
        };

        var reqCounter = 0;
        $scope.commitTranscationSuccessItem = [];

        AmenityService.preDeductAccountBalance(payerId, $scope.data.upgradeData.TotalCost, $rootScope.currentUser.id).then(function (value) {
          //20170620 add pendingAmountObjId
          $scope.pendingAmountObjId = value.pendingAmountObjId;
          if (value.success) {

            // GPU
            if ($scope.data.upgradeData.GPUCount > 0) {
              reqCounter++;
              UpgradeService.purchaseUpgrades(
                CM_RequestInfoToWSSWUFromUI, payerId, beneficiaryId, comment, $rootScope.currentUser.id, $scope.data.upgradeData.GPUTotal
              ).then(function (value1) {

                var item = {
                  'Name': 'Global Premier Upgrade',
                  'Count': $scope.data.upgradeData.GPUCount,
                  'UnitPrice': $scope.data.upgradeData.GPUUnitCost,
                  'Total': $scope.data.upgradeData.GPUTotal,
                  'ExpiryDate': value1.ExpirationDate
                };
                reqCounter--;
                if (value1.success) {
                  $scope.data.upgradeResult.SuccessItems.push(item);
                  $scope.commitTranscationSuccessItem.push(value1);
                }
                else {
                  if (value1.messages.length > 0) {
                    item.msg = value1.messages[0];
                  }
                  $scope.data.upgradeResult.FailedItems.push(item);
                }
                $scope.checkResult(reqCounter, $scope.data.upgradeResult);
              }, function (err) {

                reqCounter--;
                $scope.data.upgradeResult.Msgs.push(err);
                $scope.checkResult(reqCounter, $scope.data.upgradeResult);
              });
            }

            // RPU
            if ($scope.data.upgradeData.RPUCount > 0) {
              reqCounter++;
              UpgradeService.purchaseUpgradesRPU(
                CM_RequestInfoToWSSWUFromUI, payerId, beneficiaryId, comment, $rootScope.currentUser.id, $scope.data.upgradeData.RPUTotal
              ).then(function (value2) {

                var item = {
                  'Name': 'Regional Premier Upgrade',
                  'Count': $scope.data.upgradeData.RPUCount,
                  'UnitPrice': $scope.data.upgradeData.RPUUnitCost,
                  'Total': $scope.data.upgradeData.RPUTotal,
                  //20170615 ExpirDate is syn with Req
                  'ExpiryDate': value2.ExpirationDate
                };
                reqCounter--;
                if (value2.success) {
                  $scope.data.upgradeResult.SuccessItems.push(item);
                  $scope.commitTranscationSuccessItem.push(value2);
                }
                else {
                  if (value2.messages.length > 0) {
                    item.msg = value2.messages[0];
                  }
                  $scope.data.upgradeResult.FailedItems.push(item);
                }
                $scope.checkResult(reqCounter, $scope.data.upgradeResult);

              }, function (err) {

                reqCounter--;
                $scope.data.upgradeResult.Msgs.push(err);
                $scope.checkResult(reqCounter, $scope.data.upgradeResult);
              });
            }
          } else {

            $rootScope.mainSpinner = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: value.messages[0]
              });
          }
        }, function (err) {

          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Sorry, an error has occurred. Please contact United for further assistance.'
            });
        });

      }
    });
    $scope.msgModal.on('hidden.bs.modal', function (e) {

      if ($scope.shouldCheckBalance) {
        $scope.shouldCheckBalance = false;
      }
      $rootScope.$broadcast('refreshSelectedAccount', {});
    });
    $scope.email = {
      sendMe: false
    };
    $scope.sendEmail = function () {

      if ($scope.email.sendMe) {
        AmenityService.sendEmail(
          $rootScope.currentUser.id,
          $scope.data.upgradeData.transactionNumber
        ).then(function () {

          $rootScope.$broadcast('showMessage',
            {
              type: 'info',
              text: 'Email sent.'
            });
        }, function (err) {

          console.debug(err);
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Failed to send email'
            });
        })
      }
    };
  }
})(); 
</script></span><span id="j_id0:j_id47">
<script type="text/javascript"> (function () {
  'use strict';

  angular.module('portalModule')
    .controller('acquisitionController', controller)
    .factory('acquisitionModel', acquisitionModel);

  function acquisitionModel() {
    var model = {
      step1: {
        custProgram: ''
      },
      step2: {
        firstName: '',
        lastName: '',
        companyName: '',
        website: '',
        email: '',
        iataNumber: '',
        address: '',
        city: '',
        state: '',
        zip: '',
        country: '',
        travelBudget: '',
        travelSpend: '',
        travelLocation: '',
        travelMarkets: '',
        comments: ''
      }
    };

    return model;
  }

  controller.$inject = ['$scope', '$rootScope', '$state', 'acquisitionModel', 'CMSService', '$window'];
  function controller($scope, $rootScope, $state, acquisitionModel, CMSService, $window) {

    CMSService.getWebToLead().then(function (value) {

      $scope.custProgramWrapper = value[0].program;
      $scope.budgetWrapper = value[0].budget;
      $scope.spendWrapper = value[0].speed;
      $scope.travelLocationWrapper = value[0].location;
      $scope.travelMarketsWrapper = value[0].market;
      $scope.countryWrapper = value[0].country;

    });


    $scope.budgetChange = function (lable) {

      $scope.data.step2.travelBudget = lable;
    };

    $scope.spendChange = function (lable) {

      $scope.data.step2.travelSpend = lable;
    };

    $scope.hideFlag = false;

    $scope.countryChange = function (lable) {

      $scope.data.step2.country = lable;
      $scope.hideFlag = true;
    };

    $scope.limitCountry = undefined;

    $scope.$watch('data.step2.country', function () {
      if ($scope.data.step2.country == '') {

        $scope.limitCountry = undefined;
      } else {

        $scope.limitCountry = 500;
      }
    });

    $scope.filterCountry = function (item) {

      if ((_.toLower(item.lable)).indexOf((_.toLower($scope.data.step2.country))) >= 0) {
        return true;
      }
      else {
        return false;
      }
    };

    $scope.isInCountryList = function () {

      var result = false;

      var countryWrapperLength = '';

      if($scope.countryWrapper != undefined){
        countryWrapperLength = $scope.countryWrapper.length;
      }else {
        countryWrapperLength = 0;
      }

      for (var i = 0; i < countryWrapperLength; i++) {

        if (_.toLower($("#country").val()) == _.toLower($scope.countryWrapper[i].lable)) {

          result = true;
        }
      }

      return result;

    };

    $scope.data = acquisitionModel;



    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {


      if (toParams.step == "step2") {


        if (!$scope.data.step1.custProgram) {

          $state.go('acquisition', {step: 'step1'});


        } else {

          $scope.step = toParams.step;


        }
      } else if (toParams.step == "step3") {


        if (localStorage.getItem('step3flag') == false) {
          if (!$scope.data.step1.custProgram || !$scope.data.step2.companyName || !$scope.data.step2.firstName || !$scope.data.step2.lastName || !$scope.data.step2.website || !$scope.data.step2.address || !$scope.data.step2.city || !$scope.data.step2.state || !$scope.data.step2.zip || !$scope.data.step2.country || !$scope.data.step2.travelBudget || !$scope.data.step2.travelSpend || !$scope.data.step2.travelLocation || !$scope.data.step2.travelMarkets) {

            $state.go('acquisition', {step: 'step2'});

          } else {


            $scope.step = toParams.step;

          }
        } else {
          $scope.step = toParams.step;
        }


      } else if (toParams.step == "step1") {

        $scope.step = toParams.step;

        localStorage.setItem('step3flag', false);

      }


    });

    $scope.next = function () {


      if (!$("[name = 'input-cust-program']:checked").attr("url")) {
        if ($("[name = 'input-cust-program']:checked").length == 0) {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Please select at least one option.'
            });
          return;
        }

        $scope.data.step1.custProgram = $("[name = 'input-cust-program']:checked").val();
        $state.go('acquisition', {step: 'step2'});
      } else {

        $window.location.href = $("[name = 'input-cust-program']:checked").attr("url");
      }

    };


    $scope.submit = function () {

      var travelLocationList = [];
      var travelMarketsList = [];

      $scope.data.step2.travelLocation = '';
      $scope.data.step2.travelMarkets = '';

      var locationList = '';
      var marketsList = '';


      for (var i = 0; i < $(".input-travelLocation:checked").length; i++) {

        locationList = locationList + $($(".input-travelLocation:checked")[i]).val() + ';';

        $scope.locationList = locationList.substring(0, locationList.length - 1);

        travelLocationList.push($($(".input-travelLocation:checked")[i]).val());
        $scope.data.step2.travelLocation = travelLocationList;

      }

      for (var i = 0; i < $(".input-travelMarkets:checked").length; i++) {

        marketsList = marketsList + $($(".input-travelMarkets:checked")[i]).val() + ';';

        $scope.marketsList = marketsList.substring(0, marketsList.length - 1);

        travelMarketsList.push($($(".input-travelMarkets:checked")[i]).val());
        $scope.data.step2.travelMarkets = travelMarketsList;

      }

      var emailRegex = /^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/;


      if (!$scope.data.step2.companyName || !$scope.data.step2.firstName || !$scope.data.step2.lastName || !$scope.data.step2.website || !$scope.data.step2.address || !$scope.data.step2.city || !$scope.data.step2.state || !$scope.data.step2.zip || !$scope.data.step2.country || !$scope.data.step2.travelBudget || !$scope.data.step2.travelSpend || !$scope.data.step2.travelLocation || !$scope.data.step2.travelMarkets) {

        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Please enter all required fields.'
          });
      }
      else {

        if (!emailRegex.test($scope.data.step2.email)) {

          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Check email format'
            });
        } else if (!$scope.isInCountryList()) {

          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Country must be in the provided list'
            });


        }
        else {

          setTimeout("document.getElementById('acquisition-form').submit()", 1000);

          localStorage.setItem('step3flag', true);


        }
      }
    }
  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('allTravelWaiverController', controller);

  controller.$inject = ['$scope', 'CMSService', '$log', '$state','$timeout', '$rootScope','$location','$anchorScroll'];
  function controller($scope, CMSService, $log, $state, $timeout, $rootScope, $location,$anchorScroll) {

    $scope.openAboveSix = false;
    $scope.currentTw = null;
    $scope.setAboveSix = null;
    $scope.showNext6 = false;

    var allArchive = {};
    var incrementIndex = 7;
    var remainingIndex = 0;

    $scope.resultId = $state.params.param;

    if($scope.resultId != null){
      $rootScope.mainSpinner = true;
    }

    CMSService.getAllActiveTravelWaiversValues().then(function (value) {
      if (!value) return;

      if (_.isArray(value) && value.length === 0) {
        return;
      }

      var data = value[0];
      $log.info('getAllActiveTravelWaiversValues ', data);

      $scope.acList = data['ActiveTW'];

    });

    CMSService.getAllArchiveTravelWaiversValues().then(function (value) {
      if (!value) return;
      allArchive = value;
      // var data = value.data;
      $log.info('getAllArchiveTravelWaiversValues ', allArchive);

      // $scope.recentSixMonth = value.splice(1, 6);
      // $scope.nextSixMonth = value.splice(6, 13);

      setTimeout(function () {
        $scope.setCurrentTw({});
      }, 0);

      $scope.allList = allArchive.slice(0, 7);

      if (value.length > 6) {
        $scope.showMore = true;
      }

      if($rootScope.activeTravelWaiverFlg == true){
        $rootScope.mainSpinner = true;
        $timeout(function(){
          $anchorScroll.yOffset = 20;
          $anchorScroll('active-travel-waivers');

          $rootScope.activeTravelWaiverFlg = false;
          $rootScope.mainSpinner = false;
        }, 2000);
      }
    });

    // $scope.setAboveSix = function () {
    //   if (!allArchive) return;
    //   $scope.showNext6 = !$scope.showNext6;
    //   if ($scope.showNext6) {
    //     $scope.allList = allArchive.slice(1, allArchive.length);
    //   } else {
    //     $scope.allList = allArchive.slice(1, 7);
    //   }
    // }
    $scope.setCurrentTw = function (obj) {
      if (obj == $scope.currentTw) {
        $scope.currentTw = {};
        return false;
      }
      $scope.currentTw = obj;

    }


    $scope.incrementItem = function () {

      var current = $scope.allList.length,
        all = allArchive.length;

      if (current + 6 > all) {
        $scope.showMore = false;
        $scope.allList = allArchive.slice(1, all);
      } else {
        incrementIndex += 6;

        $scope.allList = allArchive.slice(1, incrementIndex);
      }
    }

    $timeout(function(){
      if($scope.resultId != null){
        $scope.hideTable = false;
        $scope.allList = allArchive;
        $scope.showMore = false;
      }
    }, 2000);

    $timeout(function(){
      $rootScope.mainSpinner = false;
      if($scope.resultId != null){

        var topSpace = $("#"+$scope.resultId).offset()?$("#"+$scope.resultId).offset().top:'';

        $("body,html").animate({scrollTop:topSpace});
      }
    }, 3000);
  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('certificationController', controller);

  controller.$inject = ['$scope', '$rootScope', 'SecurityService', 'CMSService', 'formPattern', '$state'];
  function controller($scope, $rootScope, SecurityService, CMSService, formPattern, $state) {

    $scope.formPattern = formPattern;
    $scope.descriptionContent = "\u003Cp\u003EOn February 21, 2017 United launched Basic Economy fares in limited markets.  Our test has shown that customers are arriving at the airport unaware of the restrictions of the fare that they purchased.\u003C/p\u003E\n\u003Cp\u003EPlease confirm that you are advising your customers that purchase Basic Economy fares of the following minimum attributes:\u003C/p\u003E" + "\u003Col\u003E\n\u003Cli\u003E(i)&nbsp;&nbsp;&nbsp;&nbsp;No seat selection: Seats are assigned by United at check-in and families and groups traveling together are not guaranteed to sit together.\n\u003C/li\u003E\n\u003Cli\u003E(ii)&nbsp;&nbsp;&nbsp;No full-sized carry-on bag: A passenger may travel with only one personal item that fits under the seat in front of him or her. (1) \n\u003C/li\u003E\n\u003Cli\u003E\n(iii)&nbsp;&nbsp;No changes and no refunds:  Ticket changes and refunds are not allowed except as stated in the United 24-hour flexible booking policy. (2)\n\u003C/li\u003E\n\u003Cli\u003E\n(iv)&nbsp;&nbsp;&nbsp;No upgrades and certain MileagePlus® member benefits are not available: MileagePlus® members, including Premier® members, will not receive Premier qualifying credit or lifetime miles; paid, earned, complimentary or mileage upgrades; or Economy Plus® seating benefits. \n\u003C/li\u003E\n\u003C/ol\u003E" + "\u003Cbr/\u003E\n\u003Cp\u003E\nPlease confirm that your agency is also offering customers:\n\u003C/p\u003E\n\u003Col\u003E\n\u003Cli\u003E(v)&nbsp;&nbsp;&nbsp;&nbsp;A side-by-side comparison of the differences between Basic Economy and a Standard Economy fare.\u003C/li\u003E\n\u003Cli\u003E(vi)&nbsp;&nbsp;&nbsp;A receipt which includes all of these fare attributes.\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cbr/\u003E\n\u003Cp\u003EThank you.\u003C/p\u003E";
    $scope.descriptionContentBottomPart1 = "\u003Cp\u003EFor more details, see below:\u003C/p\u003E\n\u003Cp\u003E\nIn response to this customer feedback, we are implementing steps to ensure a consistent communication of Basic Economy fares.  Below we set forth specific display requirements we expect you to meet.  Please certify your commitment to cooperate by March 31, 2017 in order to continue selling United Basic Economy fare tickets and please make sure that any third parties upon which you rely are as thoughtful and exacting about these disclosure issues as United knows you will be.  \u003C/p\u003E\n\u003Cp\u003E\nAs a reminder, Basic Economy restrictions include:\n\u003C/p\u003E" + "\u003Col\u003E\n\u003Cli\u003E(i)&nbsp;&nbsp;&nbsp;&nbsp;No seat selection: Seats are automatically assigned at check-in and families and groups traveling together are not guaranteed to sit together;\u003C/li\u003E\n\u003Cli\u003E(ii)&nbsp;&nbsp;&nbsp;No full-sized carry-on bag: A passenger may travel with only one personal item that fits under the seat in front of him or her.  Only limited exceptions apply for MileagePlus® Premier® members, the primary card member of a qualifying MileagePlus credit card, or Star Alliance™ Gold members.  If an exception does not apply, passengers who bring a full-sized carry-on to the gate will have that luggage checked and will be subject to the applicable checked baggage fee plus a $25 USD gate handling charge;\u003C/li\u003E\n\u003Cli\u003E(iii)&nbsp;&nbsp;Nonrefundable and no changes:  Ticket changes and refunds are not allowed except as stated in the United 24-hour flexible booking policy.  This includes advanced changes and same-day changes, even for MileagePlus® Premier® members;\u003C/li\u003E\n\u003C/ol\u003E" + "\u003Col\u003E \n\u003Cli\u003E(iv)&nbsp;&nbsp;&nbsp;No upgrades and certain MileagePlus® member benefits are not available: MileagePlus® members, including Premier® members, will not receive Premier qualifying credit or lifetime miles; paid, earned, complimentary or mileage upgrades; or Economy Plus® seating benefits.\u003C/li\u003E \n\u003C/ol\u003E \n\u003Cbr/\u003E \n\u003Cp\u003EA more detailed description of the Basic Economy fare remains available at united.com/basiceconomy, as well as in the Basic Economy Reference Guide that United previously distributed and which is available at https://united.cantoflight.com/s/T0QB0. For additional information on Basic Economy, please visit United Jetstream at jetstream.united.com, United’s new business portal designed exclusively for our corporate customers and travel agencies.\u003C/p\u003E" + "\u003Cp\u003E\nWe are asking all travel agencies to ensure that all Basic Economy bookings tools and paths and customer communications have clear and accurate information regarding our Basic Economy attributes as required by United’s Booking and Ticketing Policy.  We appreciate your assistance in this regard.  \n\u003C/p\u003E\n\u003Cp\u003E\nDisclose Basic Economy Fare Attributes.  Specifically, all of the above attributes must be expressly communicated to the passenger during the sale of United’s Basic Economy fare.  \n\u003C/p\u003E" + "\u003Cp\u003EShow The Customer A Side-by-Side Comparison.  Additionally, a side-by-side comparison of the Basic Economy fare and our standard Economy fare must be communicated and/or displayed when purchasing online and/or over the phone or in person, as it is through this contrast that the Basic Economy restrictions are most clearly communicated.  An example of United’s side-by-side comparison is below for your review.  Customer feedback indicates that those purchasing Basic Economy where the side-by-side comparison is available better understand the fare restrictions.  \u003C/p\u003E";
    $scope.descriptionContentBottomPart2 = "\u003Cp\u003EInclude A Statement Of Basic Economy Fare Attributes In Emails and Receipts.  In addition, all confirmation emails or receipts must include the above Basic Economy fare attributes.  \u003C/p\u003E\n\u003Cp\u003EWe know you share our desire to accurately communicate the attributes of the Basic Economy fare and its restrictions.  To that end, as a condition of offering United Basic Economy for sale, we are requiring travel agencies, on behalf of themselves and all travel agencies within their agency network, to certify that they (including all agencies within their network) are complying with these display and disclosure requirements, by signing the below certification by March 31, 2017.  United reserves its rights under all applicable law. \u003C/p\u003E" + "\u003Cbr\u003E\n\u003Col\u003E\n\u003Cli\u003E(1)&nbsp;&nbsp;&nbsp;&nbsp;Only limited exceptions apply for MileagePlus® Premier® members, the primary card member of a qualifying MileagePlus credit card, or Star Alliance™ Gold members.  If an exception does not apply, passengers who bring a full-sized carry-on to the gate will have that luggage checked and will be subject to the applicable checked baggage fee plus a $25 USD gate handling charge.\u003C/li\u003E\n\u003Cli\u003E(2)&nbsp;&nbsp;&nbsp;&nbsp;This includes advanced changes and same-day changes, even for MileagePlus® Premier® members\u003C/li\u003E\n\u003C/ol\u003E" + "\u003Cbr/\u003E\n\u003Cp\u003ETerms & Conditions:\n\u003Cbr/\u003E\n\*For the most up-to-date itinerary information, please visit united.com.\n\u003C/p\u003E\n\u003Col\u003E\n\u003Cli\u003Ei.&nbsp;&nbsp;&nbsp;&nbsp;Seats are assigned prior to boarding, and customers traveling together, including families, will not be able to sit together. You will also not be eligible to purchase Economy Plus seating or premium cabin upgrades, or receive Economy Plus subscription benefits. With standard Economy, customers traveling together can choose seats together if open seats are available.\u003C/li\u003E\n\u003C/ol\u003E" + "\u003Col\u003E\n\u003Cli\u003Eii.&nbsp;&nbsp;&nbsp;You’re allowed a small personal item, such as a shoulder bag, purse or laptop bag or other small item, 9 inches x 10 inches x 17 inches (22 cm x 25 cm x 43 cm) or less. Full-sized carry-on bags are not allowed except for MileagePlus Premier members, primary cardmembers of a qualifying MileagePlus credit card, and Star AllianceTM Gold members. Must be a primary cardmember of a qualifying MileagePlus credit card at time of check-in. Mobility aids and other assistive devices are also permitted. If you’re traveling on a Basic Economy fare and bring a full-sized carry-on bag to the gate, you’ll be subject to the applicable checked bag fee plus a $25 gate handling service charge. Full-sized carry-on bags are still allowed for MileagePlus® Premier members, primary cardmembers of a qualifying MileagePlus credit card and Star AllianceTM Gold members. Payment by credit card only.\u003C/li\u003E\n\u003C/ol\u003E" + "\u003Col\u003E\n\u003Cli\u003Eiii.&nbsp;&nbsp;Fares are nonrefundable. Ticket changes are not allowed, even for Premier members. This includes advance changes and same-day changes on the day of travel.\u003C/li\u003E\n\u003Cli\u003Eiv.&nbsp;&nbsp;&nbsp;MileagePlus members will not earn Premier qualifying dollars, Premier qualifying miles, Premier qualifying segments or lifetime miles, or earn toward the four-segment minimum. They will still earn award miles based on the fare and their MileagePlus status.\u003C/li\u003E\n\u003C/ol\u003E";

    var contactId = '';
    if ($rootScope.IsImpersonation) {
      contactId = $rootScope.impersonationContactId;
    }

    SecurityService.getUserInfoExtension(contactId).then(function (value) {

      $scope.userPhone = value[0] ? value[0].currentUser.Phone : '';
      $scope.certification = {
        phone: $rootScope.currentUser ? $scope.userPhone : '',
        arcNumber: $rootScope.currentUser ? $rootScope.currentUser.accArcNumber : '',
        email: $rootScope.currentUser ? $rootScope.currentUser.email : '',
        name: $rootScope.currentUser ? $rootScope.currentUser.name : ''
      };
    });

    $scope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {

        $scope.step = toParams.step;

    });

    $scope.submit = function (obj) {

      $rootScope.mainSpinner = true;
      CMSService.insertCertification(obj).then(function (CertificationResult) {

        if (CertificationResult.success == true) {
          $state.go('certification-form', {step: 'step2'});
          $rootScope.mainSpinner = false;
        } else {
          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: CertificationResult.message
            });
        }
      })
    }
  };

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('globalSearchController', controller);

  controller.$inject = ['$scope','$rootScope','$state','$stateParams', 'CMSService', '$location'];
  function controller($scope, $rootScope, $state,$stateParams, CMSService, $location) {

    $scope.showFlg = false;

    $scope.searchKeyword = $state.params.param;

    if($scope.searchKeyword != null){
      if($scope.searchKeyword.length < 3){

        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Search keyword should be at least 3 characters long.'
          });
      }else {

        globalSearch($scope.searchKeyword);
      }
    }

    function globalSearch (keyWord) {

      $rootScope.mainSpinner = true;

      CMSService.search(keyWord).then(function (value) {

        if(!value.errorMessage){

          var pageNum = value.pages;

          $scope.resultNum = value.records;

          $scope.findingMsg = value.records + ' '+ 'matching results found';

          $scope.resultWrapper = value.results[1];

          $(".pagination").createPage({
            pageCount:pageNum,
            current:1,
            backFn:function(p){
              $scope.resultWrapper = value.results[p];
              $scope.$apply();
            }
          });
        }else {

          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.errorMessage
            });
        }

        $rootScope.mainSpinner = false;
        $scope.showFlg = true;
      })
    }

    $scope.validateUrl = function (e) {

      var splitUrl = e.result.url.substring(e.result.url.indexOf('#')+2,e.result.url.length);

      if(splitUrl == 'all-travel-waiver'){

        $state.go('all-travel-waiver', {param : e.result.recordId});

      }else if(e.result.url.indexOf('#') > 0 && splitUrl.indexOf('/') > 0){

        if(splitUrl.split('/')[0] == 'news-detail'){

          $state.go(splitUrl.split('/')[0], {id : splitUrl.split('/')[1]});

        }else if(splitUrl.split('/')[0] == 'sub-link'){

          $state.go(splitUrl.split('/')[0], {linkId : splitUrl.split('/')[1]});

        }else if(splitUrl.split('/')[0] == 'marketing-detail'){

          $state.go(splitUrl.split('/')[0], {id : splitUrl.split('/')[1]});

        }

      }else if(e.result.url.indexOf('#') > 0 && splitUrl.indexOf('/') < 0){
        $state.go(splitUrl);
      }else {
        window.open(e.result.url);
      }
    }

    $scope.document_onkeypress = function(e)
    {
      if(e.keyCode == 13 && $scope.searchKeyword != null)
      {
        if($scope.searchKeyword.length < 3){

          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Search keyword should be at least 3 characters long.'
            });
        }else {

          globalSearch($scope.searchKeyword);
        }
      }
    }

  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('loginController', controller)
    .directive('adjustTop', ['$window', function ($window) {

      var ddo = {
        restrict: 'AC',
        link: function (scope, element, attrs) {

          $(window).on('resize', function () {
            adjustTop();
          });

          function adjustTop() {

            var box = $('#login.adjust-top');
            var headerHeight = $('header').height();
            var footerHeight = $('#footer').height() + 80; // 80 padding

            box.css("margin-top", Math.max(0, (window.innerHeight - headerHeight - footerHeight - box.height()) / 2));
          }
        }
      };
      return ddo;
    }]);

  function controller() {
  }

})();
(function () {
  "use strict";

  angular.module('portalModule')
    .component('loginComp', {
      templateUrl: 'Sip_LoginCompTemplate',
      controller: controller,
      bindings: {
        isPopup: '='
      }
    });

  controller.$inject = ['$window', '$rootScope', 'SecurityService', '$state'];
  function controller($window, $rootScope, SecurityService, $state) {

    var $ctrl = this;
    $ctrl.showError = false;
    $ctrl.errorMessages = '';
    $ctrl.username = '';
    $ctrl.pwd = '';
    $ctrl.data = {};
    $ctrl.nubbin = 'bottom';

    $(window).on('resize', function (e) {

      $ctrl.adjustNubbin();
    });

    this.$onInit = function () {

      $ctrl.adjustNubbin();
    };
    $ctrl.adjustNubbin = function () {

      if ($ctrl.isPopup) {
        if ($rootScope.bootstrapGrid == 'xs' || $rootScope.bootstrapGrid == 'sm') {
          $ctrl.nubbin = 'left';
        }
        else {
          $ctrl.nubbin = 'right';
        }
      }
    };
    $ctrl.hideTooltip = function () {

      $ctrl.showError = false;
    };
    $ctrl.gotoReg = function () {

      $state.go('registration', {}, {reload: true});
    };
    $ctrl.submit = function () {

      if ($ctrl.username.length > 0 && $ctrl.pwd.length > 0) {

        SecurityService.authenticate(
          $ctrl.username,
          $ctrl.pwd
        ).then(function (value) {

          if (value.ErrorMessage) {
            $ctrl.showError = true;
            $ctrl.errorMessages = value.ErrorMessage;
          }
          else {
            $ctrl.showError = false;
            $ctrl.data = value;

            if ($ctrl.data.LoginUrl) {
              $ctrl.data.LoginUrl = $ctrl.data.LoginUrl.replace('amp;', '').replace('amp;', '').replace('amp;', '').replace('amp;', '').replace('amp;', '').replace('amp;', '').replace('amp;', '').replace('amp;', '');
              $window.open($ctrl.data.LoginUrl, '_self');
            }
            else {
              $ctrl.showError = true;
            }
          }
        });
      }
    }
  }
})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('loginStopoverController', controller);

  controller.$inject = ['$rootScope', '$scope', '$state',
    'CMSService', 'session', 'stateFactory'];
  function controller($rootScope, $scope, $state,
                      CMSService, session, stateFactory) {

    $scope.agreementContent = '';
    $scope.agreementTitle = '';

    $scope.showAgreement = false;
    $scope.isAgreed = false;
    $scope.showType = ''; // tc / ac

    CMSService.getTermConditionContentManagementValues().then(function (value) {

      var tc;
      var ac;
      var user = value[0].UserList[0];
      var isTcAgreed = user.Agree__c;
      var isAcAgreed = user.SIP_Amenity_Consent__c;

      if (value[0].UserAgreementWrapper[0].Name == 'Amenity Consent') {
        ac = value[0].UserAgreementWrapper[0];
        tc = value[0].UserAgreementWrapper[1];
      }
      else {
        tc = value[0].UserAgreementWrapper[0];
        ac = value[0].UserAgreementWrapper[1];
      }

      if ($rootScope.isAmenityConsent &&
        !$rootScope.currentUser.isInternalUser) {

        if (isAcAgreed) {
          $scope.goHome();
        }
        else {
          $scope.showType = 'ac';
          $scope.agreementTitle = ac.Name;
          $scope.agreementContent = ac.Content__c;
          $scope.showAgreement = true;
        }
      }
      else {
        if (isTcAgreed) {
          $scope.goHome();
        }
        else {
          $scope.showType = 'tc';
          $scope.agreementTitle = tc.Name;
          $scope.agreementContent = tc.Content__c;
          $scope.showAgreement = true;
        }
      }
    });
    $scope.goHome = function (isSkipPasswordExpiryCheck) {

      stateFactory.checkSession(function () {

        if (!isSkipPasswordExpiryCheck) {
          if ($rootScope.currentUser.isPasswordExpireSoon) {
            $rootScope.showMessagePanel = true;
            $rootScope.messagePanelType = 'alert';
            $rootScope.messagePanelContent = 'Your password will be expired in {0} days.\u003Ca href=\"Sip_EditPassword?o=1\"\u003EUpdate now\u003C/a\u003E';
            $rootScope.messagePanelContent = $rootScope.messagePanelContent.replace('{0}', $rootScope.currentUser.passwordExpireSoonDays);
          }
        }
        $state.go('secure-landing-home', {feature: 'init'});
      });
    };
    $scope.agree = function () {

      switch ($scope.showType) {
        case 'ac':
          CMSService.confirmAmenityConsent().then(function (value) {

            session.clear();
            $scope.goHome(true);
          });
          break;
        case 'tc':
          CMSService.UpdateUserAgreeCheckbox(
            $scope.isAgreed
          ).then(function (value) {

            session.clear();
            $scope.goHome();
          });
          break;
      }
    };
  }
})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('marketingDetailController', controller);

  controller.$inject = ['$scope', '$stateParams', 'CMSService', 'util'];
  function controller($scope, $stateParams, CMSService, util) {

    $scope.dataInfo = {};
    CMSService.getUnitedMarketingOrPromotionTitleAndContent($stateParams.id).then(function (value) {

      if (value && value[0]) {
        $scope.dataInfo.id = value[0].MarketingOrPromotion[0].Id;
        $scope.dataInfo.imageURL = value[0].ImageURL;
        $scope.dataInfo.title = value[0].MarketingOrPromotion[0].Title__c;
        $scope.dataInfo.content = util.decodedHtml(value[0].MarketingOrPromotion[0].Content__c);
        $scope.dataInfo.name = value[0].MarketingOrPromotion[0].Name;
      }
    });
  }

})();
(function () {
  'use strict'
  angular.module('portalModule')
    .controller('massResultController', controller);

  controller.$inject = ['$scope', '$rootScope', '$state', '$stateParams', 'CMSService', 'dataURLtoBlobService'];
  function controller($scope, $rootScope, $state, $stateParams, CMSService, dataURLtoBlobService) {
    $scope.pageTitle = 'Mass upload completed';
    $scope.massError = [];
    $scope.massSuccess = [];
    $('#alert-modal-massupload').modal('hide');
    if (!$stateParams.errorObj) {
      // !!! uncomment before deploy
      // $state.go('user-management');
    }
    if (!$stateParams.arcNumber && !($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp)) {
      //in agent user we need arcNumber every time we uploadMass
      $state.go('user-management.home');
      console.error('MassUpload arcNumber missing!!!');
    }
    $scope.sourceObj = $stateParams.errorObj;
    // console.log($scope.sourceObj);


    $scope.massSuccess = $scope.sourceObj && $scope.sourceObj.filter(function (value) {
        return value.uploadFlag == true;
      });
    $scope.massError = $scope.sourceObj && $scope.sourceObj.filter(function (value) {
        return value.uploadFlag == false;
      });

    //MassUpload Common Function copy from 'usermanagement Controller'
    $scope.massArcNumber = '';
    $scope.massUploadBtnText = 'Upload';
    $scope.previewFileName = '';
    $scope.csvBlob = '';
    $scope.showMassUpload = function () {
      if ($stateParams.arcNumber) {
        $scope.massArcNumber = ' for ' + $scope.userDetails.userProfileInfo.arcNumber
      } else {
        $scope.massArcNumber = '';
      }

      $scope.massUploadBtnText = 'Upload';
      $('#massFile').next().val('');
      $scope.csvBlob = null;

      $('#alert-modal-massupload').modal();
    };
    $scope.uploadMass = function () {
      // https://unitedairlines--phase2dev--c.cs26.visual.force.com/resource/Sip_MassUploadUser_Template


      if (!$scope.csvBlob) {
        document.querySelector('#massFile').click()
        return
      }

      $rootScope.mainSpinner = true;
      CMSService.massUploadUser($scope.csvBlob.imgBlob, $stateParams.arcNumber || '').then(function (value) {

        $rootScope.mainSpinner = false;
        $scope.massUploadBtnText = 'Upload';
        $scope.previewFileName = '';
        $scope.csvBlob = '';

        if (value.state == "Success") {

          var errorMsg = value.uploadUserResults;
          $state.go('user-management-mass-result', {
            errorObj: errorMsg,
            arcNumber: $stateParams.arcNumber
          }, {reload: true});
        } else {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.errorMessages[0]
            });
        }

      })
    };
    $scope.previewCsv = function (elem) {

      if (!elem.files) {
        return false;
      }
      var reader = new FileReader();
      var uploadFile = elem.files[0];
      $scope.previewFileName = uploadFile.name;


      reader.readAsDataURL(uploadFile);

      $rootScope.mainSpinner = true;
      reader.onload = function (evt) {
        $rootScope.mainSpinner = false;
        // $scope.prevUrl = evt.target.result;
        var blob = dataURLtoBlobService(evt.target.result);
        var type = blob.type;
        var imgBlob = evt.target.result.split(',')[1] ? evt.target.result.split(',')[1] : '';

        $scope.csvBlob = {
          imgBlob: imgBlob,
          type: type
        };

        // $scope.massUploadBtnText = "Ok";

        $scope.$apply();
      }


    };
    $scope.clickLookUp = function () {
      document.querySelector('#massFile').click()
    };


  }
})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('myIncentivesController', controller);

  controller.$inject = ['$scope', '$rootScope', 'CMSService'];
  function controller($scope, $rootScope, CMSService) {

    CMSService.getIncentiveReports($rootScope.currentUser.id).then(function (value) {
      $scope.reportWrapper = value;
    })

  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('myProfileController', controller);

  controller.$inject = ['$scope', '$rootScope','SecurityService','$state','CMSService'];
  function controller($scope, $rootScope,SecurityService,$state,CMSService) {

    $rootScope.mainSpinner = true;
    var obj = 'user';
    var recordId = $rootScope.currentUser.id;

    $scope.userObj = {
      userId: '',
      firstName:'',
      lastName:'',
      username:'',
      title: '',
      phone: '',
      cellPhone: '',
      email: '',
      alternateEmail: '',
      maillingStreet: '',
      maillingCity: '',
      maillingState: '',
      maillingCountry: '',
      maillingPostalCode: '',
      primaryAirportId: ''


    };

    CMSService.getUserDetails(obj,recordId).then(function (value) {
      if(!(angular.isUndefined(value.value))){
        value = JSON.parse(value.value);
      }
      if (value && value.state == "Success") {

        $scope.userDetails = value.userDetails;

        $("#photo").css("background-image", "url(" + $scope.userDetails.userProfileInfo.photoUrl + ")");
      }

      $rootScope.mainSpinner = false;
    });

    CMSService.getAirports().then(function (value) {
      if (value && value.state == "Success") {
        $scope.airportsList = value.airports;
      } else {
        console.error('getAirports failed', value);
      }
    });


    CMSService.getCountries().then(function (value) {
      $scope.countriesList = value.countries;
      $scope.countryName = value.countries[0];

    });

    $scope.userProSubmit = function (proSubmitParam,proImgParam) {

      $rootScope.mainSpinner = true;

      $scope.userObj.userId = $scope.userDetails.userProfileInfo.userId;
      $scope.userObj.firstName = $scope.userDetails.userProfileInfo.firstName;
      $scope.userObj.lastName = $scope.userDetails.userProfileInfo.lastName;
      $scope.userObj.username = $scope.userDetails.userProfileInfo.username;
      $scope.userObj.title = $scope.userDetails.userProfileInfo.title;
      $scope.userObj.phone = $scope.userDetails.userProfileInfo.phone;
      $scope.userObj.cellPhone = $scope.userDetails.userProfileInfo.cellPhone;
      $scope.userObj.email = $scope.userDetails.userProfileInfo.email;
      $scope.userObj.alternateEmail = $scope.userDetails.userProfileInfo.alternateEmail;
      $scope.userObj.maillingStreet = $scope.userDetails.userProfileInfo.maillingStreet;
      $scope.userObj.maillingCity = $scope.userDetails.userProfileInfo.maillingCity;
      $scope.userObj.maillingState = $scope.userDetails.userProfileInfo.maillingState;
      $scope.userObj.maillingCountry = $scope.userDetails.userProfileInfo.maillingCountry;
      $scope.userObj.maillingPostalCode = $scope.userDetails.userProfileInfo.maillingPostalCode;

      if($scope.userDetails.userProfileInfo.primaryAirport == ''){
        $scope.userObj.primaryAirportId = '';
      }else {
        $scope.userObj.primaryAirportId = $scope.userDetails.userProfileInfo.primaryAirportId;
      }

      if($rootScope.fileSize > 950000){

        $rootScope.mainSpinner = false;
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'The size of the photo should not be larger than 1MB.'
          });

        return false;
      }

      CMSService.updateUserPhoto($rootScope.imgType, $rootScope.imgBlob).then(function (value) {

        if(value == 'Success'){

          CMSService.updateUserProfile(obj, $scope.userObj)
            .then(function (value) {
              if(value.state == 'Success'){

                $rootScope.mainSpinner = false;
                window.location.reload();
              }else {

                $rootScope.mainSpinner = false;
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: value.errorMessages[0]
                  });
              }

            })
        }else {

          $rootScope.mainSpinner = false;
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Failed to update the photo.'
            });
        }
      });

    }
  }

})();
(function () {
  "use strict";

  angular.module('portalModule')
    .component('myProfileComponent', {
      templateUrl: 'Sip_MyProfileCompTemplate',
      controller: controller,
      bindings: {
        data: '=',
        btnShow: '=',
        airportsList: '=',
        countriesList: '=',
        submit: '&',
        editFlg: '=',
        imgBlob: '=',
        refresh: '&'
      }
    });

  controller.$inject = ['$state', 'CMSService', '$rootScope', '$scope', 'formPattern'];
  function controller($state, CMSService, $rootScope, $scope, formPattern) {

    var CTRL = this;

    /*chris add*/
    var fileSize = '';
    var imgBlob = '';
    var type = '';

    $rootScope.imgBlob = '';
    $rootScope.imgType = '';
    $rootScope.fileSize = '';

    if($state.current.name == 'user-management'){
      CTRL.requiredFlg = true;
    }else {
      CTRL.requiredFlg = false;
    }

    function dataURLtoBlob(dataurl) {
      var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
        bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
      while (n--) {
        u8arr[n] = bstr.charCodeAt(n);
      }
      return new Blob([u8arr], {type: mime});
    }


    function preview(file, callback) {

      $("#head-img").remove();

      if (file.files && file.files[0]) {

        fileSize = file.files[0].size;

        var reader = new FileReader();

        reader.onload = function (evt) {

          $("#photo").append('<img id="head-img" src="' + evt.target.result + '" alt="Head image" />');

          localStorage.setItem('currentDataUrl', evt.target.result);

          var blob = dataURLtoBlob(evt.target.result);
          type = blob.type;
          imgBlob = evt.target.result.split(',')[1] ? evt.target.result.split(',')[1] : '';

          if (callback)
            callback();
        };

        reader.readAsDataURL(file.files[0]);
      }
      else {

        var reader = new FileReader();

        reader.onload = function () {

          var existedUrl = localStorage.getItem('currentDataUrl');
          $("#photo").append('<img id="head-img" src="' + existedUrl + '" alt="Head image"/>');

          imgBlob = localStorage.getItem('currentDataUrl').split(',')[1] ? localStorage.getItem('currentDataUrl').split(',')[1] : '';
          if (callback)
            callback();
        };
        reader.readAsDataURL(dataURLtoBlob(localStorage.getItem('currentDataUrl')));
      }
    }

    function creatMaskLayer(effectItem) {

      var divItem = {};

      divItem = document.createElement("div");
      divItem.className = "mask-style";
      divItem.style.lineHeight = effectItem.offsetHeight + "px";
      divItem.style.width = effectItem.offsetWidth;
      divItem.style.height = effectItem.offsetHeight;
      divItem.style.top = effectItem.offsetTop;
      divItem.style.left = effectItem.offsetLeft;
      return divItem;
    }

    function setMask() {
      var effectItem = document.getElementById("photo");
      var existMaskItem = findMaskItem(effectItem);
      if (existMaskItem) {
        return;
      }

      effectItem.appendChild(creatMaskLayer(effectItem));
    }

    function removeMask() {
      var effectItem = document.getElementById("photo");
      var maskItem = findMaskItem(effectItem);
      if (maskItem) {
        effectItem.removeChild(maskItem);
      }
    }

    function findMaskItem(item) {
      var children = item.children;
      for (var i = 0; i < children.length; i++) {
        if ("mask-style" == (children[i].className)) {
          return children[i];
        }
      }
    }

    $(document).on('change', '#_f', function () {

      preview(this, function () {
        $("#photo").css("background-image", "");

        $rootScope.imgBlob = imgBlob;
        $rootScope.imgType = type;
        $rootScope.fileSize = fileSize;
      });
    });
    /*chris end*/

    CTRL.formPattern = formPattern;
    CTRL.addressLabel = (function () {
      var str = "Same As Agency\'s Address";
      if ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp) {
        str = "Same as Company\'s Address";
      }
      return str;
    })();

    CTRL.editFlg = false;
    CTRL.clickApprove = function () {
      $("#alert-modal-approve").modal();
    };

    // CTRL.mailEditable=false;

    CTRL.cancelEdit = function () {
      CTRL.editFlg = !CTRL.editFlg;
      CTRL.data = CTRL.backupData;
      imgBlob = '';
      type = '';
      fileSize = '';
      removeMask();
      $("#photo").css("background-image", "url(" + CTRL.data.userProfileInfo.photoUrl + ")");
      $("#head-img").remove();
      $("#_f").val("");
      $rootScope.imgBlob = imgBlob;
      $rootScope.imgType = type;
      $rootScope.fileSize = fileSize;

      //quick fix : better to remove in phase 3
      if (!CTRL.data.userProfileInfo.alternateEmail) {
        CTRL.data.userProfileInfo.alternateEmail = null
      }
      if (!CTRL.data.userProfileInfo.cellPhone) {
        CTRL.data.userProfileInfo.cellPhone = null
      }
    };
    CTRL.clickEdit = function () {
      //set a backup
      CTRL.backupData = angular.copy(CTRL.data);
      CTRL.editFlg = !CTRL.editFlg;
      if(CTRL.requiredFlg == false){
        setMask();
      }
    };
    CTRL.clickReject = function () {
      $("#alert-modal-reject").modal();
    };

    //deprecated
    // CTRL.validateUsername = isValidation;
    // CTRL.isValidation = isValidation;


    CTRL.setCountry = function (value) {
      CTRL.data.userProfileInfo.maillingCountry = value;
    }

    CTRL.confirmApprove = function () {

      $('#alert-modal-approve').modal('hide');

      setTimeout(function () {
        $state.go('user-management-create.one', {needBinding: true});
      }, 1000);

    };


    // CTRL.confirmReject = function () {
    //   CTRL.refresh();
    // }
    CTRL.confirmReject = function () {
      $('#alert-modal-reject').modal('hide');
      var registrationId = CTRL.data.userProfileInfo.registrationId;
      CMSService.rejectUser(registrationId).then(function (value) {
        if (value.state == 'Success') {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'User has been rejected.'
            });
          //todo...refresh userlist and userdetail
          CTRL.refresh();

        } else {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.errorMessages[0]
            });

        }
      })
    }

    $(document).on('click', '#input-save-as-agency', function () {


      $rootScope.mainSpinner = true;
      var arcNumber = CTRL.data.userProfileInfo.arcNumber;

      var billing = {};

      if ($("#input-save-as-agency").is(':checked')) {
        CMSService.getAgencyAddress(arcNumber).then(function (value) {
          billing = value.agencyAddress;
          CTRL.data.userProfileInfo.maillingCity = billing.billingCity;
          CTRL.data.userProfileInfo.maillingCountry = billing.billingCountry;
          CTRL.data.userProfileInfo.maillingPostalCode = billing.billingPostalCode;
          CTRL.data.userProfileInfo.maillingState = billing.billingState;
          CTRL.data.userProfileInfo.maillingStreet = billing.billingStreet;
          $rootScope.mainSpinner = false;
        });

        // console.log('userObj', CTRL.data);
      } else {
        // console.log('no');
        // console.log('CTRL.backupData.agencyAddress', CTRL.backupData);
        /*          CTRL.data.userProfileInfo.maillingCity = CTRL.backupData.userProfileInfo.maillingCity;
         CTRL.data.userProfileInfo.maillingCountry = CTRL.backupData.userProfileInfo.maillingCountry;
         CTRL.data.userProfileInfo.maillingPostalCode = CTRL.backupData.userProfileInfo.maillingPostalCode;
         CTRL.data.userProfileInfo.maillingState = CTRL.backupData.userProfileInfo.maillingState;
         CTRL.data.userProfileInfo.maillingStreet = CTRL.backupData.userProfileInfo.maillingStreet;*/
        // console.log('userObj', CTRL.data);
        $rootScope.mainSpinner = false;
      }
    })

    // this.$onChanges=function (changeObj) {
    // //   console.log(changeObj);
    // }

    CTRL.airportSuggestList = [];
    CTRL.setAirports = function (event) {
      var el = event.target,
        val = el.value,
        keyCode = event.keyCode;

      // uncomment if it is needed
      if (val.length < 1) return false;
      CTRL.airportSuggestList = (CTRL.queryAirport(val, CTRL.airportsList)).slice(0, 100);

    };
    CTRL.queryAirport = function (kw, list) {
      //  var reg = new RegExp(kw.toLowerCase());
      return list.filter(function (value) {
        //return reg.test(value['name'].toLowerCase());
        return value.name.toLowerCase().indexOf(kw.toLowerCase()) != -1;
      })
    };
    CTRL.showDropDown = function (event) {
      $(event.target).siblings('ul').dropdown('toggle')
    }
  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('mySalesContactsController', controller);

  controller.$inject = ['$scope', '$rootScope', 'CMSService'];
  function controller($scope, $rootScope, CMSService) {

    CMSService.getSalesContacts($rootScope.currentUser.id).then(function (value) {

      if(value.unitedContacts && value.unitedContacts.SIP_Content__c){
        $scope.unitedContactsWrapper = value.unitedContacts.SIP_Content__c;
      }

      if(value.salesManager){
        $scope.salesManagerWrapper = value.salesManager;
        $scope.salesManagerPhoto = value.salesManager.SmallPhotoUrl;
        $scope.salesManagerName = value.salesManager.Name;
        $scope.salesManagerTitle = value.salesManager.Title;
        $scope.salesManagerEmail = value.salesManager.Email;
        $scope.salesManagerPhone = value.salesManager.Phone;
        $scope.salesManagerMobile = value.salesManager.MobilePhone;
      }

      if (value.salesServiceManager) {
        $scope.salesServiceManagerWrapper = value.salesServiceManager;
        $scope.salesServiceManagerPhoto = value.salesServiceManager.SmallPhotoUrl;
        $scope.salesServiceManagerName = value.salesServiceManager.Name;
        $scope.salesServiceManagerTitle = value.salesServiceManager.Title;
        $scope.salesServiceManagerEmail = value.salesServiceManager.Email;
        $scope.salesServiceManagerPhone = value.salesServiceManager.Phone;
        $scope.salesServiceManagerMobile = value.salesServiceManager.MobilePhone;
      }

      if (value.admins) {
        $scope.adminWrapper = value.admins;
      }

    })

  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('newsDetailController', controller);

  controller.$inject = ['$scope', '$stateParams', 'CMSService', 'util'];
  function controller($scope, $stateParams, CMSService, util) {

    $scope.dataInfo = {};
    CMSService.getKnowMoreNewsContent($stateParams.id).then(function (value) {

      if (value && value[0]) {
        $scope.dataInfo.imageURL = value[0].news.ContentImageURL__c;
        $scope.dataInfo.title = value[0].news.Title__c;
        $scope.dataInfo.publishDate = value[0].news.Published_Date_Format__c;
        $scope.dataInfo.nextNewsId = value[0].nextNewsId;
        $scope.dataInfo.previousNewsId = value[0].previousNewsId;
        $scope.dataInfo.isFirst = value[0].isFirst;
        $scope.dataInfo.isLast = value[0].isLast;
        $scope.dataInfo.content = util.decodedHtml(value[0].news.Content__c);
      }
    });
  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('newsListController', controller);

  controller.$inject = ['$scope', '$state', 'CMSService'];
  function controller($scope, $state, CMSService) {

    $scope.dataInfo = {
      newList: [],
      currentPage: 0,
      isLastPage: false
    };

    $scope.loadMore = function () {

      $scope.dataInfo.currentPage += 1;
      CMSService.getViewAllNewsContent($scope.dataInfo.currentPage).then(function (value) {

        if (value && value[0]) {
          $scope.dataInfo.currentPage = value[0].currentPage;
          $scope.dataInfo.isLastPage = value[0].isLastPage;
          for (var i = 0; i < value[0].newsList.length; i++) {
            var sourceNews = value[0].newsList[i];
            var newsWrapper = {};
            newsWrapper.news = {};
            newsWrapper.news.imgURL = sourceNews.news.ContentImageURL__c;
            newsWrapper.news.Published_Date_Format__c = sourceNews.news.Published_Date_Format__c;
            newsWrapper.news.Header__c = sourceNews.news.Homepage_Header__c;
            newsWrapper.news.Title__c = sourceNews.news.Title__c;
            newsWrapper.news.id = sourceNews.news.Id;
            $scope.dataInfo.newList.push(newsWrapper);
          }
        }
      });
    };

    $scope.jumpToDetail = function (id) {

      var id = {'id': id};
      $state.go('news-detail', id);
    };

    $scope.loadMore();
  }

})();
(function () {
  'use strict';
  angular.module('portalModule')
    .controller('publicLandingController', controller);

  controller.$inject = ['$scope'];
  function controller($scope) {

  }
})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('registrationController', registrationController);


  registrationController.$inject = ['$scope', '$rootScope', '$state', 'CMSService', 'formPattern'];
  function registrationController($scope, $rootScope, $state, CMSService, formPattern) {
    $scope.step = 1;
    $scope.forceInsert = false;
    $scope.userInfo = {}
    $scope.showUserFlg = 'Agency';
    $scope.iataOrCorpText = 'Please use 8 digit IATA #';
    $scope.formPattern = formPattern;

    $scope.setCountry = function (val) {
      $scope.userInfo.Country = val;
    };
    $scope.userFLgChanged = function (arr) {
      $scope.iataOrCorp = '';
      if (arr == 'Agency') {
        $scope.userInfo.UCSNumber = '';
        $scope.iataOrCorpText = 'Please use 8 digit IATA #';
      } else {
        $scope.userInfo.ARCORIATANumber = '';
        $scope.iataOrCorpText = 'Corporate UCS Number';
      }
    };
    $scope.regiSubmit = function (e) {
      e && e.preventDefault();

      if ($scope.showUserFlg == 'Agency') {
        $scope.userInfo.ARCORIATANumber = $scope.userInfo.iataOrCorp;
      } else {
        // $scope.userInfo.ARCORIATANumber = '';
        $scope.userInfo.UCSNumber = $scope.userInfo.iataOrCorp;
      }

      $scope.userInfo.email = $scope.preEmail;

      // if ($scope.registrationForm.$valid) {
      $scope.InsertUserRegistrationPageValues(function (value) {
        //todo...logic here
        $scope.forceInsert = false;
        if (value.state) {
          $scope.step = 2;
          return false;
        } else {
          if (value.message == 'NeedConfirm') {
            $("#alert-modal-confirm").modal();
          } else {
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: value.message
              });
          }
        }
        // if(value.)
      });
      // }
    };
    $scope.confirmSubmit = function (e) {
      $scope.forceInsert = true;
      $("#alert-modal-confirm").modal('hide');
      $scope.regiSubmit(e)
    };


    $scope.InsertUserRegistrationPageValues = function (callback) {
      console.debug('Params...', {
        'param 01 -- stringify': $scope.userInfo,
        'param 02': $scope.forceInsert
      });
      $rootScope.mainSpinner = true;
      CMSService.InsertUserRegistrationPageValues(JSON.stringify($scope.userInfo), $scope.forceInsert).then(function (resultValue) {
        $rootScope.mainSpinner = false;
        callback(resultValue);
      });
    };


    $scope.countryWrapper = [];
    $scope.hideFlag = false;

    CMSService.getCountries().then(function (value) {
      $scope.countryWrapper = value.countries;
    });


    var validationHelperParam = {
      name: 'username',
      val: 'tcool.ma.approve'
    }

    // CMSService.validationHelper(validationHelperParam).then(function (value) {
    //   debugger
    //   console.log("validationHelper...", value);
    //
    // });

    $scope.showDropDown = function (event) {
      $(event.target).siblings('ul').dropdown('toggle')
    }

  }

})();
/*
 * Created by Chris 2017.3.30
 * */
(function () {
  'use strict';
  angular.module('portalModule')
    .controller('secureLandingController', controller);

  controller.$inject = ['$scope', '$rootScope', 'CMSService', 'SecurityService', '$state'];
  function controller($scope, $rootScope, CMSService, SecurityService, $state) {

    $rootScope.backFlg = '';

    $scope.drowDownFlg = false;

    $scope.selectedReport = '';

    $(document).ready(function () {
      if ($rootScope.isAmenityConsent) {
        $rootScope.isAmenityConsent = false;
        $('#amenity-tab').tab('show');
      } else {
/*        switch ($rootScope.currentUser.profileName) {
          case $rootScope.PROFILE_TYPE.agent:
          case $rootScope.PROFILE_TYPE.sales:
          case $rootScope.PROFILE_TYPE.ccs:
          case $rootScope.PROFILE_TYPE.ssm:
            $('#amenity-tab').tab('show');
            break;
          case $rootScope.PROFILE_TYPE.corp:
          case $rootScope.PROFILE_TYPE.agtMgr:
            $('#dashboard-tab').tab('show');
            break;
        }*/
        if($rootScope.currentUser.isInternalUser || ($rootScope.currentUser.profileName === $rootScope.PROFILE_TYPE.agent)){
          $('#amenity-tab').tab('show');
        }else {
          $('#dashboard-tab').tab('show');
        }
      }
    });

    $scope.reportSelect = function (report) {

      $scope.drowDownFlg = false;
      if ($scope.reportTabsNew.length > 3) {
        $scope.reportTabsNew.pop();
      }
      $scope.reportTabsNew.push(report);
      $scope.selectedTab = report.name;
      $scope.selectTab(report.name, report.displayName);
      $scope.selectedReport = report.displayName;
    };

    $scope.data = {};
    $scope.tab = $('#tab');
    $scope.tabContent = $('#tab-content');
    $scope.noData = $('#no-data');
    $scope.reportMenu = $('.single-pb-menu');
    $scope.showDetailButton = true;

    $scope.report = {
      element: $('div.powerbi-frame')
    };

    $scope.reloadData = function (id) {

      CMSService.getEmbeddedPowerBIReport(id).then(function (value) {

        if (value && value[0]) {
          var embedUrl = value[0].embedUrl;
          var accessToken = value[0].accessToken;
          $scope.report.embedUrl = embedUrl;
          $scope.report.accessToken = accessToken;
          $scope.report.accountId = value[0].AccountId;
          $scope.report.id = value[0].id;
        }
        else {
          $scope.noData.show();
          $scope.reportMenu.hide();
          $scope.report.element.hide();
        }
      });
    };

    $scope.onEmbedded = function (report) {

      $scope.report = $scope.report || {};
      $scope.report.instance = $scope.report.instance || {};
      $scope.report.instance = report;

      $scope.report.instance.on('loaded', function (event) {

        $scope.report.instance.updateSettings({
          filterPaneEnabled: false,
          navContentPaneEnabled: false
        });

        $scope.report.instance.getPages().then(function (value) {

          // get all pages in current pb frame
          var reportPages = value;
          $scope.reportTabs = [];
          $scope.reportTabsNew = [];
          $scope.reportTabsExtra = [];
          _.forEach(reportPages, function (r) {

            _.forEach($rootScope.currentUser.reportPermission, function (p) {

              if (r.displayName.toUpperCase() == p) {
                $scope.reportTabs.push(r);
              }
            });
          });

          if ($scope.reportTabs.length <= 3) {
            $scope.reportTabsNew = $scope.reportTabs;
          }

          if ($scope.reportTabs.length > 3) {
            for (var i = 0; i < 3; i++) {
              $scope.reportTabsNew.push($scope.reportTabs[i]);
            }
            for (var j = 3; j < $scope.reportTabs.length; j++) {
              $scope.reportTabsExtra.push($scope.reportTabs[j]);
            }
          }

          if ($scope.reportTabs.length > 0) {
            $scope.noData.hide();
            $scope.reportMenu.show();
            $scope.report.element.show();
            $scope.selectedTab = $scope.reportTabs[0].name;
            $scope.report.instance.setPage($scope.reportTabs[0].name);
          }
          else {
            $scope.noData.show();
            $scope.reportMenu.hide();
            $scope.report.element.hide();
          }
          $scope.$apply();
        });
      });
      $scope.report.instance.on('dataSelected', function (event) {

        $scope.dataObj = event.detail;
      });
      $scope.report.instance.on('pageChanged', function (event) {

        $scope.dataObj = {
          page: {
            displayName: event.detail.newPage.displayName,
            name: event.detail.newPage.name
          }
        };

        // Ryan : Hard coded to hide the button for this report
        // DF-00741
        // 20170221 : add custom label Sip_Config_Dashboard_Button
        try {
          //var name = event.detail.newPage.name;
          var displayName = event.detail.newPage.displayName;
          var tmpFlag = !($rootScope.currentUser.dashboard == 'PL_ABC_Summary' &&
          displayName == 'Earnings Summary');
          $scope.showDetailButton = !($rootScope.currentUser.dashboard == 'PL_ABC_Summary' && displayName == 'Earnings Summary');;
        }
        catch (ex) {
          console.debug(ex);
        }
      });
    };

    $scope.clickToPb = function () {

      $rootScope.backFlg = 'homepage';
      $state.go('single-power-bi', {dataObj: $scope.dataObj});
    };

    $scope.selectTab = function (name, displayName) {

      $scope.report.instance.setPage(name, displayName);

      // Ryan : Hard coded to hide the button for this report
      // DF-00741
      // 20170221 : add custom label Sip_Config_Dashboard_Button
      try {
        var tmpFlag = !($rootScope.currentUser.dashboard == 'PL_ABC_Summary' &&
        displayName == 'Earnings Summary');
        $scope.showDetailButton = !($rootScope.currentUser.dashboard == 'PL_ABC_Summary' && displayName == 'Earnings Summary');;
      }
      catch (ex) {
        console.debug(ex);
      }
    };

    $scope.reloadData($rootScope.currentUser.id);
  }
})();
(function () {
  'use strict';
  angular.module('portalModule')
    .controller('secureLandingHomeController', controller);

  controller.$inject = ['$scope', '$rootScope', 'CMSService'];

  function controller($scope, $rootScope, CMSService) {

    CMSService.getKeyMetrics($rootScope.currentUser.id).then(function (value) {
      if (value) {
        $scope.keyMetricsWrapper = value;
        $scope.serviceFundsBlance = value.serviceFundsBalance;
        $scope.serviceFundsAverageSpend = value.serviceFundsAverageSpend;
        $scope.performance = value.performance;
        $scope.estimatedEarnings = value.estimatedEarnings;
        $scope.currentContractPerformance = value.currentContractPerformance;
        $scope.currentContractDiscountSavings = value.currentContractDiscountSavings;
        $scope.currentPerformance = $scope.performance.nonJV;
      }
    });

    $scope.switchPerformanceLeft = function () {
      switch ($scope.currentPerformance.label) {
        case 'Back-End Performance - Quarter':
          break;
        case 'Back-End Performance - Non-JV':
          break;
        case 'Back-End Performance - Transatlantic':
          $scope.currentPerformance = $scope.performance.nonJV;
          break;
        case 'Back-End Performance - Pacific-JV':
          $scope.currentPerformance = $scope.performance.transatlantic;
          break;
      }
    };

    $scope.switchPerformanceRight = function () {
      switch ($scope.currentPerformance.label) {
        case 'Back-End Performance - Quarter':
          break;
        case 'Back-End Performance - Non-JV':
          $scope.currentPerformance = $scope.performance.transatlantic;
          break;
        case 'Back-End Performance - Transatlantic':
          $scope.currentPerformance = $scope.performance.pacificJV;
          break;
        case 'Back-End Performance - Pacific-JV':
          break;
      }
    }
  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('powerbiReportController', controller);

  controller.$inject = ['$scope', '$stateParams', 'CMSService', '$rootScope', '$state'];
  function controller($scope, $stateParams, CMSService, $rootScope, $state) {
    var dataObj = $stateParams['dataObj'];
    var PAGE = dataObj ? dataObj.page : {};

    var userId = $rootScope.currentUser.id;
    var powerBiPermission = $rootScope.currentUser.reportPermission;

    if($rootScope.fromUrl == '/dashboard/:userId'){
      userId = $rootScope.biUserId;
      powerBiPermission = $rootScope.biUserPermissions;
    }


    function setFilterObj() {

      if (!dataObj || !dataObj.dataPoints) {
        return null;
      }

      var models = window['powerbi-client'].models;
      var tableName = dataObj.dataPoints[0].identity[0].target.table;
      var columnName = dataObj.dataPoints[0].identity[0].target.column;
      var equalsVal = dataObj.dataPoints[0].identity[0].equals;
      var filter = new models.BasicFilter(
        {
          table: tableName,
          column: columnName
        },
        "In",
        [equalsVal]
      );

      return filter;
    }

    $scope.backToHomePage = function () {

      $state.go('secure-landing-home', {feature: 'init'});
    };

    $scope.backToUM = function () {

      $state.go('user-management.dashboard');
    };

    $scope.drowDownFlg = false;

    $scope.reportSelect = function (report) {

      $scope.drowDownFlg = false;

      if ($scope.reportTabsNew.length > 3) {
        $scope.reportTabsNew.pop();
      }
      $scope.reportTabsNew.push(report);
      $scope.selectedTab = report.name;
      $scope.report.instance.setPage(report.name);
      // $scope.selectTab(report.name, report.displayName);
      $scope.selectedReport = report.displayName;
    };

    CMSService.getDetailEmbeddedPowerBIReport(userId).then(function (value) {

      var res = value[0];
      $scope.AccountId = res.AccountId;
      $scope.UserId = res.UserId;
      $scope.accessToken = res.accessToken;
      $scope.apiKey = res.apiKey;
      $scope.embedUrl = res.embedUrl;
      $scope.id = res.id;
      $scope.wkspaceCollectionName = res.wkspaceCollectionName;
      $scope.wkspaceId = res.wkspaceId;
      $scope.report = {
        element: $('div.powerbi-frame')
      };
    });

    $scope.onEmbedded = function (report) {

      $scope.report.instance = report;
      $scope.report.instance.on('loaded', function (event) {

        var filter = setFilterObj();

        $scope.report.instance.updateSettings({
          filterPaneEnabled: false,
          navContentPaneEnabled: false
        });

        // filter && $scope.report.instance.setFilters([filter]);

        $scope.report.instance.getPages().then(function (value) {

          // get all pages in current pb frame
          var reportPages = value;

          $scope.reportTabs = [];
          $scope.reportTabsNew = [];
          $scope.reportTabsExtra = [];
          _.forEach(reportPages, function (r) {

            _.forEach(powerBiPermission, function (p) {

              if (r.displayName.toUpperCase() == p) {
                $scope.reportTabs.push(r);
              }
            });
          });

          if ($scope.reportTabs.length <= 3) {
            $scope.reportTabsNew = $scope.reportTabs;
          }
          if ($scope.reportTabs.length > 3) {
            for (var i = 0; i < 3; i++) {
              $scope.reportTabsNew.push($scope.reportTabs[i]);
            }
            for (var j = 3; j < $scope.reportTabs.length; j++) {
              $scope.reportTabsExtra.push($scope.reportTabs[j]);
            }
          }
          if (PAGE && PAGE.displayName) {
            var reportList = [];
            var reportNew = {};
            for(var k = 0; k < $scope.reportTabsNew.length; k++){
              reportList.push($scope.reportTabsNew[k].displayName.toUpperCase());
            }
            for(var i =0; i < $scope.reportTabs.length; i++){
              if($scope.reportTabs[i].displayName.toUpperCase() == PAGE.displayName.toUpperCase()){
                reportNew = $scope.reportTabs[i];
              }
            }

            if(reportList.indexOf(PAGE.displayName.toUpperCase()) < 0){
              $scope.reportTabsNew.push(reportNew);
            }

            reportNew && $scope.report.instance.setPage(reportNew.name);

            $scope.selectedTab = reportNew.name;
          }
          else if ($scope.reportTabs.length > 0) {
            $scope.selectedTab = $scope.reportTabs[0].name;
            $scope.report.instance.setPage($scope.reportTabs[0].name);

          }
          $scope.$apply();
        });
      });
    };
  }
})();
/*
 * Created by Ryan 2016.11.9
 * Modified by XXX 201X.XX.XX
 * */
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('subMenuPageController', ['$scope', '$stateParams', 'CMSService', function ($scope, $stateParams, CMSService) {

      if ($stateParams.linkId == 'doc-uma') {
        CMSService.getUserManagementHelpDoc($stateParams.linkId).then(function (value) {
          if (value.length == 0) return false;

          $scope.id = value.userManagementDocs[0].docId;
          $scope.name = value.userManagementDocs[0].docName;
          $scope.title = value.userManagementDocs[0].docTitle;
          $scope.content = value.userManagementDocs[0].docContent;

          //hotfix from Jason
          setTimeout(function () {
            $('.sub-bottom img').css({'height': '100%', 'width': '100%'});
          });
        });

        return;
      }
      if ($stateParams.linkId == 'amenity-consent') {
        CMSService.getAmenityConsent().then(function (value) {
          angular.extend($scope, value)
        });
        return;
      }
      CMSService.getHeaderTitleandContentValues($stateParams.linkId).then(function (value) {

        $scope.id = $stateParams.linkId;
        $scope.name = value[0].Parent_Link__r.Name;
        $scope.title = value[0].SIP_Title__c;
        $scope.content = value[0].SIP_Content__c + "";
      })
    }])
})();


(function () {
  'use strict';

  angular.module('portalModule')
    .controller('subscribeController', controller);

  controller.$inject = ['$scope'];
  function controller($scope) {
  }

})();
/*
 * Created by Ryan 2016.11.9
 * Modified by XXX 201X.XX.XX
 * */
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('termConditionController', controller);

  controller.$inject = ['$scope', 'CMSService', 'util'];
  function controller($scope, CMSService, util) {

    CMSService.getTermConditionContentManagementValues().then(function (value) {

      $scope.dataInfo = {};
      // Tcool 2017.07.09 hotfix
      if (value) {
        if (value[0].UserAgreementWrapper[0].Name == 'User Agreement') {
          $scope.dataInfo.termConditionContent = util.decodedString(value[0].UserAgreementWrapper[0].Content__c);
        }
        else {
          $scope.dataInfo.termConditionContent = util.decodedString(value[0].UserAgreementWrapper[1].Content__c);
        }
        $('#term-condition-content').html($scope.dataInfo.termConditionContent);
      }

      // if (value && value[0] && value[0].UserAgreementWrapper && value[0].UserAgreementWrapper[0]) {
      //   $scope.dataInfo.termConditionContent = util.decodedString(value[0].UserAgreementWrapper[0].Content__c);
      //   $('#term-condition-content').html($scope.dataInfo.termConditionContent);
      // }
    });
  }

})();
(function () {
  "use strict";

  angular.module('portalModule')
    .component('userAccessComponent', {
      templateUrl: 'Sip_UserManagement_AccessCompTemplate',
      controller: controller,
      bindings: {
        data: '<',
        userNow: '<',
        editFlg: '=',
        availableUpg: '<',
        submitFunc: '&'
      }
    });

  controller.$inject = ['CMSService', '$state', '$rootScope', 'UserManagementFactory', '$scope'];
  function controller(CMSService, $state, $rootScope, UserManagementFactory, $scope) {
    var ctrl = this;

    ctrl.log = UserManagementFactory.devLog;
    ctrl.showError = false;
    ctrl.item1 = true;
    ctrl.currentGroup = {};
    ctrl.dataValueBackup = {};
    ctrl.cancelOrBack = '';
    ctrl.userRoleId = '';
    ctrl.permissionGroupId = '';
    ctrl.orderList = [''];

    ctrl.editToggle = function () {

      // permissionId = ctrl.data.userProfileInfo.permissionId;
      // userId = ctrl.data.userProfileInfo.userId;
      ctrl.userRoleId = ctrl.data.userProfileInfo.userRoleId;
      ctrl.permissionGroupId = ctrl.data.userProfileInfo.permissionGroupId;

      ctrl.dataValueBackup = angular.copy(ctrl.data);
      ctrl.editFlg = true;

      //set two new variable
      // ctrl.roleName = ctrl.data.userProfileInfo.userRole;
      // ctrl.groupName = ctrl.data.userProfileInfo.permissionGroup;
    };

    ctrl.roleChange = function (role) {
      ctrl.data.userProfileInfo.userRole = role.userRoleName;
      ctrl.permissionFilter = [];

      for (var i = 0; i < ctrl.availableUpg.groupNameWrapper.length; i++) {
        if (role.userRoleName == ctrl.availableUpg.groupNameWrapper[i].parent) {
          ctrl.permissionFilter.push(ctrl.availableUpg.groupNameWrapper[i]);
        }
      }

      if (ctrl.permissionFilter[0]) {
        ctrl.data.userProfileInfo.permissionGroup = ctrl.permissionFilter[0].permissionGroupName;
        ctrl.currentGroup = ctrl.permissionFilter[0];
      } else {
        ctrl.data.userProfileInfo.permissionGroup = '';
      }

      ctrl.groupChange(ctrl.currentGroup.permissionGroupId, ctrl.data.userProfileInfo.arcNumber);
      ctrl.userRoleId = role.userRoleId;

      //Description
      ctrl.data.userProfileInfo.userRoleDesc = role.userRoleDesc;

    };

    ctrl.clickGroup = function (group) {
      ctrl.data.userProfileInfo.permissionGroup = group.permissionGroupName;
      ctrl.groupChange(group.permissionGroupId, ctrl.data.userProfileInfo.arcNumber);
      ctrl.permissionGroupId = group.permissionGroupId;

      //Description
      ctrl.data.userProfileInfo.permissionGroupDesc = group.permissionGroupDesc;
    };

    ctrl.groupChange = function (groupIdNow, arcNumber) {
      ctrl.data.userAccessInfo = ctrl.data.userAccessInfo || {};
      ctrl.data.userAccessInfo.userAccessDetails = ctrl.data.userAccessInfo.userAccessDetails || [];

      $rootScope.mainSpinner = true;
      // console.log('getAvailablePermissions =======================',ctrl.data.userProfileInfo.userId)
      CMSService.getAvailablePermissions(groupIdNow, arcNumber, ctrl.data.userProfileInfo.userId || '').then(function (value) {
        // console.log('getAvailablePermissions in access!!', value);
        $rootScope.mainSpinner = false;
        ctrl.data.serviceFunds = ctrl.data.serviceFunds || [];
        if (value && (value.state).toLowerCase() == "success") {
          angular.extend(ctrl.data.userAccessInfo.userAccessDetails, value.permissions);
          angular.extend(ctrl.data.serviceFunds, value.serviceFunds);
          ctrl.permissionGroupId = groupIdNow;
        } else {
          console.error('Get available permissions failed!')
        }

      });


    };


    if ($state.current.name == 'user-management-create.three') {
      ctrl.cancelOrBack = 'back';
    } else {
      ctrl.cancelOrBack = 'cancel';
    }

    ctrl.clickCancel = function () {
      if ($state.current.name == 'user-management-create.three') {
        //force to clear data the user choose in the past
        angular.extend(ctrl.data.userProfileInfo, {
          'userRole': null,
          'userRoleId': null,
          'permissionGroup': null,
          'permissionGroupId': null
        });
        $state.go('user-management-create.two', {stepTwo: ctrl.data})
      } else {
        ctrl.editFlg = false;
        ctrl.data = ctrl.dataValueBackup;
      }
    };

    //UI update to add more than one additional agency
    ctrl.removeAdditionalIata = function (iataObj) {

      if (iataObj) {
        ctrl.iataToRemoved = iataObj;
        $('#modal-remove-iata').modal();
        return;
      }
      ctrl.additionalIataInput = '';

      // ctrl.data.userProfileInfo.additionalAgencies = _.without(ctrl.data.userProfileInfo.additionalAgencies, iataNumberInput);
      if (angular.isArray(ctrl.data.userProfileInfo.additionalAgencies)) {
        ctrl.data.userProfileInfo.additionalAgencies = ctrl.data.userProfileInfo.additionalAgencies.filter(function (value) {
          return value.arcNumber != ctrl.iataToRemoved.arcNumber;
        })
      }
    };
    ctrl.addAdditionalIata = function () {

      var iataNumberInput = ctrl.additionalIataInput;

      ctrl.log('home:addAdditionalIata === new add-iata', iataNumberInput);

      ctrl.additionalIataInput = '';

      if (!/^\d{8}$/g.test(iataNumberInput)) {
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Iata Number must be 8 digits'
          });
        return false;
      }

      //forbid duplicated value
      if (_.isArray(ctrl.data.userProfileInfo.additionalAgencies)) {
        if ((ctrl.data.userProfileInfo.additionalAgencies).some(function (element) {
            return element.arcNumber == iataNumberInput;
          })) {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Duplicated Additional Iata Number'
            });
          return false;
        }
      }


      CMSService.validateAdditionalAgency(ctrl.data.userProfileInfo.arcNumber, iataNumberInput).then(function (res) {
        if (res.state == 'Fail') {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: res.errorMessages[0]
            });

        } else {

          if (!angular.isArray(ctrl.data.userProfileInfo.additionalAgencies)) {
            ctrl.data.userProfileInfo.additionalAgencies = [];
          }
          ctrl.data.userProfileInfo.additionalAgencies.push({
            agencyName: res.additionalAgency.agencyName,
            arcNumber: res.additionalAgency.arcNumber
          });
          $rootScope.$broadcast('showMessage',
            {
              type: 'success',
              text: 'ARC / IATA # added successfully. Please click \'Submit\' to save changes'
            });


        }

      })


    };

    //computed
    ctrl.canSubmit = function (userRole, permissionGroup, userNow) {
      if (!userNow && userNow === {}) return false;
      var b = Boolean(userRole && permissionGroup && userNow)
      console.log('canSubmit', b)
      return b
      // return !ctrl.data.userProfileInfo.userRole || !ctrl.data.userProfileInfo.permissionGroup || !ctrl.userNow
      // ng-class="{'disabled-btn':!$ctrl.data.userProfileInfo.userRole || !$ctrl.data.userProfileInfo.permissionGroup || !$ctrl.userNow,'tertiary':$ctrl.data.userProfileInfo.userRole && $ctrl.data.userProfileInfo.permissionGroup && $ctrl.userNow}">
    }
  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('userManagementController.agencies', controller);

  controller.$inject = ['$scope', '$state', 'CMSService', '$rootScope', '$stateParams', 'umCache', 'UserManagementFactory', '$timeout'];
  function controller($scope, $state, CMSService, $rootScope, $stateParams, umCache, UserManagementFactory, $timeout) {
    var vm = this;

    vm.agencyDetail = vm.agencyDetail || {};
    vm.agencyNow = vm.agencyNow || {};
    vm.showAgencyDetail = true;
    vm.log = UserManagementFactory.devLog;

    angular.extend(vm, {
      changeAgency: function (agency) {
        vm.agencyNow = agency;
        vm.getCorpDetails(agency);
      },
      toggleWaivers: function () {
        var newVal = vm.toggleAllWaivers

        vm.agencyDetail.allWaiversFavorsPermissions.forEach(function (item) {
          item.permissionValue = newVal;
        })
        vm.agencyDetail.nonJetstreamProducts.forEach(function (item) {
          item.permissionValue = newVal;
        })

        vm.updateCorpAgencyPermissions(vm.agencyDetail);
      },
      toggleAmenities: function () {
        var newVal = vm.toggleAllAmenities
        vm.agencyDetail.allAmenitiesPermissions.forEach(function (item) {
          item.permissionValue = newVal;
        })

        vm.updateCorpAgencyPermissions(vm.agencyDetail);
      },
      resetToggle: function () {
        vm.toggleAllWaivers = vm.isTravelAllChecked(vm.agencyDetail) ? true : false;
        vm.toggleAllAmenities = vm.isAmenitiesAllChecked(vm.agencyDetail) ? true : false;
      },
      checkboxChanged: function () {
        vm.resetToggle();
        vm.updateCorpAgencyPermissions(vm.agencyDetail);
      },
      isTravelAllChecked: function (obj) {
        var row1 = obj['allWaiversFavorsPermissions']
        var row2 = obj['nonJetstreamProducts']
        return row1.every(function (item, index) {
            return item['permissionValue'] == true;
          }) && row2.every(function (item, index) {
            return item['permissionValue'] == true;
          })
      },
      isAmenitiesAllChecked: function (obj) {
        var row1 = obj['allAmenitiesPermissions']
        return row1.every(function (item, index) {
          return item['permissionValue'] == true;
        })
      },
      getCorpAgencies: function () {
        $rootScope.mainSpinner = true;
        CMSService.getCorpAgencies().then(function (value) {
          // $rootScope.mainSpinner = false;

          if (value && value.state == "Success") {
            //Agencies List
            vm.agenciesData = value.myAgencies;

            //Agency now
            vm.agencyNow = vm.agenciesData[0];
            $scope.$parent.vm.umStatus.agencyNow = vm.agenciesData[0];
            vm.log('agencies:getCorpAgencies === agencies', vm.agenciesData);

            vm.getCorpDetails(vm.agencyNow);
          } else {
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: value.errorMessages[0]
              });
          }

        });
      },
      getCorpDetails: function (agency) {
        if (!agency) return;
        $rootScope.mainSpinner = true;
        CMSService.getCorpAgencyDetail(agency['aorAccountId']).then(function (value) {
          var detailsObj = value.myAgencyDetail;
          vm.agencyDetail = detailsObj;
          $timeout(vm.resetToggle)
          vm.log('agencies:getCorpDetails === agency detail', vm.agencyDetail);
          $rootScope.mainSpinner = false;
        })
      },
      updateCorpAgencyPermissions: function (agencyObj) {
        $rootScope.mainSpinner = true;
        CMSService.updateCorpAgencyPermissions(agencyObj).then(function (value) {
          $rootScope.mainSpinner = false;
          // vm.noDetailWatch = true;
          vm.agencyDetail = value.myAgencyDetail;

          if (value.state == 'Success') {
          } else {
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: value.errorMessages[0]
              });
          }
        })
      }
    })

    vm.getCorpAgencies()


  }

})
();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('userManagementController.branch', controller);

  controller.$inject = ['$scope', '$state', 'CMSService', '$rootScope', '$stateParams', 'umCache', 'UserManagementFactory'];
  function controller($scope, $state, CMSService, $rootScope, $stateParams, umCache, UserManagementFactory) {
    $scope.log = UserManagementFactory.devLog;
    $scope.$parent.mainTabFlg = 5;
    $scope.$parent.vm.umStatus.branchNow = {};

    // $scope.pageTitle = 'User Management';
    $scope.orderByValue = 'pendingUsers';
    $scope.orderReverse = false;
    $scope.userClickedSomeChk = false;
    $scope.setOrderFunc = function (typeVal) {
      if (typeVal == $scope.orderByValue) {
        $scope.orderReverse = !$scope.orderReverse;
        return;
      }
      $scope.orderReverse = false;
      $scope.orderByValue = typeVal;
    };
    // $rootScope.mainSpinner = true;

    var userDetails = umCache.get('userDetails');
    if (userDetails) {
      $scope.userDetails = userDetails;
    } else {
      $state.go('user-management.home');
    }

    $scope.selectBranch = function (branchName, iataNumber, accId) {
      // $scope.$parent.vm.umStatus.branchNow = {name: branchName, iata: iataNumber, accId: accId};

      umCache.put('allInOneBranch', {name: branchName, iata: iataNumber, accId: accId});
      $state.go('user-management.home', {name: branchName, iata: iataNumber, accId: accId});
      // UserManagementFactory.redirectUtil('home');
    };

    $scope.branchList = umCache.get('getBranchLocation');

    $scope.branchList.map(function (branch) {
      return angular.extend(branch, {isSelected: false});
    });

    $scope.showMassUpload = function () {
      if ($scope.userClickedSomeChk) return;
      $('#alert-modal-massupload').modal();
    };
    $scope.createNewUser = function () {
      if ($scope.userClickedSomeChk) return;
      $state.go('user-management-create.one',
        {
          stepOne: {userNow: $scope.userDetails}
        }
      );
    };


    $scope.chkBranches = [];
    $scope.$watch('branchList', function (newVal) {
      if (newVal.length > 0) {
        $scope.chkBranches = newVal.filter(function (item) {
          return item.isSelected == true;
        });

        $scope.chkAll = !(newVal.some(function (item) {
          return item.isSelected == false;
        }));
      }
    }, true);

    $scope.selectAll = function () {
      var isSelected = false;
      $scope.chkAll ? isSelected = true : isSelected = false;
      $scope.branchList = $scope.branchList.map(function (item) {
        return angular.extend(item, {isSelected: isSelected});
      });
    };

  }

})();
(function () {
  'use strict';

  /*
   param {object} stepOne
   param {object} userNow
   * */
  angular.module('portalModule')
    .controller('createOneController', ['$scope', '$rootScope'
      , 'CMSService'
      , '$stateParams', '$state', 'umCache', 'formPattern', 'UserManagementFactory'
      , function ($scope, $rootScope, CMSService, $stateParams, $state, umCache, formPattern, UserManagementFactory) {
        $scope.log = UserManagementFactory.devLog;
        $rootScope.createUserStep = 1;
        $scope.showCountryDrop = false;
        // $scope.isValidation = isValidation;
        $scope.agencyMail = {};
        $scope.formPattern = formPattern;

        if (umCache.get('createModel')) {
          //create new user model
          $scope.userData = umCache.get('createModel');
          $scope.log('create.one:init === ', 'back from create.two');
        } else if (umCache.get('userDetails')) {
          //main model
          $scope.userData = umCache.get('userDetails');
          $scope.log('create.one:init === ', 'from um.home');
        } else {
          $scope.log('create.one:init === ', 'miss parameters,force direct to um.home');
          $state.go('user-management.home');
        }

        //set Default for some fields
        $scope.mailEditable = false;

        $scope.countriesList = umCache.get('countries');
        $scope.countryName = $scope.countriesList[0];

        $scope.iataList = [];


        if (!$stateParams.needBinding) {
          //clean object
          var plainObj = {}
          $scope.log('create.one:needBinding === prove user data change before:', $scope.userData);
          angular.forEach($scope.userData.userProfileInfo, function (value, key) {
            if (key !== 'arcNumber') {
              this[key] = "";
            }
          }, plainObj);
          angular.extend($scope.userData.userProfileInfo, plainObj);

          //do not need these two field
          delete $scope.userData.userProfileInfo.isFrozen;
          delete $scope.userData.userProfileInfo.isPasswordLocked;


          if ($scope.userData.userAccessInfo) {
            angular.forEach($scope.userData.userAccessInfo.permissions, function (value) {
              value.map(function (value, key) {
                value['isChecked'] = false;
                value['isReadonly'] = false;
              })
            });
          }


          angular.forEach($scope.userData.serviceFunds, function (value) {
            value['isChecked'] = false;
            // uncomment it if it is needed
            // value['isReadonly'] = false;
          });
          $scope.log('create.one:needBinding === prove user data change done:', $scope.userData);
        }

        $scope.agenciesData = umCache.get('getCorpAgencies');
        $scope.agencyNow = $scope.agenciesData[0];


        (function () {

          CMSService.getAvailableARCNumbers().then(function (value) {
          var res = [];
          for (var item in value.availableARCNumbers) {
            res.push(item);
          }
          $scope.iataList = res;
          $scope.agencyName = res[0];
          })
        })();


        $scope.setIata = function (value) {
          $scope.userData.userProfileInfo.arcNumber = value;
        };
        $scope.setCountry = function (value) {
          $scope.userData.userProfileInfo.maillingCountry = value;
        };


        $scope.jumpToStep2 = function (obj) {
          if (!$scope.createForm.$valid) {
            return false;
          }

          $rootScope.mainSpinner = true;
          CMSService.validateUserProfileInfo({
            'email': obj.email,
            'arcNumber': obj.arcNumber,
            'username': obj.username,
            'actionName': 'submitProfile'
          }).then(function (value) {
            $rootScope.mainSpinner = false;
            $scope.errMsg = '';
            $scope.log('create.one:validateUserProfileInfo === before step2', value);
            if (value.state == 'Success') {
              if (value.errorMessages) {
                //unique email
                $scope.errMsg = value.errorMessages[0];
                $("#alert-modal-validation").modal();
              } else {
                umCache.put('createModel', $scope.userData);
                $state.go('user-management-create.two');
              }
            } else {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.errorMessages[0]
                });
            }
          });
        };

        $scope.clickModalOk = function () {
          $('#alert-modal-validation').modal('hide');
          umCache.put('createModel', $scope.userData);
          // setTimeout(function () {
          $state.go('user-management-create.two');
          // }, 1000);
        };

        $scope.getAgencyAddress = function () {
          // // $scope.setAction(false);
          CMSService.getAgencyAddress($scope.userData.userProfileInfo.arcNumber).then(function (value) {
            // // $scope.setAction(true);
            if (value) {
              angular.extend($scope.userData.userProfileInfo, {
                'maillingCity': value.agencyAddress.billingCity,
                'maillingCountry': value.agencyAddress.billingCountry,
                'maillingPostalCode': value.agencyAddress.billingPostalCode,
                'maillingState': value.agencyAddress.billingState,
                'maillingStreet': value.agencyAddress.billingStreet,
              })
            }
          });
        };

        $scope.setMailEdit = function () {
          $scope.getAgencyAddress();
          $scope.createForm.maillingCountry.$touched = true;
          $scope.createForm.maillingCountry.$untouched = false;
        };

        $scope.showDropDown = function (event) {
          $(event.target).siblings('ul').dropdown('toggle')
        }

      }])

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('createThreeController', ['$scope', '$state', '$rootScope', '$stateParams', 'CMSService', 'umCache', 'UserManagementFactory',
      function ($scope, $state, $rootScope, $stateParams, CMSService, umCache, UserManagementFactory) {
        $rootScope.createUserStep = 3;
        $scope.log = UserManagementFactory.devLog;
        $scope.editFlg = true;

        $scope.userData = {};
        $scope.userList = [];
        $scope.userNow = $stateParams.userNow;

        $scope.userData = umCache.get('createModel');

        var userDataFixed = [];
        $scope.userDataFixed = userDataFixed;
        var convertAllUsers = function (rawObj, cb) {

          rawObj.map(function (item) {
            item['name'] = item['fullName'];
            item['persona'] = item['title'];
            item['active'] = item['status'];

            //todo...use status to check user Id or registrationId
            if (item['userId'] == null) {
              item['id'] = item['registrationId'];
            } else {
              item['id'] = item['userId'];
            }
            item['imgUrl'] = item['photoUrl'];
          });
          cb(rawObj);
        };
        $scope.queryBranchInfo = function (arcNumber, callback) {
          $rootScope.mainSpinner = true;
          if ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp) {
            callback('');
            return;
          }
          CMSService.getAvailableARCNumbers().then(function (value) {
            var map = value.availableARCNumbers;
            callback(map[arcNumber]);
          })
        };

        $scope.log('create.three:init === createModel', umCache.get('createModel'));
        $scope.log('create.three:init === data before change', userDataFixed);


        if ($stateParams.stepThree && $stateParams.stepThree.type == "new") {
          // $scope.userData = $stateParams.stepThree.userData;
          $scope.userNow = true;  //not a real user object,just to show the selector
          $scope.showUserSelector = false;

        } else if ($stateParams.stepThree && $stateParams.stepThree.type == "duplicate") {
          // $scope.userData = $stateParams.stepThree.userData;
          $scope.showUserSelector = true;
          // $scope.setAction(false);
          $scope.queryBranchInfo($scope.userData.userProfileInfo.arcNumber, function (accId) {
            CMSService.getUserList(accId).then(function (value) {
              $rootScope.mainSpinner = false;
              convertAllUsers(value.allUsers, function (resObj) {
                // console.debug('remove pending user before', resObj);
                resObj = resObj.filter(function (item) {
                  return item.active != 2;
                });
                resObj = resObj.filter(function (item) {
                  return item.userRoleId;
                });
                // value.userDetails.userProfileInfo.userRoleId
                // console.debug('remove pending user after', resObj);

                $scope.userList = resObj;

                $scope.userDataFixed = resObj;
                $scope.setAction(true);


              });
            });
          });
        } else {
          $state.go('user-management.home');
        }


        var getUserProfile = function (cb) {

          $rootScope.mainSpinner = true;
          CMSService.getUserDetails($scope.userNow.active == 2 ? 'registration' : 'user', $scope.userNow.userId || '').then(function (value) {
            if (!(angular.isUndefined(value.value))) {
              value = JSON.parse(value.value);
            }
            $rootScope.mainSpinner = false;
            if (value && value.state == "Success") {
              $scope.userData.userAccessInfo = $scope.userData.userAccessInfo || {};
              $scope.userData.serviceFunds = $scope.userData.serviceFunds || [];

              angular.extend($scope.userData.userAccessInfo, value.userDetails.userAccessInfo);
              angular.extend($scope.userData.serviceFunds, value.userDetails.serviceFunds);
              angular.extend($scope.userData.userProfileInfo,
                {
                  'userRole': value.userDetails.userProfileInfo.userRole,
                  'permissionGroup': value.userDetails.userProfileInfo.permissionGroup,
                  'userRoleId': value.userDetails.userProfileInfo.userRoleId,
                  'permissionGroupId': value.userDetails.userProfileInfo.permissionGroupId,
                  'additionalAgencies': value.userDetails.userProfileInfo.additionalAgencies
                });
            } else {
              $state.go('user-management.home');
            }

          });
        };

        // $scope.searchUserModel={name:'Search for a user'}
        $scope.setUserNow = function (user) {
          $scope.userNow = user;
          $scope.searchUserModel = user.name;
          getUserProfile();
        };

        $scope.createUserSubmit = function (data, userRoleId, permissionGroupId) {
          // if ($state.current.name == 'user-management-create.three') {
          for (var item in data.userProfileInfo) {
            if (/Date/.test(item)) {
              data.userProfileInfo[item] = null;
            }
          }
          //parse AdditionalAgency
          // if (!data.userProfileInfo.additionalAgencies) {
          //   data.userProfileInfo.additionalAgencies = [];
          // }
          data.userProfileInfo.additionalAgencies = data.userProfileInfo.additionalAgencies || [];
          data.userProfileInfo.userRoleId = data.userProfileInfo.userRoleId || userRoleId;
          data.userProfileInfo.permissionGroupId = data.userProfileInfo.permissionGroupId || permissionGroupId;


          // ctrl.log('home:access permission === submit', data);

          if (!data.userProfileInfo.userRoleId) {
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: 'Please choose a correct user role .'
              });
            return false;
          }

          $rootScope.mainSpinner = true;
          CMSService.createUserWithPermissions(data).then(function (result) {
            // ctrl.setAction(true);

            $rootScope.mainSpinner = false;
            if (result.state == 'Success') {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'success',
                  text: 'User created!'
                });


              $state.go('user-management', {reload: true});
            } else {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: result.errorMessages[0]
                });
            }
          });

        }

        //getAvailableUserRolesAndPermissionGroups to user-access
        ;
        (function () {
          CMSService.getAvailableUserRolesAndPermissionGroups().then(function (value) {
            var res = {};
            res.groupNameWrapper = [];
            res.roleNameWrapper = value.userRoles;

            for (var i = 0; i < res.roleNameWrapper.length; i++) {
              for (var j = 0; j < res.roleNameWrapper[i].permissionGroupInfos.length; j++) {
                var obj = res.roleNameWrapper[i].permissionGroupInfos[j];
                obj.parent = res.roleNameWrapper[i].userRoleName;

                res.groupNameWrapper.push(obj);
              }
            }

            $scope.availableUserRolesAndPermissionGroups = res;
          });
        })();


      }])


})();
(function () {
  'use strict';

  angular.module('portalModule')

    .controller('createTwoController', ['$scope', '$rootScope', '$stateParams', 'UserManagementFactory', 'umCache',
      function ($scope, $rootScope, $stateParams, UserManagementFactory, umCache) {
        $scope.type = 'new';
        $rootScope.createUserStep = 2;
        $scope.userData = $stateParams.stepTwo;
        $scope.log = UserManagementFactory.devLog;

        $scope.log('create.two:init === createModel', umCache.get('createModel'));

      }])


})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('userCreateController', ['$scope', 'UserManagementFactory', function ($scope, UserManagementFactory) {
      $scope.log = UserManagementFactory.devLog;
      $scope.setAction = function (flg) {
        $scope.getUserDetailsAction = flg;
      };
      $scope.setAction(true);
    }]);

})();
/*
 * Created by Chris 2017.3.30
 * */
(function () {
  'use strict';
  angular.module('portalModule')
    .controller('userManagementController.dashboard', controller);

  controller.$inject = ['$scope', '$rootScope', 'CMSService', 'SecurityService',
    '$state', 'umCache', '$timeout'];
  function controller($scope, $rootScope, CMSService, SecurityService,
                      $state, umCache, $timeout) {

    var userDetails = umCache.get('reportUser');
    var allInOneBranch = umCache.get('allInOneBranch');

    if (!userDetails) {
      $state.go('user-management.home');
      return false;
    }

    //initiate the variable
    $scope.drowDownFlg = false;
    $scope.selectedReport = '';

    //every time visit the um dashboard page
    CMSService.getSubordinateUsers().then(function (value) {
      $scope.userData = value.allUsers;
      var userList = [];
      $scope.userObjList = [];
      for (var i = 0; i < $scope.userData.length; i++) {
        if ($scope.userData[i].hasReports == true) {
          userList.push($scope.userData[i].fullName);
          $scope.userObjList.push($scope.userData[i]);
        }
      }

      if ($rootScope.fromUrl == '/branch') {
        $rootScope.biUserId = '';
        $rootScope.biUserName = '';
        $rootScope.userNameLabel = '';
        $rootScope.biUserPhoto = '';
      } else {
        if (userDetails && userList.indexOf(userDetails.fullName) >= 0) {
          $rootScope.biUserId = userDetails.userId;
          $rootScope.biUserName = userDetails.fullName;
          $rootScope.userNameLabel = userDetails.fullName;
          $rootScope.biUserPhoto = userDetails.photoUrl;
        } else {
          $rootScope.biUserId = $scope.userData[0].userId;
          $rootScope.biUserName = $scope.userData[0].fullName;
          $rootScope.userNameLabel = $scope.userData[0].fullName;
          $rootScope.biUserPhoto = $scope.userData[0].photoUrl;
          umCache.put('reportUser', $scope.userData[0]);
        }

        CMSService.getPowerBiReportPermissions($rootScope.biUserId).then(function (value) {

          $rootScope.biUserPermissions = value.powerBiReportPermissions;
          $scope.reloadData();
        });
      }
    }, function (err) {
      console.debug(err);
      $rootScope.$broadcast('showMessage',
        {
          type: 'alert',
          text: 'Failed to get the user list.'
        });
    });

    //select different user to view dashboard
    $scope.userSelect = function (obj) {
      if (obj.isBranchUser) {
        umCache.put('allInOneBranch', {name: obj.branchName, iata: obj.iataNumber, accId: obj.accId});
      }
      $rootScope.biUserId = obj.userId;
      $rootScope.biUserName = obj.fullName;
      $rootScope.userNameLabel = obj.fullName;
      $rootScope.biUserPhoto = obj.photoUrl;

      umCache.put('reportUser', obj);

      CMSService.getPowerBiReportPermissions($rootScope.biUserId).then(function (value) {

        $rootScope.biUserPermissions = value.powerBiReportPermissions;
        //$state.go('user-management.dashboard');
        $state.go('user-management.dashboard', {step: obj.userId});
      })
    };

    $scope.reportSelect = function (report) {

      $scope.drowDownFlg = false;
      if ($scope.reportTabsNew.length > 3) {
        $scope.reportTabsNew.pop();
      }
      $scope.reportTabsNew.push(report);
      $scope.selectedTab = report.name;
      $scope.selectTab(report.name, report.displayName);
      $scope.selectedReport = report.displayName;
    };

    $scope.data = {};
    $scope.tab = $('#tab');
    $scope.tabContent = $('#tab-content');
    $scope.noData = $('#no-data');
    $scope.reportMenu = $('.single-pb-menu');
    $scope.showDetailButton = true;

    $scope.report = {
      element: $('div.powerbi-frame')
    };

    $scope.reloadData = function () {
      CMSService.getEmbeddedPowerBIReport($rootScope.biUserId).then(function (value) {

        if (value && value[0]) {
          var embedUrl = value[0].embedUrl;
          var accessToken = value[0].accessToken;
          $scope.report.embedUrl = embedUrl;
          $scope.report.accessToken = accessToken;
          $scope.report.accountId = value[0].AccountId;
          $scope.report.id = value[0].id;
        }
        else {
          $scope.noData.show();
          $scope.reportMenu.hide();
          $scope.report.element.hide();
        }
      });
    };

    $scope.onEmbedded = function (report) {

      $scope.report.instance = report;
      $scope.report.instance.on('loaded', function (event) {

        $scope.report.instance.updateSettings({
          filterPaneEnabled: false,
          navContentPaneEnabled: false
        });
        $scope.getReportPage();
      });
      $scope.report.instance.on('dataSelected', function (event) {

        $scope.dataObj = event.detail;
      });
      $scope.report.instance.on('pageChanged', function (event) {

        $scope.dataObj = {
          page: {
            displayName: event.detail.newPage.displayName,
            name: event.detail.newPage.name
          }
        };

        // Ryan : Hard coded to hide the button for this report
        // DF-00741
        // 20170221 : add custom label Sip_Config_Dashboard_Button
        try {
          //var name = event.detail.newPage.name;
          var displayName = event.detail.newPage.displayName;
          var tmpFlag = !($rootScope.currentUser.dashboard == 'PL_ABC_Summary' &&
          displayName == 'Earnings Summary');
          $scope.showDetailButton = !($rootScope.currentUser.dashboard == 'PL_ABC_Summary' && displayName == 'Earnings Summary');;
        }
        catch (ex) {
          console.debug(ex);
        }
      });
    };
    $scope.getReportPage = function () {
      $scope.report.instance.getPages().then(function (value) {
        $rootScope.mainSpinner = false;

        // get all pages in current pb frame
        var reportPages = value;
        $scope.reportTabs = [];
        $scope.reportTabsNew = [];
        $scope.reportTabsExtra = [];
        _.forEach(reportPages, function (r) {

          _.forEach($rootScope.biUserPermissions, function (p) {

            if (r.displayName.toUpperCase() == p) {
              $scope.reportTabs.push(r);
            }
          });
        });
        if ($scope.reportTabs.length <= 3) {
          $scope.reportTabsNew = $scope.reportTabs;
        }

        if ($scope.reportTabs.length > 3) {
          for (var i = 0; i < 3; i++) {
            $scope.reportTabsNew.push($scope.reportTabs[i]);
          }
          for (var j = 3; j < $scope.reportTabs.length; j++) {
            $scope.reportTabsExtra.push($scope.reportTabs[j]);
          }
        }

        if ($scope.reportTabs.length > 0) {
          $scope.noData.hide();
          $scope.reportMenu.show();
          $scope.report.element.show();
          $scope.selectedTab = $scope.reportTabs[0].name;
          $scope.report.instance.setPage($scope.reportTabs[0].name);
        }
        else {
          $scope.noData.show();
          $scope.reportMenu.hide();
          $scope.report.element.hide();
        }
        $scope.$apply();
      });
    };

    $scope.clickToPb = function () {

      $rootScope.backFlg = 'user management';
      $state.go('single-power-bi', {dataObj: $scope.dataObj});
    };

    $scope.goBackToUMHome = function () {
      $state.go('user-management.home', {dashboardViewUser: true});
      //$rootScope.goFromDashboard = true;
    }

    $scope.selectTab = function (name, displayName) {

      $scope.report.instance.setPage(name, displayName);

      // Ryan : Hard coded to hide the button for this report
      // DF-00741
      // 20170221 : add custom label Sip_Config_Dashboard_Button
      try {
        var tmpFlag = !($rootScope.currentUser.dashboard == 'PL_ABC_Summary' &&
        displayName == 'Earnings Summary');
        $scope.showDetailButton = !($rootScope.currentUser.dashboard == 'PL_ABC_Summary' && displayName == 'Earnings Summary');;
      }
      catch (ex) {
        console.debug(ex);
      }
    };

    //Initially reset header tabs status.
    $('.tab-branch')[0].classList.remove('slds-is-active');

  }
})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('userManagementController.fund', controller);

  controller.$inject = ['$state', 'CMSService', '$rootScope', '$stateParams', 'umCache', 'UserManagementFactory', '$scope'];
  function controller($state, CMSService, $rootScope, $stateParams, umCache, UserManagementFactory, $scope) {
    var vm = this;
    vm.fundObj = {};
    vm.isEditRecord = {};
    vm.log = UserManagementFactory.devLog;
    vm.rdoselect = 'Funds Expiring First';
    // vm.clickExpire = function (type) {
    //   vm.rdoselect=type;
    // }

    vm.totalM = {};
    vm.calculateTotal = function (tableData) {
      if (!(_.isArray(tableData))) return false;
      var resObj = {}
      var sum = function (arr, prop) {
        var total = 0
        for (var i = 0, _len = arr.length; i < _len; i++) {
          total += arr[i][prop]
        }
        return total
      };

      resObj['lifeAuthVal'] = sum(tableData, 'amountAuthorized');
      resObj['usedAmountVal'] = sum(tableData, 'amountUsed');
      resObj['expiredAmountVal'] = sum(tableData, 'fundsExpired');
      resObj['remainingBalanceVal'] = sum(tableData, 'remainingBalance');

      // console.log('calculateTotal', resObj);

      return resObj;

    };

    vm.manageAgencyFundAuthorization = function () {
      $rootScope.mainSpinner = true;

      CMSService.manageAgencyFundAuthorization().then(function (value) {
        $rootScope.mainSpinner = false;
        if (value.state == 'Success') {
          value.agencyFundAuthorization.agencyFundAuthorizationItems = value.agencyFundAuthorization.agencyFundAuthorizationItems.map(function (item) {
            item.changeVal = '';
            item.editType = '';

            return item;
          });


          vm.fundObj = value.agencyFundAuthorization;

          vm.totalM = vm.calculateTotal(value.agencyFundAuthorization.agencyFundAuthorizationItems);
        }


      })
    };

    vm.orderByValue = ['-travelAmenitiesAccess', '-remainingBalance', '-amountAuthorized', '-amountUsed', '-fundsExpired']
    vm.setOrderFunc = function (typeVal) {

      if (typeVal == vm.orderByValue) {
        vm.orderReverse = !vm.orderReverse;
        return;
      }
      $scope.orderReverse = false;
      vm.orderByValue = typeVal;
    }
    vm.editAmount = function (record, type) {
      vm.rdoselect = 'Funds Expiring First';
      vm.isEditRecord = record;

      if (record.editType == type) {
        record.editType = '';
        return false;
      }
      record.editType = type;

    };

    vm.parseAmountNumber = function (val) {
      val = parseFloat(val)
      val = val.toFixed(2)
      return val
    }
    vm.checkAmount = function (changeVal) {
      if (!changeVal) {
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Please type a correct number in the blank .'
          });
        return false;
      }
      return true;
    }
    vm.addAmount = function (record) {
      record.changeVal = vm.parseAmountNumber(record.changeVal)
      if (!vm.checkAmount(record.changeVal)) {
        return false;
      }

      $rootScope.mainSpinner = true;
      CMSService.updateAmount(record.aorAccountId, '+' + record.changeVal, vm.rdoselect)
        .then(function (value) {
          $rootScope.mainSpinner = false;
          if (value.state == 'Success') {
            vm.manageAgencyFundAuthorization();
          } else {
            record.changeVal = 0;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: value.errorMessages[0]
              });
          }
        })
    };
    vm.removeAmount = function (record) {
      record.changeVal = vm.parseAmountNumber(record.changeVal)
      // record.changeVal = parseFloat(record.changeVal)
      // record.changeVal = record.changeVal.toFixed(2)

      if (!vm.checkAmount(record.changeVal)) {
        return false;
      }

      // if (!/e/.test(record.changeVal)) {
        $rootScope.mainSpinner = true;
      CMSService.updateAmount(record.aorAccountId, '-' + record.changeVal, vm.rdoselect)
        .then(function (value) {
          $rootScope.mainSpinner = false;
          if (value.state == 'Success') {
            vm.manageAgencyFundAuthorization();
          } else {
            record.changeVal = 0;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: value.errorMessages[0]
              });
          }
        })
      // }
    };

    // vm.changeTravelAmenitiesAccess = function (el) {
    //   $rootScope.mainSpinner = true;
    //   CMSService.updateTravelAmenitiesAccess({
    //     'aorAccountId': el.aorAccountId,
    //     'travelAmenitiesAccess': el.travelAmenitiesAccess
    //   }).then(function (value) {
    //     $rootScope.mainSpinner = false;
    //     if (value.state == 'Fail') {
    //       $state.reload();
    //     }
    //   })
    // }

    // $scope.$watch('vm.fundObj',function (newVal) {
    //   debugger
    // },true)


    vm.manageAgencyFundAuthorization();

  }

})();
(function () {
  'use strict';
  angular.module('portalModule')
    .controller('userManagementController.home', controller)

  controller.$inject = ['$scope', '$rootScope', '$state', '$stateParams', 'CMSService', '$timeout', 'umCache', 'UserManagementFactory'];
  function controller($scope, $rootScope, $state, $stateParams, CMSService, $timeout, umCache, UserManagementFactory) {
    $scope.userNow = {};
    $scope.generalNum = 1;
    $scope.currentUser = '';
    $scope.userFilterDrop = '';
    $scope.selectorType = '';
    $scope.profileData = {};
    $scope.airportsList = [];
    $scope.availableUserRolesAndPermissionGroups = {};
    $scope.tabTarget = 1;
    $scope.selectedBranch = null;
    $scope.editFlg = false;
    $scope.hasBranch = true;
    $scope.hasAgencies = true;    //DF-00359
    $scope.commonAlertMsg = 'Are you sure?';
    $scope.commonFunc = null;
    $scope.modalFlg = '';
    $scope.backupProfileData = null;
    $scope.massArcNumber = '';
    $scope.massUploadBtnText = 'Upload';
    $scope.previewFileName = '';
    $scope.actionBtnName = '';
    $scope.log = UserManagementFactory.devLog;

    var userDataFixed = [];

    //clear cache from create new user
    umCache.put('createModel', null);
    $scope.log('home:global current user === ', $rootScope.currentUser);

    //new version logic of select one branch from branch location
    if (umCache.get('allInOneBranch')) {

      $timeout(
        function () {
          $('.tab-my')[0].classList.remove('slds-is-active');
          $('.tab-branch')[0].classList.add('slds-is-active');
        }
      )


      var branchInfo = umCache.get('allInOneBranch');
      $scope.selectedBranch = {
        name: branchInfo.name,
        iata: branchInfo.iata,
        accId: branchInfo.accId
      };
      $scope.log('home:manage one branch', $scope.selectedBranch);


    } else {
      //In Branch View we should remove the underline for Branch Location Manually!!!
      $('.tab-branch')[0].classList.remove('slds-is-active');
    }


    $scope.getUserListFunc = function (doNotSet) {
      $rootScope.mainSpinner = true;
      var accId = $scope.selectedBranch ? $scope.selectedBranch.accId : '';

      CMSService.getUserList(accId).then(function (value) {
        if (accId == '') {
          $scope.hasBranch = value.hasBranch;
        } else {
          $scope.hasBranch = true;
        }

        $scope.hasAgencies = value.hasAgencies;
        console.debug('hasAgencies', value.hasAgencies);


        if (!value.allUsers.length) {
          //Empty UserList Empty UserNow No UserDetailNow
          $scope.userData = [];
          console.error('No Users from um.home');
          if ($scope.selectedBranch['iata']) {
            var core = umCache.get('userDetails');
            core.userProfileInfo.arcNumber = $scope.selectedBranch['iata'];
            umCache.put('userDetails', core);
          }

          $rootScope.mainSpinner = false;
          return false
        }
        if (value && value.state == 'Success') {
          $scope.convertAllUsers(value.allUsers, function (resObj) {
            $scope.userData = resObj;
            userDataFixed = resObj;

            if (!doNotSet) {
              $scope.setUser(resObj[0]);
            } else {
              var newUserNow = resObj.find(function (item) {
                return item.userId == $scope.userNow.userId
              });
              $scope.setUser(newUserNow);
            }

            $scope.setUserFilterDrop('All Users', 0);
          });
        } else {
          console.error('Get user list failed', value)
        }

      });

    };

    $scope.getUserDetails = function (obj) {
      if (!obj) {
        return false;
      }

      $rootScope.mainSpinner = true;
      CMSService.getUserDetails(obj.active == 2 ? 'registration' : 'user', obj.userId || obj.registrationId).then(function (value) {
        $scope.log('home: userDetails string === ', value);
        if (!(angular.isUndefined(value.value))) {
          value = JSON.parse(value.value);
        }
        $scope.log('home: userDetails === ', value);
        $rootScope.mainSpinner = false;

        if (value && value.state == "Success") {
          umCache.put('userDetails', value.userDetails);

          $scope.backupProfileData = angular.copy(value.userDetails);
          $scope.userDetails = value.userDetails;
        } else {
          console.error('getUserDetails error', value);
        }

      });

    };

    $scope.setTabInit = function () {
      if ('profileName' in $rootScope.currentUser) {
        switch ($rootScope.currentUser.profileName) {
          case $rootScope.PROFILE_TYPE.agent:
            $scope.tabTarget = 1;
            break;
          case $rootScope.PROFILE_TYPE.corp:
            if ($scope.selectorType == '') {
              $scope.tabTarget = 1;
            } else {
              $scope.tabTarget = 4;
            }
            break;
          case  $rootScope.PROFILE_TYPE.agtMgr:
            $scope.tabTarget = 1;
            break;
        }
        // $scope.$apply();
      } else {
        console.error('$rootScope.currentUser.profileName ERROR!!!')
        return false;
      }
    };
    $scope.clickTab = function (num) {
      $scope.tabTarget = num;
      $scope.editFlg = false;
      //reset form value
      $scope.userDetails = angular.copy($scope.backupProfileData);

    };
    $scope.setUser = function (obj) {
      $scope.editFlg = false;
      $scope.userNow = obj;

      $scope.getUserDetails($scope.userNow);


      umCache.put('reportUser', $scope.userNow);
      CMSService.getPowerBiReportPermissions($scope.userNow.userId).then(function (value) {

        $rootScope.biUserPermissions = value.powerBiReportPermissions;
      });

      //step two: Set the visibility of the buttons in userProfile component
      //step two: Set current tab
      switch (parseInt(obj.active)) {
        case 0:
        case 1:
          $scope.btnShowUserProfile = {submit: true, cancel: true, approve: false, reject: false, edit: true};
          break;
        case 2:
          $scope.tabTarget = 1;
          $scope.btnShowUserProfile = {submit: false, cancel: false, approve: true, reject: true, edit: false};
          break;
        case 3:
          $scope.btnShowUserProfile = {submit: true, cancel: true, approve: false, reject: false, edit: true};
          break;
      }
    };

    $scope.setUserFilterDrop = function (str, isCrop) {
      if (isCrop == 1) {
        $scope.userFilterDropCrop = str;
      } else {
        $scope.userFilterDrop = str;
      }

      switch (str) {
        case 'All Users':
          // $scope.userData = userDataFixed;

          // console.log('$scope.userData..', $scope.userData);

          $scope.userData = userDataFixed.filter(function (item, index, list) {
            // need to add filter when $scope.selectedBranch != null
            if ($scope.selectedBranch != null) {
              return item.iataNumber == $scope.selectedBranch.iata;
            } else {
              return item;
            }
          });
          break;
        case 'Active Users':
          $scope.userData = userDataFixed.filter(function (item) {
            if ($scope.selectedBranch != null) {
              return item.active == 1 && item.iataNumber == $scope.selectedBranch.iata;
            } else {
              return item.active == 1;
            }
          });
          break;
        case 'Pending Users':
          $scope.userData = userDataFixed.filter(function (item) {
            if ($scope.selectedBranch != null) {
              return item.active == 2 && item.iataNumber == $scope.selectedBranch.iata;
            } else {
              return item.active == 2;
            }
          });
          break;
        case 'Inactive Users':
          $scope.userData = userDataFixed.filter(function (item) {
            if ($scope.selectedBranch != null) {
              return item.active == 0 && item.iataNumber == $scope.selectedBranch.iata;
            } else {
              return item.active == 0;
            }
          });
          break;
        case 'Locked Users':
          $scope.userData = userDataFixed.filter(function (item) {
            if ($scope.selectedBranch != null) {
              return item.active == 3 && item.iataNumber == $scope.selectedBranch.iata;
            } else {
              return item.active == 3;
            }
          });
          break;
      }
    };
    $scope.setUserState = function (obj, flg) {
      $('#alert-modal-common').modal('hide');
      $rootScope.mainSpinner = true;

      CMSService[flg](obj.userProfileInfo.userId).then(function (value) {
        $rootScope.mainSpinner = false;

        if (value.state == "Success") {
          $rootScope.$broadcast('showMessage',
            {
              type: 'success',
              text: 'Operation completed successfully!'
            });
          $timeout(function () {
            $scope.getUserListFunc(true);
          }, 2000);
        } else {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.errorMessages[0]
            });
        }

      });

    };
    $scope.setCommonAlertMsg = function (str) {
      $scope.commonAlertMsg = str;
    };


    $scope.assignCommonOkFunc = function (str) {
      switch (str) {
        case "lockUser":
        case "rejectUser":  //not in use
        case "deactivateUser":
        case "activateUser":
        case "unLockUser":
        case "resetPsd":
          $scope.commonFunc = $scope.setUserState;
          $scope.modalFlg = str;

          break;
        case 'duplicatedEmail':
          $scope.commonFunc = $scope.userProSubmit;
          $scope.actionBtnName = "ignore";
          $scope.modalFlg = 'duplicatedEmail';
          break;
      }

      $scope.log('home:assignCommonOkFunc === function', $scope.commonFunc);
      $scope.log('home:assignCommonOkFunc === modal flag', $scope.modalFlg);
      $scope.log('home:assignCommonOkFunc === button text', $scope.actionBtnName);
    };


    $scope.modalCancel = function () {
      $scope.actionBtnName = "";
    };
    $scope.userProSubmit = function (data, modalFlg) {
      $rootScope.mainSpinner = true;

      $scope.actionBtnName = $scope.actionBtnName == 'ignore' ? 'ignore' : 'submitProfile';

      $scope.validateUserProfileInfo(function (value) {
        $rootScope.mainSpinner = false;
        if (value.errorMessages || value == null) {

          $scope.setCommonAlertMsg(value.errorMessages[0]);
          $scope.assignCommonOkFunc('duplicatedEmail');
          $('#alert-modal-common').modal();

        } else {

          // console.log('updateUserProfile params', data);


          for (var item in data.userProfileInfo) {
            if (/Date/.test(item)) {
              data.userProfileInfo[item] = null;
            }
          }

          $rootScope.mainSpinner = true;

          //sync airports DF-00802
          if (!(data.userProfileInfo.primaryAirportId && data.userProfileInfo.primaryAirport)) {
            data.userProfileInfo.primaryAirportId = '';
            data.userProfileInfo.primaryAirport = '';
          }

          $scope.log('home:userProSubmit === passed submit validation', data);
          CMSService.updateUserProfile(data.active == 2 ? 'registration' : 'user', data.userProfileInfo)
            .then(function (value) {
              $rootScope.mainSpinner = false;

              if (value && value.state == "Success") {

                $rootScope.$broadcast('showMessage',
                  {
                    type: 'success',
                    text: 'User profile updated successfully!'
                  });

                $timeout(function () {
                  $scope.getUserListFunc(true);
                  $scope.log('home:userProSubmit === callback success re-get user-list', '');
                }, 2000);
              } else {
                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: value.errorMessages[0]
                  });
              }

            });
        }
      });
    };


    /*
     * Utils
     * */
    $scope.convertAllUsers = function (rawObj, cb) {
      if (!rawObj) {
        return false;
      }
      rawObj.map(function (item) {
        item['name'] = item['fullName'];
        item['persona'] = item['title'];
        item['active'] = item['status'];

        //todo...use status to check user Id or registrationId
        if (item['userId'] == null) {
          item['id'] = item['registrationId'];
        } else {
          item['id'] = item['userId'];
        }
        item['imgUrl'] = item['photoUrl'];
      });
      cb(rawObj);
    };
    $scope.validateUserProfileInfo = function (callback) {
      CMSService.validateUserProfileInfo({
        'email': $scope.userDetails.userProfileInfo.email,
        'arcNumber': $scope.userDetails.userProfileInfo.arcNumber,
        'username': $scope.userDetails.userProfileInfo.username,
        'userId': $scope.userDetails.userProfileInfo.userId,
        'actionName': $scope.actionBtnName
      }).then(function (value) {
        $rootScope.mainSpinner = false;
        if (value.state == 'Success') {
          callback && callback(value);
        } else {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.errorMessages[0]
            });
        }

      });
    };
    $scope.goToUserMain = function () {

      $scope.selectedBranch = null;
      $scope.getUserListFunc();
      // $scope.userData = userDataFixed;
      $state.go('user-management.home');
    };
    $scope.refreshAll = function () {
      $scope.getUserListFunc();
    };


    /*
     * UI related
     * */
    $scope.showAlertModal = function (flg) {

      // var needValidation = false;
      $scope.actionBtnName = flg;
      // if (flg == 'activateUser') {
      //   needValidation = true;
      // }

      $scope.validateUserProfileInfo(function (value) {
        if (value.errorMessages) {
          $scope.setCommonAlertMsg(value.errorMessages[0]);
        } else {
          $scope.setCommonAlertMsg("Are you sure?");
        }
        $scope.assignCommonOkFunc(flg);
        $('#alert-modal-common').modal();


      });
    };

    $scope.userAccessSubmit = function (data, userRoleId, permissionGroupId) {

      // if ($state.current.name == 'user-management.home') {

      $rootScope.mainSpinner = true;
      for (var item in data.userProfileInfo) {
        if (/Date/.test(item)) {
          data.userProfileInfo[item] = null;
        }
      }
      $scope.log('home:access permission === submit', data);
      data.userProfileInfo.userRoleId = userRoleId;
      data.userProfileInfo.permissionGroupId = permissionGroupId;
      CMSService.saveUserPermissions(data).then(function (result) {

        $rootScope.mainSpinner = false;
        if (result.state == 'Success') {
          $scope.editFlg = false;

          $rootScope.$broadcast('showMessage',
            {
              type: 'success',
              text: 'User access updated successfully!'
            });
          angular.extend($scope.userNow, data.userProfileInfo);
          // $timeout(function () {
            $scope.getUserDetails($scope.userNow);
          // }, 3000)

          // $state.go('user-management');
        } else {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: result.errorMessages[0]
            });

        }
      });
      // }
    };

    $scope.setTabInit();

    if ($stateParams.dashboardViewUser) {
      $scope.userNow = umCache.get('reportUser');
      $scope.getUserListFunc(true);
    } else {
      $scope.getUserListFunc();
    }

    var allDataGotCount = 0;
    $scope.bindOtherData = function () {
      $scope.airportsList = umCache.get('airports');
      $scope.countriesList = umCache.get('countries');
      $scope.countryName = $scope.countriesList[0];
      $scope.availableUserRolesAndPermissionGroups = umCache.get('availableUserRolesAndPermissionGroups');
    };


    // if ($scope.$parent.vm.allDataGot >= 6) {
    if (umCache.get('airports') && umCache.get('countries') && umCache.get('availableUserRolesAndPermissionGroups')) {
      //from other page to um.home page
      $scope.bindOtherData();
    }
    $scope.$on('allDataGot', function (event, data) {
      //from um related pages to um.home page
      allDataGotCount++;
      // if (allDataGotCount >= 6) {
      if (umCache.get('airports') && umCache.get('countries') && umCache.get('availableUserRolesAndPermissionGroups')) {
        $scope.bindOtherData();
      }
    });

    $scope.$on('editFlg', function (event, data) {
      //will be used
      $scope.editFlg = data;
    });


  }
})();
(function () {
  "use strict";

  angular.module('portalModule')
    .component('userProfileComponent', {
      templateUrl: 'Sip_UserManagement_ProfileCompTemplate',
      controller: controller,
      bindings: {
        data: '=',
        btnShow: '=',
        airportsList: '=',
        countriesList: '=',
        submit: '&',
        editFlg: '=',
        imgBlob: '=',
        refresh: '&'
      }
    });

  controller.$inject = ['$state', 'CMSService', '$rootScope', 'UserManagementFactory', 'formPattern'];
  function controller($state, CMSService, $rootScope, UserManagementFactory, formPattern) {
    var CTRL = this;
    CTRL.log = UserManagementFactory.devLog;
    CTRL.formPattern = formPattern;
    CTRL.addressLabel = (function () {
      var str = "Same As Agency's Address";
      if ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp) {
        str = "Same as Company's Address";
      }
      return str;
    })();

    CTRL.editFlg = false;
    CTRL.clickApprove = function () {
      $("#alert-modal-approve").modal();
    };

    // CTRL.mailEditable=false;

    CTRL.cancelEdit = function () {
      CTRL.editFlg = !CTRL.editFlg;
      CTRL.data = CTRL.backupData;

      //quick fix : better to remove in phase 3
      if (!CTRL.data.userProfileInfo.alternateEmail) {
        CTRL.data.userProfileInfo.alternateEmail = null
      }
      if (!CTRL.data.userProfileInfo.cellPhone) {
        CTRL.data.userProfileInfo.cellPhone = null
      }
    };
    CTRL.clickEdit = function () {
      //set a backup
      CTRL.backupData = angular.copy(CTRL.data);
      CTRL.editFlg = !CTRL.editFlg;
    };
    CTRL.clickReject = function () {
      $("#alert-modal-reject").modal();
    };

    //deprecated
    // CTRL.validateUsername = isValidation;
    // CTRL.isValidation = isValidation;


    CTRL.setCountry = function (value) {
      CTRL.data.userProfileInfo.maillingCountry = value;
    }

    CTRL.confirmApprove = function () {

      $('#alert-modal-approve').modal('hide');

      setTimeout(function () {
        $state.go('user-management-create.one', {needBinding: true});
      }, 1000);

    };


    // CTRL.confirmReject = function () {
    //   CTRL.refresh();
    // }
    CTRL.confirmReject = function () {
      $('#alert-modal-reject').modal('hide');
      var registrationId = CTRL.data.userProfileInfo.registrationId;
      CMSService.rejectUser(registrationId).then(function (value) {
        // console.log('reject user', value);
        if (value.state == 'Success') {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'User has been rejected.'
            });
          //todo...refresh userlist and userdetail
          CTRL.refresh();

        } else {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.errorMessages[0]
            });

        }
      })
    }

    $(document).on('click', '#input-save-as-agency', function () {


      $rootScope.mainSpinner = true;
      // console.log('123');
      var arcNumber = CTRL.data.userProfileInfo.arcNumber;

      var billing = {};

      if ($("#input-save-as-agency").is(':checked')) {
        // console.log('yes')
        CMSService.getAgencyAddress(arcNumber).then(function (value) {
          // console.log('billing', value.agencyAddress);
          billing = value.agencyAddress;
          CTRL.data.userProfileInfo.maillingCity = billing.billingCity;
          CTRL.data.userProfileInfo.maillingCountry = billing.billingCountry;
          CTRL.data.userProfileInfo.maillingPostalCode = billing.billingPostalCode;
          CTRL.data.userProfileInfo.maillingState = billing.billingState;
          CTRL.data.userProfileInfo.maillingStreet = billing.billingStreet;
          $rootScope.mainSpinner = false;
        });

        // console.log('userObj', CTRL.data);
      } else {
        // console.log('no');
        // console.log('CTRL.backupData.agencyAddress', CTRL.backupData);
        /*          CTRL.data.userProfileInfo.maillingCity = CTRL.backupData.userProfileInfo.maillingCity;
         CTRL.data.userProfileInfo.maillingCountry = CTRL.backupData.userProfileInfo.maillingCountry;
         CTRL.data.userProfileInfo.maillingPostalCode = CTRL.backupData.userProfileInfo.maillingPostalCode;
         CTRL.data.userProfileInfo.maillingState = CTRL.backupData.userProfileInfo.maillingState;
         CTRL.data.userProfileInfo.maillingStreet = CTRL.backupData.userProfileInfo.maillingStreet;*/
        // console.log('userObj', CTRL.data);
        $rootScope.mainSpinner = false;
      }
    })

    // this.$onChanges=function (changeObj) {
    // //   console.log(changeObj);
    // }

    CTRL.airportSuggestList = [];
    CTRL.setAirports = function (event) {
      var el = event.target,
        val = el.value,
        keyCode = event.keyCode;

      // uncomment if it is needed
      if (val.length < 1) return false;
      CTRL.airportSuggestList = (CTRL.queryAirport(val, CTRL.airportsList)).slice(0, 100);

    };
    CTRL.queryAirport = function (kw, list) {
      var reg = new RegExp(kw.toLowerCase());
      return list.filter(function (value) {
        return reg.test(value['name'].toLowerCase());
      })
    };
    CTRL.showDropDown = function (event) {
      $(event.target).siblings('ul').dropdown('toggle')
    }
  }

})();
(function () {
  angular.module('portalModule')
    .component('umSubTitle', {
      bindings: {
        page: '@',
        reportBranches: '=',
        branchTitle: '=',
        branchAll: '='
      },
      templateUrl: 'Sip_UserManagement_SubTitleCompTemplate',
      controller: ['CMSService', 'UserManagementFactory', '$state', '$rootScope', 'UserManagementFactory', 'umCache','$window', function (CMSService, UserManagementFactory, $state, $rootScope, UserManagementFactory, umCache,$window) {
        var ctrl = this;
        ctrl.UserManagementFactory = UserManagementFactory;
        ctrl.log = UserManagementFactory.devLog;
        // ctrl.$state = $state;
        ctrl.exportReport = function () {
          switch (ctrl.page) {
            case 'home':
              //in corp user
              if ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp) {
                ctrl.exportUserManagementReportByType('my');
                return;
              }

              if (ctrl.branchTitle) {
                //Selected branch
                ctrl.exportUserManagementReportByArcNumbers([ctrl.branchTitle.iata]);
              } else {
                //my location
                $rootScope.mainSpinner = true;
                CMSService.getUserManagementBasicVariable().then(function (value) {
                  $rootScope.mainSpinner = false;
                  if (value.hasBranch) {
                    //If the user has't branch info , it will download the report for itself.
                    $('#alert-modal-report').modal();
                  } else {
                    ctrl.exportUserManagementReportByType('my');
                  }

                })
              }
              break;
            case 'branch':
              if (ctrl.branchAll) {
                ctrl.exportUserManagementReportByType('branches');
              } else {
                if (ctrl.reportBranches.length > 0) {
                  var idList = ctrl.reportBranches.map(function (item) {
                    return item.iataNumber;
                  });
                  ctrl.exportUserManagementReportByArcNumbers(idList);
                }
              }
              break;
          }

        }


        ctrl.showMassUpload = function () {
          if (ctrl.page === 'branch') {
            if (ctrl.reportBranches.length == 0) {
              $('#alert-modal-massupload').modal();
            }
          } else {
            $('#alert-modal-massupload').modal();
          }
        };

        ctrl.back = function () {
          //clear one branch
          umCache.put('allInOneBranch', null);

          $state.go('user-management.branch');
        };

        ctrl.exportUserManagementReportByArcNumbers = function (arrIata) {
          $rootScope.mainSpinner = true;
          CMSService.exportUserManagementReportByArcNumbers(arrIata).then(function (value) {
            $rootScope.mainSpinner = false;

            if (value.state == 'Fail') {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.errorMessages[0]
                });
              return;
            }

            $window.open(value.userManagementReportUrl,'_self');
          })
        };
        ctrl.exportUserManagementReportByType = function (strType) {
          $rootScope.mainSpinner = true;
          strType && CMSService.exportUserManagementReportByType(strType).then(function (value) {
            $rootScope.mainSpinner = false;

            if (value.state == 'Fail') {
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.errorMessages[0]
                });
              return;
            }

            $window.open(value.userManagementReportUrl,'_self');
          })
        };

        ctrl.createNew = function () {

          if (ctrl.page === 'branch') {
            ctrl.reportBranches.length == 0 && $state.go('user-management-create.one');
          } else {
            $state.go('user-management-create.one');
          }

        }


      }
      ]
    })

})();


(function () {
  'use strict';
  angular.module('portalModule')
    .controller('userManagementController', controller)
    .factory('umCache', function ($cacheFactory) {
      return $cacheFactory('umCache');
    })
    .component('massUploaderComp', {
      transclude: true,
      bindings: {
        arcNumber: '<'
      },
      templateUrl: 'massUploadTempl.html',
      controller: ['$rootScope', 'dataURLtoBlobService', '$scope', 'CMSService', '$state', function ($rootScope, dataURLtoBlobService, $scope, CMSService, $state) {
        // $rootScope.mainSpinner = true;
        var CTRL = this;
        CTRL.massUploadBtnText = 'Upload';
        CTRL.csvBlob = '';
        CTRL.previewFileName = '';
        CTRL.resetMass = function () {
          $('#massFile').val('');
          CTRL.previewFileName = '';
          CTRL.csvBlob = '';
          CTRL.massUploadBtnText = 'Upload';
        };
        CTRL.$onChanges = function (changeObj) {
          if (changeObj && changeObj['arcNumber']) {
            CTRL.arcNumber = changeObj['arcNumber']['currentValue'];
            if (CTRL.arcNumber) {
              CTRL.massArcNumber = CTRL.arcNumber;
              // CTRL.massArcNumber = '<span class="bold">'+CTRL.arcNumber+'</span>';
            } else {
              CTRL.massArcNumber = '';
            }
          }
        };
        CTRL.$onInit = function (data) {

        };
        CTRL.clickLookUp = function () {
          document.querySelector('#massFile').click()
        };
        CTRL.uploadMass = function () {
          // https://unitedairlines--phase2dev--c.cs26.visual.force.com/resource/Sip_MassUploadUser_Template
          if (!CTRL.csvBlob) {
            document.querySelector('#massFile').click()
            return false;
          }

          $('#alert-modal-massupload').modal('hide');

          $rootScope.mainSpinner = true;
          CMSService.massUploadUser(CTRL.csvBlob.imgBlob, CTRL.arcNumber).then(function (value) {
            $rootScope.mainSpinner = false;
            if (value.state == "Success") {
              var errorMsg = value.uploadUserResults;
              $state.go('user-management-mass-result', {
                errorObj: errorMsg,
                arcNumber: CTRL.arcNumber
              });
            } else {
              CTRL.resetMass();
              $rootScope.$broadcast('showMessage',
                {
                  type: 'alert',
                  text: value.errorMessages[0]
                });
            }
          });
        };
        CTRL.previewCsv = function (elem) {
          if (!elem.files) {
            return false;
          }
          var reader = new FileReader();
          var uploadFile = elem.files[0];
          CTRL.previewFileName = uploadFile.name;
          if (!(false || !!document.documentMode)) {
            $scope.$apply();
          }


          reader.readAsDataURL(uploadFile);

          $rootScope.mainSpinner = true;
          reader.onload = function (evt) {
            $rootScope.mainSpinner = false;
            // $scope.prevUrl = evt.target.result;
            var blob = dataURLtoBlobService(evt.target.result);
            var type = blob.type;
            var imgBlob = evt.target.result.split(',')[1] ? evt.target.result.split(',')[1] : '';

            CTRL.csvBlob = {
              imgBlob: imgBlob,
              type: type
            };

            // uncomment it if you want change button text
            // CTRL.massUploadBtnText = "Ok";

            if (!(false || !!document.documentMode)) {
              $scope.$apply();
            }
          }
        };
      }]
    });

  controller.$inject = ['$scope', '$rootScope', '$state', 'UserManagementFactory', 'CMSService', '$timeout', 'umCache'];

  function controller($scope, $rootScope, $state, UserManagementFactory, CMSService, $timeout, umCache) {
    var vm = this;
    vm.basicVal = {};
    vm.redirectUtil = UserManagementFactory.redirectUtil;
    vm.log = UserManagementFactory.devLog;
    // vm.viewType='';

    vm.mobileMenuShow = false;

    vm.jumpHome = function () {
      //clear one branch
      umCache.put('allInOneBranch', null);
      $state.go('user-management.home', {}, {reload: true});

      // vm.redirectUtil('home');
    };

    if ($state.current.name == 'user-management') {
      //   // if ($rootScope.currentUser.profileName == $rootScope.PROFILE_TYPE.corp) {
      //   //   vm.redirectUtil('fund');
      //   // } else {
      $state.go('user-management.home');
      //   // }
    }

    //To collect main data model from all um pages
    vm.umStatus = {
      agencyNow: {},
      userNow: {},
      branchNow: {}
    };


    vm.allDataGot = 0;

    $scope.$on('changeAgency', function (event, data) {

      vm.umStatus['agencyNow'] = data;
      // console.log('um agencyNow', data);
    });
    $scope.$on('changeUser', function (event, data) {
      vm.umStatus['userNow'] = data;
      // console.log('um userNow', data);
    });
    $scope.$on('changeBranch', function (event, data) {
      vm.umStatus['branchNow'] = data;
      // console.log('um branchNow', data);
    });

    //show spinner when ajax global resources are loading
    $rootScope.mainSpinner = true;
    $timeout(function () {
      if ($rootScope.mainSpinner == true) {
        $rootScope.mainSpinner = false;
      }
    }, 4000);


    //#1 getCountries
    (function () {
      $timeout(function () {
        CMSService.getCountries().then(function (value) {
          if (!value.countries) {
            return false;
          }
          umCache.put('countries', value.countries);

          //如果直接进入 manage user页面，使用此事件计数.
          $scope.$broadcast('allDataGot');

          //如果先进入非 manage user 页面，使用此计数器 判断数据完整性
          vm.allDataGot++;

          vm.log('got countries', '');
        })
      }, 2000)
    })();

    //#2 getAirports
    (function () {
      $timeout(function () {
        CMSService.getAirports().then(function (value) {
          if (value && value.state == "Success") {
            // $scope.airportsList = value.airports;
            umCache.put('airports', value.airports);
            $scope.$broadcast('allDataGot');
            vm.allDataGot++;
            vm.log('got airports', '');
          } else {
            console.error('getAirports failed', value);
          }
        });
      }, 3000)
    })();

    //#3 getAvailableUserRolesAndPermissionGroups
    (function () {
      CMSService.getAvailableUserRolesAndPermissionGroups().then(function (value) {
        if (value && value.state == "Success") {
          var res = {};
          res.groupNameWrapper = [];
          res.roleNameWrapper = value.userRoles;

          for (var i = 0; i < res.roleNameWrapper.length; i++) {
            for (var j = 0; j < res.roleNameWrapper[i].permissionGroupInfos.length; j++) {
              var obj = res.roleNameWrapper[i].permissionGroupInfos[j];
              obj.parent = res.roleNameWrapper[i].userRoleName;
              res.groupNameWrapper.push(obj);
            }
          }

          umCache.put('availableUserRolesAndPermissionGroups', res);
          $scope.$broadcast('allDataGot');
          // $scope.availableUserRolesAndPermissionGroups = res;
          vm.log('got availableUserRolesAndPermissionGroups', '');
        }

      });
    })();

    //#4 getBranchLocation
    (function () {
      $timeout(function () {
        CMSService.getBranchLocation().then(function (value) {
          // $rootScope.mainSpinner = false;
          if (value && value.state == "Success") {
            umCache.put('getBranchLocation', value.branches);
            $scope.$broadcast('allDataGot');
            vm.allDataGot++;
            vm.log('got BranchLocation', '');
          }
        });
      }, 300);
    })();

    //#5 getCorpAgencies
    (function () {
      CMSService.getCorpAgencies().then(function (value) {
        // $rootScope.mainSpinner = false;
        if (value && value.state == "Success") {
          umCache.put('getCorpAgencies', value.myAgencies);

          $scope.$broadcast('allDataGot');
          vm.allDataGot++;
          vm.log('got CorpAgencies', '');
        }
      });
    })();

    //#6 getAvailableARCNumbers
    // (function () {
    //   CMSService.getAvailableARCNumbers().then(function (value) {
    //     // $rootScope.mainSpinner = false;
    //     if (value && value.state == "Success") {
    //       umCache.put('getAvailableARCNumbers', value);
    //
    //       $scope.$broadcast('allDataGot');
    //       vm.allDataGot++;
    //       // $scope.branchList = value.branches;
    //     }
    //   });
    // })();


    (function () {
      CMSService.getUserManagementBasicVariable().then(function (value) {
        vm.basicVal = value;
        vm.log('got UserManagementBasicVariable', '');

        //hard code!!!!
        // vm.basicVal.viewUserDashboard = true;
      });
    })();


    return vm;

  }


})();


(function () {
  'use strict';

  angular.module('portalModule')
    .controller('viewTicketController', controller);

  controller.$inject = ['$scope', '$rootScope', 'CMSService', '$stateParams', '$state'];
  function controller($scope, $rootScope, CMSService, $stateParams, $state) {
    $scope.ticketsList = [];

    $scope.setShowNum = function (event) {
      if (event) {
        if (event.keyCode != 13) {
          return false;
        }
      }

      if ($scope.numType.length != 13) {
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Ticket number must be 13 characters long.'
          });
        return false;
      }
      if (!/^[0-9]*$/.test($scope.numType)) {
        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Ticket number must be 13 characters long.'
          });
        return false;
      }

      getTicketInfo($scope.numType);


    };

    $scope.setAction = function (flg) {
      $scope.getUserDetailsAction = flg;
    };

    function getTicketInfo(num) {
      var currentUserId = '';
      if($rootScope.currentUser){
        currentUserId = $rootScope.currentUser.Id;
      }
      $scope.setAction(false);
      CMSService.getTicketInfo(num, currentUserId).then(function (value) {
        // $scope.getUserDetailsAction = true;
        $scope.setAction(true);
        if (value.state == 'Success') {
          // debugger
          $scope.ticketsList = value.tickets;

        } else {
          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: value.message
            });
        }
      })
    }

    $scope.setNextShow = function (e) {
      e.target.nextElementSibling.classList.add('on');
    };
    $scope.setHide = function (e) {
      e.target.nextElementSibling.classList.remove('on');
    };

    if ($stateParams.searchVal != null) {
      $scope.numType = $stateParams.searchVal;
      $scope.setShowNum();
    }else {
      $scope.numType = '';
    }

    $scope.clickIssued = function (str) {
      $scope.numType = str;
    };

    $scope.showBackBtn = false;
    if (/tabName/.test(window.location.href)) {
      $scope.showBackBtn = true;
    } else {
      $scope.showBackBtn = false;
    }
  }

})();
(function () {
  'use strict';

  angular.module('portalModule')
    .controller('webToCaseController', controller);

  controller.$inject = ['$scope', '$rootScope','SecurityService'];
  function controller($scope, $rootScope,SecurityService) {

    var contactId = '';
    if ($rootScope.IsImpersonation) {
      contactId = $rootScope.impersonationContactId;
    }

    SecurityService.getUserInfoExtension(contactId).then(function (value) {

      $scope.userPhone = value[0]?value[0].currentUser.Phone:'';

      $scope.feedback = {
        browser:'',
        phone: $rootScope.currentUser ? $scope.userPhone : '',
        arcNumber: $rootScope.currentUser ? $rootScope.currentUser.accArcNumber : '',
        email: $rootScope.currentUser ? $rootScope.currentUser.email : '',
        name: $rootScope.currentUser ? $rootScope.currentUser.name : '',
        emailReadOnly: $rootScope.currentUser ? true : false,
        type: '',
        subject: '',
        description: ''
      };
    });

    $scope.typeChange = function (type) {
      $scope.feedback.type = type;
    };
    $scope.browserChange = function (browser) {
      $scope.feedback.browser = browser;
    };
    $scope.submit = function ($event) {

      var emailRegex = /^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/;
      var phoneRegex = /^[\d()+-\s]+$/
      var phone = $("#phone").val();

      if ($("#phone").val()=='' || $("#email").val()=='' || $("#name").val()=='' || $("#type").val()=='' || $("#subject").val()=='') {

        $rootScope.$broadcast('showMessage',
          {
            type: 'alert',
            text: 'Please enter all required fields.'
          });
      }
      else {
        if (!emailRegex.test($scope.feedback.email)) {

          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Check email format'
            });
        }else if(phone.length > 20 || !phoneRegex.test(phone.replace(/\s+/g, ""))){

          $rootScope.$broadcast('showMessage',
            {
              type: 'alert',
              text: 'Check phone number format'
            });
        }
        else {
          document.getElementById('feedback-form').submit();
        }
      }
    };
  }

})(); 
</script></span><span id="j_id0:j_id50">
<script type="text/javascript"> (function () {
  'use strict';

  angular.module('commonModule')
    .factory('APIService', ['$q', '$http', 'APP_CONFIG',
      function ($q, $http, APP_CONFIG) {
        /*
         * REST API process.env.port
         * */
        var port = 8080;

        var svc = {};
        if (APP_CONFIG.env == 'dev') {
          svc.invokeAction = existing_invokeAction;
        } else {
          svc.invokeAction = existing_invokeAction;
        }

        //Local data
        function temp_invokeAction() {

          var deferred = $q.defer();
          var method = arguments[0];

          $http.get('./data/' + method + '.json').then(function (response) {
            deferred.resolve(response.data);
          }, function () {
            deferred.resolve({});
          });

          return deferred.promise;
        }

        //RESTful API
        function rest_invokeAction(method, param) {
          var list = method.split('.');
          var paramList = [];
          var arrArgument = Array.prototype.slice.call(arguments);

          arrArgument.forEach(function (value, index) {

            if (index > 0) {
              var tmp1 = angular.toJson(value);
              var tmp2 = angular.fromJson(tmp1);
              paramList.push(tmp2);
            }
          });

          // if (paramList.length > 0 && APP_CONFIG.env == 'dev') {
          //   console.log('***** ' + method + '\n' + '***** Params ******', paramList)
          // }

          var url = 'http://localhost:' + port + '/local/api',
            //var url = 'http://10.20.89.71:8080/local/api',
            data = {method: list[1], class_name: list[0], params: paramList},
            config = {
              // transformResponse: function (data) {
              //
              // }
            };

          var deferred = $q.defer();
          $http.post(url, data, config).then(function (value) {
            if (value.status == 200) {
              deferred.resolve(value.data);
            } else {
              deferred.reject(value.statusText);
            }
          });

          return deferred.promise;
        }

        //Existing; with remoting service
        function existing_invokeAction(method) {

          var deferred = $q.defer();
          var params = arguments;

          // this part is to clear angular injected [hash] in object while performing ng-repeat
          _(params).forEach(function (param, index) {

            if (_.isObject(param)) {
              var tmp1 = angular.toJson(param);
              var tmp2 = angular.fromJson(tmp1);
              params[index] = tmp2;
            } else if (typeof param == 'undefined') {
              params[index] = '';
            }

          });

          [].push.call(params, function (result, event) {
            if (event.status) {
              deferred.resolve(result);
            }
            else {
              deferred.reject(event.message);
            }
          });
          [].push.call(params, {escape: false, timeout: 120000});

          Visualforce.remoting.Manager.invokeAction.apply(Visualforce.remoting.Manager, params);
          Visualforce.remoting.maxretries = 1;
          return deferred.promise;
        }

        return svc;
      }])
    .factory('util', ['$sce', '$rootScope', '$timeout',
      function ($sce, $rootScope, $timeout) {

        var svc = {};

        svc.decodedHtml = function (value) {

          var decoded = angular.element('<textarea />').html(value).text();
          var rs = $sce.trustAsHtml(decoded);
          return rs;
        };

        svc.decodedString = function (value) {

          var decoded = angular.element('<textarea />').html(value).text();
          var rs = $sce.trustAsHtml(decoded);
          if (rs) {
            rs = rs.valueOf();
          }
          return rs;
        };

        svc.isSuccessService = function (value) {

          var result = true;
          if (!value.success) {

            result = false;
            $rootScope.$broadcast('showMessage',
              {
                type: 'alert',
                text: value.messages ? value.messages[0] : 'Sorry, an error has occurred. Please contact United for further assistance.'
              });
          }
          else {
            result = true;
            if (value.messages && value.messages.length > 0) {
              $timeout(function () {

                $rootScope.$broadcast('showMessage',
                  {
                    type: 'alert',
                    text: value.messages[0]
                  });
              }, 300);
            }
          }

          return result;
        };

        // Account Dropdown order:
        // 1. Discretionary Account
        // 2. HOL Account
        // 3. Reserved Account
        // 4. Corporate Account
        // 5. Branches
        // Among a specific grouping, the accounts will be ordered by ARC/IATA/UCS#.
        svc.sortAccount = function (accounts) {

          var result = [];
          var accs;

          accs = _.filter(accounts, function (acc) {

            return acc.AccountType == $rootScope.ACC_TYPE.dis;
          });
          accs = _.sortBy(accs, ['ExtId']);
          result = _.concat(result, accs);

          accs = _.filter(accounts, function (acc) {

            return acc.AccountType == $rootScope.ACC_TYPE.agency;
          });
          accs = _.sortBy(accs, ['ExtId']);
          result = _.concat(result, accs);

          accs = _.filter(accounts, function (acc) {

            return acc.AccountType == $rootScope.ACC_TYPE.resv;
          });
          accs = _.sortBy(accs, ['ExtId']);
          result = _.concat(result, accs);

          accs = _.filter(accounts, function (acc) {

            return acc.AccountType == $rootScope.ACC_TYPE.corp;
          });
          accs = _.sortBy(accs, ['ExtId']);
          result = _.concat(result, accs);

          accs = _.filter(accounts, function (acc) {

            return acc.AccountType == $rootScope.ACC_TYPE.aor;
          });
          accs = _.sortBy(accs, ['ExtId']);
          result = _.concat(result, accs);

          accs = _.filter(accounts, function (acc) {

            return acc.AccountType == $rootScope.ACC_TYPE.agencyBranch;
          });
          accs = _.sortBy(accs, ['ExtId']);
          result = _.concat(result, accs);

          accs = _.filter(accounts, function (acc) {

            return acc.AccountType == $rootScope.ACC_TYPE.psuedo;
          });
          accs = _.sortBy(accs, ['ExtId']);
          result = _.concat(result, accs);

          return result;
        };

        svc.filterAccountByType = function (accounts, types) {

          var typesOrder = [];
          if (_.indexOf(types, $rootScope.ACC_TYPE.dis) > -1) {
            typesOrder.push($rootScope.ACC_TYPE.dis);
          }
          if (_.indexOf(types, $rootScope.ACC_TYPE.agency) > -1) {
            typesOrder.push($rootScope.ACC_TYPE.agency);
          }
          if (_.indexOf(types, $rootScope.ACC_TYPE.resv) > -1) {
            typesOrder.push($rootScope.ACC_TYPE.resv);
          }
          if (_.indexOf(types, $rootScope.ACC_TYPE.corp) > -1) {
            typesOrder.push($rootScope.ACC_TYPE.corp);
          }
          if (_.indexOf(types, $rootScope.ACC_TYPE.aor) > -1) {
            typesOrder.push($rootScope.ACC_TYPE.aor);
          }
          if (_.indexOf(types, $rootScope.ACC_TYPE.agencyBranch) > -1) {
            typesOrder.push($rootScope.ACC_TYPE.agencyBranch);
          }
          if (_.indexOf(types, $rootScope.ACC_TYPE.psuedo) > -1) {
            typesOrder.push($rootScope.ACC_TYPE.psuedo);
          }

          var result = [];
          _.forEach(typesOrder, function (type) {

            var accs = _.filter(accounts, function (acc) {

              return acc.AccountType == type;
            });
            accs = _.sortBy(accs, ['ExtId']);
            result = _.concat(result, accs);
          });
          return result;
        };

        return svc;
      }])
    .factory('session', ['localStorageService',
      function (localStorageService) {

        var svc = {};

        svc.create = function (accId, accName, accArcNumber,
                               profileName, id, firstName,
                               lastName, name, fullPhotoUrl,
                               smallPhotoUrl, isAgreed, email,
                               mgrName, mgrEmail, mgrPhone,
                               mgrPhotoUrl, mgrMobilePhone, isPasswordExpireSoon,
                               passwordExpireSoonDays, permission, emulatorName,
                               reportPermission, dashboard, isInternalUser) {

          localStorageService.set('current-user', {
            'accId': accId,
            'accName': accName,
            'accArcNumber': accArcNumber,
            'profileName': profileName,
            'id': id,
            'firstName': firstName,
            'lastName': firstName,
            'name': name,
            'fullPhotoUrl': fullPhotoUrl,
            'smallPhotoUrl': smallPhotoUrl,
            'isAgreed': isAgreed,
            'email': email,
            'mgrName': mgrName,
            'mgrEmail': mgrEmail,
            'mgrPhone': mgrPhone,
            'mgrMobilePhone': mgrMobilePhone,
            'mgrPhotoUrl': mgrPhotoUrl,
            'isPasswordExpireSoon': isPasswordExpireSoon,
            'passwordExpireSoonDays': passwordExpireSoonDays,
            'permission': permission,
            'emulatorName': emulatorName,
            'reportPermission': reportPermission,
            'dashboard': dashboard,
            'isInternalUser': isInternalUser,
            'timestamp': new Date().getTime()
          });
        };

        svc.clear = function () {

          localStorageService.remove('current-user');
        };

        svc.get = function (name) {

          var value = localStorageService.get(name);
          return value;
        };

        svc.currentUser = function () {

          var currentUser = localStorageService.get('current-user') || null;
          return currentUser;
        };

        return svc;
      }
    ]);
})();


 
</script></span><span id="j_id0:j_id53">
<script type="text/javascript"> (function () {
  'use strict';
  angular.module('commonModule')
    .factory('AmenityService', ['APIService',
      function (APIService) {

        var svc = {};
        svc.getPNRInfo = function (recordLocator, recordLocatorSource, accId, userId, callerAccId) {

          return APIService.invokeAction('Sip_AmenityController.getPNRInfo',
            recordLocator, recordLocatorSource, accId, userId, callerAccId);
        };
        svc.proceedTickets = function (pnr) {

          return APIService.invokeAction('Sip_AmenityController.proceedTickets',
            pnr);
        };
        svc.confirmAllTravelerServices = function (pnr, userId, payerId, beneficiaryId, callerId, productCode, comment, callerFirstName, callerLastName, remarks) {

          return APIService.invokeAction('Sip_AmenityController.confirmAllTravelerServices',
            pnr, userId, payerId, beneficiaryId, callerId, productCode, comment, callerFirstName, callerLastName, remarks);
        };
        svc.sendRemarks = function (pnr, userId, waiverCode, productCode, remark) {

          return APIService.invokeAction('Sip_AmenityController.sendRemarks',
            pnr, userId, waiverCode, productCode, remark);
        };
        svc.sendEmail = function (userId, refNo) {

          return APIService.invokeAction('Sip_AmenityController.sendEmail',
            userId, refNo);
        };
        svc.preDeductAccountBalance = function (payerId, totalCost, userId) {

          return APIService.invokeAction('Sip_AmenityController.preDeductAccountBalance',
            payerId, totalCost, userId);
        };
        svc.addAmount = function (payerId, totalCost, userId, pendingAmountObjId) {

          return APIService.invokeAction('Sip_AmenityController.addAmount',
            payerId, totalCost, userId, pendingAmountObjId);
        };
        svc.preDeductAccountBalanceForNomination = function (payerId, totalCost, premierLevel, userId) {

          return APIService.invokeAction('Sip_AmenityController.preDeductAccountBalanceForNomination',
            payerId, totalCost, premierLevel, userId);
        };
        return svc;
      }])
    .factory('ProductService', ['APIService',
      function (APIService) {

        var svc = {};
        svc.getAmenityProductList = function (accId) {

          return APIService.invokeAction('Sip_ProductInfoController.getAmenityProductList', accId);
        };
        svc.getProductByCode = function (list, code) {

          var product = {};
          _(list).forEach(function (p) {
            if (p.ProductCode == code) {
              product = p;
              return false;
            }
          });

          return product;
        };

        svc.getTravelCertificate = function (accId) {

          return APIService.invokeAction('Sip_ProductInfoController.getTravelCertificate', accId);
        };

        return svc;
      }])
    .factory('AccountService', ['APIService', '$q', 'APP_CONFIG', 'util',
      function (APIService, $q, APP_CONFIG, util) {

        var svc = {};
        svc.getAccounts = function (userId, tileName, keyword, extId) {

          var index = 0;
          var accounts = [];
          var deferred = $q.defer();

          var load = function (index) {

            svc.getAccountsByPage(userId, tileName, keyword, extId, index).then(
              function (val) {
                accounts = _.concat(accounts, val.Accounts);

                if (APP_CONFIG.env == 'dev' && index == 3) {
                  val.queryEndFlag = true;
                }

                if (!val.queryEndFlag) {
                  index++;
                  return load(index);
                }
                else {

                  if (APP_CONFIG.env == 'dev') {
                    var idIndex = 1;
                    _(accounts).forEach(function (acc) {
                      acc.Id = idIndex++;
                    });
                  }

                  accounts = util.sortAccount(accounts);
                  deferred.resolve({
                    Accounts: accounts
                  });
                }
              }, function (err) {

                deferred.reject(err);
              });
          };
          load(index, deferred);

          return deferred.promise;
        };
        svc.getAccountsByPage = function (userId, tileName, keyword, extId, queryTime) {

          return APIService.invokeAction('Sip_AccountController.getAccounts',
            userId, tileName, keyword, extId, queryTime);
        };
        svc.getAccountsForUpgrades = function (userId, keyword, extId) {

          var index = 0;
          var accounts = [];
          var deferred = $q.defer();

          var load = function (index) {

            svc.getAccountsForUpgradesByPage(userId, keyword, extId, index).then(
              function (val) {
                accounts = _.concat(accounts, val.Accounts);

                if (APP_CONFIG.env == 'dev' && index == 3) {
                  val.queryEndFlag = true;
                }

                if (!val.queryEndFlag) {
                  index++;
                  return load(index);
                }
                else {

                  if (APP_CONFIG.env == 'dev') {
                    var idIndex = 1;
                    _(accounts).forEach(function (acc) {
                      acc.Id = idIndex++;
                    });
                  }

                  accounts = util.sortAccount(accounts);
                  deferred.resolve({
                    Accounts: accounts
                  });
                }
              }, function (err) {

                deferred.reject(err);
              });
          };
          load(index, deferred);

          return deferred.promise;
        };
        svc.getAccountsForUpgradesByPage = function (userId, keyword, extId, queryTime) {

          return APIService.invokeAction('Sip_AccountController.getAccountsForUpgrades',
            userId, keyword, extId, queryTime);
        };
        svc.getBeneficiaryAccounts = function (userId, tileName, keyword) {

          var index = 0;
          var accounts = [];
          var deferred = $q.defer();

          var load = function (index) {

            svc.getBeneficiaryAccountsByPage(userId, tileName, keyword, index).then(
              function (val) {
                accounts = _.concat(accounts, val.Accounts);

                if (APP_CONFIG.env == 'dev' && index == 3) {
                  val.queryEndFlag = true;
                }

                if (!val.queryEndFlag) {
                  index++;
                  return load(index);
                }
                else {

                  if (APP_CONFIG.env == 'dev') {
                    var idIndex = 1;
                    _(accounts).forEach(function (acc) {
                      acc.Id = idIndex++;
                    });
                  }

                  accounts = util.sortAccount(accounts);
                  deferred.resolve({
                    Accounts: accounts
                  });
                }
              }, function (err) {

                deferred.reject(err);
              });
          };
          load(index, deferred);

          return deferred.promise;
        };
        svc.getBeneficiaryAccountsByPage = function (userId, tileName, keyword, queryTime) {

          return APIService.invokeAction('Sip_AccountController.getBeneficiaryAccounts',
            userId, tileName, keyword, queryTime);
        };
        svc.getFromAccountsForFundsTx = function (userId, accId) {

          return APIService.invokeAction('Sip_AccountController.getFromAccountsForFundsTx',
            userId, accId);
        };
        svc.getSelectableAccountsForFundsTxMultiple = function (userId, accId, keyword) {

          var index = 0;
          var accounts = [];
          var deferred = $q.defer();

          var load = function (index) {

            svc.getSelectableAccountsForFundsTxByPage(userId, accId, keyword, index).then(
              function (val) {
                accounts = _.concat(accounts, val.Accounts);

                if (APP_CONFIG.env == 'dev' && index == 3) {
                  val.queryEndFlag = true;
                }

                if (!val.queryEndFlag) {
                  index++;
                  return load(index);
                }
                else {

                  if (APP_CONFIG.env == 'dev') {
                    var idIndex = 1;
                    _(accounts).forEach(function (acc) {
                      acc.Id = idIndex++;
                    });
                  }

                  accounts = util.sortAccount(accounts);
                  deferred.resolve({
                    Accounts: accounts
                  });
                }
              }, function (err) {

                deferred.reject(err);
              });
          };
          load(index, deferred);

          return deferred.promise;
        };
        svc.getSelectableAccountsForFundsTxByPage = function (userId, accId, keyword, queryTime) {

          return APIService.invokeAction('Sip_AccountController.getSelectableAccountsForFundsTxMultiple',
            userId, accId, keyword, queryTime);
        };
        svc.getAccountById = function (accountId, userId) {

          return APIService.invokeAction('Sip_AccountController.getAccountById',
            accountId, userId);
        };
        svc.getAccountByExtId = function (extId) {

          return APIService.invokeAction('Sip_AccountController.getAccountByExtId',
            extId);
        };
        svc.getAccountByIATA = function (iata, userId) {

          return APIService.invokeAction('Sip_AccountController.getAccountByIATA',
            iata, userId);
        };
        svc.getAccountSummaryById = function (accountId, userId) {

          return APIService.invokeAction('Sip_AccountController.getAccountSummaryById',
            accountId, userId);
        };
        svc.updateSFNotificationAmount = function (accountId, sfAmount) {

          return APIService.invokeAction('Sip_AccountController.updateSFNotificationAmount',
            accountId, sfAmount);
        };
        svc.getAccountsInManagement = function (userId) {

          return APIService.invokeAction('Sip_AccountController.getAccountsInManagement',
            userId);
        };
        svc.submitFundsTransfer = function (obj) {

          return APIService.invokeAction('Sip_AccountController.submitFundsTransfer',
            obj);
        };
        svc.isInAmexFamily = function (accId) {

          return APIService.invokeAction('Sip_AccountController.isInAmexFamily',
            accId);
        };
        svc.getCategoriesByAccountId = function (accId) {

          return APIService.invokeAction('Sip_AmenityController.getCategoriesByAccountId',
            accId);
        };
        svc.getTransferLimit = function (accId, expiringFirst) {

          return APIService.invokeAction('Sip_AccountController.getTransferLimit',
          accId, expiringFirst);
        }
        return svc;
      }])
    .factory('UnitedClubService', ['APIService',
      function (APIService) {

        var svc = {};
        svc.retrievePremierQualification = function (lastName, mPlusNumber, isTestAccount, userId) {

          var req = {
            LastName: lastName,
            MileagePlusNumber: mPlusNumber,
            IsTestAccount: isTestAccount
          };
          return APIService.invokeAction('Sip_AmenityController.retrievePremierQualification',
            req, userId);
        };
        svc.retrieveSubscription = function (premiumQual, accId, amenityType, userId) {

          return APIService.invokeAction('Sip_AmenityController.retrieveSubscription',
            premiumQual, accId, amenityType, userId);
        };
        svc.getPassDetail = function (req, subscription, accId) {

          return APIService.invokeAction('Sip_AmenityController.getPassDetail',
            req, subscription, accId);
        };
        svc.submitUCMEnrollment = function (subscription, payerId, beneficiaryId, callerId, comment, userId, cost, pendingAmountObjId) {

          return APIService.invokeAction('Sip_AmenityController.submitUCMEnrollment', subscription, payerId, beneficiaryId, callerId, comment, userId, cost, pendingAmountObjId);
        };
        //20170418 Shan. Added Method getPassDetail
        //20170424 Shan add methods again
        svc.getPassDetail = function (requestInfoFromUI, subscription, accId) {

          return APIService.invokeAction('Sip_AmenityController.getPassDetail',
            requestInfoFromUI, subscription, accId);
        };
        svc.getPassDetailWitEmail = function (requestInfoFromUI, accId) {

          return APIService.invokeAction('Sip_AmenityController.getPassDetailWitEmail',
            requestInfoFromUI, accId);
        };
        svc.retrieveIssuePassWithMP = function (qual, requestInfoFromUI, passDetail, payerId, beneficiaryId, callerId, comment, userId, cost, pendingAmountObjId) {

          return APIService.invokeAction('Sip_AmenityController.retrieveIssuePassWithMP',
            qual, requestInfoFromUI, passDetail, payerId, beneficiaryId, callerId, comment, userId, cost, pendingAmountObjId);
        };
        svc.retrieveIssuePassWithoutMP = function (passDetail, payerId, beneficiaryId, callerId, comment, userId, cost, pendingAmountObjId) {

          return APIService.invokeAction('Sip_AmenityController.retrieveIssuePassWithoutMP',
            passDetail, payerId, beneficiaryId, callerId, comment, userId, cost, pendingAmountObjId);
        };

        return svc;
      }])
    .factory('BonusMilesService', ['APIService',
      function (APIService) {

        var svc = {};
        svc.retrievePremierQualification = function (lastName, mPlusNumber, isTestAccount, userId) {

          var params = {
            LastName: lastName,
            MileagePlusNumber: mPlusNumber,
            IsTestAccount: isTestAccount,
          };
          return APIService.invokeAction('Sip_AmenityController.retrievePremierQualification',
            params, userId);
        };
        svc.getBonusmilesQuota = function (premierQualification, userId) {

          return APIService.invokeAction('Sip_AmenityController.getBonusmilesQuota', premierQualification, userId);
        };
        svc.getAwardMiles = function (accountId, payerId, milesAmount, MPNumber, beneficiary, commentContent, userId, CurrentPremierLevel, fn, ln, callerId, cost, pendingAmountObjId) {

          var params = {
            'AccountId': accountId,
            'PayerId': payerId,
            'MilesAmount': milesAmount,
            'MPNumber': MPNumber,
            'Beneficiary': beneficiary,
            'Comment': commentContent,
            'userId': userId,
            'CurrentPremierLevel': CurrentPremierLevel,
            'FirstName': fn,
            'LastName': ln
          };
          return APIService.invokeAction('Sip_AmenityController.getAwardMiles',
            params, callerId, cost, pendingAmountObjId);
        };
        return svc;
      }])
    .factory('StatusNominationService', ['APIService',
      function (APIService) {

        var svc = {};
        svc.getCurrentPremierLevelStatus = function (req) {

          return APIService.invokeAction('Sip_AmenityController.getCurrentPremierLevelStatus',
            req);
        };
        svc.purchasePremierLevel = function (loyaltyInfo, payerId, beneficiaryId, callerId, comments, userId, cost, pendingAmountObjId) {

          var uiReq = {
            "premierLevelCode": loyaltyInfo.NewCode
          };
          return APIService.invokeAction('Sip_AmenityController.purchasePremierLevel',
            loyaltyInfo, uiReq, payerId, beneficiaryId, callerId, comments, userId, cost, pendingAmountObjId);
        };
        svc.calculateNewExpirationDateByPremierLevelCutOffDate = function (selectedLevelCode) {

          return APIService.invokeAction('Sip_AmenityController.calculateNewExpirationDateByPremierLevelCutOffDate',
            selectedLevelCode);
        }
        return svc;
      }])
    .factory('TravelCertificateService', ['APIService',
      function (APIService) {

        var svc = {};

        svc.getCertAllocationByEmpID = function () {

          return APIService.invokeAction('Sip_AmenityController.getCertAllocationByEmpID');
        };
        svc.activateTravelCert = function (param, getCertAllocationByEmpID, times, payerId, beneficiaryId, comment, userId, cost) {
          return APIService.invokeAction('Sip_AmenityController.activateTravelCert', param, getCertAllocationByEmpID, times, payerId, beneficiaryId, comment, userId, cost);
        };
        svc.sendTravelCertEmails = function (html, email, userId, transactionNumber) {

          return APIService.invokeAction('Sip_AmenityController.sendTravelCertEmails',
            html, email, userId, transactionNumber);
        };
        svc.commitTravelCertsTransaction = function (successList, proCode, payer, bene, callerId, comm, userid, cost, pendingAmountObjId) {

          return APIService.invokeAction('Sip_AmenityController.commitTravelCertsTransaction',
            successList, proCode, payer, bene, callerId, comm, userid, cost, pendingAmountObjId);
        };
        return svc;
      }])
    .factory('BeverageCouponService', ['APIService',
      function (APIService) {
        var svc = {};
        svc.purchaseBeverageCoupons = function (info, payerid, benefid, caller, comments, userid, cost, pendingAmountObjId) {

          return APIService.invokeAction('Sip_AmenityController.purchaseBeverageCoupons',
            info, payerid, benefid, caller, comments, userid, cost, pendingAmountObjId);
        };
        return svc;
      }])
    .factory('UpgradeService', ['APIService',
      function (APIService) {

        var svc = {};
        svc.getUpgradeBalance = function (requestInfoFromUI, userId) {

          return APIService.invokeAction('Sip_AmenityController.getUpgradeBalance',
            requestInfoFromUI, userId);
        };
        svc.purchaseUpgrades = function (requestInfoFromUI, payerId, beneficiaryId, comments, userID, cost) {

          return APIService.invokeAction('Sip_AmenityController.purchaseUpgrades',
            requestInfoFromUI, payerId, beneficiaryId, comments, userID, cost);
        };
        svc.purchaseUpgradesRPU = function (requestInfoFromUI, payerId, beneficiaryId, comments, userID, cost) {

          return APIService.invokeAction('Sip_AmenityController.purchaseUpgradesRPU',
            requestInfoFromUI, payerId, beneficiaryId, comments, userID, cost);
        };
        svc.commitUpgradeTransaction = function (successData, payerId, beneficiaryId, callerId, comments, userID, cost, pendingAmountObjId) {

          return APIService.invokeAction('Sip_AmenityController.commitUpgradeTransaction',
            successData, payerId, beneficiaryId, callerId, comments, userID, cost, pendingAmountObjId);
        };

        return svc;
      }])
    .factory('CMSService', ['APIService',
      function (APIService) {

        var svc = {};
        svc.getSummaryByFilter = function (filter) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getSummaryByFilter', filter);
        };
        svc.getHomePageHeaderValues = function () {

          return APIService.invokeAction('Sip_HomePageHeadersController.getHomePageHeaderValues');
        };
        svc.getHomePageHeaderValues = function () {

          return APIService.invokeAction('Sip_HomePageHeadersController.getHomePageHeaderValues');
        };
        svc.getHeaderTitleandContentValues = function (HeaderId) {

          return APIService.invokeAction('Sip_HomePageHeadersController.getHeaderTitleandContentValues', HeaderId);
        };
        svc.getHeaderTitleandContentValues = function (HeaderId) {

          return APIService.invokeAction('Sip_HomePageHeadersController.getHeaderTitleandContentValues', HeaderId);
        };
        svc.getFooterValues = function () {

          return APIService.invokeAction('Sip_HomePageHeadersController.getFooterValues');
        };
        svc.getFooterValues = function () {

          return APIService.invokeAction('Sip_HomePageHeadersController.getFooterValues');
        };
        svc.getAcquisition = function () {

          return APIService.invokeAction('Sip_ContentManagementController.getAcquisition');
        };
        svc.getUnitedNewsContentManagementValues = function () {

          return APIService.invokeAction('Sip_ContentManagementController.getUnitedNewsContentManagementValues');
        };
        svc.getMarketingOrPromotionBlock1 = function () {

          return APIService.invokeAction('Sip_ContentManagementController.getMarketingOrPromotionBlock1');
        };
        svc.getMarketingOrPromotionBlock2 = function () {

          return APIService.invokeAction('Sip_ContentManagementController.getMarketingOrPromotionBlock2');
        };
        svc.getUnitedMarketingOrPromotionTitleAndContent = function (id) {

          return APIService.invokeAction('Sip_ContentManagementController.getUnitedMarketingOrPromotionTitleAndContent', id);
        };
        svc.getUnitedMarketingOrPromotionTitleAndContent = function (id) {

          return APIService.invokeAction('Sip_ContentManagementController.getUnitedMarketingOrPromotionTitleAndContent', id);
        };
        svc.getUnitedSubscribeNowToOurEmail = function () {

          return APIService.invokeAction('Sip_ContentManagementController.getUnitedSubscribeNowToOurEmail');
        };
        svc.getUnitedUniversity = function () {

          return APIService.invokeAction('Sip_ContentManagementController.getUnitedUniversity');
        };
        svc.getKnowMoreNewsContent = function (newsId) {

          return APIService.invokeAction('Sip_UnitedNewsController.getKnowMoreNewsContent', newsId);
        };
        svc.getKnowMoreNewsContent = function (newsId) {

          return APIService.invokeAction('Sip_UnitedNewsController.getKnowMoreNewsContent', newsId);
        };
        svc.getViewAllNewsContent = function (pageNum) {

          return APIService.invokeAction('Sip_UnitedNewsController.getViewAllUnitedNews', pageNum);
        };
        svc.getViewAllNewsContent = function (pageNum) {

          return APIService.invokeAction('Sip_UnitedNewsController.getViewAllUnitedNews', pageNum);
        };
        svc.getUnitedTravelWaiverContentManagementValues = function () {

          return APIService.invokeAction('Sip_ContentManagementController.getUnitedTravelWaiverContentManagementValues');
        };
        svc.getFeedbackContentManagementValues = function () {

          return APIService.invokeAction('Sip_ContentManagementController.getFeedbackContentManagementValues');
        };
        svc.getTermConditionContentManagementValues = function () {

          return APIService.invokeAction('Sip_UserAgreementController.getTermConditionContentManagementValues');
        };
        svc.UpdateUserAgreeCheckbox = function (flag) {

          return APIService.invokeAction('Sip_UserAgreementController.UpdateUserAgreeCheckbox', flag);
        };
        svc.confirmAmenityConsent = function () {

          return APIService.invokeAction('Sip_UserAgreementController.confirmAmenityConsent');
        };
        svc.getAmenityConsent = function () {

          return APIService.invokeAction('Sip_UserAgreementController.getAmenityConsent');
        };
        svc.getEmbeddedPowerBIReport = function (userId) {

          return APIService.invokeAction('Sip_EmbeddedBIController.getEmbeddedPowerBIReport', userId);
        };
        svc.getDetailEmbeddedPowerBIReport = function (userId) {

          return APIService.invokeAction('Sip_EmbeddedBIController.getDetailEmbeddedPowerBIReport', userId);
        };
        svc.getUserNotification = function (userId) {

          return APIService.invokeAction('Sip_NotificationController.getUserNotification', userId);
        };
        svc.UpdateUserNotification = function (str) {

          return APIService.invokeAction('Sip_NotificationController.UpdateUserNotification', str);
        };
        svc.getSIPAnnualAirTravelBudget = function () {

          return APIService.invokeAction('Sip_WebToLeadController.getSIPAnnualAirTravelBudget');
        };
        svc.getSIPAvgAnnualUATravelSpend = function () {

          return APIService.invokeAction('Sip_WebToLeadController.getSIPAvgAnnualUATravelSpend');
        };
        svc.getSIPCompanyTravelLocations = function () {

          return APIService.invokeAction('Sip_WebToLeadController.getSIPCompanyTravelLocations');
        };
        svc.getSIPKeyTravelMarkets = function () {

          return APIService.invokeAction('Sip_WebToLeadController.getSIPKeyTravelMarkets');
        };
        svc.getSIPInterestedCustomerProgram = function () {

          return APIService.invokeAction('Sip_WebToLeadController.getSIPKeyTravelMarkets');
        };
        svc.getWebToLead = function () {

          return APIService.invokeAction('Sip_WebToLeadController.getWebToLead');
        };
        svc.getWebToLead = function () {

          return APIService.invokeAction('Sip_WebToLeadController.getWebToLead');
        };
        svc.UpdateUserProfilePhotoandUserdata = function (type, img, userObj) {

          return APIService.invokeAction('Sip_MyProfileController.UpdateUserProfilePhotoandUserdata', type, img, userObj);
        };
        svc.getIncentiveReports = function (userId) {

          return APIService.invokeAction('Sip_IncentiveReportsController.getIncentiveReports', userId);
        };
        svc.InsertUserRegistrationPageValues = function (userObj, forceInsert) {

          return APIService.invokeAction('Sip_RegistrationPageandProcess.InsertUserRegistrationPageValues', userObj, forceInsert);
        };
        svc.getAllActiveTravelWaiversValues = function () {

          return APIService.invokeAction('Sip_ViewAllTravelWaiverController.getAllActiveTravelWaiversValues');
        };
        svc.getAllArchiveTravelWaiversValues = function () {

          return APIService.invokeAction('Sip_ViewAllTravelWaiverController.getAllArchiveTravelWaiversValues');
        };
        svc.getCountryList = function () {

          return APIService.invokeAction('Sip_CountryListController.getCountryList');
        };
        svc.getSalesContacts = function (userId) {

          return APIService.invokeAction('Sip_MyProfileController.getSalesContacts', userId);
        };

        /* User Management ∨ */
        svc.getUserList = function (agencyId) {

          return APIService.invokeAction('Sip_UserManagementController.getUserList', agencyId);
        };
        svc.getUserDetails = function (obj, recordId) {

          return APIService.invokeAction('Sip_UserManagementController.getUserDetails', obj, recordId);
        };
        svc.lockUser = function (userId) {

          return APIService.invokeAction('Sip_UserManagementController.lockUser', userId);
        };
        svc.unLockUser = function (userId) {

          return APIService.invokeAction('Sip_UserManagementController.unlockUser', userId);
        };
        svc.resetPsd = function (userName) {

          return APIService.invokeAction('Sip_UserManagementController.resetPassword', userName);
        };
        svc.deactivateUser = function (userId) {

          return APIService.invokeAction('Sip_UserManagementController.deactivateUser', userId);
        };
        svc.activateUser = function (userId) {

          return APIService.invokeAction('Sip_UserManagementController.activateUser', userId);
        };
        svc.rejectUser = function (registrationId) {

          return APIService.invokeAction('Sip_UserManagementController.rejectUser', registrationId);
        };
        svc.getAvailableUserRolesAndPermissionGroups = function () {

          return APIService.invokeAction('Sip_UserManagementController.getAvailableUserRolesAndPermissionGroups');
        };
        svc.getAvailablePermissions = function (permissionGroupId, arcNumber, userId) {

          return APIService.invokeAction('Sip_UserManagementController.getAvailablePermissions', permissionGroupId, arcNumber, userId);
        };
        svc.saveUserPermissions = function (userDetailWrap) {

          return APIService.invokeAction('Sip_UserManagementController.saveUserPermissions', userDetailWrap);
        };
        svc.getBranchLocation = function () {

          return APIService.invokeAction('Sip_UserManagementController.getBranchLocation');
        };

        //create new user final step submit
        svc.createUserWithPermissions = function (userDetailWrap) {

          return APIService.invokeAction('Sip_UserManagementController.createUserWithPermissions', userDetailWrap);
        };
        svc.getCorpAgencies = function () {

          return APIService.invokeAction('Sip_UserManagementController.getCorpAgencies');
        };
        svc.updateCorpAgencyPermissions = function (agencyObject) {

          return APIService.invokeAction('Sip_UserManagementController.updateCorpAgencyPermissions', agencyObject);
        };
        svc.updateUserProfile = function (obj, userProfileInfo) {

          return APIService.invokeAction('Sip_UserManagementController.updateUserProfile', obj, userProfileInfo);
        };

        // get permissions of the given user
        svc.getUserPermissions = function (userId) {

          return APIService.invokeAction('Sip_UserManagementController.getUserPermissions', userId);
        };
        svc.getAvailableARCNumbers = function () {

          return APIService.invokeAction('Sip_UserManagementController.getAvailableARCNumbers');
        };
        svc.getCountries = function () {

          return APIService.invokeAction('Sip_UserManagementController.getCountries');
        };
        svc.getAirports = function () {

          return APIService.invokeAction('Sip_UserManagementController.getAirports');
        };
        svc.getAgencyAddress = function (arcNum) {

          return APIService.invokeAction('Sip_UserManagementController.getAgencyAddress', arcNum);
        };
        svc.validateUserProfileInfo = function (userInfo) {

          return APIService.invokeAction('Sip_UserManagementController.validateUserProfileInfo', userInfo);
        };
        svc.massUploadUser = function (fileContent, arcNumber) {
          return APIService.invokeAction('Sip_UserManagementController.massUploadUser', fileContent, arcNumber);
        };
        svc.exportUserManagementReport = function (arcNumbers, flg) {
          return APIService.invokeAction('Sip_UserManagementController.exportUserManagementReport', arcNumbers, flg);
        };

        svc.manageAgencyFundAuthorization = function () {
          return APIService.invokeAction('Sip_UserManagementController.manageAgencyFundAuthorization');
        };

        svc.getUserManagementBasicVariable = function () {
          return APIService.invokeAction('Sip_UserManagementController.getUserManagementBasicVariable');
        };
        svc.updateAmount = function (aorAccId, amount, expireFlg) {
          return APIService.invokeAction('Sip_UserManagementController.updateAmount', aorAccId, amount, expireFlg);
        };

        svc.getCorpAgencyDetail = function (aorAccId) {
          return APIService.invokeAction('Sip_UserManagementController.getCorpAgencyDetail', aorAccId);
        };
        svc.updateTravelAmenitiesAccess = function (fundObj) {
          return APIService.invokeAction('Sip_UserManagementController.updateTravelAmenitiesAccess', fundObj);
        };
        /* User Management ∧ */
        svc.search = function (keyWord) {
          return APIService.invokeAction('Sip_GlobalSearchController.search', keyWord);
        };
        svc.pagination = function (pageNum) {
          return APIService.invokeAction('Sip_GlobalSearchController.pagination', pageNum);
        };
        /* key metrics*/
        svc.getKeyMetrics = function (userId) {
          return APIService.invokeAction('Sip_MyProfileController.getKeyMetrics', userId);
        };
        svc.getTicketInfo = function (ticketNum, userId) {
          return APIService.invokeAction('Sip_ViewTicketController.getTicketInfo', ticketNum, userId);
        };
        svc.updateUserPhoto = function (type, content) {
          return APIService.invokeAction('Sip_MyProfileController.updateUserPhoto', type, content);
        };

        /*
         * param {name:'username',val:'lorem'}
         * name: {string}, //username | arcNumber | ucsNumber | email
         * val : {string}
         * */
        svc.validationHelper = function (objQ) {
          return APIService.invokeAction('Sip_UserManagementController.validationHelper', objQ)
        };

        svc.insertCertification = function (obj) {

          return APIService.invokeAction('Sip_CertificationFormController.insertCertification', obj);
        };

        svc.validateAdditionalAgency = function (userId, arcNumber) {
          return APIService.invokeAction('Sip_UserManagementController.validateAdditionalAgency', userId, arcNumber);
        };
        // Sip_UserManagementController.getUserManagementHelpDoc
        svc.getUserManagementHelpDoc = function (type) {
          return APIService.invokeAction('Sip_UserManagementController.getUserManagementHelpDoc', type);
        };
        svc.getPowerBiReportPermissions = function (userId) {
          return APIService.invokeAction('Sip_UserManagementController.getPowerBiReportPermissions', userId);
        };

        svc.exportUserManagementReportByArcNumbers = function (arrIata) {
          return APIService.invokeAction('Sip_UserManagementController.exportUserManagementReportByArcNumbers', arrIata);
        };
        svc.exportUserManagementReportByType = function (strType) {
          return APIService.invokeAction('Sip_UserManagementController.exportUserManagementReportByType', strType);
        };
        svc.getSubordinateUsers = function () {
          return APIService.invokeAction('Sip_UserManagementController.getSubordinateUsers');
        };
        return svc;
      }])
    .factory('PNRService', ['APIService', '$rootScope',
      function (APIService) {

        var svc = {};
        svc.getPNRInfo = function (recordLocator, recordLocatorSource, accId, userId, callerAccId) {

          return APIService.invokeAction('Sip_ValidatePNRController.getPNRInfo',
            recordLocator, recordLocatorSource, accId, userId, callerAccId);
        };
        svc.getEPlusPNRDetail = function (recordLocator, recordLocatorSource, userId, callerAccId) {

          return APIService.invokeAction('Sip_ValidatePNRController.generatePNRViewModelForEPlus',
            recordLocator, recordLocatorSource, userId, callerAccId);
        };
        svc.generatePNRViewModelForEPlusCorporateUser = function (recordLocator, recordLocatorSource, lastName, userId) {

          return APIService.invokeAction('Sip_ValidatePNRController.generatePNRViewModelForEPlusCorporateUser',
            recordLocator, recordLocatorSource, lastName, userId);
        };
        svc.applyWaiver = function (pnr) {

          return APIService.invokeAction('Sip_ValidatePNRController.proceedTickets', pnr);
        };
        svc.postRemark = function (transactionInfo, pnr) {

          return APIService.invokeAction('Sip_ValidatePNRController.sendRemarksRemoteActionMethod',
            transactionInfo, pnr);
        };
        svc.confirmWaiverFavor = function (pnr, userId, payerId, beneficiaryId, callerId, comment, remarks) {

          return APIService.invokeAction('Sip_ValidatePNRController.confirmWaiverFavor',
            pnr, userId, payerId, beneficiaryId, callerId, comment, remarks);
        };
        svc.sendConfirmationEmail = function (referenceNumber, otherEmail, sendToUser, sendToSecondaryUser, pnr) {

          return APIService.invokeAction('Sip_ValidatePNRController.sendTransactionEmail',
            referenceNumber, otherEmail, sendToUser, sendToSecondaryUser, pnr);
        };
        svc.selectSalesAccount = function (arcNumber, IsGetAccountBalance, IsGetAccountTransaction, IsGetMembership) {

          return APIService.invokeAction('Sip_ValidatePNRController.getSalesAccountInfo',
            arcNumber, IsGetAccountBalance, IsGetAccountTransaction, IsGetMembership);
        };
        svc.retrieveSalesAccountBalanceByName = function (accountName, IsGetAccountBalance, IsGetAccountTransaction, IsGetMembership) {

          return APIService.invokeAction('Sip_ValidatePNRController.getSalesAccountInfo',
            accountName, IsGetAccountBalance, IsGetAccountTransaction, IsGetMembership);
        };
        svc.retrieveSalesAccounts = function (accid, userId) {

          return APIService.invokeAction('Sip_ValidatePNRController.retrieveSalesAccounts',
            accid, userId);
        };
        svc.getAccountFundInstrument = function (accId) {

          return APIService.invokeAction('Sip_ValidatePNRController.getAccountFundInstrument',
            accId);
        };
        svc.retrieveImpersonationSalesAccounts = function (accid, userId) {

          return APIService.invokeAction('Sip_ValidatePNRController.retrieveImpersonationSalesAccounts',
            accid, userId);
        };
        svc.getSeatMap = function () {

          return APIService.invokeAction('Sip_ValidatePNRController.getSeatMap');
        };
        svc.generateSeatMapViewModelForEPlus = function (pnrInfo, totalStops, userId) {

          return APIService.invokeAction('Sip_ValidatePNRController.generateSeatMapViewModelForEPlus',
            pnrInfo, totalStops, userId);
        };
        // Yang 3/5/2017 Seperate seatMap logic
        svc.generateSeatMapViewModelForEPlusStep1 = function (pnrInfo, totalStops, userId, flightLegIndex) {

          return APIService.invokeAction('Sip_ValidatePNRController.generateSeatMapViewModelForEPlusStep1',
            pnrInfo, totalStops, userId, flightLegIndex);
        };
        // Yang 3/5/2017 Seperate seatMap logic
        svc.generateSeatMapViewModelByLeg = function (pnrInfo, totalStops, userId, flightLegIndex) {

          return APIService.invokeAction('Sip_ValidatePNRController.generateSeatMapViewModelByLeg',
            pnrInfo, totalStops, userId, flightLegIndex);
        };
        svc.submitEPlus = function (pnr, cartItems, dummyItems, pendingAmountObjId) {

          return APIService.invokeAction('Sip_ValidatePNRController.submitEPlus',
            pnr, cartItems, dummyItems, pendingAmountObjId);
        };
        svc.submitEPlusFund = function (seatAssignResult, pnrInfo, payerId, beneficiaryId, callerId, comment, remarks) {

          return APIService.invokeAction('Sip_ValidatePNRController.submitEPlusFund',
            seatAssignResult, pnrInfo, payerId, beneficiaryId, callerId, comment, remarks);
        };
        svc.submitEPlusRemarks = function (pnr, userId, remarks) {

          return APIService.invokeAction('Sip_ValidatePNRController.submitEPlusRemarks',
            pnr, userId, remarks);
        };
        svc.submitEPlusEmail = function (transactionNumberList, pnr, additionalEmialAddress, sendToUser, sendToSecondaryUser) {

          return APIService.invokeAction('Sip_ValidatePNRController.submitEPlusEmail',
            transactionNumberList, pnr, additionalEmialAddress, sendToUser, sendToSecondaryUser);
        };
        svc.saveSelectedSeatsInfo = function (pnrInfo, prevSegmentSeatMapTraveler, userId) {

          return APIService.invokeAction('Sip_ValidatePNRController.saveSelectedSeats',
            pnrInfo, prevSegmentSeatMapTraveler, userId);
        };
        return svc;
      }])
    .factory('SecurityService', ['APIService',
      function (APIService) {

        var svc = {};

        svc.authenticate = function (username, password) {

          return APIService.invokeAction('Sip_LoginController.login', username, password);
        };
        svc.getTilePermissions = function (persona) {

          // TBD Hard Code for Persona
          // console.debug('*** Persona is');
          // console.debug(persona);
          return APIService.invokeAction('Sip_SecuritySettingController.getTileConfigrationByRoleName', persona);
        };
        svc.getUserInfo = function (userId) {

          return APIService.invokeAction('Sip_MyProfileController.getUserInfo', userId)
        };
        svc.getUserInfoExtension = function (contactId) {

          return APIService.invokeAction('Sip_MyProfileController.getUserInfoExtension', contactId)
        };
        svc.getImpersonationUserInfo = function (contactId) {

          return APIService.invokeAction('Sip_MyProfileController.getImpersonationUserByContactId', contactId);
        };
        svc.localLogout = function () {

          return APIService.invokeAction('Sip_ContentManagementController.localLogout')
        };
        svc.validatePassword = function (securityInfo) {

          return APIService.invokeAction('Sip_EditPasswordController.validatePassword', securityInfo)
        };
        svc.editChangePassword = function (securityInfo) {

          return APIService.invokeAction('Sip_EditPasswordController.changePassword', securityInfo)
        };
        svc.editVerifySecurityAnswer = function (securityAnswer) {

          return APIService.invokeAction('Sip_EditPasswordController.verifySecurityAnswer', securityAnswer)
        };
        svc.submitUsername = function (username) {

          return APIService.invokeAction('Sip_ForgetPasswordController.submitUsername', username)
        };
        svc.verifySecurityAnswer = function (username, securityAnswer) {

          return APIService.invokeAction('Sip_ForgetPasswordController.verifySecurityAnswer', username, securityAnswer)
        };
        svc.changePassword = function (newPassword, verifyNewPassword) {

          return APIService.invokeAction('Sip_ForgetPasswordController.changePassword', newPassword, verifyNewPassword)
        };

        return svc;
      }])
    .factory('TransactionHistoryService', ['APIService', '$q', 'APP_CONFIG', 'util',
      function (APIService, $q, APP_CONFIG, util) {
        var svc = {};

        svc.getAccountsForTransactionLog = function (userId, tileName, keyword) {

          var index = 0;
          var accounts = [];
          var deferred = $q.defer();

          var load = function (index) {

            svc.getAccountsForTransactionLogByPage(userId, tileName, keyword, index).then(
              function (val) {
                accounts = _.concat(accounts, val.Accounts);

                if (APP_CONFIG.env == 'dev' && index == 3) {
                  val.queryEndFlag = true;
                }

                if (!val.queryEndFlag) {
                  index++;
                  return load(index);
                }
                else {

                  if (APP_CONFIG.env == 'dev') {
                    var idIndex = 1;
                    _(accounts).forEach(function (acc) {
                      acc.Id = idIndex++;
                    });
                  }

                  accounts = util.sortAccount(accounts);
                  deferred.resolve({
                    Accounts: accounts
                  });
                }
              }, function (err) {

                deferred.reject(err);
              });
          };
          load(index, deferred);

          return deferred.promise;
        };
        svc.getAccountsForTransactionLogByPage = function (userId, tileName, keyword, queryTime) {

          return APIService.invokeAction('Sip_AccountController.getAccountsForTransactionLog',
            userId, tileName, keyword, queryTime);
        };
        svc.getDebitsByTransactionNumber = function (userId, transactionNumber) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getDebitsByTransactionNumber',
            userId, transactionNumber);
        };
        svc.getDebitsByAccId = function (filter, userId, accId) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getDebitsByAccId',
            filter, userId, accId);
        };
        svc.getDebitFilterConfig = function (userId, accId) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getDebitsFilterConfig',
            userId, accId);
        };
        svc.getDebitsByFilter = function (filter, userId) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getDebitsByFilter',
            filter, userId);
        };
        svc.getSummaryByFilter = function (filter, userId, arcNumber) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getSummaryByFilter',
            filter, userId, arcNumber);
        };
        svc.getTransactionDetail = function (transactionId, userId) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getTransactionDetail',
            transactionId, userId);
        };
        svc.refreshTransactionLogFromSI = function (userId, startDate, endDate) {

          return APIService.invokeAction('Sip_TransactionHistoryController.retrievelatestTransactionLog',
            userId, startDate, endDate);
        };
        svc.getTransactionDebitCSVUrl = function (filter, userId, accId, transactionNumber) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getTransactionDebitCSVUrl',
            filter, userId, accId, transactionNumber);
        };
        svc.getTransactionSummaryCSVUrl = function (filter, userId, arcNumber) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getTransactionSummaryCSVUrl',
            filter, userId, arcNumber);
        };
        svc.resendOTPEmail = function (emailAddress, transactionId, userId) {

          return APIService.invokeAction('Sip_TransactionHistoryController.resendOTPEmail',
            emailAddress, transactionId, userId);
        };
        svc.resendTravelCertEmail = function (transactionId, otherEmail) {

          return APIService.invokeAction('Sip_TransactionHistoryController.resendTravelCertEmail',
            transactionId, otherEmail);
        };
        svc.getFamilyReportUrl = function (accId, currentUserAccId) {

          return APIService.invokeAction('Sip_TransactionHistoryController.getFamilyReportUrl',
            accId, currentUserAccId);
        };
        return svc;
      }])
    .factory('UserManagementFactory', ['$state', 'LOG_CONFIG', function ($state, LOG_CONFIG) {
      var obj = {};
      obj.redirectUtil = function (stateName) {
        switch (stateName) {
          case 'um':
            $state.go('user-management');
          case 'home':
          case 'agencies':
          case 'fund':
          case 'branch':
          case 'dashboard':
            $state.go('user-management.' + stateName);
            break;
          case 'create':
          case 'create.one':
          case 'create.two':
          case 'create.three':
            $state.go('user-management-' + stateName);
            break;
        }
      };

      obj.devLog = function (logContent, logVal) {
        if (!LOG_CONFIG.enable) return false;

      };

      return obj;
    }])
})(); 
</script></span><span id="j_id0:j_id56">
<script type="text/javascript"> (function () {
  'use strict';
  angular.module('commonModule')
    .directive('dynamicModel', ['$compile', '$parse',
      function ($compile, $parse) {
        return {
          restrict: 'A',
          terminal: true,
          priority: 100000,
          link: function (scope, element, attrs) {

            var name = $parse(element.attr('dynamic-model'))(scope);
            element.removeAttr('dynamic-model');
            element.attr('ng-model', name);
            $compile(element)(scope);
          }
        };
      }])
    .directive('dynamicBind', ['$compile', '$parse',
      function ($compile, $parse) {
        return {
          restrict: 'A',
          terminal: true,
          priority: 100000,
          link: function (scope, element, attrs) {

            var name = $parse(element.attr('dynamic-bind'))(scope);
            element.removeAttr('dynamic-bind');
            element.attr('ng-bind-html', name + '?' + name + ": '&#160;'");
            $compile(element)(scope);
          }
        };
      }])
    .directive('focusOnClick', function () {
      return {
        restrict: 'C',
        link: function (scope, element, attrs) {
          $(element).click(function () {
            $(element).select();
          });
        }
      };
    })
    .directive('bootstrapTooltip', function () {
      return {
        restrict: 'C',
        link: function (scope, element, attrs) {
          $(element).hover(function () {
            // on mouseenter
            $(element).tooltip('show');
          }, function () {
            // on mouseleave
            $(element).tooltip('hide');
          });
        }
      };
    })
    .directive('datePicker', [function () {
      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          date: '=',
          id: '@',
          placeholder: '@'
        },
        template: '<div class="flatpickr"> \
        <div class="input-group custom" data-toggle>\
          <input id="input-{{id}}" type="text" class="form-control no-right-border flatpickr-input" data-input placeholder="{{placeholder}}" ng-model="date"/> \
            <span class="input-group-addon"> \
              <span class="glyphicon glyphicon-calendar"></span> \
            </span> \
            </div>\
        </div>',
        link: function (scope, element, attrs) {

          flatpickr(".flatpickr", {
            wrap: true,
            clickOpens: false,
            // dateFormat: 'Y/m/d',
            dateFormat: 'm/d/Y',
            disableMobile: true
          });
        }
      };
      return directive;
    }])
    .directive('datePickerTc', [function () {
      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          date: '=',
          id: '@',
          placeholder: '@',
          currentDate: '@'
        },
        template: '<div class="flatpickr"> \
        <div class="input-group custom" data-toggle>\
          <input id="input-{{id}}" type="text" class="form-control no-right-border flatpickr-input" data-input placeholder="{{placeholder}}" ng-model="date"/> \
            <span class="input-group-addon"> \
              <span class="glyphicon glyphicon-calendar"></span> \
            </span> \
            </div>\
        </div>',
        link: function (scope, element, attrs) {
          var d = new Date(),
            maxDate = d.getFullYear() + '-12-31';

          flatpickr(".flatpickr", {
            wrap: true,
            clickOpens: false,
            dateFormat: 'Y-m-d',
            maxDate: maxDate,
            minDate: scope.currentDate,
            disableMobile: true
          });
        }
      };
      return directive;
    }])
    .directive('sldsCheckbox', [function () {
      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          label: '@',
          id: '@',
          value: '@',
          class: '@',
          checked: '=',
          isdisabled: '='
        },
        template: '<div class="slds-form-element"> \
        <div class="slds-form-element__control"> \
          <span class="slds-checkbox"> \
            <input type="checkbox" name="options" id="input-{{id}}" value="{{value}}" class="input-{{class}}" ng-model="checked" ng-disabled="isdisabled"/> \
            <label class="slds-checkbox__label" for="input-{{id}}"> \
              <span class="slds-checkbox--faux" ng-class="{disabledChk:isdisabled}"></span> \
              <span class="slds-form-element__label" ng-bind-html="label | to_trusted"></span> \
            </label> \
          </span> \
        </div> \
      </div>'
      };

      return directive;
    }])
    .directive('sldsRadio', [function () {
      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          id: '@',
          value: '@',
          url: '@',
          name: '@',
          model: '='
        },
        template: '<fieldset class="slds-form-element"> \
                  <div class="slds-form-element__control"> \
                    <span class="slds-radio"> \
                      <input type="radio" id="input-{{id}}" value="{{value}}" name="input-{{name}}" url="{{url}}" ng-model="model"/> \
                      <label class="slds-radio__label" for="input-{{id}}"> \
                        <span class="slds-radio--faux"></span> \
                        <span class="slds-form-element__label">{{value}}</span> \
                      </label> \
                    </span> \
                  </div> \
                </fieldset>'
      };

      return directive;
    }])
    .directive('sldsSpinner', [function () {

      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        template: '<div class="slds-spinner_container"> \
        <div class="slds-spinner slds-spinner--medium" role="alert"> \
          <span class="slds-assistive-text">Loading</span> \
          <div class="slds-spinner__dot-a"></div> \
          <div class="slds-spinner__dot-b"></div> \
        </div> \
      </div>',
      };

      return directive;
    }])
    .directive('rexSpinner', [function () {

      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        template: '<div class="spinner-container"> \
          <div class="circles-container"> \
            <div class="circle circle-inner"></div> \
            <div class="circle circle-mid"></div> \
            <div class="circle circle-outer"></div> \
          </div> \
        </div>'
      };

      return directive;
    }])
    .directive('rexSpinnerInline', [function () {

      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        template: '<div class="spinner-container inline"> \
          <div class="circles-container"> \
            <div class="circle circle-mid"></div> \
            <div class="circle circle-outer"></div> \
          </div> \
        </div>'
      };

      return directive;
    }])
    .directive('stdTooltips', [function () {

      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          header: '@',
          type: '@', // info, alert
          contents: '=',
          nubbin: '@' // top, bottom, left, right
        },
        template: '<div class="slds-popover tooltips" \
                        ng-class="{\'slds-nubbin--bottom\': nubbin == \'bottom\' || nubbin == undefined, \
                                   \'slds-nubbin--top\': nubbin == \'top\', \
                                   \'slds-nubbin--left\': nubbin == \'left\', \
                                   \'slds-nubbin--right\': nubbin == \'right\', \
                                   \'alert-msg\': type == \'alert\', \
                                   \'info-msg\': type != \'alert\'}" \
                                   role="dialog"> \
          <div class="slds-popover__body"> \
            <p class="tooltips-header"> \
              <img alt="Information" src="/resource/Sip_img_info" ng-if="type == \'info\'"/> \
              <img alt="Alert" src="/resource/Sip_img_alert" ng-if="type == \'alert\'"/> \
              <span>{{header}}</span> \
            </p> \
            <p ng-repeat="content in contents" ng-bind-html="content | to_trusted"> \
            </p> \
          </div> \
        </div>'
      };

      return directive;
    }])
    .directive('stdTooltips2', [function () {

      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          header: '@',
          type: '@', // info, alert
          contents: '=',
          nubbin: '=' // top, bottom, left, right
        },
        template: '<div class="slds-popover tooltips" \
                        ng-class="{\'slds-nubbin--bottom\': nubbin == \'bottom\' || nubbin == undefined, \
                                   \'slds-nubbin--top\': nubbin == \'top\', \
                                   \'slds-nubbin--left\': nubbin == \'left\', \
                                   \'slds-nubbin--right\': nubbin == \'right\', \
                                   \'alert-msg\': type == \'alert\', \
                                   \'info-msg\': type != \'alert\'}" \
                                   role="dialog"> \
          <div class="slds-popover__body"> \
            <p class="tooltips-header"> \
              <img alt="Information" src="/resource/Sip_img_info" ng-if="type == \'info\'"/> \
              <img alt="Alert" src="/resource/Sip_img_alert" ng-if="type == \'alert\'"/> \
              <span>{{header}}</span> \
            </p> \
            <p ng-repeat="content in contents" ng-bind-html="content | to_trusted"> \
            </p> \
          </div> \
        </div>'
      };

      return directive;
    }])
    .directive('customTooltips', [function () {

      var directive = {
        restrict: 'E',
        transclude: true,
        replace: false,
        scope: {
          header: '@',
          type: '@', // info, alert,
          nubbin: '@'
        },
        template: '<div class="slds-popover {{nubbin ? (nubbin == \'top\' ? \'slds-nubbin--top\' : \'slds-nubbin--bottom\') : \'slds-nubbin--bottom\'}} {{type == \'alert\' ? \'alert-msg\' : \'info-msg\' }}" role="dialog"> \
          <div class="slds-popover__body"> \
            <p class="tooltips-header"> \
              <img alt="Information" src="/resource/Sip_img_info" ng-if="type == \'info\'"/> \
              <img alt="Alert" src="/resource/Sip_img_alert" ng-if="type == \'alert\'"/> \
              <span>{{header}}</span> \
            </p> \
            <div ng-transclude></div> \
          </div> \
        </div>'
      };

      return directive;
    }])
    .directive('inlineTooltips', [function () {

      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          type: '@', // info, alert
          content: '@'
        },
        template: '<div class="tooltips inline {{type == \'alert\' ? \'alert-msg\' : \'info-msg\' }}"> \
          <span> \
            <img alt="Information" src="/resource/Sip_img_info_white" \
                 ng-if="type == \'info-white\'"/> \
            <img alt="Information" src="/resource/Sip_img_info" \
                 ng-if="type == \'info\'"/> \
            <img alt="Alert" src="/resource/Sip_img_alert" \
                 ng-if="type == \'alert\'"/> \
          </span> \
          <span ng-bind-html="content | to_trusted"></span> \
        </div>'
      };

      return directive;
    }])
    .directive('modal', [function ($templateCache) {

      var directive = {
        restrict: 'E',
        transclude: true,
        replace: false,
        scope: {
          identity: '@',
          type: '@' // info, alert, success
        },
        template: '<div class="modal-dialog" role="document"> \
          <div class="modal-content \
                      {{type == \'alert\' ? \'alert-msg\' : \
                        type == \'info\' ? \'info-msg\' : \
                        type == \'success\' ? \'success-msg\' : \
                        type == \'success-svg\' ? \'success-msg\' : \'\'}}"> \
            <div class="modal-body"> \
              <img class="icon" src="/resource/Sip_img_alert_orange" alt="Alert" ng-if="type == \'alert\'"/> \
              <img class="icon" src="/resource/Sip_img_info" alt="Information" ng-if="type == \'info\'"/> \
              <img class="icon" src="/resource/Sip_img_success" alt="Success" ng-if="type == \'success\'"/> \
              <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" \
                   ng-if="type == \'success-svg\'"> \
                  <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/> \
                  <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/> \
              </svg> \
              <div ng-transclude></div> \
            </div> \
           </div> \
          </div> \
        </div>'
      };

      return directive;
    }])
    .directive('externalCard', [function () {
      //specific for landing page
      //Demo directive by Ming
      //Anyone who need to set DOM ,please use this workflow.

      return {
        restrict: 'C',
        link: function (scope, element, attrs) {

          // var title = $(element).children('div').children()[0].tagName.toLowerCase();
          var strVar = "";
          strVar += "   <i class=\"external-link-small\">";
          strVar += "              <svg aria-hidden=\"true\"class=\"slds-button__icon new-window-icon\">";
          strVar += "                <use xmlns:xlink=\"http:\/\/www.w3.org\/1999\/xlink\"";
          strVar += "                     xlink:href=\"./resource\/Sip_salesforce_lightning_design_system\/assets\/icons\/utility-sprite\/svg\/symbols.svg#new_window\"><\/use>";
          strVar += "              <\/svg>";
          strVar += "            <\/i>";


          //MarketingContent 2
          if ($(element[0]).find('#marketing-02-wrap').length > 0) {
            var isExternal = $(element[0]).find('#marketing-02-wrap').data('is-external');
            if (!isExternal) {
              return false;
            }
            $(element).find('a').last().before(strVar);
            $(element).find('svg').css({'color': '#fff'})
            return;
          }

          //Subscribe
          if (/external-link-subscribe/.test(element[0].className)) {
            $(element).find('a').last().before(strVar);
            return;
          }

          //MarketingContent 1

        }
      }
    }])
    .directive('wipMark', [function () {
      //specific for landing page
      //Demo directive by Ming
      //Anyone who need to set DOM ,please use this workflow.

      return {
        restrict: 'CA',
        link: function (scope, element, attrs) {

          if (!$) return;

          var title = "WIP";

          var el = $('<h3>' + title + '</h3>');

          el.css({
            position: 'absolute',
            top: '0',
            left: '50%',
            color: '#999',
            fontSize: '18px',
            transform: 'rotate(30deg)'
          });
          element.append(el);
        }
      }
    }])
    .directive('sldsCheckboxAccess', [function () {
      var ddo = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          label: '@',
          id: '@',
          value: '@',
          checked: '=',
          sldsDisabled: '=',
          ngChangeFunc: '&'
        },
        template: '<div class="slds-form-element"> \
        <div class="slds-form-element__control"> \
          <span class="slds-checkbox"> \
            <input type="checkbox" name="options" id="input-{{id}}" value="{{value}}" ng-model="checked" ng-disabled="sldsDisabled" ng-click="ngChangeFunc(this)"/> \
            <label class="slds-checkbox__label" for="input-{{id}}"> \
              <span class="slds-checkbox--faux" ng-class="{disabledChk:sldsDisabled}"></span> \
              <span class="slds-form-element__label">{{label}}</span> \
            </label> \
          </span> \
        </div> \
      </div>'
      };
      return ddo;
    }])
    .directive('sldsCheckboxProfile', [function () {
      var directive = {
        restrict: 'E',
        transclude: false,
        replace: true,
        scope: {
          label: '@',
          id: '@',
          value: '@',
          class: '@'
        },
        template: '<div class="slds-form-element"> \
        <div class="slds-form-element__control"> \
          <span class="slds-checkbox"> \
            <input type="checkbox" name="options" id="input-{{id}}" value="{{value}}" class="input-{{class}}"/> \
            <label class="slds-checkbox__label" for="input-{{id}}"> \
              <span class="slds-checkbox--faux" ng-class="{disabledChk:disabled}"></span> \
              <span class="slds-form-element__label">{{label}}</span> \
            </label> \
          </span> \
        </div> \
      </div>'
      };

      return directive;
    }])
    .directive('onlyDigits', function () {
      /* use case :
       *  <input type="text" class="form-control" ng-model="record.changeVal" only-digits="true"/>
       *  restrict use to only input digit   :jason
       * */
      return {
        restrict: 'A',
        require: '?ngModel',
        link: function (scope, element, attrs, ngModel) {
          // if (!ngModel) return;
          // ngModel.$parsers.unshift(function (inputValue) {
          //   var digits = inputValue.split('').filter(function (s) {
          //     return (!isNaN(s) && s != ' ' && s != '+' && s != '-');
          //   }).join('');
          //   ngModel.$viewValue = digits;
          //   ngModel.$render();
          //   return digits;
          // });

          ngModel.$parsers.push(function (inputValue) {
            inputValue += ''
            if (inputValue == undefined) return ''
            var transformedInput = inputValue.replace(/[^0-9]/g, '')
            var postTransFormdInput = inputValue.replace(/,/g, '')

            var firstDot = postTransFormdInput.indexOf('.')

            if (firstDot != -1) {
              var arr = transformedInput.split('')
              arr.splice(firstDot, 0, '.')
              arr.splice(firstDot + 3)
              transformedInput = arr.join('')
            }

            if (transformedInput != inputValue) {
              ngModel.$setViewValue(transformedInput)
              ngModel.$render()
            }
            return transformedInput
          })
        }
      };
    })
})(); 
</script></span><span id="j_id0:j_id59">
<script type="text/javascript"> (function () {
  'use strict';

  /*****************************************
   In Page use ngBindHtml directive
   And Use this filter
   All html script will be decode
   'angular way'
   /*****************************************/
  angular.module('commonModule')
    .filter('to_trusted', ['$sce', function ($sce) {

      return function (text) {

        return $sce.trustAsHtml(text);
      };
    }])
    .filter('reverseDate', [function () {

      return function (text) {

        if (!text) {
          return;
        }

        return text.split('-').map(function (item) {

          return item.trim().split(' ').reverse().join(' ')
        }).join(' - ');
      };
    }])
    .filter('formatToDate', [function () {

      return function (text) {

        var d = new Date(Date.parse(text));
        return d;
      };
    }])
    .filter('formatToDateDumb', [function () {

      return function (text) {

        var d = '';
        try {
          if (text) {
            var idx = text.indexOf(' ', 0);
            var iMonth = text.substring(0, idx);
            var month = '';
            switch (iMonth) {
              case '1':
              case '01':
                month = 'Jan';
                break;
              case '2':
              case '02':
                month = 'Feb';
                break;
              case '3':
              case '03':
                month = 'Mar';
                break;
              case '4':
              case '04':
                month = 'Apr';
                break;
              case '5':
              case '05':
                month = 'May';
                break;
              case '6':
              case '06':
                month = 'Jun';
                break;
              case '7':
              case '07':
                month = 'Jul';
                break;
              case '8':
              case '08':
                month = 'Aug';
                break;
              case '9':
              case '09':
                month = 'Sep';
                break;
              case '10':
                month = 'Oct';
                break;
              case '11':
                month = 'Nov';
                break;
              case '12':
                month = 'Dec';
                break;
            }
            text = month + ' ' + text.substring(idx + 1, text.length);
            d = new Date(Date.parse(text));
          }
        }
        catch (ex) {
          d = '';
        }
        return d;
      };
    }])
    .filter('getNameInUsername', [function (str) {

      return function (str) {

        if (str) {
          return str.split('@')[0]
        }
      };
    }]);

})(); 
</script></span><span id="j_id0:j_id62">
<script type="text/javascript"> (function () {
  'use strict';
  angular.module('commonModule')
    .directive('paragraph', ['formPattern', function (formPattern) {
      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ctrl) {

          var isValid = function (input) {

            if (!input) {
              return true;
            }

            var regex = new RegExp(formPattern.paragraph);
            return regex.test(input);
          };

          element.bind("keydown keypress", function (event) {

            var functionKeys = [8, 9, 13, 37, 39, 46, 91, 92];
            if (_.indexOf(functionKeys, event.which) > -1) {
              return true;
            }
            else {
              var regex = new RegExp(formPattern.paragraph);
              var key = event.key;
              if (!regex.test(key)) {
                event.preventDefault();
                return false;
              }
            }
          });

          ctrl.$validators.paragraph = function (modelVal, viewVal) {

            return isValid(viewVal);
          };

          scope.$watch(attrs.ngModel, function (newVal, oldVal, scope) {

            ctrl.$validate();
          });
        }
      }
    }])
    .directive('alphaNumeric', ['formPattern', function (formPattern) {
      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ctrl) {

          var isValid = function (input) {

            if (!input) {
              return true;
            }

            var regex = new RegExp(formPattern.alphaNumeric);
            return regex.test(input);
          };

          element.bind("keydown keypress", function (event) {

            var functionKeys = [8, 9, 37, 39];
            if (_.indexOf(functionKeys, event.which) > -1) {
              return true;
            }
            else {
              var regex = new RegExp(formPattern.alphaNumeric);
              var key = event.key;
              if (!regex.test(key)) {
                event.preventDefault();
                return false;
              }
            }
          });

          ctrl.$validators.alphaNumeric = function (modelVal, viewVal) {

            return isValid(viewVal);
          };

          scope.$watch(attrs.ngModel, function (newVal, oldVal, scope) {

            ctrl.$validate();
          });
        }
      }
    }])
    .directive('alphaNumericSpace', ['formPattern', function (formPattern) {
      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ctrl) {

          var isValid = function (input) {

            if (!input) {
              return true;
            }

            var regex = new RegExp(formPattern.alphaNumericSpace);
            return regex.test(input);
          };

          element.bind("keydown keypress", function (event) {

            var functionKeys = [8, 9, 32, 37, 39];
            if (_.indexOf(functionKeys, event.which) > -1) {
              return true;
            }
            var regex = new RegExp(formPattern.alphaNumericSpace);
            var key = event.key;
            if (!regex.test(key)) {
              event.preventDefault();
              return false;
            }
          });

          ctrl.$validators.alphaNumericSpace = function (modelVal, viewVal) {

            return isValid(viewVal);
          };

          scope.$watch(attrs.ngModel, function (newVal, oldVal, scope) {

            ctrl.$validate();
          });
        }
      }
    }])
    .directive('alphaNumericSpaceDash', ['formPattern', function (formPattern) {
      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ctrl) {

          var isValid = function (input) {

            if (!input) {
              return true;
            }

            var regex = new RegExp(formPattern.alphaNumericSpaceDash);
            return regex.test(input);
          };

          element.bind("keydown keypress", function (event) {

            var functionKeys = [8, 9, 32, 37, 39];
            if (_.indexOf(functionKeys, event.which) > -1) {
              return true;
            }
            var regex = new RegExp(formPattern.alphaNumericSpaceDash);
            var key = event.key;
            if (!regex.test(key)) {
              event.preventDefault();
              return false;
            }
          });

          ctrl.$validators.alphaNumericSpaceDash = function (modelVal, viewVal) {

            return isValid(viewVal);
          };

          scope.$watch(attrs.ngModel, function (newVal, oldVal, scope) {

            ctrl.$validate();
          });
        }
      }
    }])
    .directive('inList', function () {
      return {
        restrict: 'A',
        require: 'ngModel',
        scope: {
          source: '=',
          field: '@'
        },
        link: function (scope, element, attrs, ctrl) {

          var isInList = function (input) {

            if (!input) {
              return true;
            }
            if (scope.source) {

              var match = false;
              if (scope.field) {
                _(scope.source).forEach(function (item) {

                  if (item[scope.field] == input) {
                    match = true;
                  }
                });
              }
              else {
                _(scope.source).forEach(function (item) {

                  if (item == input) {
                    match = true;
                  }
                });
              }
              return match;
            }
            else {
              return false;
            }
          };

          ctrl.$validators.inList = function (modelVal, viewVal) {

            return isInList(viewVal);
          };

          scope.$watch(attrs.ngModel, function (newVal, oldVal, scope) {

            ctrl.$validate();
          });
        }
      }
    })
    .directive('inCountryList', function () {
      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ctrl) {

          var params = attrs['inCountryList'].split(',');
          var compFlg = params[0];
          var countryList = params[1];
          var ctrlName = params[2];
          var ngModelName = params[3];

          if (compFlg === 'comp') {
            ngModelName = 'scope.$ctrl.' + ngModelName;
          }

          var isInList = function (item, list) {

            if (!item) {
              return true;
            }
            if (list) {
              return list.some(function (countryName) {

                return angular.uppercase(countryName) == angular.uppercase(item);
              })
            }
          };

          ctrl.$validators.inCountryList = function (modelVal, viewVal) {

            if (compFlg === 'comp') {
              return isInList(viewVal, scope['$ctrl'][countryList]);
            } else {
              return isInList(viewVal, scope[countryList]);
            }
          };

          scope.$watch(ngModelName, function (newVal, oldVal, scope) {

            ctrl.$validate();
          });
        }
      }
    })
    .directive('formValidatePhone', function () {

      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ctrl) {

          ctrl.$validators.validatePhone = function (modelVal, viewVal) {

            if (!viewVal) {
              return true;
            }

            // Ryan 20170310 :
            // Phone 20 digit; include space
            if (viewVal.length > 20) {
              return false;
            }

            var phone_number = viewVal.replace(/\s+/g, "");
            return /^[\d()+-\s]+$/.test(phone_number);
          };

          scope.$watch(attrs.ngModel, function (newVal, oldVal, scope) {

            ctrl.$validate();
          })
        }
      }
    })
    .directive('inAirportsList', function () {
      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ctrl) {

          var params = attrs['inAirportsList'].split(',');
          var compFlg = params[0];
          var countryList = params[1];
          var ctrlName = params[2];
          var ngModelName = params[3];

          if (compFlg === 'comp') {
            ngModelName = 'scope.$ctrl.' + ngModelName;
          }

          var isInList = function (item, list) {

            if (!item) {
              return true;
            }
            if (list) {
              return list.some(function (countryName) {

                return countryName['name'] == item;
              })
            } else {
              return true;
            }
          };

          ctrl.$validators.inAirportsList = function (modelVal, viewVal) {

            if (compFlg === 'comp') {
              return isInList(viewVal, scope['$ctrl'][countryList]);
            } else {
              return isInList(viewVal, scope[countryList]);
            }
          };

          scope.$watch(ngModelName, function (newVal, oldVal, scope) {

            ctrl.$validate();
          })
        }
      }
    })
    .factory('dataURLtoBlobService', [function (dataurl) {

      return function (dataurl) {

        var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
          bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
        while (n--) {
          u8arr[n] = bstr.charCodeAt(n);
        }
        return new Blob([u8arr], {type: mime});
      };
    }])
    .factory('isUsernameAvailable', ['CMSService', '$q', function (CMSService, $q) {

      return function (val) {

        var deferred = $q.defer();
        CMSService.validationHelper({name: 'username', val: val}).then(function (data) {

          if (data.state == "Success") {
            deferred.resolve();
          } else {
            deferred.reject();
          }
        });
        return deferred.promise;
      }
    }])
    .factory('isUcsAvailable', ['CMSService', '$q', function (CMSService, $q) {

      return function (val) {

        var deferred = $q.defer();
        CMSService.validationHelper({name: 'ucsNumber', val: val}).then(function (data) {

          if (data.state == "Success") {
            deferred.resolve();
          } else {
            deferred.reject();
          }
        });
        return deferred.promise;
      }
    }])
    .factory('isArcNumberAvailable', ['CMSService', '$q', function (CMSService, $q) {

      return function (val) {

        var deferred = $q.defer();
        CMSService.validationHelper({name: 'arcNumber', val: val}).then(function (data) {

          if (data.state == "Success") {
            deferred.resolve();
          } else {
            deferred.reject();
          }
        });
        return deferred.promise;
      }
    }])
    .directive('uniqueUsername', ['isUsernameAvailable', function (isUsernameAvailable) {

      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ngModel) {

          ngModel.$asyncValidators.unique = isUsernameAvailable;
        }
      };
    }])
    .directive('uniqueUcs', ['isUcsAvailable', function (isUcsAvailable) {

      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ngModel) {

          ngModel.$asyncValidators.uniqueUcs = isUcsAvailable;
        }
      };
    }])
    .directive('uniqueArcNumber', ['isArcNumberAvailable', function (isArcNumberAvailable) {

      return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ngModel) {

          ngModel.$asyncValidators.uniqueArcNumber = isArcNumberAvailable;
        }
      };
    }])
    .constant("formPattern", {
      paragraph: /^[a-zA-Z0-9 \b\n.,:;\(\)-]*$/,
      alphaNumeric: /^[a-zA-Z0-9]+$/,
      alphaNumericSpace: /^[a-zA-Z0-9 ]+$/,
      alphaNumericSpaceDash: /^[a-zA-Z0-9\- ]+$/,
      username: /^[\da-zA-Z_.]*$/,
      iata: /^\d{0,8}$/,
      ucs: /^\d{0,5}$/
    })
})(); 
</script></span>





<script src="/resource/Sip_angular/angular-messages.min.js" type="text/javascript"></script>


<script id="nodes_renderer.html" type="text/ng-template">
  <div ui-tree-handle="true"
       class="tree-node tree-node-content "
       data-nodrag="true"
       ng-click="clickT3(node,this)">
    <span ng-show="!collapsed && node.id.toString().length==2"
          class="slds-icon_container">
      <svg aria-hidden="true" class="slds-icon slds-icon-text-default">
        <use xmlns:xlink="http://www.w3.org/1999/xlink"
             xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
      </svg>
      <span class="slds-assistive-text">Close menu</span>
    </span>
    <span class="slds-icon_container"
          ng-show="collapsed && node.id.toString().length==2">
      <svg aria-hidden="true" class="slds-icon slds-icon-text-default">
        <use xmlns:xlink="http://www.w3.org/1999/xlink"
             xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#add"></use>
      </svg>
      <span class="slds-assistive-text">Expand menu</span>
    </span>
    {{node.title}}
    <svg aria-hidden="true" ng-if="node.SIP_Link_To_External_URL__c" class="slds-button__icon new-window-icon"
         style="fill:#fff;">
      <use xmlns:xlink="http://www.w3.org/1999/xlink"
           xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#new_window"></use>
    </svg>
    <!--************************************-->
  </div>
  <ol ui-tree-nodes="true"
      ng-model="node.nodes"
      ng-class="{hidden: collapsed}">
    <li ng-repeat="node in node.nodes"
        ui-tree-node="true"
        ng-include="'nodes_renderer.html'"
        ng-show="visible(node)">
    </li>
  </ol>
</script>
<script id="massUploadTempl.html" type="text/ng-template">
  <div id="alert-modal-massupload"
       aria-labelledby="alert-modal-massupload"
       class="modal fade"
       tabindex="-1"
       role="dialog"
       aria-hidden="true"
       data-backdrop="static"
       data-keyboard="false">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header text-center" style="border-bottom: 0;">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&#215;</span></button>
          <h4 class="modal-title " ng-hide="$ctrl.massArcNumber">Mass Upload Users</h4>
          <h4 class="modal-title " ng-show="$ctrl.massArcNumber">Mass Upload Users for
            <strong>{{$ctrl.massArcNumber}}</strong></h4>
        </div>
        <div class="modal-body mass-content">
          <div class="row mass-download">
            <div class="col-xs-8">
              <p class="template-title">Template</p>
              <p class="template-title">Standard template .csv</p>
            </div>
            <div class="col-xs-4">
              <div class="action-item tertiary download-btn">
                <a href="/servlet/servlet.FileDownload?file=01536000002VKZW"
                   class="uppercase-font">Download</a>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <a href="#/sub-link/doc-uma" target="_blank" class="">View Role & Permission Group Table</a>
            </div>
          </div>
          <div class="row "
               id="click-upload-mass">
            <p>Upload file from your computer</p>
            <div class="c-inline c-inlineMass" style="margin-bottom: 10px;">
              <inline-tooltips type="info"
                               content="The Maximum Number of Records to Upload One Time is 200<br>All the fields in the template are required"></inline-tooltips>
            </div>
            <div class="input-group">
              <label for="massFile" class="slds-assistive-text">mass file</label>
              <input type="file"
                     id="massFile"
                     class="form-control no-right-border"
                     style="display: none;"
                     accept=".csv"
                     onchange="angular.element(this).scope().$ctrl.previewCsv(this)"
                     placeholder="Locate file from your local drive."/>
              <label for="locate-file" class="slds-assistive-text">locate file</label>
              <input id="locate-file" type="text"
                     class="form-control no-right-border"
                     readonly="true"
                     ng-model="$ctrl.previewFileName"
                     ng-click="$ctrl.clickLookUp()"
                     placeholder="Locate file from your local drive."/>
              <span class="input-group-addon right" ng-click="$ctrl.clickLookUp()">
                <svg aria-hidden="true" class="slds-button__icon slds-button__icon--large">
                  <use xmlns:xlink="http://www.w3.org/1999/xlink"
                       xlink:href="/resource/Sip_salesforce_lightning_design_system/assets/icons/utility-sprite/svg/symbols.svg#search"></use>
                </svg>
              </span>
            </div>
          </div>
        </div>
        <div class="modal-footer" style="border-top: 0;">
          <div class="row button">
            <div class="col-xs-6">
              <div class="action-item secondary r-margin">
                <a href=""
                   id="mass-cancel"
                   data-dismiss="modal"
                   ng-click="$ctrl.resetMass()"
                   class="uppercase-font">cancel</a>
              </div>
            </div>
            <div class="col-xs-6">
              <div class="action-item tertiary l-margin">
                <a href=""
                   ng-click="$ctrl.uploadMass()"
                   class="uppercase-font"
                   ng-bind="$ctrl.massUploadBtnText"></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</script>

<script id="error-messages-required" type="text/ng-template">
  <div ng-message="required" class="error-msg">Please enter all required fields.</div>
</script>
<script id="error-messages-email" type="text/ng-template">
  <p ng-message="email" class="error-msg">Check email format</p>
</script>
<script id="error-messages-phone" type="text/ng-template">
  <p ng-message="validatePhone" class="error-msg">Check cell phone number format</p>
</script>
<script id="error-messages-invalid-option" type="text/ng-template">
  <p ng-message="inList" class="error-msg">Invalid option</p>
</script>
<script id="error-messages-invalid-paragraph" type="text/ng-template">
  <p ng-message="paragraph" class="error-msg">Invalid character(s) exist in input</p>
</script>
<script id="error-messages-username" type="text/ng-template">
  <p ng-message="pattern" class="error-msg">Please check your username format</p>
</script>
<script id="error-messages-airport" type="text/ng-template">
  <p ng-message="inAirportsList" class="error-msg">Airport must be in the provided list</p>
</script>
<script id="error-messages-country" type="text/ng-template">
  <p ng-message="inCountryList" class="error-msg">Country must be in the provided list</p>
</script>
<script id="error-messages-username-unique" type="text/ng-template">
  <p ng-message="unique" class="error-msg">This Username is already in use. Please choose a different username</p>
</script>

</body>
</html>